
/*
 *
 * More info at [www.dropzonejs.com](http://www.dropzonejs.com)
 *
 * Copyright (c) 2012, Matias Meno
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */

(function() {
  var Dropzone, Emitter, camelize, contentLoaded, detectVerticalSquash, drawImageIOSFix, noop, without,
    __slice = [].slice,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  noop = function() {};

  Emitter = (function() {
    function Emitter() {}

    Emitter.prototype.addEventListener = Emitter.prototype.on;

    Emitter.prototype.on = function(event, fn) {
      this._callbacks = this._callbacks || {};
      if (!this._callbacks[event]) {
        this._callbacks[event] = [];
      }
      this._callbacks[event].push(fn);
      return this;
    };

    Emitter.prototype.emit = function() {
      var args, callback, callbacks, event, _i, _len;
      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      this._callbacks = this._callbacks || {};
      callbacks = this._callbacks[event];
      if (callbacks) {
        for (_i = 0, _len = callbacks.length; _i < _len; _i++) {
          callback = callbacks[_i];
          callback.apply(this, args);
        }
      }
      return this;
    };

    Emitter.prototype.removeListener = Emitter.prototype.off;

    Emitter.prototype.removeAllListeners = Emitter.prototype.off;

    Emitter.prototype.removeEventListener = Emitter.prototype.off;

    Emitter.prototype.off = function(event, fn) {
      var callback, callbacks, i, _i, _len;
      if (!this._callbacks || arguments.length === 0) {
        this._callbacks = {};
        return this;
      }
      callbacks = this._callbacks[event];
      if (!callbacks) {
        return this;
      }
      if (arguments.length === 1) {
        delete this._callbacks[event];
        return this;
      }
      for (i = _i = 0, _len = callbacks.length; _i < _len; i = ++_i) {
        callback = callbacks[i];
        if (callback === fn) {
          callbacks.splice(i, 1);
          break;
        }
      }
      return this;
    };

    return Emitter;

  })();

  Dropzone = (function(_super) {
    var extend, resolveOption;

    __extends(Dropzone, _super);

    Dropzone.prototype.Emitter = Emitter;


    /*
    This is a list of all available events you can register on a dropzone object.
    
    You can register an event handler like this:
    
        dropzone.on("dragEnter", function() { });
     */

    Dropzone.prototype.events = ["drop", "dragstart", "dragend", "dragenter", "dragover", "dragleave", "addedfile", "addedfiles", "removedfile", "thumbnail", "error", "errormultiple", "processing", "processingmultiple", "uploadprogress", "totaluploadprogress", "sending", "sendingmultiple", "success", "successmultiple", "canceled", "canceledmultiple", "complete", "completemultiple", "reset", "maxfilesexceeded", "maxfilesreached", "queuecomplete"];

    Dropzone.prototype.defaultOptions = {
      url: null,
      method: "post",
      withCredentials: false,
      parallelUploads: 2,
      uploadMultiple: false,
      maxFilesize: 256,
      paramName: "file",
      createImageThumbnails: true,
      maxThumbnailFilesize: 10,
      thumbnailWidth: 120,
      thumbnailHeight: 120,
      filesizeBase: 1000,
      maxFiles: null,
      params: {},
      clickable: true,
      ignoreHiddenFiles: true,
      acceptedFiles: null,
      acceptedMimeTypes: null,
      autoProcessQueue: true,
      autoQueue: true,
      addRemoveLinks: false,
      previewsContainer: null,
      hiddenInputContainer: "body",
      capture: null,
      renameFilename: null,
      dictDefaultMessage: "Drop files here to upload",
      dictFallbackMessage: "Your browser does not support drag'n'drop file uploads.",
      dictFallbackText: "Please use the fallback form below to upload your files like in the olden days.",
      dictFileTooBig: "File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",
      dictInvalidFileType: "You can't upload files of this type.",
      dictResponseError: "Server responded with {{statusCode}} code.",
      dictCancelUpload: "Cancel upload",
      dictCancelUploadConfirmation: "Are you sure you want to cancel this upload?",
      dictRemoveFile: "Remove file",
      dictRemoveFileConfirmation: null,
      dictMaxFilesExceeded: "You can not upload any more files.",
      accept: function(file, done) {
        return done();
      },
      init: function() {
        return noop;
      },
      forceFallback: false,
      fallback: function() {
        var child, messageElement, span, _i, _len, _ref;
        this.element.className = "" + this.element.className + " dz-browser-not-supported";
        _ref = this.element.getElementsByTagName("div");
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          child = _ref[_i];
          if (/(^| )dz-message($| )/.test(child.className)) {
            messageElement = child;
            child.className = "dz-message";
            continue;
          }
        }
        if (!messageElement) {
          messageElement = Dropzone.createElement("<div class=\"dz-message\"><span></span></div>");
          this.element.appendChild(messageElement);
        }
        span = messageElement.getElementsByTagName("span")[0];
        if (span) {
          if (span.textContent != null) {
            span.textContent = this.options.dictFallbackMessage;
          } else if (span.innerText != null) {
            span.innerText = this.options.dictFallbackMessage;
          }
        }
        return this.element.appendChild(this.getFallbackForm());
      },
      resize: function(file) {
        var info, srcRatio, trgRatio;
        info = {
          srcX: 0,
          srcY: 0,
          srcWidth: file.width,
          srcHeight: file.height
        };
        srcRatio = file.width / file.height;
        info.optWidth = this.options.thumbnailWidth;
        info.optHeight = this.options.thumbnailHeight;
        if ((info.optWidth == null) && (info.optHeight == null)) {
          info.optWidth = info.srcWidth;
          info.optHeight = info.srcHeight;
        } else if (info.optWidth == null) {
          info.optWidth = srcRatio * info.optHeight;
        } else if (info.optHeight == null) {
          info.optHeight = (1 / srcRatio) * info.optWidth;
        }
        trgRatio = info.optWidth / info.optHeight;
        if (file.height < info.optHeight || file.width < info.optWidth) {
          info.trgHeight = info.srcHeight;
          info.trgWidth = info.srcWidth;
        } else {
          if (srcRatio > trgRatio) {
            info.srcHeight = file.height;
            info.srcWidth = info.srcHeight * trgRatio;
          } else {
            info.srcWidth = file.width;
            info.srcHeight = info.srcWidth / trgRatio;
          }
        }
        info.srcX = (file.width - info.srcWidth) / 2;
        info.srcY = (file.height - info.srcHeight) / 2;
        return info;
      },

      /*
      Those functions register themselves to the events on init and handle all
      the user interface specific stuff. Overwriting them won't break the upload
      but can break the way it's displayed.
      You can overwrite them if you don't like the default behavior. If you just
      want to add an additional event handler, register it on the dropzone object
      and don't overwrite those options.
       */
      drop: function(e) {
        return this.element.classList.remove("dz-drag-hover");
      },
      dragstart: noop,
      dragend: function(e) {
        return this.element.classList.remove("dz-drag-hover");
      },
      dragenter: function(e) {
        return this.element.classList.add("dz-drag-hover");
      },
      dragover: function(e) {
        return this.element.classList.add("dz-drag-hover");
      },
      dragleave: function(e) {
        return this.element.classList.remove("dz-drag-hover");
      },
      paste: noop,
      reset: function() {
        return this.element.classList.remove("dz-started");
      },
      addedfile: function(file) {
        var node, removeFileEvent, removeLink, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _results;
        if (this.element === this.previewsContainer) {
          this.element.classList.add("dz-started");
        }
        if (this.previewsContainer) {
          file.previewElement = Dropzone.createElement(this.options.previewTemplate.trim());
          file.previewTemplate = file.previewElement;
          this.previewsContainer.appendChild(file.previewElement);
          _ref = file.previewElement.querySelectorAll("[data-dz-name]");
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            node = _ref[_i];
            node.textContent = this._renameFilename(file.name);
          }
          _ref1 = file.previewElement.querySelectorAll("[data-dz-size]");
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            node = _ref1[_j];
            node.innerHTML = this.filesize(file.size);
          }
          if (this.options.addRemoveLinks) {
            file._removeLink = Dropzone.createElement("<a class=\"dz-remove\" href=\"javascript:undefined;\" data-dz-remove>" + this.options.dictRemoveFile + "</a>");
            file.previewElement.appendChild(file._removeLink);
          }
          removeFileEvent = (function(_this) {
            return function(e) {
              e.preventDefault();
              e.stopPropagation();
              if (file.status === Dropzone.UPLOADING) {
                return Dropzone.confirm(_this.options.dictCancelUploadConfirmation, function() {
                  return _this.removeFile(file);
                });
              } else {
                if (_this.options.dictRemoveFileConfirmation) {
                  return Dropzone.confirm(_this.options.dictRemoveFileConfirmation, function() {
                    return _this.removeFile(file);
                  });
                } else {
                  return _this.removeFile(file);
                }
              }
            };
          })(this);
          _ref2 = file.previewElement.querySelectorAll("[data-dz-remove]");
          _results = [];
          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
            removeLink = _ref2[_k];
            _results.push(removeLink.addEventListener("click", removeFileEvent));
          }
          return _results;
        }
      },
      removedfile: function(file) {
        var _ref;
        if (file.previewElement) {
          if ((_ref = file.previewElement) != null) {
            _ref.parentNode.removeChild(file.previewElement);
          }
        }
        return this._updateMaxFilesReachedClass();
      },
      thumbnail: function(file, dataUrl) {
        var thumbnailElement, _i, _len, _ref;
        if (file.previewElement) {
          file.previewElement.classList.remove("dz-file-preview");
          _ref = file.previewElement.querySelectorAll("[data-dz-thumbnail]");
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            thumbnailElement = _ref[_i];
            thumbnailElement.alt = file.name;
            thumbnailElement.src = dataUrl;
          }
          return setTimeout(((function(_this) {
            return function() {
              return file.previewElement.classList.add("dz-image-preview");
            };
          })(this)), 1);
        }
      },
      error: function(file, message) {
        var node, _i, _len, _ref, _results;
        if (file.previewElement) {
          file.previewElement.classList.add("dz-error");
          if (typeof message !== "String" && message.error) {
            message = message.error;
          }
          _ref = file.previewElement.querySelectorAll("[data-dz-errormessage]");
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            node = _ref[_i];
            _results.push(node.textContent = message);
          }
          return _results;
        }
      },
      errormultiple: noop,
      processing: function(file) {
        if (file.previewElement) {
          file.previewElement.classList.add("dz-processing");
          if (file._removeLink) {
            return file._removeLink.textContent = this.options.dictCancelUpload;
          }
        }
      },
      processingmultiple: noop,
      uploadprogress: function(file, progress, bytesSent) {
        var node, _i, _len, _ref, _results;
        if (file.previewElement) {
          _ref = file.previewElement.querySelectorAll("[data-dz-uploadprogress]");
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            node = _ref[_i];
            if (node.nodeName === 'PROGRESS') {
              _results.push(node.value = progress);
            } else {
              _results.push(node.style.width = "" + progress + "%");
            }
          }
          return _results;
        }
      },
      totaluploadprogress: noop,
      sending: noop,
      sendingmultiple: noop,
      success: function(file) {
        if (file.previewElement) {
          return file.previewElement.classList.add("dz-success");
        }
      },
      successmultiple: noop,
      canceled: function(file) {
        return this.emit("error", file, "Upload canceled.");
      },
      canceledmultiple: noop,
      complete: function(file) {
        if (file._removeLink) {
          file._removeLink.textContent = this.options.dictRemoveFile;
        }
        if (file.previewElement) {
          return file.previewElement.classList.add("dz-complete");
        }
      },
      completemultiple: noop,
      maxfilesexceeded: noop,
      maxfilesreached: noop,
      queuecomplete: noop,
      addedfiles: noop,
      previewTemplate: "<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-image\"><img data-dz-thumbnail /></div>\n  <div class=\"dz-details\">\n    <div class=\"dz-size\"><span data-dz-size></span></div>\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n  </div>\n  <div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n  <div class=\"dz-success-mark\">\n    <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Check</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <path d=\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" stroke-opacity=\"0.198794158\" stroke=\"#747474\" fill-opacity=\"0.816519475\" fill=\"#FFFFFF\" sketch:type=\"MSShapeGroup\"></path>\n      </g>\n    </svg>\n  </div>\n  <div class=\"dz-error-mark\">\n    <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:sketch=\"http://www.bohemiancoding.com/sketch/ns\">\n      <title>Error</title>\n      <defs></defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n        <g id=\"Check-+-Oval-2\" sketch:type=\"MSLayerGroup\" stroke=\"#747474\" stroke-opacity=\"0.198794158\" fill=\"#FFFFFF\" fill-opacity=\"0.816519475\">\n          <path d=\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\" id=\"Oval-2\" sketch:type=\"MSShapeGroup\"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>"
    };

    extend = function() {
      var key, object, objects, target, val, _i, _len;
      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      for (_i = 0, _len = objects.length; _i < _len; _i++) {
        object = objects[_i];
        for (key in object) {
          val = object[key];
          target[key] = val;
        }
      }
      return target;
    };

    function Dropzone(element, options) {
      var elementOptions, fallback, _ref;
      this.element = element;
      this.version = Dropzone.version;
      this.defaultOptions.previewTemplate = this.defaultOptions.previewTemplate.replace(/\n*/g, "");
      this.clickableElements = [];
      this.listeners = [];
      this.files = [];
      if (typeof this.element === "string") {
        this.element = document.querySelector(this.element);
      }
      if (!(this.element && (this.element.nodeType != null))) {
        throw new Error("Invalid dropzone element.");
      }
      if (this.element.dropzone) {
        throw new Error("Dropzone already attached.");
      }
      Dropzone.instances.push(this);
      this.element.dropzone = this;
      elementOptions = (_ref = Dropzone.optionsForElement(this.element)) != null ? _ref : {};
      this.options = extend({}, this.defaultOptions, elementOptions, options != null ? options : {});
      if (this.options.forceFallback || !Dropzone.isBrowserSupported()) {
        return this.options.fallback.call(this);
      }
      if (this.options.url == null) {
        this.options.url = this.element.getAttribute("action");
      }
      if (!this.options.url) {
        throw new Error("No URL provided.");
      }
      if (this.options.acceptedFiles && this.options.acceptedMimeTypes) {
        throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");
      }
      if (this.options.acceptedMimeTypes) {
        this.options.acceptedFiles = this.options.acceptedMimeTypes;
        delete this.options.acceptedMimeTypes;
      }
      this.options.method = this.options.method.toUpperCase();
      if ((fallback = this.getExistingFallback()) && fallback.parentNode) {
        fallback.parentNode.removeChild(fallback);
      }
      if (this.options.previewsContainer !== false) {
        if (this.options.previewsContainer) {
          this.previewsContainer = Dropzone.getElement(this.options.previewsContainer, "previewsContainer");
        } else {
          this.previewsContainer = this.element;
        }
      }
      if (this.options.clickable) {
        if (this.options.clickable === true) {
          this.clickableElements = [this.element];
        } else {
          this.clickableElements = Dropzone.getElements(this.options.clickable, "clickable");
        }
      }
      this.init();
    }

    Dropzone.prototype.getAcceptedFiles = function() {
      var file, _i, _len, _ref, _results;
      _ref = this.files;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        if (file.accepted) {
          _results.push(file);
        }
      }
      return _results;
    };

    Dropzone.prototype.getRejectedFiles = function() {
      var file, _i, _len, _ref, _results;
      _ref = this.files;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        if (!file.accepted) {
          _results.push(file);
        }
      }
      return _results;
    };

    Dropzone.prototype.getFilesWithStatus = function(status) {
      var file, _i, _len, _ref, _results;
      _ref = this.files;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        if (file.status === status) {
          _results.push(file);
        }
      }
      return _results;
    };

    Dropzone.prototype.getQueuedFiles = function() {
      return this.getFilesWithStatus(Dropzone.QUEUED);
    };

    Dropzone.prototype.getUploadingFiles = function() {
      return this.getFilesWithStatus(Dropzone.UPLOADING);
    };

    Dropzone.prototype.getAddedFiles = function() {
      return this.getFilesWithStatus(Dropzone.ADDED);
    };

    Dropzone.prototype.getActiveFiles = function() {
      var file, _i, _len, _ref, _results;
      _ref = this.files;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        if (file.status === Dropzone.UPLOADING || file.status === Dropzone.QUEUED) {
          _results.push(file);
        }
      }
      return _results;
    };

    Dropzone.prototype.init = function() {
      var eventName, noPropagation, setupHiddenFileInput, _i, _len, _ref, _ref1;
      if (this.element.tagName === "form") {
        this.element.setAttribute("enctype", "multipart/form-data");
      }
      if (this.element.classList.contains("dropzone") && !this.element.querySelector(".dz-message")) {
        this.element.appendChild(Dropzone.createElement("<div class=\"dz-default dz-message\"><span>" + this.options.dictDefaultMessage + "</span></div>"));
      }
      if (this.clickableElements.length) {
        setupHiddenFileInput = (function(_this) {
          return function() {
            if (_this.hiddenFileInput) {
              _this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput);
            }
            _this.hiddenFileInput = document.createElement("input");
            _this.hiddenFileInput.setAttribute("type", "file");
            if ((_this.options.maxFiles == null) || _this.options.maxFiles > 1) {
              _this.hiddenFileInput.setAttribute("multiple", "multiple");
            }
            _this.hiddenFileInput.className = "dz-hidden-input";
            if (_this.options.acceptedFiles != null) {
              _this.hiddenFileInput.setAttribute("accept", _this.options.acceptedFiles);
            }
            if (_this.options.capture != null) {
              _this.hiddenFileInput.setAttribute("capture", _this.options.capture);
            }
            _this.hiddenFileInput.style.visibility = "hidden";
            _this.hiddenFileInput.style.position = "absolute";
            _this.hiddenFileInput.style.top = "0";
            _this.hiddenFileInput.style.left = "0";
            _this.hiddenFileInput.style.height = "0";
            _this.hiddenFileInput.style.width = "0";
            document.querySelector(_this.options.hiddenInputContainer).appendChild(_this.hiddenFileInput);
            return _this.hiddenFileInput.addEventListener("change", function() {
              var file, files, _i, _len;
              files = _this.hiddenFileInput.files;
              if (files.length) {
                for (_i = 0, _len = files.length; _i < _len; _i++) {
                  file = files[_i];
                  _this.addFile(file);
                }
              }
              _this.emit("addedfiles", files);
              return setupHiddenFileInput();
            });
          };
        })(this);
        setupHiddenFileInput();
      }
      this.URL = (_ref = window.URL) != null ? _ref : window.webkitURL;
      _ref1 = this.events;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        eventName = _ref1[_i];
        this.on(eventName, this.options[eventName]);
      }
      this.on("uploadprogress", (function(_this) {
        return function() {
          return _this.updateTotalUploadProgress();
        };
      })(this));
      this.on("removedfile", (function(_this) {
        return function() {
          return _this.updateTotalUploadProgress();
        };
      })(this));
      this.on("canceled", (function(_this) {
        return function(file) {
          return _this.emit("complete", file);
        };
      })(this));
      this.on("complete", (function(_this) {
        return function(file) {
          if (_this.getAddedFiles().length === 0 && _this.getUploadingFiles().length === 0 && _this.getQueuedFiles().length === 0) {
            return setTimeout((function() {
              return _this.emit("queuecomplete");
            }), 0);
          }
        };
      })(this));
      noPropagation = function(e) {
        e.stopPropagation();
        if (e.preventDefault) {
          return e.preventDefault();
        } else {
          return e.returnValue = false;
        }
      };
      this.listeners = [
        {
          element: this.element,
          events: {
            "dragstart": (function(_this) {
              return function(e) {
                return _this.emit("dragstart", e);
              };
            })(this),
            "dragenter": (function(_this) {
              return function(e) {
                noPropagation(e);
                return _this.emit("dragenter", e);
              };
            })(this),
            "dragover": (function(_this) {
              return function(e) {
                var efct;
                try {
                  efct = e.dataTransfer.effectAllowed;
                } catch (_error) {}
                e.dataTransfer.dropEffect = 'move' === efct || 'linkMove' === efct ? 'move' : 'copy';
                noPropagation(e);
                return _this.emit("dragover", e);
              };
            })(this),
            "dragleave": (function(_this) {
              return function(e) {
                return _this.emit("dragleave", e);
              };
            })(this),
            "drop": (function(_this) {
              return function(e) {
                noPropagation(e);
                return _this.drop(e);
              };
            })(this),
            "dragend": (function(_this) {
              return function(e) {
                return _this.emit("dragend", e);
              };
            })(this)
          }
        }
      ];
      this.clickableElements.forEach((function(_this) {
        return function(clickableElement) {
          return _this.listeners.push({
            element: clickableElement,
            events: {
              "click": function(evt) {
                if ((clickableElement !== _this.element) || (evt.target === _this.element || Dropzone.elementInside(evt.target, _this.element.querySelector(".dz-message")))) {
                  _this.hiddenFileInput.click();
                }
                return true;
              }
            }
          });
        };
      })(this));
      this.enable();
      return this.options.init.call(this);
    };

    Dropzone.prototype.destroy = function() {
      var _ref;
      this.disable();
      this.removeAllFiles(true);
      if ((_ref = this.hiddenFileInput) != null ? _ref.parentNode : void 0) {
        this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);
        this.hiddenFileInput = null;
      }
      delete this.element.dropzone;
      return Dropzone.instances.splice(Dropzone.instances.indexOf(this), 1);
    };

    Dropzone.prototype.updateTotalUploadProgress = function() {
      var activeFiles, file, totalBytes, totalBytesSent, totalUploadProgress, _i, _len, _ref;
      totalBytesSent = 0;
      totalBytes = 0;
      activeFiles = this.getActiveFiles();
      if (activeFiles.length) {
        _ref = this.getActiveFiles();
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          file = _ref[_i];
          totalBytesSent += file.upload.bytesSent;
          totalBytes += file.upload.total;
        }
        totalUploadProgress = 100 * totalBytesSent / totalBytes;
      } else {
        totalUploadProgress = 100;
      }
      return this.emit("totaluploadprogress", totalUploadProgress, totalBytes, totalBytesSent);
    };

    Dropzone.prototype._getParamName = function(n) {
      if (typeof this.options.paramName === "function") {
        return this.options.paramName(n);
      } else {
        return "" + this.options.paramName + (this.options.uploadMultiple ? "[" + n + "]" : "");
      }
    };

    Dropzone.prototype._renameFilename = function(name) {
      if (typeof this.options.renameFilename !== "function") {
        return name;
      }
      return this.options.renameFilename(name);
    };

    Dropzone.prototype.getFallbackForm = function() {
      var existingFallback, fields, fieldsString, form;
      if (existingFallback = this.getExistingFallback()) {
        return existingFallback;
      }
      fieldsString = "<div class=\"dz-fallback\">";
      if (this.options.dictFallbackText) {
        fieldsString += "<p>" + this.options.dictFallbackText + "</p>";
      }
      fieldsString += "<input type=\"file\" name=\"" + (this._getParamName(0)) + "\" " + (this.options.uploadMultiple ? 'multiple="multiple"' : void 0) + " /><input type=\"submit\" value=\"Upload!\"></div>";
      fields = Dropzone.createElement(fieldsString);
      if (this.element.tagName !== "FORM") {
        form = Dropzone.createElement("<form action=\"" + this.options.url + "\" enctype=\"multipart/form-data\" method=\"" + this.options.method + "\"></form>");
        form.appendChild(fields);
      } else {
        this.element.setAttribute("enctype", "multipart/form-data");
        this.element.setAttribute("method", this.options.method);
      }
      return form != null ? form : fields;
    };

    Dropzone.prototype.getExistingFallback = function() {
      var fallback, getFallback, tagName, _i, _len, _ref;
      getFallback = function(elements) {
        var el, _i, _len;
        for (_i = 0, _len = elements.length; _i < _len; _i++) {
          el = elements[_i];
          if (/(^| )fallback($| )/.test(el.className)) {
            return el;
          }
        }
      };
      _ref = ["div", "form"];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        tagName = _ref[_i];
        if (fallback = getFallback(this.element.getElementsByTagName(tagName))) {
          return fallback;
        }
      }
    };

    Dropzone.prototype.setupEventListeners = function() {
      var elementListeners, event, listener, _i, _len, _ref, _results;
      _ref = this.listeners;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        elementListeners = _ref[_i];
        _results.push((function() {
          var _ref1, _results1;
          _ref1 = elementListeners.events;
          _results1 = [];
          for (event in _ref1) {
            listener = _ref1[event];
            _results1.push(elementListeners.element.addEventListener(event, listener, false));
          }
          return _results1;
        })());
      }
      return _results;
    };

    Dropzone.prototype.removeEventListeners = function() {
      var elementListeners, event, listener, _i, _len, _ref, _results;
      _ref = this.listeners;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        elementListeners = _ref[_i];
        _results.push((function() {
          var _ref1, _results1;
          _ref1 = elementListeners.events;
          _results1 = [];
          for (event in _ref1) {
            listener = _ref1[event];
            _results1.push(elementListeners.element.removeEventListener(event, listener, false));
          }
          return _results1;
        })());
      }
      return _results;
    };

    Dropzone.prototype.disable = function() {
      var file, _i, _len, _ref, _results;
      this.clickableElements.forEach(function(element) {
        return element.classList.remove("dz-clickable");
      });
      this.removeEventListeners();
      _ref = this.files;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        _results.push(this.cancelUpload(file));
      }
      return _results;
    };

    Dropzone.prototype.enable = function() {
      this.clickableElements.forEach(function(element) {
        return element.classList.add("dz-clickable");
      });
      return this.setupEventListeners();
    };

    Dropzone.prototype.filesize = function(size) {
      var cutoff, i, selectedSize, selectedUnit, unit, units, _i, _len;
      selectedSize = 0;
      selectedUnit = "b";
      if (size > 0) {
        units = ['TB', 'GB', 'MB', 'KB', 'b'];
        for (i = _i = 0, _len = units.length; _i < _len; i = ++_i) {
          unit = units[i];
          cutoff = Math.pow(this.options.filesizeBase, 4 - i) / 10;
          if (size >= cutoff) {
            selectedSize = size / Math.pow(this.options.filesizeBase, 4 - i);
            selectedUnit = unit;
            break;
          }
        }
        selectedSize = Math.round(10 * selectedSize) / 10;
      }
      return "<strong>" + selectedSize + "</strong> " + selectedUnit;
    };

    Dropzone.prototype._updateMaxFilesReachedClass = function() {
      if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {
        if (this.getAcceptedFiles().length === this.options.maxFiles) {
          this.emit('maxfilesreached', this.files);
        }
        return this.element.classList.add("dz-max-files-reached");
      } else {
        return this.element.classList.remove("dz-max-files-reached");
      }
    };

    Dropzone.prototype.drop = function(e) {
      var files, items;
      if (!e.dataTransfer) {
        return;
      }
      this.emit("drop", e);
      files = e.dataTransfer.files;
      this.emit("addedfiles", files);
      if (files.length) {
        items = e.dataTransfer.items;
        if (items && items.length && (items[0].webkitGetAsEntry != null)) {
          this._addFilesFromItems(items);
        } else {
          this.handleFiles(files);
        }
      }
    };

    Dropzone.prototype.paste = function(e) {
      var items, _ref;
      if ((e != null ? (_ref = e.clipboardData) != null ? _ref.items : void 0 : void 0) == null) {
        return;
      }
      this.emit("paste", e);
      items = e.clipboardData.items;
      if (items.length) {
        return this._addFilesFromItems(items);
      }
    };

    Dropzone.prototype.handleFiles = function(files) {
      var file, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        _results.push(this.addFile(file));
      }
      return _results;
    };

    Dropzone.prototype._addFilesFromItems = function(items) {
      var entry, item, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = items.length; _i < _len; _i++) {
        item = items[_i];
        if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {
          if (entry.isFile) {
            _results.push(this.addFile(item.getAsFile()));
          } else if (entry.isDirectory) {
            _results.push(this._addFilesFromDirectory(entry, entry.name));
          } else {
            _results.push(void 0);
          }
        } else if (item.getAsFile != null) {
          if ((item.kind == null) || item.kind === "file") {
            _results.push(this.addFile(item.getAsFile()));
          } else {
            _results.push(void 0);
          }
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    Dropzone.prototype._addFilesFromDirectory = function(directory, path) {
      var dirReader, errorHandler, readEntries;
      dirReader = directory.createReader();
      errorHandler = function(error) {
        return typeof console !== "undefined" && console !== null ? typeof console.log === "function" ? console.log(error) : void 0 : void 0;
      };
      readEntries = (function(_this) {
        return function() {
          return dirReader.readEntries(function(entries) {
            var entry, _i, _len;
            if (entries.length > 0) {
              for (_i = 0, _len = entries.length; _i < _len; _i++) {
                entry = entries[_i];
                if (entry.isFile) {
                  entry.file(function(file) {
                    if (_this.options.ignoreHiddenFiles && file.name.substring(0, 1) === '.') {
                      return;
                    }
                    file.fullPath = "" + path + "/" + file.name;
                    return _this.addFile(file);
                  });
                } else if (entry.isDirectory) {
                  _this._addFilesFromDirectory(entry, "" + path + "/" + entry.name);
                }
              }
              readEntries();
            }
            return null;
          }, errorHandler);
        };
      })(this);
      return readEntries();
    };

    Dropzone.prototype.accept = function(file, done) {
      if (file.size > this.options.maxFilesize * 1024 * 1024) {
        return done(this.options.dictFileTooBig.replace("{{filesize}}", Math.round(file.size / 1024 / 10.24) / 100).replace("{{maxFilesize}}", this.options.maxFilesize));
      } else if (!Dropzone.isValidFile(file, this.options.acceptedFiles)) {
        return done(this.options.dictInvalidFileType);
      } else if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {
        done(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}", this.options.maxFiles));
        return this.emit("maxfilesexceeded", file);
      } else {
        return this.options.accept.call(this, file, done);
      }
    };

    Dropzone.prototype.addFile = function(file) {
      file.upload = {
        progress: 0,
        total: file.size,
        bytesSent: 0
      };
      this.files.push(file);
      file.status = Dropzone.ADDED;
      this.emit("addedfile", file);
      this._enqueueThumbnail(file);
      return this.accept(file, (function(_this) {
        return function(error) {
          if (error) {
            file.accepted = false;
            _this._errorProcessing([file], error);
          } else {
            file.accepted = true;
            if (_this.options.autoQueue) {
              _this.enqueueFile(file);
            }
          }
          return _this._updateMaxFilesReachedClass();
        };
      })(this));
    };

    Dropzone.prototype.enqueueFiles = function(files) {
      var file, _i, _len;
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        this.enqueueFile(file);
      }
      return null;
    };

    Dropzone.prototype.enqueueFile = function(file) {
      if (file.status === Dropzone.ADDED && file.accepted === true) {
        file.status = Dropzone.QUEUED;
        if (this.options.autoProcessQueue) {
          return setTimeout(((function(_this) {
            return function() {
              return _this.processQueue();
            };
          })(this)), 0);
        }
      } else {
        throw new Error("This file can't be queued because it has already been processed or was rejected.");
      }
    };

    Dropzone.prototype._thumbnailQueue = [];

    Dropzone.prototype._processingThumbnail = false;

    Dropzone.prototype._enqueueThumbnail = function(file) {
      if (this.options.createImageThumbnails && file.type.match(/image.*/) && file.size <= this.options.maxThumbnailFilesize * 1024 * 1024) {
        this._thumbnailQueue.push(file);
        return setTimeout(((function(_this) {
          return function() {
            return _this._processThumbnailQueue();
          };
        })(this)), 0);
      }
    };

    Dropzone.prototype._processThumbnailQueue = function() {
      if (this._processingThumbnail || this._thumbnailQueue.length === 0) {
        return;
      }
      this._processingThumbnail = true;
      return this.createThumbnail(this._thumbnailQueue.shift(), (function(_this) {
        return function() {
          _this._processingThumbnail = false;
          return _this._processThumbnailQueue();
        };
      })(this));
    };

    Dropzone.prototype.removeFile = function(file) {
      if (file.status === Dropzone.UPLOADING) {
        this.cancelUpload(file);
      }
      this.files = without(this.files, file);
      this.emit("removedfile", file);
      if (this.files.length === 0) {
        return this.emit("reset");
      }
    };

    Dropzone.prototype.removeAllFiles = function(cancelIfNecessary) {
      var file, _i, _len, _ref;
      if (cancelIfNecessary == null) {
        cancelIfNecessary = false;
      }
      _ref = this.files.slice();
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        file = _ref[_i];
        if (file.status !== Dropzone.UPLOADING || cancelIfNecessary) {
          this.removeFile(file);
        }
      }
      return null;
    };

    Dropzone.prototype.createThumbnail = function(file, callback) {
      var fileReader;
      fileReader = new FileReader;
      fileReader.onload = (function(_this) {
        return function() {
          if (file.type === "image/svg+xml") {
            _this.emit("thumbnail", file, fileReader.result);
            if (callback != null) {
              callback();
            }
            return;
          }
          return _this.createThumbnailFromUrl(file, fileReader.result, callback);
        };
      })(this);
      return fileReader.readAsDataURL(file);
    };

    Dropzone.prototype.createThumbnailFromUrl = function(file, imageUrl, callback, crossOrigin) {
      var img;
      img = document.createElement("img");
      if (crossOrigin) {
        img.crossOrigin = crossOrigin;
      }
      img.onload = (function(_this) {
        return function() {
          var canvas, ctx, resizeInfo, thumbnail, _ref, _ref1, _ref2, _ref3;
          file.width = img.width;
          file.height = img.height;
          resizeInfo = _this.options.resize.call(_this, file);
          if (resizeInfo.trgWidth == null) {
            resizeInfo.trgWidth = resizeInfo.optWidth;
          }
          if (resizeInfo.trgHeight == null) {
            resizeInfo.trgHeight = resizeInfo.optHeight;
          }
          canvas = document.createElement("canvas");
          ctx = canvas.getContext("2d");
          canvas.width = resizeInfo.trgWidth;
          canvas.height = resizeInfo.trgHeight;
          drawImageIOSFix(ctx, img, (_ref = resizeInfo.srcX) != null ? _ref : 0, (_ref1 = resizeInfo.srcY) != null ? _ref1 : 0, resizeInfo.srcWidth, resizeInfo.srcHeight, (_ref2 = resizeInfo.trgX) != null ? _ref2 : 0, (_ref3 = resizeInfo.trgY) != null ? _ref3 : 0, resizeInfo.trgWidth, resizeInfo.trgHeight);
          thumbnail = canvas.toDataURL("image/png");
          _this.emit("thumbnail", file, thumbnail);
          if (callback != null) {
            return callback();
          }
        };
      })(this);
      if (callback != null) {
        img.onerror = callback;
      }
      return img.src = imageUrl;
    };

    Dropzone.prototype.processQueue = function() {
      var i, parallelUploads, processingLength, queuedFiles;
      parallelUploads = this.options.parallelUploads;
      processingLength = this.getUploadingFiles().length;
      i = processingLength;
      if (processingLength >= parallelUploads) {
        return;
      }
      queuedFiles = this.getQueuedFiles();
      if (!(queuedFiles.length > 0)) {
        return;
      }
      if (this.options.uploadMultiple) {
        return this.processFiles(queuedFiles.slice(0, parallelUploads - processingLength));
      } else {
        while (i < parallelUploads) {
          if (!queuedFiles.length) {
            return;
          }
          this.processFile(queuedFiles.shift());
          i++;
        }
      }
    };

    Dropzone.prototype.processFile = function(file) {
      return this.processFiles([file]);
    };

    Dropzone.prototype.processFiles = function(files) {
      var file, _i, _len;
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        file.processing = true;
        file.status = Dropzone.UPLOADING;
        this.emit("processing", file);
      }
      if (this.options.uploadMultiple) {
        this.emit("processingmultiple", files);
      }
      return this.uploadFiles(files);
    };

    Dropzone.prototype._getFilesWithXhr = function(xhr) {
      var file, files;
      return files = (function() {
        var _i, _len, _ref, _results;
        _ref = this.files;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          file = _ref[_i];
          if (file.xhr === xhr) {
            _results.push(file);
          }
        }
        return _results;
      }).call(this);
    };

    Dropzone.prototype.cancelUpload = function(file) {
      var groupedFile, groupedFiles, _i, _j, _len, _len1, _ref;
      if (file.status === Dropzone.UPLOADING) {
        groupedFiles = this._getFilesWithXhr(file.xhr);
        for (_i = 0, _len = groupedFiles.length; _i < _len; _i++) {
          groupedFile = groupedFiles[_i];
          groupedFile.status = Dropzone.CANCELED;
        }
        file.xhr.abort();
        for (_j = 0, _len1 = groupedFiles.length; _j < _len1; _j++) {
          groupedFile = groupedFiles[_j];
          this.emit("canceled", groupedFile);
        }
        if (this.options.uploadMultiple) {
          this.emit("canceledmultiple", groupedFiles);
        }
      } else if ((_ref = file.status) === Dropzone.ADDED || _ref === Dropzone.QUEUED) {
        file.status = Dropzone.CANCELED;
        this.emit("canceled", file);
        if (this.options.uploadMultiple) {
          this.emit("canceledmultiple", [file]);
        }
      }
      if (this.options.autoProcessQueue) {
        return this.processQueue();
      }
    };

    resolveOption = function() {
      var args, option;
      option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      if (typeof option === 'function') {
        return option.apply(this, args);
      }
      return option;
    };

    Dropzone.prototype.uploadFile = function(file) {
      return this.uploadFiles([file]);
    };

    Dropzone.prototype.uploadFiles = function(files) {
      var file, formData, handleError, headerName, headerValue, headers, i, input, inputName, inputType, key, method, option, progressObj, response, updateProgress, url, value, xhr, _i, _j, _k, _l, _len, _len1, _len2, _len3, _m, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;
      xhr = new XMLHttpRequest();
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        file.xhr = xhr;
      }
      method = resolveOption(this.options.method, files);
      url = resolveOption(this.options.url, files);
      xhr.open(method, url, true);
      xhr.withCredentials = !!this.options.withCredentials;
      response = null;
      handleError = (function(_this) {
        return function() {
          var _j, _len1, _results;
          _results = [];
          for (_j = 0, _len1 = files.length; _j < _len1; _j++) {
            file = files[_j];
            _results.push(_this._errorProcessing(files, response || _this.options.dictResponseError.replace("{{statusCode}}", xhr.status), xhr));
          }
          return _results;
        };
      })(this);
      updateProgress = (function(_this) {
        return function(e) {
          var allFilesFinished, progress, _j, _k, _l, _len1, _len2, _len3, _results;
          if (e != null) {
            progress = 100 * e.loaded / e.total;
            for (_j = 0, _len1 = files.length; _j < _len1; _j++) {
              file = files[_j];
              file.upload = {
                progress: progress,
                total: e.total,
                bytesSent: e.loaded
              };
            }
          } else {
            allFilesFinished = true;
            progress = 100;
            for (_k = 0, _len2 = files.length; _k < _len2; _k++) {
              file = files[_k];
              if (!(file.upload.progress === 100 && file.upload.bytesSent === file.upload.total)) {
                allFilesFinished = false;
              }
              file.upload.progress = progress;
              file.upload.bytesSent = file.upload.total;
            }
            if (allFilesFinished) {
              return;
            }
          }
          _results = [];
          for (_l = 0, _len3 = files.length; _l < _len3; _l++) {
            file = files[_l];
            _results.push(_this.emit("uploadprogress", file, progress, file.upload.bytesSent));
          }
          return _results;
        };
      })(this);
      xhr.onload = (function(_this) {
        return function(e) {
          var _ref;
          if (files[0].status === Dropzone.CANCELED) {
            return;
          }
          if (xhr.readyState !== 4) {
            return;
          }
          response = xhr.responseText;
          if (xhr.getResponseHeader("content-type") && ~xhr.getResponseHeader("content-type").indexOf("application/json")) {
            try {
              response = JSON.parse(response);
            } catch (_error) {
              e = _error;
              response = "Invalid JSON response from server.";
            }
          }
          updateProgress();
          if (!((200 <= (_ref = xhr.status) && _ref < 300))) {
            return handleError();
          } else {
            return _this._finished(files, response, e);
          }
        };
      })(this);
      xhr.onerror = (function(_this) {
        return function() {
          if (files[0].status === Dropzone.CANCELED) {
            return;
          }
          return handleError();
        };
      })(this);
      progressObj = (_ref = xhr.upload) != null ? _ref : xhr;
      progressObj.onprogress = updateProgress;
      headers = {
        "Accept": "application/json",
        "Cache-Control": "no-cache",
        "X-Requested-With": "XMLHttpRequest"
      };
      if (this.options.headers) {
        extend(headers, this.options.headers);
      }
      for (headerName in headers) {
        headerValue = headers[headerName];
        if (headerValue) {
          xhr.setRequestHeader(headerName, headerValue);
        }
      }
      formData = new FormData();
      if (this.options.params) {
        _ref1 = this.options.params;
        for (key in _ref1) {
          value = _ref1[key];
          formData.append(key, value);
        }
      }
      for (_j = 0, _len1 = files.length; _j < _len1; _j++) {
        file = files[_j];
        this.emit("sending", file, xhr, formData);
      }
      if (this.options.uploadMultiple) {
        this.emit("sendingmultiple", files, xhr, formData);
      }
      if (this.element.tagName === "FORM") {
        _ref2 = this.element.querySelectorAll("input, textarea, select, button");
        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
          input = _ref2[_k];
          inputName = input.getAttribute("name");
          inputType = input.getAttribute("type");
          if (input.tagName === "SELECT" && input.hasAttribute("multiple")) {
            _ref3 = input.options;
            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {
              option = _ref3[_l];
              if (option.selected) {
                formData.append(inputName, option.value);
              }
            }
          } else if (!inputType || ((_ref4 = inputType.toLowerCase()) !== "checkbox" && _ref4 !== "radio") || input.checked) {
            formData.append(inputName, input.value);
          }
        }
      }
      for (i = _m = 0, _ref5 = files.length - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; i = 0 <= _ref5 ? ++_m : --_m) {
        formData.append(this._getParamName(i), files[i], this._renameFilename(files[i].name));
      }
      return this.submitRequest(xhr, formData, files);
    };

    Dropzone.prototype.submitRequest = function(xhr, formData, files) {
      return xhr.send(formData);
    };

    Dropzone.prototype._finished = function(files, responseText, e) {
      var file, _i, _len;
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        file.status = Dropzone.SUCCESS;
        this.emit("success", file, responseText, e);
        this.emit("complete", file);
      }
      if (this.options.uploadMultiple) {
        this.emit("successmultiple", files, responseText, e);
        this.emit("completemultiple", files);
      }
      if (this.options.autoProcessQueue) {
        return this.processQueue();
      }
    };

    Dropzone.prototype._errorProcessing = function(files, message, xhr) {
      var file, _i, _len;
      for (_i = 0, _len = files.length; _i < _len; _i++) {
        file = files[_i];
        file.status = Dropzone.ERROR;
        this.emit("error", file, message, xhr);
        this.emit("complete", file);
      }
      if (this.options.uploadMultiple) {
        this.emit("errormultiple", files, message, xhr);
        this.emit("completemultiple", files);
      }
      if (this.options.autoProcessQueue) {
        return this.processQueue();
      }
    };

    return Dropzone;

  })(Emitter);

  Dropzone.version = "4.3.0";

  Dropzone.options = {};

  Dropzone.optionsForElement = function(element) {
    if (element.getAttribute("id")) {
      return Dropzone.options[camelize(element.getAttribute("id"))];
    } else {
      return void 0;
    }
  };

  Dropzone.instances = [];

  Dropzone.forElement = function(element) {
    if (typeof element === "string") {
      element = document.querySelector(element);
    }
    if ((element != null ? element.dropzone : void 0) == null) {
      throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");
    }
    return element.dropzone;
  };

  Dropzone.autoDiscover = true;

  Dropzone.discover = function() {
    var checkElements, dropzone, dropzones, _i, _len, _results;
    if (document.querySelectorAll) {
      dropzones = document.querySelectorAll(".dropzone");
    } else {
      dropzones = [];
      checkElements = function(elements) {
        var el, _i, _len, _results;
        _results = [];
        for (_i = 0, _len = elements.length; _i < _len; _i++) {
          el = elements[_i];
          if (/(^| )dropzone($| )/.test(el.className)) {
            _results.push(dropzones.push(el));
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      };
      checkElements(document.getElementsByTagName("div"));
      checkElements(document.getElementsByTagName("form"));
    }
    _results = [];
    for (_i = 0, _len = dropzones.length; _i < _len; _i++) {
      dropzone = dropzones[_i];
      if (Dropzone.optionsForElement(dropzone) !== false) {
        _results.push(new Dropzone(dropzone));
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  };

  Dropzone.blacklistedBrowsers = [/opera.*Macintosh.*version\/12/i];

  Dropzone.isBrowserSupported = function() {
    var capableBrowser, regex, _i, _len, _ref;
    capableBrowser = true;
    if (window.File && window.FileReader && window.FileList && window.Blob && window.FormData && document.querySelector) {
      if (!("classList" in document.createElement("a"))) {
        capableBrowser = false;
      } else {
        _ref = Dropzone.blacklistedBrowsers;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          regex = _ref[_i];
          if (regex.test(navigator.userAgent)) {
            capableBrowser = false;
            continue;
          }
        }
      }
    } else {
      capableBrowser = false;
    }
    return capableBrowser;
  };

  without = function(list, rejectedItem) {
    var item, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = list.length; _i < _len; _i++) {
      item = list[_i];
      if (item !== rejectedItem) {
        _results.push(item);
      }
    }
    return _results;
  };

  camelize = function(str) {
    return str.replace(/[\-_](\w)/g, function(match) {
      return match.charAt(1).toUpperCase();
    });
  };

  Dropzone.createElement = function(string) {
    var div;
    div = document.createElement("div");
    div.innerHTML = string;
    return div.childNodes[0];
  };

  Dropzone.elementInside = function(element, container) {
    if (element === container) {
      return true;
    }
    while (element = element.parentNode) {
      if (element === container) {
        return true;
      }
    }
    return false;
  };

  Dropzone.getElement = function(el, name) {
    var element;
    if (typeof el === "string") {
      element = document.querySelector(el);
    } else if (el.nodeType != null) {
      element = el;
    }
    if (element == null) {
      throw new Error("Invalid `" + name + "` option provided. Please provide a CSS selector or a plain HTML element.");
    }
    return element;
  };

  Dropzone.getElements = function(els, name) {
    var e, el, elements, _i, _j, _len, _len1, _ref;
    if (els instanceof Array) {
      elements = [];
      try {
        for (_i = 0, _len = els.length; _i < _len; _i++) {
          el = els[_i];
          elements.push(this.getElement(el, name));
        }
      } catch (_error) {
        e = _error;
        elements = null;
      }
    } else if (typeof els === "string") {
      elements = [];
      _ref = document.querySelectorAll(els);
      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
        el = _ref[_j];
        elements.push(el);
      }
    } else if (els.nodeType != null) {
      elements = [els];
    }
    if (!((elements != null) && elements.length)) {
      throw new Error("Invalid `" + name + "` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");
    }
    return elements;
  };

  Dropzone.confirm = function(question, accepted, rejected) {
    if (window.confirm(question)) {
      return accepted();
    } else if (rejected != null) {
      return rejected();
    }
  };

  Dropzone.isValidFile = function(file, acceptedFiles) {
    var baseMimeType, mimeType, validType, _i, _len;
    if (!acceptedFiles) {
      return true;
    }
    acceptedFiles = acceptedFiles.split(",");
    mimeType = file.type;
    baseMimeType = mimeType.replace(/\/.*$/, "");
    for (_i = 0, _len = acceptedFiles.length; _i < _len; _i++) {
      validType = acceptedFiles[_i];
      validType = validType.trim();
      if (validType.charAt(0) === ".") {
        if (file.name.toLowerCase().indexOf(validType.toLowerCase(), file.name.length - validType.length) !== -1) {
          return true;
        }
      } else if (/\/\*$/.test(validType)) {
        if (baseMimeType === validType.replace(/\/.*$/, "")) {
          return true;
        }
      } else {
        if (mimeType === validType) {
          return true;
        }
      }
    }
    return false;
  };

  if (typeof jQuery !== "undefined" && jQuery !== null) {
    jQuery.fn.dropzone = function(options) {
      return this.each(function() {
        return new Dropzone(this, options);
      });
    };
  }

  if (typeof module !== "undefined" && module !== null) {
    module.exports = Dropzone;
  } else {
    window.Dropzone = Dropzone;
  }

  Dropzone.ADDED = "added";

  Dropzone.QUEUED = "queued";

  Dropzone.ACCEPTED = Dropzone.QUEUED;

  Dropzone.UPLOADING = "uploading";

  Dropzone.PROCESSING = Dropzone.UPLOADING;

  Dropzone.CANCELED = "canceled";

  Dropzone.ERROR = "error";

  Dropzone.SUCCESS = "success";


  /*
  
  Bugfix for iOS 6 and 7
  Source: http://stackoverflow.com/questions/11929099/html5-canvas-drawimage-ratio-bug-ios
  based on the work of https://github.com/stomita/ios-imagefile-megapixel
   */

  detectVerticalSquash = function(img) {
    var alpha, canvas, ctx, data, ey, ih, iw, py, ratio, sy;
    iw = img.naturalWidth;
    ih = img.naturalHeight;
    canvas = document.createElement("canvas");
    canvas.width = 1;
    canvas.height = ih;
    ctx = canvas.getContext("2d");
    ctx.drawImage(img, 0, 0);
    data = ctx.getImageData(0, 0, 1, ih).data;
    sy = 0;
    ey = ih;
    py = ih;
    while (py > sy) {
      alpha = data[(py - 1) * 4 + 3];
      if (alpha === 0) {
        ey = py;
      } else {
        sy = py;
      }
      py = (ey + sy) >> 1;
    }
    ratio = py / ih;
    if (ratio === 0) {
      return 1;
    } else {
      return ratio;
    }
  };

  drawImageIOSFix = function(ctx, img, sx, sy, sw, sh, dx, dy, dw, dh) {
    var vertSquashRatio;
    vertSquashRatio = detectVerticalSquash(img);
    return ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh / vertSquashRatio);
  };


  /*
   * contentloaded.js
   *
   * Author: Diego Perini (diego.perini at gmail.com)
   * Summary: cross-browser wrapper for DOMContentLoaded
   * Updated: 20101020
   * License: MIT
   * Version: 1.2
   *
   * URL:
   * http://javascript.nwbox.com/ContentLoaded/
   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE
   */

  contentLoaded = function(win, fn) {
    var add, doc, done, init, poll, pre, rem, root, top;
    done = false;
    top = true;
    doc = win.document;
    root = doc.documentElement;
    add = (doc.addEventListener ? "addEventListener" : "attachEvent");
    rem = (doc.addEventListener ? "removeEventListener" : "detachEvent");
    pre = (doc.addEventListener ? "" : "on");
    init = function(e) {
      if (e.type === "readystatechange" && doc.readyState !== "complete") {
        return;
      }
      (e.type === "load" ? win : doc)[rem](pre + e.type, init, false);
      if (!done && (done = true)) {
        return fn.call(win, e.type || e);
      }
    };
    poll = function() {
      var e;
      try {
        root.doScroll("left");
      } catch (_error) {
        e = _error;
        setTimeout(poll, 50);
        return;
      }
      return init("poll");
    };
    if (doc.readyState !== "complete") {
      if (doc.createEventObject && root.doScroll) {
        try {
          top = !win.frameElement;
        } catch (_error) {}
        if (top) {
          poll();
        }
      }
      doc[add](pre + "DOMContentLoaded", init, false);
      doc[add](pre + "readystatechange", init, false);
      return win[add](pre + "load", init, false);
    }
  };

  Dropzone._autoDiscoverFunction = function() {
    if (Dropzone.autoDiscover) {
      return Dropzone.discover();
    }
  };

  contentLoaded(window, Dropzone._autoDiscoverFunction);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJkcm9wem9uZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLypcclxuICpcclxuICogTW9yZSBpbmZvIGF0IFt3d3cuZHJvcHpvbmVqcy5jb21dKGh0dHA6Ly93d3cuZHJvcHpvbmVqcy5jb20pXHJcbiAqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMiwgTWF0aWFzIE1lbm9cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXHJcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcclxuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxyXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcclxuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuICpcclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cclxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcbiAqXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuICogVEhFIFNPRlRXQVJFLlxyXG4gKlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICB2YXIgRHJvcHpvbmUsIEVtaXR0ZXIsIGNhbWVsaXplLCBjb250ZW50TG9hZGVkLCBkZXRlY3RWZXJ0aWNhbFNxdWFzaCwgZHJhd0ltYWdlSU9TRml4LCBub29wLCB3aXRob3V0LFxyXG4gICAgX19zbGljZSA9IFtdLnNsaWNlLFxyXG4gICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXHJcbiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcclxuXHJcbiAgbm9vcCA9IGZ1bmN0aW9uKCkge307XHJcblxyXG4gIEVtaXR0ZXIgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICBmdW5jdGlvbiBFbWl0dGVyKCkge31cclxuXHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gRW1pdHRlci5wcm90b3R5cGUub247XHJcblxyXG4gICAgRW1pdHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbihldmVudCwgZm4pIHtcclxuICAgICAgdGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xyXG4gICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrc1tldmVudF0pIHtcclxuICAgICAgICB0aGlzLl9jYWxsYmFja3NbZXZlbnRdID0gW107XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5fY2FsbGJhY2tzW2V2ZW50XS5wdXNoKGZuKTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG5cclxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGFyZ3MsIGNhbGxiYWNrLCBjYWxsYmFja3MsIGV2ZW50LCBfaSwgX2xlbjtcclxuICAgICAgZXZlbnQgPSBhcmd1bWVudHNbMF0sIGFyZ3MgPSAyIDw9IGFyZ3VtZW50cy5sZW5ndGggPyBfX3NsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSA6IFtdO1xyXG4gICAgICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XHJcbiAgICAgIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrc1tldmVudF07XHJcbiAgICAgIGlmIChjYWxsYmFja3MpIHtcclxuICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNhbGxiYWNrcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFja3NbX2ldO1xyXG4gICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuXHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IEVtaXR0ZXIucHJvdG90eXBlLm9mZjtcclxuXHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBFbWl0dGVyLnByb3RvdHlwZS5vZmY7XHJcblxyXG4gICAgRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IEVtaXR0ZXIucHJvdG90eXBlLm9mZjtcclxuXHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihldmVudCwgZm4pIHtcclxuICAgICAgdmFyIGNhbGxiYWNrLCBjYWxsYmFja3MsIGksIF9pLCBfbGVuO1xyXG4gICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrcyB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzID0ge307XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH1cclxuICAgICAgY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzW2V2ZW50XTtcclxuICAgICAgaWYgKCFjYWxsYmFja3MpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfVxyXG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IF9pID0gMCwgX2xlbiA9IGNhbGxiYWNrcy5sZW5ndGg7IF9pIDwgX2xlbjsgaSA9ICsrX2kpIHtcclxuICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrc1tpXTtcclxuICAgICAgICBpZiAoY2FsbGJhY2sgPT09IGZuKSB7XHJcbiAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gRW1pdHRlcjtcclxuXHJcbiAgfSkoKTtcclxuXHJcbiAgRHJvcHpvbmUgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XHJcbiAgICB2YXIgZXh0ZW5kLCByZXNvbHZlT3B0aW9uO1xyXG5cclxuICAgIF9fZXh0ZW5kcyhEcm9wem9uZSwgX3N1cGVyKTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuRW1pdHRlciA9IEVtaXR0ZXI7XHJcblxyXG5cclxuICAgIC8qXHJcbiAgICBUaGlzIGlzIGEgbGlzdCBvZiBhbGwgYXZhaWxhYmxlIGV2ZW50cyB5b3UgY2FuIHJlZ2lzdGVyIG9uIGEgZHJvcHpvbmUgb2JqZWN0LlxyXG4gICAgXHJcbiAgICBZb3UgY2FuIHJlZ2lzdGVyIGFuIGV2ZW50IGhhbmRsZXIgbGlrZSB0aGlzOlxyXG4gICAgXHJcbiAgICAgICAgZHJvcHpvbmUub24oXCJkcmFnRW50ZXJcIiwgZnVuY3Rpb24oKSB7IH0pO1xyXG4gICAgICovXHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmV2ZW50cyA9IFtcImRyb3BcIiwgXCJkcmFnc3RhcnRcIiwgXCJkcmFnZW5kXCIsIFwiZHJhZ2VudGVyXCIsIFwiZHJhZ292ZXJcIiwgXCJkcmFnbGVhdmVcIiwgXCJhZGRlZGZpbGVcIiwgXCJhZGRlZGZpbGVzXCIsIFwicmVtb3ZlZGZpbGVcIiwgXCJ0aHVtYm5haWxcIiwgXCJlcnJvclwiLCBcImVycm9ybXVsdGlwbGVcIiwgXCJwcm9jZXNzaW5nXCIsIFwicHJvY2Vzc2luZ211bHRpcGxlXCIsIFwidXBsb2FkcHJvZ3Jlc3NcIiwgXCJ0b3RhbHVwbG9hZHByb2dyZXNzXCIsIFwic2VuZGluZ1wiLCBcInNlbmRpbmdtdWx0aXBsZVwiLCBcInN1Y2Nlc3NcIiwgXCJzdWNjZXNzbXVsdGlwbGVcIiwgXCJjYW5jZWxlZFwiLCBcImNhbmNlbGVkbXVsdGlwbGVcIiwgXCJjb21wbGV0ZVwiLCBcImNvbXBsZXRlbXVsdGlwbGVcIiwgXCJyZXNldFwiLCBcIm1heGZpbGVzZXhjZWVkZWRcIiwgXCJtYXhmaWxlc3JlYWNoZWRcIiwgXCJxdWV1ZWNvbXBsZXRlXCJdO1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5kZWZhdWx0T3B0aW9ucyA9IHtcclxuICAgICAgdXJsOiBudWxsLFxyXG4gICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICB3aXRoQ3JlZGVudGlhbHM6IGZhbHNlLFxyXG4gICAgICBwYXJhbGxlbFVwbG9hZHM6IDIsXHJcbiAgICAgIHVwbG9hZE11bHRpcGxlOiBmYWxzZSxcclxuICAgICAgbWF4RmlsZXNpemU6IDI1NixcclxuICAgICAgcGFyYW1OYW1lOiBcImZpbGVcIixcclxuICAgICAgY3JlYXRlSW1hZ2VUaHVtYm5haWxzOiB0cnVlLFxyXG4gICAgICBtYXhUaHVtYm5haWxGaWxlc2l6ZTogMTAsXHJcbiAgICAgIHRodW1ibmFpbFdpZHRoOiAxMjAsXHJcbiAgICAgIHRodW1ibmFpbEhlaWdodDogMTIwLFxyXG4gICAgICBmaWxlc2l6ZUJhc2U6IDEwMDAsXHJcbiAgICAgIG1heEZpbGVzOiBudWxsLFxyXG4gICAgICBwYXJhbXM6IHt9LFxyXG4gICAgICBjbGlja2FibGU6IHRydWUsXHJcbiAgICAgIGlnbm9yZUhpZGRlbkZpbGVzOiB0cnVlLFxyXG4gICAgICBhY2NlcHRlZEZpbGVzOiBudWxsLFxyXG4gICAgICBhY2NlcHRlZE1pbWVUeXBlczogbnVsbCxcclxuICAgICAgYXV0b1Byb2Nlc3NRdWV1ZTogdHJ1ZSxcclxuICAgICAgYXV0b1F1ZXVlOiB0cnVlLFxyXG4gICAgICBhZGRSZW1vdmVMaW5rczogZmFsc2UsXHJcbiAgICAgIHByZXZpZXdzQ29udGFpbmVyOiBudWxsLFxyXG4gICAgICBoaWRkZW5JbnB1dENvbnRhaW5lcjogXCJib2R5XCIsXHJcbiAgICAgIGNhcHR1cmU6IG51bGwsXHJcbiAgICAgIHJlbmFtZUZpbGVuYW1lOiBudWxsLFxyXG4gICAgICBkaWN0RGVmYXVsdE1lc3NhZ2U6IFwiRHJvcCBmaWxlcyBoZXJlIHRvIHVwbG9hZFwiLFxyXG4gICAgICBkaWN0RmFsbGJhY2tNZXNzYWdlOiBcIllvdXIgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IGRyYWcnbidkcm9wIGZpbGUgdXBsb2Fkcy5cIixcclxuICAgICAgZGljdEZhbGxiYWNrVGV4dDogXCJQbGVhc2UgdXNlIHRoZSBmYWxsYmFjayBmb3JtIGJlbG93IHRvIHVwbG9hZCB5b3VyIGZpbGVzIGxpa2UgaW4gdGhlIG9sZGVuIGRheXMuXCIsXHJcbiAgICAgIGRpY3RGaWxlVG9vQmlnOiBcIkZpbGUgaXMgdG9vIGJpZyAoe3tmaWxlc2l6ZX19TWlCKS4gTWF4IGZpbGVzaXplOiB7e21heEZpbGVzaXplfX1NaUIuXCIsXHJcbiAgICAgIGRpY3RJbnZhbGlkRmlsZVR5cGU6IFwiWW91IGNhbid0IHVwbG9hZCBmaWxlcyBvZiB0aGlzIHR5cGUuXCIsXHJcbiAgICAgIGRpY3RSZXNwb25zZUVycm9yOiBcIlNlcnZlciByZXNwb25kZWQgd2l0aCB7e3N0YXR1c0NvZGV9fSBjb2RlLlwiLFxyXG4gICAgICBkaWN0Q2FuY2VsVXBsb2FkOiBcIkNhbmNlbCB1cGxvYWRcIixcclxuICAgICAgZGljdENhbmNlbFVwbG9hZENvbmZpcm1hdGlvbjogXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2FuY2VsIHRoaXMgdXBsb2FkP1wiLFxyXG4gICAgICBkaWN0UmVtb3ZlRmlsZTogXCJSZW1vdmUgZmlsZVwiLFxyXG4gICAgICBkaWN0UmVtb3ZlRmlsZUNvbmZpcm1hdGlvbjogbnVsbCxcclxuICAgICAgZGljdE1heEZpbGVzRXhjZWVkZWQ6IFwiWW91IGNhbiBub3QgdXBsb2FkIGFueSBtb3JlIGZpbGVzLlwiLFxyXG4gICAgICBhY2NlcHQ6IGZ1bmN0aW9uKGZpbGUsIGRvbmUpIHtcclxuICAgICAgICByZXR1cm4gZG9uZSgpO1xyXG4gICAgICB9LFxyXG4gICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gbm9vcDtcclxuICAgICAgfSxcclxuICAgICAgZm9yY2VGYWxsYmFjazogZmFsc2UsXHJcbiAgICAgIGZhbGxiYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY2hpbGQsIG1lc3NhZ2VFbGVtZW50LCBzcGFuLCBfaSwgX2xlbiwgX3JlZjtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lID0gXCJcIiArIHRoaXMuZWxlbWVudC5jbGFzc05hbWUgKyBcIiBkei1icm93c2VyLW5vdC1zdXBwb3J0ZWRcIjtcclxuICAgICAgICBfcmVmID0gdGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiZGl2XCIpO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgICAgY2hpbGQgPSBfcmVmW19pXTtcclxuICAgICAgICAgIGlmICgvKF58IClkei1tZXNzYWdlKCR8ICkvLnRlc3QoY2hpbGQuY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICBtZXNzYWdlRWxlbWVudCA9IGNoaWxkO1xyXG4gICAgICAgICAgICBjaGlsZC5jbGFzc05hbWUgPSBcImR6LW1lc3NhZ2VcIjtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbWVzc2FnZUVsZW1lbnQpIHtcclxuICAgICAgICAgIG1lc3NhZ2VFbGVtZW50ID0gRHJvcHpvbmUuY3JlYXRlRWxlbWVudChcIjxkaXYgY2xhc3M9XFxcImR6LW1lc3NhZ2VcXFwiPjxzcGFuPjwvc3Bhbj48L2Rpdj5cIik7XHJcbiAgICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQobWVzc2FnZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzcGFuID0gbWVzc2FnZUVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpWzBdO1xyXG4gICAgICAgIGlmIChzcGFuKSB7XHJcbiAgICAgICAgICBpZiAoc3Bhbi50ZXh0Q29udGVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSB0aGlzLm9wdGlvbnMuZGljdEZhbGxiYWNrTWVzc2FnZTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoc3Bhbi5pbm5lclRleHQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBzcGFuLmlubmVyVGV4dCA9IHRoaXMub3B0aW9ucy5kaWN0RmFsbGJhY2tNZXNzYWdlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZ2V0RmFsbGJhY2tGb3JtKCkpO1xyXG4gICAgICB9LFxyXG4gICAgICByZXNpemU6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICB2YXIgaW5mbywgc3JjUmF0aW8sIHRyZ1JhdGlvO1xyXG4gICAgICAgIGluZm8gPSB7XHJcbiAgICAgICAgICBzcmNYOiAwLFxyXG4gICAgICAgICAgc3JjWTogMCxcclxuICAgICAgICAgIHNyY1dpZHRoOiBmaWxlLndpZHRoLFxyXG4gICAgICAgICAgc3JjSGVpZ2h0OiBmaWxlLmhlaWdodFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc3JjUmF0aW8gPSBmaWxlLndpZHRoIC8gZmlsZS5oZWlnaHQ7XHJcbiAgICAgICAgaW5mby5vcHRXaWR0aCA9IHRoaXMub3B0aW9ucy50aHVtYm5haWxXaWR0aDtcclxuICAgICAgICBpbmZvLm9wdEhlaWdodCA9IHRoaXMub3B0aW9ucy50aHVtYm5haWxIZWlnaHQ7XHJcbiAgICAgICAgaWYgKChpbmZvLm9wdFdpZHRoID09IG51bGwpICYmIChpbmZvLm9wdEhlaWdodCA9PSBudWxsKSkge1xyXG4gICAgICAgICAgaW5mby5vcHRXaWR0aCA9IGluZm8uc3JjV2lkdGg7XHJcbiAgICAgICAgICBpbmZvLm9wdEhlaWdodCA9IGluZm8uc3JjSGVpZ2h0O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5mby5vcHRXaWR0aCA9PSBudWxsKSB7XHJcbiAgICAgICAgICBpbmZvLm9wdFdpZHRoID0gc3JjUmF0aW8gKiBpbmZvLm9wdEhlaWdodDtcclxuICAgICAgICB9IGVsc2UgaWYgKGluZm8ub3B0SGVpZ2h0ID09IG51bGwpIHtcclxuICAgICAgICAgIGluZm8ub3B0SGVpZ2h0ID0gKDEgLyBzcmNSYXRpbykgKiBpbmZvLm9wdFdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cmdSYXRpbyA9IGluZm8ub3B0V2lkdGggLyBpbmZvLm9wdEhlaWdodDtcclxuICAgICAgICBpZiAoZmlsZS5oZWlnaHQgPCBpbmZvLm9wdEhlaWdodCB8fCBmaWxlLndpZHRoIDwgaW5mby5vcHRXaWR0aCkge1xyXG4gICAgICAgICAgaW5mby50cmdIZWlnaHQgPSBpbmZvLnNyY0hlaWdodDtcclxuICAgICAgICAgIGluZm8udHJnV2lkdGggPSBpbmZvLnNyY1dpZHRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoc3JjUmF0aW8gPiB0cmdSYXRpbykge1xyXG4gICAgICAgICAgICBpbmZvLnNyY0hlaWdodCA9IGZpbGUuaGVpZ2h0O1xyXG4gICAgICAgICAgICBpbmZvLnNyY1dpZHRoID0gaW5mby5zcmNIZWlnaHQgKiB0cmdSYXRpbztcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluZm8uc3JjV2lkdGggPSBmaWxlLndpZHRoO1xyXG4gICAgICAgICAgICBpbmZvLnNyY0hlaWdodCA9IGluZm8uc3JjV2lkdGggLyB0cmdSYXRpbztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaW5mby5zcmNYID0gKGZpbGUud2lkdGggLSBpbmZvLnNyY1dpZHRoKSAvIDI7XHJcbiAgICAgICAgaW5mby5zcmNZID0gKGZpbGUuaGVpZ2h0IC0gaW5mby5zcmNIZWlnaHQpIC8gMjtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgIFRob3NlIGZ1bmN0aW9ucyByZWdpc3RlciB0aGVtc2VsdmVzIHRvIHRoZSBldmVudHMgb24gaW5pdCBhbmQgaGFuZGxlIGFsbFxyXG4gICAgICB0aGUgdXNlciBpbnRlcmZhY2Ugc3BlY2lmaWMgc3R1ZmYuIE92ZXJ3cml0aW5nIHRoZW0gd29uJ3QgYnJlYWsgdGhlIHVwbG9hZFxyXG4gICAgICBidXQgY2FuIGJyZWFrIHRoZSB3YXkgaXQncyBkaXNwbGF5ZWQuXHJcbiAgICAgIFlvdSBjYW4gb3ZlcndyaXRlIHRoZW0gaWYgeW91IGRvbid0IGxpa2UgdGhlIGRlZmF1bHQgYmVoYXZpb3IuIElmIHlvdSBqdXN0XHJcbiAgICAgIHdhbnQgdG8gYWRkIGFuIGFkZGl0aW9uYWwgZXZlbnQgaGFuZGxlciwgcmVnaXN0ZXIgaXQgb24gdGhlIGRyb3B6b25lIG9iamVjdFxyXG4gICAgICBhbmQgZG9uJ3Qgb3ZlcndyaXRlIHRob3NlIG9wdGlvbnMuXHJcbiAgICAgICAqL1xyXG4gICAgICBkcm9wOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZHotZHJhZy1ob3ZlclwiKTtcclxuICAgICAgfSxcclxuICAgICAgZHJhZ3N0YXJ0OiBub29wLFxyXG4gICAgICBkcmFnZW5kOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZHotZHJhZy1ob3ZlclwiKTtcclxuICAgICAgfSxcclxuICAgICAgZHJhZ2VudGVyOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZHotZHJhZy1ob3ZlclwiKTtcclxuICAgICAgfSxcclxuICAgICAgZHJhZ292ZXI6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkei1kcmFnLWhvdmVyXCIpO1xyXG4gICAgICB9LFxyXG4gICAgICBkcmFnbGVhdmU6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJkei1kcmFnLWhvdmVyXCIpO1xyXG4gICAgICB9LFxyXG4gICAgICBwYXN0ZTogbm9vcCxcclxuICAgICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImR6LXN0YXJ0ZWRcIik7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFkZGVkZmlsZTogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgIHZhciBub2RlLCByZW1vdmVGaWxlRXZlbnQsIHJlbW92ZUxpbmssIF9pLCBfaiwgX2ssIF9sZW4sIF9sZW4xLCBfbGVuMiwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVzdWx0cztcclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSB0aGlzLnByZXZpZXdzQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImR6LXN0YXJ0ZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnByZXZpZXdzQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICBmaWxlLnByZXZpZXdFbGVtZW50ID0gRHJvcHpvbmUuY3JlYXRlRWxlbWVudCh0aGlzLm9wdGlvbnMucHJldmlld1RlbXBsYXRlLnRyaW0oKSk7XHJcbiAgICAgICAgICBmaWxlLnByZXZpZXdUZW1wbGF0ZSA9IGZpbGUucHJldmlld0VsZW1lbnQ7XHJcbiAgICAgICAgICB0aGlzLnByZXZpZXdzQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpbGUucHJldmlld0VsZW1lbnQpO1xyXG4gICAgICAgICAgX3JlZiA9IGZpbGUucHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWR6LW5hbWVdXCIpO1xyXG4gICAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBfcmVmW19pXTtcclxuICAgICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9IHRoaXMuX3JlbmFtZUZpbGVuYW1lKGZpbGUubmFtZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBfcmVmMSA9IGZpbGUucHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWR6LXNpemVdXCIpO1xyXG4gICAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBfcmVmMVtfal07XHJcbiAgICAgICAgICAgIG5vZGUuaW5uZXJIVE1MID0gdGhpcy5maWxlc2l6ZShmaWxlLnNpemUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5hZGRSZW1vdmVMaW5rcykge1xyXG4gICAgICAgICAgICBmaWxlLl9yZW1vdmVMaW5rID0gRHJvcHpvbmUuY3JlYXRlRWxlbWVudChcIjxhIGNsYXNzPVxcXCJkei1yZW1vdmVcXFwiIGhyZWY9XFxcImphdmFzY3JpcHQ6dW5kZWZpbmVkO1xcXCIgZGF0YS1kei1yZW1vdmU+XCIgKyB0aGlzLm9wdGlvbnMuZGljdFJlbW92ZUZpbGUgKyBcIjwvYT5cIik7XHJcbiAgICAgICAgICAgIGZpbGUucHJldmlld0VsZW1lbnQuYXBwZW5kQ2hpbGQoZmlsZS5fcmVtb3ZlTGluayk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZW1vdmVGaWxlRXZlbnQgPSAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICBpZiAoZmlsZS5zdGF0dXMgPT09IERyb3B6b25lLlVQTE9BRElORykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERyb3B6b25lLmNvbmZpcm0oX3RoaXMub3B0aW9ucy5kaWN0Q2FuY2VsVXBsb2FkQ29uZmlybWF0aW9uLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW92ZUZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLm9wdGlvbnMuZGljdFJlbW92ZUZpbGVDb25maXJtYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIERyb3B6b25lLmNvbmZpcm0oX3RoaXMub3B0aW9ucy5kaWN0UmVtb3ZlRmlsZUNvbmZpcm1hdGlvbiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW92ZUZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW92ZUZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSkodGhpcyk7XHJcbiAgICAgICAgICBfcmVmMiA9IGZpbGUucHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWR6LXJlbW92ZV1cIik7XHJcbiAgICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gX3JlZjIubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZUxpbmsgPSBfcmVmMltfa107XHJcbiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2gocmVtb3ZlTGluay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVtb3ZlRmlsZUV2ZW50KSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmVkZmlsZTogZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgIHZhciBfcmVmO1xyXG4gICAgICAgIGlmIChmaWxlLnByZXZpZXdFbGVtZW50KSB7XHJcbiAgICAgICAgICBpZiAoKF9yZWYgPSBmaWxlLnByZXZpZXdFbGVtZW50KSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIF9yZWYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmaWxlLnByZXZpZXdFbGVtZW50KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZU1heEZpbGVzUmVhY2hlZENsYXNzKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHRodW1ibmFpbDogZnVuY3Rpb24oZmlsZSwgZGF0YVVybCkge1xyXG4gICAgICAgIHZhciB0aHVtYm5haWxFbGVtZW50LCBfaSwgX2xlbiwgX3JlZjtcclxuICAgICAgICBpZiAoZmlsZS5wcmV2aWV3RWxlbWVudCkge1xyXG4gICAgICAgICAgZmlsZS5wcmV2aWV3RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZHotZmlsZS1wcmV2aWV3XCIpO1xyXG4gICAgICAgICAgX3JlZiA9IGZpbGUucHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWR6LXRodW1ibmFpbF1cIik7XHJcbiAgICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgICAgdGh1bWJuYWlsRWxlbWVudCA9IF9yZWZbX2ldO1xyXG4gICAgICAgICAgICB0aHVtYm5haWxFbGVtZW50LmFsdCA9IGZpbGUubmFtZTtcclxuICAgICAgICAgICAgdGh1bWJuYWlsRWxlbWVudC5zcmMgPSBkYXRhVXJsO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoKChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGZpbGUucHJldmlld0VsZW1lbnQuY2xhc3NMaXN0LmFkZChcImR6LWltYWdlLXByZXZpZXdcIik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9KSh0aGlzKSksIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKGZpbGUsIG1lc3NhZ2UpIHtcclxuICAgICAgICB2YXIgbm9kZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzO1xyXG4gICAgICAgIGlmIChmaWxlLnByZXZpZXdFbGVtZW50KSB7XHJcbiAgICAgICAgICBmaWxlLnByZXZpZXdFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkei1lcnJvclwiKTtcclxuICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSAhPT0gXCJTdHJpbmdcIiAmJiBtZXNzYWdlLmVycm9yKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLmVycm9yO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgX3JlZiA9IGZpbGUucHJldmlld0VsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWR6LWVycm9ybWVzc2FnZV1cIik7XHJcbiAgICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBfcmVmW19pXTtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChub2RlLnRleHRDb250ZW50ID0gbWVzc2FnZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBlcnJvcm11bHRpcGxlOiBub29wLFxyXG4gICAgICBwcm9jZXNzaW5nOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgaWYgKGZpbGUucHJldmlld0VsZW1lbnQpIHtcclxuICAgICAgICAgIGZpbGUucHJldmlld0VsZW1lbnQuY2xhc3NMaXN0LmFkZChcImR6LXByb2Nlc3NpbmdcIik7XHJcbiAgICAgICAgICBpZiAoZmlsZS5fcmVtb3ZlTGluaykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmlsZS5fcmVtb3ZlTGluay50ZXh0Q29udGVudCA9IHRoaXMub3B0aW9ucy5kaWN0Q2FuY2VsVXBsb2FkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgcHJvY2Vzc2luZ211bHRpcGxlOiBub29wLFxyXG4gICAgICB1cGxvYWRwcm9ncmVzczogZnVuY3Rpb24oZmlsZSwgcHJvZ3Jlc3MsIGJ5dGVzU2VudCkge1xyXG4gICAgICAgIHZhciBub2RlLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7XHJcbiAgICAgICAgaWYgKGZpbGUucHJldmlld0VsZW1lbnQpIHtcclxuICAgICAgICAgIF9yZWYgPSBmaWxlLnByZXZpZXdFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1kei11cGxvYWRwcm9ncmVzc11cIik7XHJcbiAgICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBfcmVmW19pXTtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09ICdQUk9HUkVTUycpIHtcclxuICAgICAgICAgICAgICBfcmVzdWx0cy5wdXNoKG5vZGUudmFsdWUgPSBwcm9ncmVzcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChub2RlLnN0eWxlLndpZHRoID0gXCJcIiArIHByb2dyZXNzICsgXCIlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB0b3RhbHVwbG9hZHByb2dyZXNzOiBub29wLFxyXG4gICAgICBzZW5kaW5nOiBub29wLFxyXG4gICAgICBzZW5kaW5nbXVsdGlwbGU6IG5vb3AsXHJcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICBpZiAoZmlsZS5wcmV2aWV3RWxlbWVudCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZpbGUucHJldmlld0VsZW1lbnQuY2xhc3NMaXN0LmFkZChcImR6LXN1Y2Nlc3NcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBzdWNjZXNzbXVsdGlwbGU6IG5vb3AsXHJcbiAgICAgIGNhbmNlbGVkOiBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW1pdChcImVycm9yXCIsIGZpbGUsIFwiVXBsb2FkIGNhbmNlbGVkLlwiKTtcclxuICAgICAgfSxcclxuICAgICAgY2FuY2VsZWRtdWx0aXBsZTogbm9vcCxcclxuICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICBpZiAoZmlsZS5fcmVtb3ZlTGluaykge1xyXG4gICAgICAgICAgZmlsZS5fcmVtb3ZlTGluay50ZXh0Q29udGVudCA9IHRoaXMub3B0aW9ucy5kaWN0UmVtb3ZlRmlsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZpbGUucHJldmlld0VsZW1lbnQpIHtcclxuICAgICAgICAgIHJldHVybiBmaWxlLnByZXZpZXdFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkei1jb21wbGV0ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGNvbXBsZXRlbXVsdGlwbGU6IG5vb3AsXHJcbiAgICAgIG1heGZpbGVzZXhjZWVkZWQ6IG5vb3AsXHJcbiAgICAgIG1heGZpbGVzcmVhY2hlZDogbm9vcCxcclxuICAgICAgcXVldWVjb21wbGV0ZTogbm9vcCxcclxuICAgICAgYWRkZWRmaWxlczogbm9vcCxcclxuICAgICAgcHJldmlld1RlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcImR6LXByZXZpZXcgZHotZmlsZS1wcmV2aWV3XFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImR6LWltYWdlXFxcIj48aW1nIGRhdGEtZHotdGh1bWJuYWlsIC8+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJkei1kZXRhaWxzXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiZHotc2l6ZVxcXCI+PHNwYW4gZGF0YS1kei1zaXplPjwvc3Bhbj48L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiZHotZmlsZW5hbWVcXFwiPjxzcGFuIGRhdGEtZHotbmFtZT48L3NwYW4+PC9kaXY+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImR6LXByb2dyZXNzXFxcIj48c3BhbiBjbGFzcz1cXFwiZHotdXBsb2FkXFxcIiBkYXRhLWR6LXVwbG9hZHByb2dyZXNzPjwvc3Bhbj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImR6LWVycm9yLW1lc3NhZ2VcXFwiPjxzcGFuIGRhdGEtZHotZXJyb3JtZXNzYWdlPjwvc3Bhbj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImR6LXN1Y2Nlc3MtbWFya1xcXCI+XFxuICAgIDxzdmcgd2lkdGg9XFxcIjU0cHhcXFwiIGhlaWdodD1cXFwiNTRweFxcXCIgdmlld0JveD1cXFwiMCAwIDU0IDU0XFxcIiB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgeG1sbnM6eGxpbms9XFxcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcXFwiIHhtbG5zOnNrZXRjaD1cXFwiaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zXFxcIj5cXG4gICAgICA8dGl0bGU+Q2hlY2s8L3RpdGxlPlxcbiAgICAgIDxkZWZzPjwvZGVmcz5cXG4gICAgICA8ZyBpZD1cXFwiUGFnZS0xXFxcIiBzdHJva2U9XFxcIm5vbmVcXFwiIHN0cm9rZS13aWR0aD1cXFwiMVxcXCIgZmlsbD1cXFwibm9uZVxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBza2V0Y2g6dHlwZT1cXFwiTVNQYWdlXFxcIj5cXG4gICAgICAgIDxwYXRoIGQ9XFxcIk0yMy41LDMxLjg0MzE0NTggTDE3LjU4NTI0MTksMjUuOTI4Mzg3NyBDMTYuMDI0ODI1MywyNC4zNjc5NzExIDEzLjQ5MTAyOTQsMjQuMzY2ODM1IDExLjkyODkzMjIsMjUuOTI4OTMyMiBDMTAuMzcwMDEzNiwyNy40ODc4NTA4IDEwLjM2NjU5MTIsMzAuMDIzNDQ1NSAxMS45MjgzODc3LDMxLjU4NTI0MTkgTDIwLjQxNDc1ODEsNDAuMDcxNjEyMyBDMjAuNTEzMzk5OSw0MC4xNzAyNTQxIDIwLjYxNTkzMTUsNDAuMjYyNjY0OSAyMC43MjE4NjE1LDQwLjM0ODg0MzUgQzIyLjI4MzU2NjksNDEuODcyNTY1MSAyNC43OTQyMzQsNDEuODYyNjIwMiAyNi4zNDYxNTY0LDQwLjMxMDY5NzggTDQzLjMxMDY5NzgsMjMuMzQ2MTU2NCBDNDQuODc3MTAyMSwyMS43Nzk3NTIxIDQ0Ljg3NTgwNTcsMTkuMjQ4Mzg4NyA0My4zMTM3MDg1LDE3LjY4NjI5MTUgQzQxLjc1NDc4OTksMTYuMTI3MzcyOSAzOS4yMTc2MDM1LDE2LjEyNTU0MjIgMzcuNjUzODQzNiwxNy42ODkzMDIyIEwyMy41LDMxLjg0MzE0NTggWiBNMjcsNTMgQzQxLjM1OTQwMzUsNTMgNTMsNDEuMzU5NDAzNSA1MywyNyBDNTMsMTIuNjQwNTk2NSA0MS4zNTk0MDM1LDEgMjcsMSBDMTIuNjQwNTk2NSwxIDEsMTIuNjQwNTk2NSAxLDI3IEMxLDQxLjM1OTQwMzUgMTIuNjQwNTk2NSw1MyAyNyw1MyBaXFxcIiBpZD1cXFwiT3ZhbC0yXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4xOTg3OTQxNThcXFwiIHN0cm9rZT1cXFwiIzc0NzQ3NFxcXCIgZmlsbC1vcGFjaXR5PVxcXCIwLjgxNjUxOTQ3NVxcXCIgZmlsbD1cXFwiI0ZGRkZGRlxcXCIgc2tldGNoOnR5cGU9XFxcIk1TU2hhcGVHcm91cFxcXCI+PC9wYXRoPlxcbiAgICAgIDwvZz5cXG4gICAgPC9zdmc+XFxuICA8L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImR6LWVycm9yLW1hcmtcXFwiPlxcbiAgICA8c3ZnIHdpZHRoPVxcXCI1NHB4XFxcIiBoZWlnaHQ9XFxcIjU0cHhcXFwiIHZpZXdCb3g9XFxcIjAgMCA1NCA1NFxcXCIgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHhtbG5zOnhsaW5rPVxcXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXFxcIiB4bWxuczpza2V0Y2g9XFxcImh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9uc1xcXCI+XFxuICAgICAgPHRpdGxlPkVycm9yPC90aXRsZT5cXG4gICAgICA8ZGVmcz48L2RlZnM+XFxuICAgICAgPGcgaWQ9XFxcIlBhZ2UtMVxcXCIgc3Ryb2tlPVxcXCJub25lXFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgc2tldGNoOnR5cGU9XFxcIk1TUGFnZVxcXCI+XFxuICAgICAgICA8ZyBpZD1cXFwiQ2hlY2stKy1PdmFsLTJcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU0xheWVyR3JvdXBcXFwiIHN0cm9rZT1cXFwiIzc0NzQ3NFxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMTk4Nzk0MTU4XFxcIiBmaWxsPVxcXCIjRkZGRkZGXFxcIiBmaWxsLW9wYWNpdHk9XFxcIjAuODE2NTE5NDc1XFxcIj5cXG4gICAgICAgICAgPHBhdGggZD1cXFwiTTMyLjY1Njg1NDIsMjkgTDM4LjMxMDY5NzgsMjMuMzQ2MTU2NCBDMzkuODc3MTAyMSwyMS43Nzk3NTIxIDM5Ljg3NTgwNTcsMTkuMjQ4Mzg4NyAzOC4zMTM3MDg1LDE3LjY4NjI5MTUgQzM2Ljc1NDc4OTksMTYuMTI3MzcyOSAzNC4yMTc2MDM1LDE2LjEyNTU0MjIgMzIuNjUzODQzNiwxNy42ODkzMDIyIEwyNywyMy4zNDMxNDU4IEwyMS4zNDYxNTY0LDE3LjY4OTMwMjIgQzE5Ljc4MjM5NjUsMTYuMTI1NTQyMiAxNy4yNDUyMTAxLDE2LjEyNzM3MjkgMTUuNjg2MjkxNSwxNy42ODYyOTE1IEMxNC4xMjQxOTQzLDE5LjI0ODM4ODcgMTQuMTIyODk3OSwyMS43Nzk3NTIxIDE1LjY4OTMwMjIsMjMuMzQ2MTU2NCBMMjEuMzQzMTQ1OCwyOSBMMTUuNjg5MzAyMiwzNC42NTM4NDM2IEMxNC4xMjI4OTc5LDM2LjIyMDI0NzkgMTQuMTI0MTk0MywzOC43NTE2MTEzIDE1LjY4NjI5MTUsNDAuMzEzNzA4NSBDMTcuMjQ1MjEwMSw0MS44NzI2MjcxIDE5Ljc4MjM5NjUsNDEuODc0NDU3OCAyMS4zNDYxNTY0LDQwLjMxMDY5NzggTDI3LDM0LjY1Njg1NDIgTDMyLjY1Mzg0MzYsNDAuMzEwNjk3OCBDMzQuMjE3NjAzNSw0MS44NzQ0NTc4IDM2Ljc1NDc4OTksNDEuODcyNjI3MSAzOC4zMTM3MDg1LDQwLjMxMzcwODUgQzM5Ljg3NTgwNTcsMzguNzUxNjExMyAzOS44NzcxMDIxLDM2LjIyMDI0NzkgMzguMzEwNjk3OCwzNC42NTM4NDM2IEwzMi42NTY4NTQyLDI5IFogTTI3LDUzIEM0MS4zNTk0MDM1LDUzIDUzLDQxLjM1OTQwMzUgNTMsMjcgQzUzLDEyLjY0MDU5NjUgNDEuMzU5NDAzNSwxIDI3LDEgQzEyLjY0MDU5NjUsMSAxLDEyLjY0MDU5NjUgMSwyNyBDMSw0MS4zNTk0MDM1IDEyLjY0MDU5NjUsNTMgMjcsNTMgWlxcXCIgaWQ9XFxcIk92YWwtMlxcXCIgc2tldGNoOnR5cGU9XFxcIk1TU2hhcGVHcm91cFxcXCI+PC9wYXRoPlxcbiAgICAgICAgPC9nPlxcbiAgICAgIDwvZz5cXG4gICAgPC9zdmc+XFxuICA8L2Rpdj5cXG48L2Rpdj5cIlxyXG4gICAgfTtcclxuXHJcbiAgICBleHRlbmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGtleSwgb2JqZWN0LCBvYmplY3RzLCB0YXJnZXQsIHZhbCwgX2ksIF9sZW47XHJcbiAgICAgIHRhcmdldCA9IGFyZ3VtZW50c1swXSwgb2JqZWN0cyA9IDIgPD0gYXJndW1lbnRzLmxlbmd0aCA/IF9fc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpIDogW107XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gb2JqZWN0cy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIG9iamVjdCA9IG9iamVjdHNbX2ldO1xyXG4gICAgICAgIGZvciAoa2V5IGluIG9iamVjdCkge1xyXG4gICAgICAgICAgdmFsID0gb2JqZWN0W2tleV07XHJcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHZhbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gRHJvcHpvbmUoZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICB2YXIgZWxlbWVudE9wdGlvbnMsIGZhbGxiYWNrLCBfcmVmO1xyXG4gICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICB0aGlzLnZlcnNpb24gPSBEcm9wem9uZS52ZXJzaW9uO1xyXG4gICAgICB0aGlzLmRlZmF1bHRPcHRpb25zLnByZXZpZXdUZW1wbGF0ZSA9IHRoaXMuZGVmYXVsdE9wdGlvbnMucHJldmlld1RlbXBsYXRlLnJlcGxhY2UoL1xcbiovZywgXCJcIik7XHJcbiAgICAgIHRoaXMuY2xpY2thYmxlRWxlbWVudHMgPSBbXTtcclxuICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcclxuICAgICAgdGhpcy5maWxlcyA9IFtdO1xyXG4gICAgICBpZiAodHlwZW9mIHRoaXMuZWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5lbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoISh0aGlzLmVsZW1lbnQgJiYgKHRoaXMuZWxlbWVudC5ub2RlVHlwZSAhPSBudWxsKSkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGRyb3B6b25lIGVsZW1lbnQuXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmVsZW1lbnQuZHJvcHpvbmUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEcm9wem9uZSBhbHJlYWR5IGF0dGFjaGVkLlwiKTtcclxuICAgICAgfVxyXG4gICAgICBEcm9wem9uZS5pbnN0YW5jZXMucHVzaCh0aGlzKTtcclxuICAgICAgdGhpcy5lbGVtZW50LmRyb3B6b25lID0gdGhpcztcclxuICAgICAgZWxlbWVudE9wdGlvbnMgPSAoX3JlZiA9IERyb3B6b25lLm9wdGlvbnNGb3JFbGVtZW50KHRoaXMuZWxlbWVudCkpICE9IG51bGwgPyBfcmVmIDoge307XHJcbiAgICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgdGhpcy5kZWZhdWx0T3B0aW9ucywgZWxlbWVudE9wdGlvbnMsIG9wdGlvbnMgIT0gbnVsbCA/IG9wdGlvbnMgOiB7fSk7XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZm9yY2VGYWxsYmFjayB8fCAhRHJvcHpvbmUuaXNCcm93c2VyU3VwcG9ydGVkKCkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmZhbGxiYWNrLmNhbGwodGhpcyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy51cmwgPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy51cmwgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLnVybCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFVSTCBwcm92aWRlZC5cIik7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5hY2NlcHRlZEZpbGVzICYmIHRoaXMub3B0aW9ucy5hY2NlcHRlZE1pbWVUeXBlcykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBjYW4ndCBwcm92aWRlIGJvdGggJ2FjY2VwdGVkRmlsZXMnIGFuZCAnYWNjZXB0ZWRNaW1lVHlwZXMnLiAnYWNjZXB0ZWRNaW1lVHlwZXMnIGlzIGRlcHJlY2F0ZWQuXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuYWNjZXB0ZWRNaW1lVHlwZXMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMuYWNjZXB0ZWRGaWxlcyA9IHRoaXMub3B0aW9ucy5hY2NlcHRlZE1pbWVUeXBlcztcclxuICAgICAgICBkZWxldGUgdGhpcy5vcHRpb25zLmFjY2VwdGVkTWltZVR5cGVzO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMub3B0aW9ucy5tZXRob2QgPSB0aGlzLm9wdGlvbnMubWV0aG9kLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgIGlmICgoZmFsbGJhY2sgPSB0aGlzLmdldEV4aXN0aW5nRmFsbGJhY2soKSkgJiYgZmFsbGJhY2sucGFyZW50Tm9kZSkge1xyXG4gICAgICAgIGZhbGxiYWNrLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZmFsbGJhY2spO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJldmlld3NDb250YWluZXIgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wcmV2aWV3c0NvbnRhaW5lcikge1xyXG4gICAgICAgICAgdGhpcy5wcmV2aWV3c0NvbnRhaW5lciA9IERyb3B6b25lLmdldEVsZW1lbnQodGhpcy5vcHRpb25zLnByZXZpZXdzQ29udGFpbmVyLCBcInByZXZpZXdzQ29udGFpbmVyXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnByZXZpZXdzQ29udGFpbmVyID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmNsaWNrYWJsZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2xpY2thYmxlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICB0aGlzLmNsaWNrYWJsZUVsZW1lbnRzID0gW3RoaXMuZWxlbWVudF07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuY2xpY2thYmxlRWxlbWVudHMgPSBEcm9wem9uZS5nZXRFbGVtZW50cyh0aGlzLm9wdGlvbnMuY2xpY2thYmxlLCBcImNsaWNrYWJsZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmdldEFjY2VwdGVkRmlsZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGZpbGUsIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0cztcclxuICAgICAgX3JlZiA9IHRoaXMuZmlsZXM7XHJcbiAgICAgIF9yZXN1bHRzID0gW107XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIGZpbGUgPSBfcmVmW19pXTtcclxuICAgICAgICBpZiAoZmlsZS5hY2NlcHRlZCkge1xyXG4gICAgICAgICAgX3Jlc3VsdHMucHVzaChmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuZ2V0UmVqZWN0ZWRGaWxlcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgZmlsZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzO1xyXG4gICAgICBfcmVmID0gdGhpcy5maWxlcztcclxuICAgICAgX3Jlc3VsdHMgPSBbXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZmlsZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgIGlmICghZmlsZS5hY2NlcHRlZCkge1xyXG4gICAgICAgICAgX3Jlc3VsdHMucHVzaChmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuZ2V0RmlsZXNXaXRoU3RhdHVzID0gZnVuY3Rpb24oc3RhdHVzKSB7XHJcbiAgICAgIHZhciBmaWxlLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7XHJcbiAgICAgIF9yZWYgPSB0aGlzLmZpbGVzO1xyXG4gICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICBmaWxlID0gX3JlZltfaV07XHJcbiAgICAgICAgaWYgKGZpbGUuc3RhdHVzID09PSBzdGF0dXMpIHtcclxuICAgICAgICAgIF9yZXN1bHRzLnB1c2goZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmdldFF1ZXVlZEZpbGVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmdldEZpbGVzV2l0aFN0YXR1cyhEcm9wem9uZS5RVUVVRUQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuZ2V0VXBsb2FkaW5nRmlsZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsZXNXaXRoU3RhdHVzKERyb3B6b25lLlVQTE9BRElORyk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5nZXRBZGRlZEZpbGVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmdldEZpbGVzV2l0aFN0YXR1cyhEcm9wem9uZS5BRERFRCk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5nZXRBY3RpdmVGaWxlcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgZmlsZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzO1xyXG4gICAgICBfcmVmID0gdGhpcy5maWxlcztcclxuICAgICAgX3Jlc3VsdHMgPSBbXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZmlsZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgIGlmIChmaWxlLnN0YXR1cyA9PT0gRHJvcHpvbmUuVVBMT0FESU5HIHx8IGZpbGUuc3RhdHVzID09PSBEcm9wem9uZS5RVUVVRUQpIHtcclxuICAgICAgICAgIF9yZXN1bHRzLnB1c2goZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGV2ZW50TmFtZSwgbm9Qcm9wYWdhdGlvbiwgc2V0dXBIaWRkZW5GaWxlSW5wdXQsIF9pLCBfbGVuLCBfcmVmLCBfcmVmMTtcclxuICAgICAgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSBcImZvcm1cIikge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJlbmN0eXBlXCIsIFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcImRyb3B6b25lXCIpICYmICF0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kei1tZXNzYWdlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKERyb3B6b25lLmNyZWF0ZUVsZW1lbnQoXCI8ZGl2IGNsYXNzPVxcXCJkei1kZWZhdWx0IGR6LW1lc3NhZ2VcXFwiPjxzcGFuPlwiICsgdGhpcy5vcHRpb25zLmRpY3REZWZhdWx0TWVzc2FnZSArIFwiPC9zcGFuPjwvZGl2PlwiKSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuY2xpY2thYmxlRWxlbWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgc2V0dXBIaWRkZW5GaWxlSW5wdXQgPSAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmhpZGRlbkZpbGVJbnB1dCkge1xyXG4gICAgICAgICAgICAgIF90aGlzLmhpZGRlbkZpbGVJbnB1dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF90aGlzLmhpZGRlbkZpbGVJbnB1dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuaGlkZGVuRmlsZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImZpbGVcIik7XHJcbiAgICAgICAgICAgIGlmICgoX3RoaXMub3B0aW9ucy5tYXhGaWxlcyA9PSBudWxsKSB8fCBfdGhpcy5vcHRpb25zLm1heEZpbGVzID4gMSkge1xyXG4gICAgICAgICAgICAgIF90aGlzLmhpZGRlbkZpbGVJbnB1dC5zZXRBdHRyaWJ1dGUoXCJtdWx0aXBsZVwiLCBcIm11bHRpcGxlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLmhpZGRlbkZpbGVJbnB1dC5jbGFzc05hbWUgPSBcImR6LWhpZGRlbi1pbnB1dFwiO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMub3B0aW9ucy5hY2NlcHRlZEZpbGVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuc2V0QXR0cmlidXRlKFwiYWNjZXB0XCIsIF90aGlzLm9wdGlvbnMuYWNjZXB0ZWRGaWxlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKF90aGlzLm9wdGlvbnMuY2FwdHVyZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgX3RoaXMuaGlkZGVuRmlsZUlucHV0LnNldEF0dHJpYnV0ZShcImNhcHR1cmVcIiwgX3RoaXMub3B0aW9ucy5jYXB0dXJlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcbiAgICAgICAgICAgIF90aGlzLmhpZGRlbkZpbGVJbnB1dC5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICAgICAgX3RoaXMuaGlkZGVuRmlsZUlucHV0LnN0eWxlLnRvcCA9IFwiMFwiO1xyXG4gICAgICAgICAgICBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuc3R5bGUubGVmdCA9IFwiMFwiO1xyXG4gICAgICAgICAgICBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIwXCI7XHJcbiAgICAgICAgICAgIF90aGlzLmhpZGRlbkZpbGVJbnB1dC5zdHlsZS53aWR0aCA9IFwiMFwiO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKF90aGlzLm9wdGlvbnMuaGlkZGVuSW5wdXRDb250YWluZXIpLmFwcGVuZENoaWxkKF90aGlzLmhpZGRlbkZpbGVJbnB1dCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5oaWRkZW5GaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICB2YXIgZmlsZSwgZmlsZXMsIF9pLCBfbGVuO1xyXG4gICAgICAgICAgICAgIGZpbGVzID0gX3RoaXMuaGlkZGVuRmlsZUlucHV0LmZpbGVzO1xyXG4gICAgICAgICAgICAgIGlmIChmaWxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZmlsZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgZmlsZSA9IGZpbGVzW19pXTtcclxuICAgICAgICAgICAgICAgICAgX3RoaXMuYWRkRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgX3RoaXMuZW1pdChcImFkZGVkZmlsZXNcIiwgZmlsZXMpO1xyXG4gICAgICAgICAgICAgIHJldHVybiBzZXR1cEhpZGRlbkZpbGVJbnB1dCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSkodGhpcyk7XHJcbiAgICAgICAgc2V0dXBIaWRkZW5GaWxlSW5wdXQoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLlVSTCA9IChfcmVmID0gd2luZG93LlVSTCkgIT0gbnVsbCA/IF9yZWYgOiB3aW5kb3cud2Via2l0VVJMO1xyXG4gICAgICBfcmVmMSA9IHRoaXMuZXZlbnRzO1xyXG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYxLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZXZlbnROYW1lID0gX3JlZjFbX2ldO1xyXG4gICAgICAgIHRoaXMub24oZXZlbnROYW1lLCB0aGlzLm9wdGlvbnNbZXZlbnROYW1lXSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5vbihcInVwbG9hZHByb2dyZXNzXCIsIChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVUb3RhbFVwbG9hZFByb2dyZXNzKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcykpO1xyXG4gICAgICB0aGlzLm9uKFwicmVtb3ZlZGZpbGVcIiwgKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZVRvdGFsVXBsb2FkUHJvZ3Jlc3MoKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KSh0aGlzKSk7XHJcbiAgICAgIHRoaXMub24oXCJjYW5jZWxlZFwiLCAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXQoXCJjb21wbGV0ZVwiLCBmaWxlKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KSh0aGlzKSk7XHJcbiAgICAgIHRoaXMub24oXCJjb21wbGV0ZVwiLCAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgaWYgKF90aGlzLmdldEFkZGVkRmlsZXMoKS5sZW5ndGggPT09IDAgJiYgX3RoaXMuZ2V0VXBsb2FkaW5nRmlsZXMoKS5sZW5ndGggPT09IDAgJiYgX3RoaXMuZ2V0UXVldWVkRmlsZXMoKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0KFwicXVldWVjb21wbGV0ZVwiKTtcclxuICAgICAgICAgICAgfSksIDApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKHRoaXMpKTtcclxuICAgICAgbm9Qcm9wYWdhdGlvbiA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XHJcbiAgICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gZS5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZWxlbWVudDogdGhpcy5lbGVtZW50LFxyXG4gICAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgIFwiZHJhZ3N0YXJ0XCI6IChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdChcImRyYWdzdGFydFwiLCBlKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KSh0aGlzKSxcclxuICAgICAgICAgICAgXCJkcmFnZW50ZXJcIjogKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIG5vUHJvcGFnYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdChcImRyYWdlbnRlclwiLCBlKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KSh0aGlzKSxcclxuICAgICAgICAgICAgXCJkcmFnb3ZlclwiOiAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVmY3Q7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICBlZmN0ID0gZS5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZDtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKF9lcnJvcikge31cclxuICAgICAgICAgICAgICAgIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnbW92ZScgPT09IGVmY3QgfHwgJ2xpbmtNb3ZlJyA9PT0gZWZjdCA/ICdtb3ZlJyA6ICdjb3B5JztcclxuICAgICAgICAgICAgICAgIG5vUHJvcGFnYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdChcImRyYWdvdmVyXCIsIGUpO1xyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pKHRoaXMpLFxyXG4gICAgICAgICAgICBcImRyYWdsZWF2ZVwiOiAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXQoXCJkcmFnbGVhdmVcIiwgZSk7XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkodGhpcyksXHJcbiAgICAgICAgICAgIFwiZHJvcFwiOiAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgbm9Qcm9wYWdhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kcm9wKGUpO1xyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pKHRoaXMpLFxyXG4gICAgICAgICAgICBcImRyYWdlbmRcIjogKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0KFwiZHJhZ2VuZFwiLCBlKTtcclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KSh0aGlzKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgXTtcclxuICAgICAgdGhpcy5jbGlja2FibGVFbGVtZW50cy5mb3JFYWNoKChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihjbGlja2FibGVFbGVtZW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gX3RoaXMubGlzdGVuZXJzLnB1c2goe1xyXG4gICAgICAgICAgICBlbGVtZW50OiBjbGlja2FibGVFbGVtZW50LFxyXG4gICAgICAgICAgICBldmVudHM6IHtcclxuICAgICAgICAgICAgICBcImNsaWNrXCI6IGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChjbGlja2FibGVFbGVtZW50ICE9PSBfdGhpcy5lbGVtZW50KSB8fCAoZXZ0LnRhcmdldCA9PT0gX3RoaXMuZWxlbWVudCB8fCBEcm9wem9uZS5lbGVtZW50SW5zaWRlKGV2dC50YXJnZXQsIF90aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kei1tZXNzYWdlXCIpKSkpIHtcclxuICAgICAgICAgICAgICAgICAgX3RoaXMuaGlkZGVuRmlsZUlucHV0LmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKHRoaXMpKTtcclxuICAgICAgdGhpcy5lbmFibGUoKTtcclxuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5pbml0LmNhbGwodGhpcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBfcmVmO1xyXG4gICAgICB0aGlzLmRpc2FibGUoKTtcclxuICAgICAgdGhpcy5yZW1vdmVBbGxGaWxlcyh0cnVlKTtcclxuICAgICAgaWYgKChfcmVmID0gdGhpcy5oaWRkZW5GaWxlSW5wdXQpICE9IG51bGwgPyBfcmVmLnBhcmVudE5vZGUgOiB2b2lkIDApIHtcclxuICAgICAgICB0aGlzLmhpZGRlbkZpbGVJbnB1dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuaGlkZGVuRmlsZUlucHV0KTtcclxuICAgICAgICB0aGlzLmhpZGRlbkZpbGVJbnB1dCA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgZGVsZXRlIHRoaXMuZWxlbWVudC5kcm9wem9uZTtcclxuICAgICAgcmV0dXJuIERyb3B6b25lLmluc3RhbmNlcy5zcGxpY2UoRHJvcHpvbmUuaW5zdGFuY2VzLmluZGV4T2YodGhpcyksIDEpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUudXBkYXRlVG90YWxVcGxvYWRQcm9ncmVzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgYWN0aXZlRmlsZXMsIGZpbGUsIHRvdGFsQnl0ZXMsIHRvdGFsQnl0ZXNTZW50LCB0b3RhbFVwbG9hZFByb2dyZXNzLCBfaSwgX2xlbiwgX3JlZjtcclxuICAgICAgdG90YWxCeXRlc1NlbnQgPSAwO1xyXG4gICAgICB0b3RhbEJ5dGVzID0gMDtcclxuICAgICAgYWN0aXZlRmlsZXMgPSB0aGlzLmdldEFjdGl2ZUZpbGVzKCk7XHJcbiAgICAgIGlmIChhY3RpdmVGaWxlcy5sZW5ndGgpIHtcclxuICAgICAgICBfcmVmID0gdGhpcy5nZXRBY3RpdmVGaWxlcygpO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgICAgZmlsZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgICAgdG90YWxCeXRlc1NlbnQgKz0gZmlsZS51cGxvYWQuYnl0ZXNTZW50O1xyXG4gICAgICAgICAgdG90YWxCeXRlcyArPSBmaWxlLnVwbG9hZC50b3RhbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdG90YWxVcGxvYWRQcm9ncmVzcyA9IDEwMCAqIHRvdGFsQnl0ZXNTZW50IC8gdG90YWxCeXRlcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0b3RhbFVwbG9hZFByb2dyZXNzID0gMTAwO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmVtaXQoXCJ0b3RhbHVwbG9hZHByb2dyZXNzXCIsIHRvdGFsVXBsb2FkUHJvZ3Jlc3MsIHRvdGFsQnl0ZXMsIHRvdGFsQnl0ZXNTZW50KTtcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl9nZXRQYXJhbU5hbWUgPSBmdW5jdGlvbihuKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnBhcmFtTmFtZSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5wYXJhbU5hbWUobik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCIgKyB0aGlzLm9wdGlvbnMucGFyYW1OYW1lICsgKHRoaXMub3B0aW9ucy51cGxvYWRNdWx0aXBsZSA/IFwiW1wiICsgbiArIFwiXVwiIDogXCJcIik7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl9yZW5hbWVGaWxlbmFtZSA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMucmVuYW1lRmlsZW5hbWUgIT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgIHJldHVybiBuYW1lO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMucmVuYW1lRmlsZW5hbWUobmFtZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5nZXRGYWxsYmFja0Zvcm0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGV4aXN0aW5nRmFsbGJhY2ssIGZpZWxkcywgZmllbGRzU3RyaW5nLCBmb3JtO1xyXG4gICAgICBpZiAoZXhpc3RpbmdGYWxsYmFjayA9IHRoaXMuZ2V0RXhpc3RpbmdGYWxsYmFjaygpKSB7XHJcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nRmFsbGJhY2s7XHJcbiAgICAgIH1cclxuICAgICAgZmllbGRzU3RyaW5nID0gXCI8ZGl2IGNsYXNzPVxcXCJkei1mYWxsYmFja1xcXCI+XCI7XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGljdEZhbGxiYWNrVGV4dCkge1xyXG4gICAgICAgIGZpZWxkc1N0cmluZyArPSBcIjxwPlwiICsgdGhpcy5vcHRpb25zLmRpY3RGYWxsYmFja1RleHQgKyBcIjwvcD5cIjtcclxuICAgICAgfVxyXG4gICAgICBmaWVsZHNTdHJpbmcgKz0gXCI8aW5wdXQgdHlwZT1cXFwiZmlsZVxcXCIgbmFtZT1cXFwiXCIgKyAodGhpcy5fZ2V0UGFyYW1OYW1lKDApKSArIFwiXFxcIiBcIiArICh0aGlzLm9wdGlvbnMudXBsb2FkTXVsdGlwbGUgPyAnbXVsdGlwbGU9XCJtdWx0aXBsZVwiJyA6IHZvaWQgMCkgKyBcIiAvPjxpbnB1dCB0eXBlPVxcXCJzdWJtaXRcXFwiIHZhbHVlPVxcXCJVcGxvYWQhXFxcIj48L2Rpdj5cIjtcclxuICAgICAgZmllbGRzID0gRHJvcHpvbmUuY3JlYXRlRWxlbWVudChmaWVsZHNTdHJpbmcpO1xyXG4gICAgICBpZiAodGhpcy5lbGVtZW50LnRhZ05hbWUgIT09IFwiRk9STVwiKSB7XHJcbiAgICAgICAgZm9ybSA9IERyb3B6b25lLmNyZWF0ZUVsZW1lbnQoXCI8Zm9ybSBhY3Rpb249XFxcIlwiICsgdGhpcy5vcHRpb25zLnVybCArIFwiXFxcIiBlbmN0eXBlPVxcXCJtdWx0aXBhcnQvZm9ybS1kYXRhXFxcIiBtZXRob2Q9XFxcIlwiICsgdGhpcy5vcHRpb25zLm1ldGhvZCArIFwiXFxcIj48L2Zvcm0+XCIpO1xyXG4gICAgICAgIGZvcm0uYXBwZW5kQ2hpbGQoZmllbGRzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZW5jdHlwZVwiLCBcIm11bHRpcGFydC9mb3JtLWRhdGFcIik7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcIm1ldGhvZFwiLCB0aGlzLm9wdGlvbnMubWV0aG9kKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZm9ybSAhPSBudWxsID8gZm9ybSA6IGZpZWxkcztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmdldEV4aXN0aW5nRmFsbGJhY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGZhbGxiYWNrLCBnZXRGYWxsYmFjaywgdGFnTmFtZSwgX2ksIF9sZW4sIF9yZWY7XHJcbiAgICAgIGdldEZhbGxiYWNrID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgZWwsIF9pLCBfbGVuO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZWxlbWVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgIGVsID0gZWxlbWVudHNbX2ldO1xyXG4gICAgICAgICAgaWYgKC8oXnwgKWZhbGxiYWNrKCR8ICkvLnRlc3QoZWwuY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZWw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBfcmVmID0gW1wiZGl2XCIsIFwiZm9ybVwiXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgdGFnTmFtZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgIGlmIChmYWxsYmFjayA9IGdldEZhbGxiYWNrKHRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKSkpIHtcclxuICAgICAgICAgIHJldHVybiBmYWxsYmFjaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLnNldHVwRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGVsZW1lbnRMaXN0ZW5lcnMsIGV2ZW50LCBsaXN0ZW5lciwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzO1xyXG4gICAgICBfcmVmID0gdGhpcy5saXN0ZW5lcnM7XHJcbiAgICAgIF9yZXN1bHRzID0gW107XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIGVsZW1lbnRMaXN0ZW5lcnMgPSBfcmVmW19pXTtcclxuICAgICAgICBfcmVzdWx0cy5wdXNoKChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHZhciBfcmVmMSwgX3Jlc3VsdHMxO1xyXG4gICAgICAgICAgX3JlZjEgPSBlbGVtZW50TGlzdGVuZXJzLmV2ZW50cztcclxuICAgICAgICAgIF9yZXN1bHRzMSA9IFtdO1xyXG4gICAgICAgICAgZm9yIChldmVudCBpbiBfcmVmMSkge1xyXG4gICAgICAgICAgICBsaXN0ZW5lciA9IF9yZWYxW2V2ZW50XTtcclxuICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2goZWxlbWVudExpc3RlbmVycy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCBmYWxzZSkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIF9yZXN1bHRzMTtcclxuICAgICAgICB9KSgpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gX3Jlc3VsdHM7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgZWxlbWVudExpc3RlbmVycywgZXZlbnQsIGxpc3RlbmVyLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7XHJcbiAgICAgIF9yZWYgPSB0aGlzLmxpc3RlbmVycztcclxuICAgICAgX3Jlc3VsdHMgPSBbXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZWxlbWVudExpc3RlbmVycyA9IF9yZWZbX2ldO1xyXG4gICAgICAgIF9yZXN1bHRzLnB1c2goKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgdmFyIF9yZWYxLCBfcmVzdWx0czE7XHJcbiAgICAgICAgICBfcmVmMSA9IGVsZW1lbnRMaXN0ZW5lcnMuZXZlbnRzO1xyXG4gICAgICAgICAgX3Jlc3VsdHMxID0gW107XHJcbiAgICAgICAgICBmb3IgKGV2ZW50IGluIF9yZWYxKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVyID0gX3JlZjFbZXZlbnRdO1xyXG4gICAgICAgICAgICBfcmVzdWx0czEucHVzaChlbGVtZW50TGlzdGVuZXJzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIsIGZhbHNlKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHMxO1xyXG4gICAgICAgIH0pKCkpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGZpbGUsIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0cztcclxuICAgICAgdGhpcy5jbGlja2FibGVFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZHotY2xpY2thYmxlXCIpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgICBfcmVmID0gdGhpcy5maWxlcztcclxuICAgICAgX3Jlc3VsdHMgPSBbXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZmlsZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5jYW5jZWxVcGxvYWQoZmlsZSkpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB0aGlzLmNsaWNrYWJsZUVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkei1jbGlja2FibGVcIik7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5maWxlc2l6ZSA9IGZ1bmN0aW9uKHNpemUpIHtcclxuICAgICAgdmFyIGN1dG9mZiwgaSwgc2VsZWN0ZWRTaXplLCBzZWxlY3RlZFVuaXQsIHVuaXQsIHVuaXRzLCBfaSwgX2xlbjtcclxuICAgICAgc2VsZWN0ZWRTaXplID0gMDtcclxuICAgICAgc2VsZWN0ZWRVbml0ID0gXCJiXCI7XHJcbiAgICAgIGlmIChzaXplID4gMCkge1xyXG4gICAgICAgIHVuaXRzID0gWydUQicsICdHQicsICdNQicsICdLQicsICdiJ107XHJcbiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfbGVuID0gdW5pdHMubGVuZ3RoOyBfaSA8IF9sZW47IGkgPSArK19pKSB7XHJcbiAgICAgICAgICB1bml0ID0gdW5pdHNbaV07XHJcbiAgICAgICAgICBjdXRvZmYgPSBNYXRoLnBvdyh0aGlzLm9wdGlvbnMuZmlsZXNpemVCYXNlLCA0IC0gaSkgLyAxMDtcclxuICAgICAgICAgIGlmIChzaXplID49IGN1dG9mZikge1xyXG4gICAgICAgICAgICBzZWxlY3RlZFNpemUgPSBzaXplIC8gTWF0aC5wb3codGhpcy5vcHRpb25zLmZpbGVzaXplQmFzZSwgNCAtIGkpO1xyXG4gICAgICAgICAgICBzZWxlY3RlZFVuaXQgPSB1bml0O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZWN0ZWRTaXplID0gTWF0aC5yb3VuZCgxMCAqIHNlbGVjdGVkU2l6ZSkgLyAxMDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gXCI8c3Ryb25nPlwiICsgc2VsZWN0ZWRTaXplICsgXCI8L3N0cm9uZz4gXCIgKyBzZWxlY3RlZFVuaXQ7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fdXBkYXRlTWF4RmlsZXNSZWFjaGVkQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKCh0aGlzLm9wdGlvbnMubWF4RmlsZXMgIT0gbnVsbCkgJiYgdGhpcy5nZXRBY2NlcHRlZEZpbGVzKCkubGVuZ3RoID49IHRoaXMub3B0aW9ucy5tYXhGaWxlcykge1xyXG4gICAgICAgIGlmICh0aGlzLmdldEFjY2VwdGVkRmlsZXMoKS5sZW5ndGggPT09IHRoaXMub3B0aW9ucy5tYXhGaWxlcykge1xyXG4gICAgICAgICAgdGhpcy5lbWl0KCdtYXhmaWxlc3JlYWNoZWQnLCB0aGlzLmZpbGVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZHotbWF4LWZpbGVzLXJlYWNoZWRcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZHotbWF4LWZpbGVzLXJlYWNoZWRcIik7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBmaWxlcywgaXRlbXM7XHJcbiAgICAgIGlmICghZS5kYXRhVHJhbnNmZXIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5lbWl0KFwiZHJvcFwiLCBlKTtcclxuICAgICAgZmlsZXMgPSBlLmRhdGFUcmFuc2Zlci5maWxlcztcclxuICAgICAgdGhpcy5lbWl0KFwiYWRkZWRmaWxlc1wiLCBmaWxlcyk7XHJcbiAgICAgIGlmIChmaWxlcy5sZW5ndGgpIHtcclxuICAgICAgICBpdGVtcyA9IGUuZGF0YVRyYW5zZmVyLml0ZW1zO1xyXG4gICAgICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGggJiYgKGl0ZW1zWzBdLndlYmtpdEdldEFzRW50cnkgIT0gbnVsbCkpIHtcclxuICAgICAgICAgIHRoaXMuX2FkZEZpbGVzRnJvbUl0ZW1zKGl0ZW1zKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5oYW5kbGVGaWxlcyhmaWxlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5wYXN0ZSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGl0ZW1zLCBfcmVmO1xyXG4gICAgICBpZiAoKGUgIT0gbnVsbCA/IChfcmVmID0gZS5jbGlwYm9hcmREYXRhKSAhPSBudWxsID8gX3JlZi5pdGVtcyA6IHZvaWQgMCA6IHZvaWQgMCkgPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmVtaXQoXCJwYXN0ZVwiLCBlKTtcclxuICAgICAgaXRlbXMgPSBlLmNsaXBib2FyZERhdGEuaXRlbXM7XHJcbiAgICAgIGlmIChpdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYWRkRmlsZXNGcm9tSXRlbXMoaXRlbXMpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5oYW5kbGVGaWxlcyA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgIHZhciBmaWxlLCBfaSwgX2xlbiwgX3Jlc3VsdHM7XHJcbiAgICAgIF9yZXN1bHRzID0gW107XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZmlsZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICBmaWxlID0gZmlsZXNbX2ldO1xyXG4gICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5hZGRGaWxlKGZpbGUpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gX3Jlc3VsdHM7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fYWRkRmlsZXNGcm9tSXRlbXMgPSBmdW5jdGlvbihpdGVtcykge1xyXG4gICAgICB2YXIgZW50cnksIGl0ZW0sIF9pLCBfbGVuLCBfcmVzdWx0cztcclxuICAgICAgX3Jlc3VsdHMgPSBbXTtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBpdGVtcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIGl0ZW0gPSBpdGVtc1tfaV07XHJcbiAgICAgICAgaWYgKChpdGVtLndlYmtpdEdldEFzRW50cnkgIT0gbnVsbCkgJiYgKGVudHJ5ID0gaXRlbS53ZWJraXRHZXRBc0VudHJ5KCkpKSB7XHJcbiAgICAgICAgICBpZiAoZW50cnkuaXNGaWxlKSB7XHJcbiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5hZGRGaWxlKGl0ZW0uZ2V0QXNGaWxlKCkpKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZW50cnkuaXNEaXJlY3RvcnkpIHtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh0aGlzLl9hZGRGaWxlc0Zyb21EaXJlY3RvcnkoZW50cnksIGVudHJ5Lm5hbWUpKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uZ2V0QXNGaWxlICE9IG51bGwpIHtcclxuICAgICAgICAgIGlmICgoaXRlbS5raW5kID09IG51bGwpIHx8IGl0ZW0ua2luZCA9PT0gXCJmaWxlXCIpIHtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh0aGlzLmFkZEZpbGUoaXRlbS5nZXRBc0ZpbGUoKSkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl9hZGRGaWxlc0Zyb21EaXJlY3RvcnkgPSBmdW5jdGlvbihkaXJlY3RvcnksIHBhdGgpIHtcclxuICAgICAgdmFyIGRpclJlYWRlciwgZXJyb3JIYW5kbGVyLCByZWFkRW50cmllcztcclxuICAgICAgZGlyUmVhZGVyID0gZGlyZWN0b3J5LmNyZWF0ZVJlYWRlcigpO1xyXG4gICAgICBlcnJvckhhbmRsZXIgPSBmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlICE9PSBudWxsID8gdHlwZW9mIGNvbnNvbGUubG9nID09PSBcImZ1bmN0aW9uXCIgPyBjb25zb2xlLmxvZyhlcnJvcikgOiB2b2lkIDAgOiB2b2lkIDA7XHJcbiAgICAgIH07XHJcbiAgICAgIHJlYWRFbnRyaWVzID0gKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGRpclJlYWRlci5yZWFkRW50cmllcyhmdW5jdGlvbihlbnRyaWVzKSB7XHJcbiAgICAgICAgICAgIHZhciBlbnRyeSwgX2ksIF9sZW47XHJcbiAgICAgICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGVudHJpZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGVudHJ5ID0gZW50cmllc1tfaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuaXNGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGVudHJ5LmZpbGUoZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5vcHRpb25zLmlnbm9yZUhpZGRlbkZpbGVzICYmIGZpbGUubmFtZS5zdWJzdHJpbmcoMCwgMSkgPT09ICcuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmaWxlLmZ1bGxQYXRoID0gXCJcIiArIHBhdGggKyBcIi9cIiArIGZpbGUubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYWRkRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVudHJ5LmlzRGlyZWN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgIF90aGlzLl9hZGRGaWxlc0Zyb21EaXJlY3RvcnkoZW50cnksIFwiXCIgKyBwYXRoICsgXCIvXCIgKyBlbnRyeS5uYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmVhZEVudHJpZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgIH0sIGVycm9ySGFuZGxlcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcyk7XHJcbiAgICAgIHJldHVybiByZWFkRW50cmllcygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24oZmlsZSwgZG9uZSkge1xyXG4gICAgICBpZiAoZmlsZS5zaXplID4gdGhpcy5vcHRpb25zLm1heEZpbGVzaXplICogMTAyNCAqIDEwMjQpIHtcclxuICAgICAgICByZXR1cm4gZG9uZSh0aGlzLm9wdGlvbnMuZGljdEZpbGVUb29CaWcucmVwbGFjZShcInt7ZmlsZXNpemV9fVwiLCBNYXRoLnJvdW5kKGZpbGUuc2l6ZSAvIDEwMjQgLyAxMC4yNCkgLyAxMDApLnJlcGxhY2UoXCJ7e21heEZpbGVzaXplfX1cIiwgdGhpcy5vcHRpb25zLm1heEZpbGVzaXplKSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoIURyb3B6b25lLmlzVmFsaWRGaWxlKGZpbGUsIHRoaXMub3B0aW9ucy5hY2NlcHRlZEZpbGVzKSkge1xyXG4gICAgICAgIHJldHVybiBkb25lKHRoaXMub3B0aW9ucy5kaWN0SW52YWxpZEZpbGVUeXBlKTtcclxuICAgICAgfSBlbHNlIGlmICgodGhpcy5vcHRpb25zLm1heEZpbGVzICE9IG51bGwpICYmIHRoaXMuZ2V0QWNjZXB0ZWRGaWxlcygpLmxlbmd0aCA+PSB0aGlzLm9wdGlvbnMubWF4RmlsZXMpIHtcclxuICAgICAgICBkb25lKHRoaXMub3B0aW9ucy5kaWN0TWF4RmlsZXNFeGNlZWRlZC5yZXBsYWNlKFwie3ttYXhGaWxlc319XCIsIHRoaXMub3B0aW9ucy5tYXhGaWxlcykpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVtaXQoXCJtYXhmaWxlc2V4Y2VlZGVkXCIsIGZpbGUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYWNjZXB0LmNhbGwodGhpcywgZmlsZSwgZG9uZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmFkZEZpbGUgPSBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGZpbGUudXBsb2FkID0ge1xyXG4gICAgICAgIHByb2dyZXNzOiAwLFxyXG4gICAgICAgIHRvdGFsOiBmaWxlLnNpemUsXHJcbiAgICAgICAgYnl0ZXNTZW50OiAwXHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMuZmlsZXMucHVzaChmaWxlKTtcclxuICAgICAgZmlsZS5zdGF0dXMgPSBEcm9wem9uZS5BRERFRDtcclxuICAgICAgdGhpcy5lbWl0KFwiYWRkZWRmaWxlXCIsIGZpbGUpO1xyXG4gICAgICB0aGlzLl9lbnF1ZXVlVGh1bWJuYWlsKGZpbGUpO1xyXG4gICAgICByZXR1cm4gdGhpcy5hY2NlcHQoZmlsZSwgKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgZmlsZS5hY2NlcHRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBfdGhpcy5fZXJyb3JQcm9jZXNzaW5nKFtmaWxlXSwgZXJyb3IpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmlsZS5hY2NlcHRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vcHRpb25zLmF1dG9RdWV1ZSkge1xyXG4gICAgICAgICAgICAgIF90aGlzLmVucXVldWVGaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gX3RoaXMuX3VwZGF0ZU1heEZpbGVzUmVhY2hlZENsYXNzKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcykpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuZW5xdWV1ZUZpbGVzID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgdmFyIGZpbGUsIF9pLCBfbGVuO1xyXG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGZpbGVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgZmlsZSA9IGZpbGVzW19pXTtcclxuICAgICAgICB0aGlzLmVucXVldWVGaWxlKGZpbGUpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuZW5xdWV1ZUZpbGUgPSBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgIGlmIChmaWxlLnN0YXR1cyA9PT0gRHJvcHpvbmUuQURERUQgJiYgZmlsZS5hY2NlcHRlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIGZpbGUuc3RhdHVzID0gRHJvcHpvbmUuUVVFVUVEO1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYXV0b1Byb2Nlc3NRdWV1ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoKChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByb2Nlc3NRdWV1ZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSkodGhpcykpLCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBmaWxlIGNhbid0IGJlIHF1ZXVlZCBiZWNhdXNlIGl0IGhhcyBhbHJlYWR5IGJlZW4gcHJvY2Vzc2VkIG9yIHdhcyByZWplY3RlZC5cIik7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl90aHVtYm5haWxRdWV1ZSA9IFtdO1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fcHJvY2Vzc2luZ1RodW1ibmFpbCA9IGZhbHNlO1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fZW5xdWV1ZVRodW1ibmFpbCA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5jcmVhdGVJbWFnZVRodW1ibmFpbHMgJiYgZmlsZS50eXBlLm1hdGNoKC9pbWFnZS4qLykgJiYgZmlsZS5zaXplIDw9IHRoaXMub3B0aW9ucy5tYXhUaHVtYm5haWxGaWxlc2l6ZSAqIDEwMjQgKiAxMDI0KSB7XHJcbiAgICAgICAgdGhpcy5fdGh1bWJuYWlsUXVldWUucHVzaChmaWxlKTtcclxuICAgICAgICByZXR1cm4gc2V0VGltZW91dCgoKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5fcHJvY2Vzc1RodW1ibmFpbFF1ZXVlKCk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKHRoaXMpKSwgMCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl9wcm9jZXNzVGh1bWJuYWlsUXVldWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuX3Byb2Nlc3NpbmdUaHVtYm5haWwgfHwgdGhpcy5fdGh1bWJuYWlsUXVldWUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuX3Byb2Nlc3NpbmdUaHVtYm5haWwgPSB0cnVlO1xyXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVUaHVtYm5haWwodGhpcy5fdGh1bWJuYWlsUXVldWUuc2hpZnQoKSwgKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgX3RoaXMuX3Byb2Nlc3NpbmdUaHVtYm5haWwgPSBmYWxzZTtcclxuICAgICAgICAgIHJldHVybiBfdGhpcy5fcHJvY2Vzc1RodW1ibmFpbFF1ZXVlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcykpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUucmVtb3ZlRmlsZSA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgaWYgKGZpbGUuc3RhdHVzID09PSBEcm9wem9uZS5VUExPQURJTkcpIHtcclxuICAgICAgICB0aGlzLmNhbmNlbFVwbG9hZChmaWxlKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmZpbGVzID0gd2l0aG91dCh0aGlzLmZpbGVzLCBmaWxlKTtcclxuICAgICAgdGhpcy5lbWl0KFwicmVtb3ZlZGZpbGVcIiwgZmlsZSk7XHJcbiAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVtaXQoXCJyZXNldFwiKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUucmVtb3ZlQWxsRmlsZXMgPSBmdW5jdGlvbihjYW5jZWxJZk5lY2Vzc2FyeSkge1xyXG4gICAgICB2YXIgZmlsZSwgX2ksIF9sZW4sIF9yZWY7XHJcbiAgICAgIGlmIChjYW5jZWxJZk5lY2Vzc2FyeSA9PSBudWxsKSB7XHJcbiAgICAgICAgY2FuY2VsSWZOZWNlc3NhcnkgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBfcmVmID0gdGhpcy5maWxlcy5zbGljZSgpO1xyXG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICBmaWxlID0gX3JlZltfaV07XHJcbiAgICAgICAgaWYgKGZpbGUuc3RhdHVzICE9PSBEcm9wem9uZS5VUExPQURJTkcgfHwgY2FuY2VsSWZOZWNlc3NhcnkpIHtcclxuICAgICAgICAgIHRoaXMucmVtb3ZlRmlsZShmaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5jcmVhdGVUaHVtYm5haWwgPSBmdW5jdGlvbihmaWxlLCBjYWxsYmFjaykge1xyXG4gICAgICB2YXIgZmlsZVJlYWRlcjtcclxuICAgICAgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyO1xyXG4gICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlmIChmaWxlLnR5cGUgPT09IFwiaW1hZ2Uvc3ZnK3htbFwiKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmVtaXQoXCJ0aHVtYm5haWxcIiwgZmlsZSwgZmlsZVJlYWRlci5yZXN1bHQpO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIF90aGlzLmNyZWF0ZVRodW1ibmFpbEZyb21VcmwoZmlsZSwgZmlsZVJlYWRlci5yZXN1bHQsIGNhbGxiYWNrKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KSh0aGlzKTtcclxuICAgICAgcmV0dXJuIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLmNyZWF0ZVRodW1ibmFpbEZyb21VcmwgPSBmdW5jdGlvbihmaWxlLCBpbWFnZVVybCwgY2FsbGJhY2ssIGNyb3NzT3JpZ2luKSB7XHJcbiAgICAgIHZhciBpbWc7XHJcbiAgICAgIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XHJcbiAgICAgIGlmIChjcm9zc09yaWdpbikge1xyXG4gICAgICAgIGltZy5jcm9zc09yaWdpbiA9IGNyb3NzT3JpZ2luO1xyXG4gICAgICB9XHJcbiAgICAgIGltZy5vbmxvYWQgPSAoZnVuY3Rpb24oX3RoaXMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICB2YXIgY2FudmFzLCBjdHgsIHJlc2l6ZUluZm8sIHRodW1ibmFpbCwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMztcclxuICAgICAgICAgIGZpbGUud2lkdGggPSBpbWcud2lkdGg7XHJcbiAgICAgICAgICBmaWxlLmhlaWdodCA9IGltZy5oZWlnaHQ7XHJcbiAgICAgICAgICByZXNpemVJbmZvID0gX3RoaXMub3B0aW9ucy5yZXNpemUuY2FsbChfdGhpcywgZmlsZSk7XHJcbiAgICAgICAgICBpZiAocmVzaXplSW5mby50cmdXaWR0aCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJlc2l6ZUluZm8udHJnV2lkdGggPSByZXNpemVJbmZvLm9wdFdpZHRoO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHJlc2l6ZUluZm8udHJnSGVpZ2h0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmVzaXplSW5mby50cmdIZWlnaHQgPSByZXNpemVJbmZvLm9wdEhlaWdodDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgICAgY2FudmFzLndpZHRoID0gcmVzaXplSW5mby50cmdXaWR0aDtcclxuICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSByZXNpemVJbmZvLnRyZ0hlaWdodDtcclxuICAgICAgICAgIGRyYXdJbWFnZUlPU0ZpeChjdHgsIGltZywgKF9yZWYgPSByZXNpemVJbmZvLnNyY1gpICE9IG51bGwgPyBfcmVmIDogMCwgKF9yZWYxID0gcmVzaXplSW5mby5zcmNZKSAhPSBudWxsID8gX3JlZjEgOiAwLCByZXNpemVJbmZvLnNyY1dpZHRoLCByZXNpemVJbmZvLnNyY0hlaWdodCwgKF9yZWYyID0gcmVzaXplSW5mby50cmdYKSAhPSBudWxsID8gX3JlZjIgOiAwLCAoX3JlZjMgPSByZXNpemVJbmZvLnRyZ1kpICE9IG51bGwgPyBfcmVmMyA6IDAsIHJlc2l6ZUluZm8udHJnV2lkdGgsIHJlc2l6ZUluZm8udHJnSGVpZ2h0KTtcclxuICAgICAgICAgIHRodW1ibmFpbCA9IGNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XHJcbiAgICAgICAgICBfdGhpcy5lbWl0KFwidGh1bWJuYWlsXCIsIGZpbGUsIHRodW1ibmFpbCk7XHJcbiAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICB9KSh0aGlzKTtcclxuICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcclxuICAgICAgICBpbWcub25lcnJvciA9IGNhbGxiYWNrO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBpbWcuc3JjID0gaW1hZ2VVcmw7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5wcm9jZXNzUXVldWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGksIHBhcmFsbGVsVXBsb2FkcywgcHJvY2Vzc2luZ0xlbmd0aCwgcXVldWVkRmlsZXM7XHJcbiAgICAgIHBhcmFsbGVsVXBsb2FkcyA9IHRoaXMub3B0aW9ucy5wYXJhbGxlbFVwbG9hZHM7XHJcbiAgICAgIHByb2Nlc3NpbmdMZW5ndGggPSB0aGlzLmdldFVwbG9hZGluZ0ZpbGVzKCkubGVuZ3RoO1xyXG4gICAgICBpID0gcHJvY2Vzc2luZ0xlbmd0aDtcclxuICAgICAgaWYgKHByb2Nlc3NpbmdMZW5ndGggPj0gcGFyYWxsZWxVcGxvYWRzKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHF1ZXVlZEZpbGVzID0gdGhpcy5nZXRRdWV1ZWRGaWxlcygpO1xyXG4gICAgICBpZiAoIShxdWV1ZWRGaWxlcy5sZW5ndGggPiAwKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnVwbG9hZE11bHRpcGxlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc0ZpbGVzKHF1ZXVlZEZpbGVzLnNsaWNlKDAsIHBhcmFsbGVsVXBsb2FkcyAtIHByb2Nlc3NpbmdMZW5ndGgpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB3aGlsZSAoaSA8IHBhcmFsbGVsVXBsb2Fkcykge1xyXG4gICAgICAgICAgaWYgKCFxdWV1ZWRGaWxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5wcm9jZXNzRmlsZShxdWV1ZWRGaWxlcy5zaGlmdCgpKTtcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLnByb2Nlc3NGaWxlID0gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmlsZXMoW2ZpbGVdKTtcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLnByb2Nlc3NGaWxlcyA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgIHZhciBmaWxlLCBfaSwgX2xlbjtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBmaWxlcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIGZpbGUgPSBmaWxlc1tfaV07XHJcbiAgICAgICAgZmlsZS5wcm9jZXNzaW5nID0gdHJ1ZTtcclxuICAgICAgICBmaWxlLnN0YXR1cyA9IERyb3B6b25lLlVQTE9BRElORztcclxuICAgICAgICB0aGlzLmVtaXQoXCJwcm9jZXNzaW5nXCIsIGZpbGUpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudXBsb2FkTXVsdGlwbGUpIHtcclxuICAgICAgICB0aGlzLmVtaXQoXCJwcm9jZXNzaW5nbXVsdGlwbGVcIiwgZmlsZXMpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLnVwbG9hZEZpbGVzKGZpbGVzKTtcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLl9nZXRGaWxlc1dpdGhYaHIgPSBmdW5jdGlvbih4aHIpIHtcclxuICAgICAgdmFyIGZpbGUsIGZpbGVzO1xyXG4gICAgICByZXR1cm4gZmlsZXMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0cztcclxuICAgICAgICBfcmVmID0gdGhpcy5maWxlcztcclxuICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgICAgZmlsZSA9IF9yZWZbX2ldO1xyXG4gICAgICAgICAgaWYgKGZpbGUueGhyID09PSB4aHIpIHtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChmaWxlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gICAgICB9KS5jYWxsKHRoaXMpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuY2FuY2VsVXBsb2FkID0gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICB2YXIgZ3JvdXBlZEZpbGUsIGdyb3VwZWRGaWxlcywgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZjtcclxuICAgICAgaWYgKGZpbGUuc3RhdHVzID09PSBEcm9wem9uZS5VUExPQURJTkcpIHtcclxuICAgICAgICBncm91cGVkRmlsZXMgPSB0aGlzLl9nZXRGaWxlc1dpdGhYaHIoZmlsZS54aHIpO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZ3JvdXBlZEZpbGVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XHJcbiAgICAgICAgICBncm91cGVkRmlsZSA9IGdyb3VwZWRGaWxlc1tfaV07XHJcbiAgICAgICAgICBncm91cGVkRmlsZS5zdGF0dXMgPSBEcm9wem9uZS5DQU5DRUxFRDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmlsZS54aHIuYWJvcnQoKTtcclxuICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBncm91cGVkRmlsZXMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XHJcbiAgICAgICAgICBncm91cGVkRmlsZSA9IGdyb3VwZWRGaWxlc1tfal07XHJcbiAgICAgICAgICB0aGlzLmVtaXQoXCJjYW5jZWxlZFwiLCBncm91cGVkRmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudXBsb2FkTXVsdGlwbGUpIHtcclxuICAgICAgICAgIHRoaXMuZW1pdChcImNhbmNlbGVkbXVsdGlwbGVcIiwgZ3JvdXBlZEZpbGVzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoKF9yZWYgPSBmaWxlLnN0YXR1cykgPT09IERyb3B6b25lLkFEREVEIHx8IF9yZWYgPT09IERyb3B6b25lLlFVRVVFRCkge1xyXG4gICAgICAgIGZpbGUuc3RhdHVzID0gRHJvcHpvbmUuQ0FOQ0VMRUQ7XHJcbiAgICAgICAgdGhpcy5lbWl0KFwiY2FuY2VsZWRcIiwgZmlsZSk7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51cGxvYWRNdWx0aXBsZSkge1xyXG4gICAgICAgICAgdGhpcy5lbWl0KFwiY2FuY2VsZWRtdWx0aXBsZVwiLCBbZmlsZV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmF1dG9Qcm9jZXNzUXVldWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUXVldWUoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXNvbHZlT3B0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBhcmdzLCBvcHRpb247XHJcbiAgICAgIG9wdGlvbiA9IGFyZ3VtZW50c1swXSwgYXJncyA9IDIgPD0gYXJndW1lbnRzLmxlbmd0aCA/IF9fc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpIDogW107XHJcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbi5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gb3B0aW9uO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUudXBsb2FkRmlsZSA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgcmV0dXJuIHRoaXMudXBsb2FkRmlsZXMoW2ZpbGVdKTtcclxuICAgIH07XHJcblxyXG4gICAgRHJvcHpvbmUucHJvdG90eXBlLnVwbG9hZEZpbGVzID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgdmFyIGZpbGUsIGZvcm1EYXRhLCBoYW5kbGVFcnJvciwgaGVhZGVyTmFtZSwgaGVhZGVyVmFsdWUsIGhlYWRlcnMsIGksIGlucHV0LCBpbnB1dE5hbWUsIGlucHV0VHlwZSwga2V5LCBtZXRob2QsIG9wdGlvbiwgcHJvZ3Jlc3NPYmosIHJlc3BvbnNlLCB1cGRhdGVQcm9ncmVzcywgdXJsLCB2YWx1ZSwgeGhyLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX20sIF9yZWYsIF9yZWYxLCBfcmVmMiwgX3JlZjMsIF9yZWY0LCBfcmVmNTtcclxuICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZmlsZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICBmaWxlID0gZmlsZXNbX2ldO1xyXG4gICAgICAgIGZpbGUueGhyID0geGhyO1xyXG4gICAgICB9XHJcbiAgICAgIG1ldGhvZCA9IHJlc29sdmVPcHRpb24odGhpcy5vcHRpb25zLm1ldGhvZCwgZmlsZXMpO1xyXG4gICAgICB1cmwgPSByZXNvbHZlT3B0aW9uKHRoaXMub3B0aW9ucy51cmwsIGZpbGVzKTtcclxuICAgICAgeGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xyXG4gICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gISF0aGlzLm9wdGlvbnMud2l0aENyZWRlbnRpYWxzO1xyXG4gICAgICByZXNwb25zZSA9IG51bGw7XHJcbiAgICAgIGhhbmRsZUVycm9yID0gKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgdmFyIF9qLCBfbGVuMSwgX3Jlc3VsdHM7XHJcbiAgICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gZmlsZXMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XHJcbiAgICAgICAgICAgIGZpbGUgPSBmaWxlc1tfal07XHJcbiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goX3RoaXMuX2Vycm9yUHJvY2Vzc2luZyhmaWxlcywgcmVzcG9uc2UgfHwgX3RoaXMub3B0aW9ucy5kaWN0UmVzcG9uc2VFcnJvci5yZXBsYWNlKFwie3tzdGF0dXNDb2RlfX1cIiwgeGhyLnN0YXR1cyksIHhocikpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKHRoaXMpO1xyXG4gICAgICB1cGRhdGVQcm9ncmVzcyA9IChmdW5jdGlvbihfdGhpcykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICB2YXIgYWxsRmlsZXNGaW5pc2hlZCwgcHJvZ3Jlc3MsIF9qLCBfaywgX2wsIF9sZW4xLCBfbGVuMiwgX2xlbjMsIF9yZXN1bHRzO1xyXG4gICAgICAgICAgaWYgKGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBwcm9ncmVzcyA9IDEwMCAqIGUubG9hZGVkIC8gZS50b3RhbDtcclxuICAgICAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gZmlsZXMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XHJcbiAgICAgICAgICAgICAgZmlsZSA9IGZpbGVzW19qXTtcclxuICAgICAgICAgICAgICBmaWxlLnVwbG9hZCA9IHtcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzOiBwcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiBlLnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgYnl0ZXNTZW50OiBlLmxvYWRlZFxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFsbEZpbGVzRmluaXNoZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBwcm9ncmVzcyA9IDEwMDtcclxuICAgICAgICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gZmlsZXMubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7XHJcbiAgICAgICAgICAgICAgZmlsZSA9IGZpbGVzW19rXTtcclxuICAgICAgICAgICAgICBpZiAoIShmaWxlLnVwbG9hZC5wcm9ncmVzcyA9PT0gMTAwICYmIGZpbGUudXBsb2FkLmJ5dGVzU2VudCA9PT0gZmlsZS51cGxvYWQudG90YWwpKSB7XHJcbiAgICAgICAgICAgICAgICBhbGxGaWxlc0ZpbmlzaGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGZpbGUudXBsb2FkLnByb2dyZXNzID0gcHJvZ3Jlc3M7XHJcbiAgICAgICAgICAgICAgZmlsZS51cGxvYWQuYnl0ZXNTZW50ID0gZmlsZS51cGxvYWQudG90YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFsbEZpbGVzRmluaXNoZWQpIHtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIF9yZXN1bHRzID0gW107XHJcbiAgICAgICAgICBmb3IgKF9sID0gMCwgX2xlbjMgPSBmaWxlcy5sZW5ndGg7IF9sIDwgX2xlbjM7IF9sKyspIHtcclxuICAgICAgICAgICAgZmlsZSA9IGZpbGVzW19sXTtcclxuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChfdGhpcy5lbWl0KFwidXBsb2FkcHJvZ3Jlc3NcIiwgZmlsZSwgcHJvZ3Jlc3MsIGZpbGUudXBsb2FkLmJ5dGVzU2VudCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKHRoaXMpO1xyXG4gICAgICB4aHIub25sb2FkID0gKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciBfcmVmO1xyXG4gICAgICAgICAgaWYgKGZpbGVzWzBdLnN0YXR1cyA9PT0gRHJvcHpvbmUuQ0FOQ0VMRUQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlICE9PSA0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJlc3BvbnNlID0geGhyLnJlc3BvbnNlVGV4dDtcclxuICAgICAgICAgIGlmICh4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJjb250ZW50LXR5cGVcIikgJiYgfnhoci5nZXRSZXNwb25zZUhlYWRlcihcImNvbnRlbnQtdHlwZVwiKS5pbmRleE9mKFwiYXBwbGljYXRpb24vanNvblwiKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKF9lcnJvcikge1xyXG4gICAgICAgICAgICAgIGUgPSBfZXJyb3I7XHJcbiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBcIkludmFsaWQgSlNPTiByZXNwb25zZSBmcm9tIHNlcnZlci5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MoKTtcclxuICAgICAgICAgIGlmICghKCgyMDAgPD0gKF9yZWYgPSB4aHIuc3RhdHVzKSAmJiBfcmVmIDwgMzAwKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZUVycm9yKCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuX2ZpbmlzaGVkKGZpbGVzLCByZXNwb25zZSwgZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcyk7XHJcbiAgICAgIHhoci5vbmVycm9yID0gKGZ1bmN0aW9uKF90aGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKGZpbGVzWzBdLnN0YXR1cyA9PT0gRHJvcHpvbmUuQ0FOQ0VMRUQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZUVycm9yKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSkodGhpcyk7XHJcbiAgICAgIHByb2dyZXNzT2JqID0gKF9yZWYgPSB4aHIudXBsb2FkKSAhPSBudWxsID8gX3JlZiA6IHhocjtcclxuICAgICAgcHJvZ3Jlc3NPYmoub25wcm9ncmVzcyA9IHVwZGF0ZVByb2dyZXNzO1xyXG4gICAgICBoZWFkZXJzID0ge1xyXG4gICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgIFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLWNhY2hlXCIsXHJcbiAgICAgICAgXCJYLVJlcXVlc3RlZC1XaXRoXCI6IFwiWE1MSHR0cFJlcXVlc3RcIlxyXG4gICAgICB9O1xyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmhlYWRlcnMpIHtcclxuICAgICAgICBleHRlbmQoaGVhZGVycywgdGhpcy5vcHRpb25zLmhlYWRlcnMpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaGVhZGVyTmFtZSBpbiBoZWFkZXJzKSB7XHJcbiAgICAgICAgaGVhZGVyVmFsdWUgPSBoZWFkZXJzW2hlYWRlck5hbWVdO1xyXG4gICAgICAgIGlmIChoZWFkZXJWYWx1ZSkge1xyXG4gICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoaGVhZGVyTmFtZSwgaGVhZGVyVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnBhcmFtcykge1xyXG4gICAgICAgIF9yZWYxID0gdGhpcy5vcHRpb25zLnBhcmFtcztcclxuICAgICAgICBmb3IgKGtleSBpbiBfcmVmMSkge1xyXG4gICAgICAgICAgdmFsdWUgPSBfcmVmMVtrZXldO1xyXG4gICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBmaWxlcy5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHtcclxuICAgICAgICBmaWxlID0gZmlsZXNbX2pdO1xyXG4gICAgICAgIHRoaXMuZW1pdChcInNlbmRpbmdcIiwgZmlsZSwgeGhyLCBmb3JtRGF0YSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy51cGxvYWRNdWx0aXBsZSkge1xyXG4gICAgICAgIHRoaXMuZW1pdChcInNlbmRpbmdtdWx0aXBsZVwiLCBmaWxlcywgeGhyLCBmb3JtRGF0YSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSBcIkZPUk1cIikge1xyXG4gICAgICAgIF9yZWYyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgYnV0dG9uXCIpO1xyXG4gICAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykge1xyXG4gICAgICAgICAgaW5wdXQgPSBfcmVmMltfa107XHJcbiAgICAgICAgICBpbnB1dE5hbWUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKTtcclxuICAgICAgICAgIGlmIChpbnB1dC50YWdOYW1lID09PSBcIlNFTEVDVFwiICYmIGlucHV0Lmhhc0F0dHJpYnV0ZShcIm11bHRpcGxlXCIpKSB7XHJcbiAgICAgICAgICAgIF9yZWYzID0gaW5wdXQub3B0aW9ucztcclxuICAgICAgICAgICAgZm9yIChfbCA9IDAsIF9sZW4zID0gX3JlZjMubGVuZ3RoOyBfbCA8IF9sZW4zOyBfbCsrKSB7XHJcbiAgICAgICAgICAgICAgb3B0aW9uID0gX3JlZjNbX2xdO1xyXG4gICAgICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChpbnB1dE5hbWUsIG9wdGlvbi52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKCFpbnB1dFR5cGUgfHwgKChfcmVmNCA9IGlucHV0VHlwZS50b0xvd2VyQ2FzZSgpKSAhPT0gXCJjaGVja2JveFwiICYmIF9yZWY0ICE9PSBcInJhZGlvXCIpIHx8IGlucHV0LmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGlucHV0TmFtZSwgaW5wdXQudmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSBfbSA9IDAsIF9yZWY1ID0gZmlsZXMubGVuZ3RoIC0gMTsgMCA8PSBfcmVmNSA/IF9tIDw9IF9yZWY1IDogX20gPj0gX3JlZjU7IGkgPSAwIDw9IF9yZWY1ID8gKytfbSA6IC0tX20pIHtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQodGhpcy5fZ2V0UGFyYW1OYW1lKGkpLCBmaWxlc1tpXSwgdGhpcy5fcmVuYW1lRmlsZW5hbWUoZmlsZXNbaV0ubmFtZSkpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLnN1Ym1pdFJlcXVlc3QoeGhyLCBmb3JtRGF0YSwgZmlsZXMpO1xyXG4gICAgfTtcclxuXHJcbiAgICBEcm9wem9uZS5wcm90b3R5cGUuc3VibWl0UmVxdWVzdCA9IGZ1bmN0aW9uKHhociwgZm9ybURhdGEsIGZpbGVzKSB7XHJcbiAgICAgIHJldHVybiB4aHIuc2VuZChmb3JtRGF0YSk7XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fZmluaXNoZWQgPSBmdW5jdGlvbihmaWxlcywgcmVzcG9uc2VUZXh0LCBlKSB7XHJcbiAgICAgIHZhciBmaWxlLCBfaSwgX2xlbjtcclxuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBmaWxlcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgIGZpbGUgPSBmaWxlc1tfaV07XHJcbiAgICAgICAgZmlsZS5zdGF0dXMgPSBEcm9wem9uZS5TVUNDRVNTO1xyXG4gICAgICAgIHRoaXMuZW1pdChcInN1Y2Nlc3NcIiwgZmlsZSwgcmVzcG9uc2VUZXh0LCBlKTtcclxuICAgICAgICB0aGlzLmVtaXQoXCJjb21wbGV0ZVwiLCBmaWxlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnVwbG9hZE11bHRpcGxlKSB7XHJcbiAgICAgICAgdGhpcy5lbWl0KFwic3VjY2Vzc211bHRpcGxlXCIsIGZpbGVzLCByZXNwb25zZVRleHQsIGUpO1xyXG4gICAgICAgIHRoaXMuZW1pdChcImNvbXBsZXRlbXVsdGlwbGVcIiwgZmlsZXMpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuYXV0b1Byb2Nlc3NRdWV1ZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NRdWV1ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIERyb3B6b25lLnByb3RvdHlwZS5fZXJyb3JQcm9jZXNzaW5nID0gZnVuY3Rpb24oZmlsZXMsIG1lc3NhZ2UsIHhocikge1xyXG4gICAgICB2YXIgZmlsZSwgX2ksIF9sZW47XHJcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZmlsZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICBmaWxlID0gZmlsZXNbX2ldO1xyXG4gICAgICAgIGZpbGUuc3RhdHVzID0gRHJvcHpvbmUuRVJST1I7XHJcbiAgICAgICAgdGhpcy5lbWl0KFwiZXJyb3JcIiwgZmlsZSwgbWVzc2FnZSwgeGhyKTtcclxuICAgICAgICB0aGlzLmVtaXQoXCJjb21wbGV0ZVwiLCBmaWxlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnVwbG9hZE11bHRpcGxlKSB7XHJcbiAgICAgICAgdGhpcy5lbWl0KFwiZXJyb3JtdWx0aXBsZVwiLCBmaWxlcywgbWVzc2FnZSwgeGhyKTtcclxuICAgICAgICB0aGlzLmVtaXQoXCJjb21wbGV0ZW11bHRpcGxlXCIsIGZpbGVzKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmF1dG9Qcm9jZXNzUXVldWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUXVldWUoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gRHJvcHpvbmU7XHJcblxyXG4gIH0pKEVtaXR0ZXIpO1xyXG5cclxuICBEcm9wem9uZS52ZXJzaW9uID0gXCI0LjMuMFwiO1xyXG5cclxuICBEcm9wem9uZS5vcHRpb25zID0ge307XHJcblxyXG4gIERyb3B6b25lLm9wdGlvbnNGb3JFbGVtZW50ID0gZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiaWRcIikpIHtcclxuICAgICAgcmV0dXJuIERyb3B6b25lLm9wdGlvbnNbY2FtZWxpemUoZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKSldO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHZvaWQgMDtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBEcm9wem9uZS5pbnN0YW5jZXMgPSBbXTtcclxuXHJcbiAgRHJvcHpvbmUuZm9yRWxlbWVudCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KTtcclxuICAgIH1cclxuICAgIGlmICgoZWxlbWVudCAhPSBudWxsID8gZWxlbWVudC5kcm9wem9uZSA6IHZvaWQgMCkgPT0gbnVsbCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBEcm9wem9uZSBmb3VuZCBmb3IgZ2l2ZW4gZWxlbWVudC4gVGhpcyBpcyBwcm9iYWJseSBiZWNhdXNlIHlvdSdyZSB0cnlpbmcgdG8gYWNjZXNzIGl0IGJlZm9yZSBEcm9wem9uZSBoYWQgdGhlIHRpbWUgdG8gaW5pdGlhbGl6ZS4gVXNlIHRoZSBgaW5pdGAgb3B0aW9uIHRvIHNldHVwIGFueSBhZGRpdGlvbmFsIG9ic2VydmVycyBvbiB5b3VyIERyb3B6b25lLlwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBlbGVtZW50LmRyb3B6b25lO1xyXG4gIH07XHJcblxyXG4gIERyb3B6b25lLmF1dG9EaXNjb3ZlciA9IHRydWU7XHJcblxyXG4gIERyb3B6b25lLmRpc2NvdmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgY2hlY2tFbGVtZW50cywgZHJvcHpvbmUsIGRyb3B6b25lcywgX2ksIF9sZW4sIF9yZXN1bHRzO1xyXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcclxuICAgICAgZHJvcHpvbmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5kcm9wem9uZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRyb3B6b25lcyA9IFtdO1xyXG4gICAgICBjaGVja0VsZW1lbnRzID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcclxuICAgICAgICB2YXIgZWwsIF9pLCBfbGVuLCBfcmVzdWx0cztcclxuICAgICAgICBfcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZWxlbWVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgIGVsID0gZWxlbWVudHNbX2ldO1xyXG4gICAgICAgICAgaWYgKC8oXnwgKWRyb3B6b25lKCR8ICkvLnRlc3QoZWwuY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICBfcmVzdWx0cy5wdXNoKGRyb3B6b25lcy5wdXNoKGVsKSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfcmVzdWx0cztcclxuICAgICAgfTtcclxuICAgICAgY2hlY2tFbGVtZW50cyhkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImRpdlwiKSk7XHJcbiAgICAgIGNoZWNrRWxlbWVudHMoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJmb3JtXCIpKTtcclxuICAgIH1cclxuICAgIF9yZXN1bHRzID0gW107XHJcbiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGRyb3B6b25lcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICBkcm9wem9uZSA9IGRyb3B6b25lc1tfaV07XHJcbiAgICAgIGlmIChEcm9wem9uZS5vcHRpb25zRm9yRWxlbWVudChkcm9wem9uZSkgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgX3Jlc3VsdHMucHVzaChuZXcgRHJvcHpvbmUoZHJvcHpvbmUpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBfcmVzdWx0cztcclxuICB9O1xyXG5cclxuICBEcm9wem9uZS5ibGFja2xpc3RlZEJyb3dzZXJzID0gWy9vcGVyYS4qTWFjaW50b3NoLip2ZXJzaW9uXFwvMTIvaV07XHJcblxyXG4gIERyb3B6b25lLmlzQnJvd3NlclN1cHBvcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGNhcGFibGVCcm93c2VyLCByZWdleCwgX2ksIF9sZW4sIF9yZWY7XHJcbiAgICBjYXBhYmxlQnJvd3NlciA9IHRydWU7XHJcbiAgICBpZiAod2luZG93LkZpbGUgJiYgd2luZG93LkZpbGVSZWFkZXIgJiYgd2luZG93LkZpbGVMaXN0ICYmIHdpbmRvdy5CbG9iICYmIHdpbmRvdy5Gb3JtRGF0YSAmJiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKSB7XHJcbiAgICAgIGlmICghKFwiY2xhc3NMaXN0XCIgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIikpKSB7XHJcbiAgICAgICAgY2FwYWJsZUJyb3dzZXIgPSBmYWxzZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBfcmVmID0gRHJvcHpvbmUuYmxhY2tsaXN0ZWRCcm93c2VycztcclxuICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgICAgIHJlZ2V4ID0gX3JlZltfaV07XHJcbiAgICAgICAgICBpZiAocmVnZXgudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xyXG4gICAgICAgICAgICBjYXBhYmxlQnJvd3NlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhcGFibGVCcm93c2VyID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2FwYWJsZUJyb3dzZXI7XHJcbiAgfTtcclxuXHJcbiAgd2l0aG91dCA9IGZ1bmN0aW9uKGxpc3QsIHJlamVjdGVkSXRlbSkge1xyXG4gICAgdmFyIGl0ZW0sIF9pLCBfbGVuLCBfcmVzdWx0cztcclxuICAgIF9yZXN1bHRzID0gW107XHJcbiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGxpc3QubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcclxuICAgICAgaXRlbSA9IGxpc3RbX2ldO1xyXG4gICAgICBpZiAoaXRlbSAhPT0gcmVqZWN0ZWRJdGVtKSB7XHJcbiAgICAgICAgX3Jlc3VsdHMucHVzaChpdGVtKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9yZXN1bHRzO1xyXG4gIH07XHJcblxyXG4gIGNhbWVsaXplID0gZnVuY3Rpb24oc3RyKSB7XHJcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1tcXC1fXShcXHcpL2csIGZ1bmN0aW9uKG1hdGNoKSB7XHJcbiAgICAgIHJldHVybiBtYXRjaC5jaGFyQXQoMSkudG9VcHBlckNhc2UoKTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIERyb3B6b25lLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbihzdHJpbmcpIHtcclxuICAgIHZhciBkaXY7XHJcbiAgICBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgZGl2LmlubmVySFRNTCA9IHN0cmluZztcclxuICAgIHJldHVybiBkaXYuY2hpbGROb2Rlc1swXTtcclxuICB9O1xyXG5cclxuICBEcm9wem9uZS5lbGVtZW50SW5zaWRlID0gZnVuY3Rpb24oZWxlbWVudCwgY29udGFpbmVyKSB7XHJcbiAgICBpZiAoZWxlbWVudCA9PT0gY29udGFpbmVyKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgd2hpbGUgKGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGUpIHtcclxuICAgICAgaWYgKGVsZW1lbnQgPT09IGNvbnRhaW5lcikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfTtcclxuXHJcbiAgRHJvcHpvbmUuZ2V0RWxlbWVudCA9IGZ1bmN0aW9uKGVsLCBuYW1lKSB7XHJcbiAgICB2YXIgZWxlbWVudDtcclxuICAgIGlmICh0eXBlb2YgZWwgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWwpO1xyXG4gICAgfSBlbHNlIGlmIChlbC5ub2RlVHlwZSAhPSBudWxsKSB7XHJcbiAgICAgIGVsZW1lbnQgPSBlbDtcclxuICAgIH1cclxuICAgIGlmIChlbGVtZW50ID09IG51bGwpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBgXCIgKyBuYW1lICsgXCJgIG9wdGlvbiBwcm92aWRlZC4gUGxlYXNlIHByb3ZpZGUgYSBDU1Mgc2VsZWN0b3Igb3IgYSBwbGFpbiBIVE1MIGVsZW1lbnQuXCIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgRHJvcHpvbmUuZ2V0RWxlbWVudHMgPSBmdW5jdGlvbihlbHMsIG5hbWUpIHtcclxuICAgIHZhciBlLCBlbCwgZWxlbWVudHMsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWY7XHJcbiAgICBpZiAoZWxzIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgZWxlbWVudHMgPSBbXTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGVscy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICAgICAgZWwgPSBlbHNbX2ldO1xyXG4gICAgICAgICAgZWxlbWVudHMucHVzaCh0aGlzLmdldEVsZW1lbnQoZWwsIG5hbWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKF9lcnJvcikge1xyXG4gICAgICAgIGUgPSBfZXJyb3I7XHJcbiAgICAgICAgZWxlbWVudHMgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbHMgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgZWxlbWVudHMgPSBbXTtcclxuICAgICAgX3JlZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZWxzKTtcclxuICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZi5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHtcclxuICAgICAgICBlbCA9IF9yZWZbX2pdO1xyXG4gICAgICAgIGVsZW1lbnRzLnB1c2goZWwpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGVscy5ub2RlVHlwZSAhPSBudWxsKSB7XHJcbiAgICAgIGVsZW1lbnRzID0gW2Vsc107XHJcbiAgICB9XHJcbiAgICBpZiAoISgoZWxlbWVudHMgIT0gbnVsbCkgJiYgZWxlbWVudHMubGVuZ3RoKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGBcIiArIG5hbWUgKyBcImAgb3B0aW9uIHByb3ZpZGVkLiBQbGVhc2UgcHJvdmlkZSBhIENTUyBzZWxlY3RvciwgYSBwbGFpbiBIVE1MIGVsZW1lbnQgb3IgYSBsaXN0IG9mIHRob3NlLlwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBlbGVtZW50cztcclxuICB9O1xyXG5cclxuICBEcm9wem9uZS5jb25maXJtID0gZnVuY3Rpb24ocXVlc3Rpb24sIGFjY2VwdGVkLCByZWplY3RlZCkge1xyXG4gICAgaWYgKHdpbmRvdy5jb25maXJtKHF1ZXN0aW9uKSkge1xyXG4gICAgICByZXR1cm4gYWNjZXB0ZWQoKTtcclxuICAgIH0gZWxzZSBpZiAocmVqZWN0ZWQgIT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gcmVqZWN0ZWQoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBEcm9wem9uZS5pc1ZhbGlkRmlsZSA9IGZ1bmN0aW9uKGZpbGUsIGFjY2VwdGVkRmlsZXMpIHtcclxuICAgIHZhciBiYXNlTWltZVR5cGUsIG1pbWVUeXBlLCB2YWxpZFR5cGUsIF9pLCBfbGVuO1xyXG4gICAgaWYgKCFhY2NlcHRlZEZpbGVzKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgYWNjZXB0ZWRGaWxlcyA9IGFjY2VwdGVkRmlsZXMuc3BsaXQoXCIsXCIpO1xyXG4gICAgbWltZVR5cGUgPSBmaWxlLnR5cGU7XHJcbiAgICBiYXNlTWltZVR5cGUgPSBtaW1lVHlwZS5yZXBsYWNlKC9cXC8uKiQvLCBcIlwiKTtcclxuICAgIGZvciAoX2kgPSAwLCBfbGVuID0gYWNjZXB0ZWRGaWxlcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xyXG4gICAgICB2YWxpZFR5cGUgPSBhY2NlcHRlZEZpbGVzW19pXTtcclxuICAgICAgdmFsaWRUeXBlID0gdmFsaWRUeXBlLnRyaW0oKTtcclxuICAgICAgaWYgKHZhbGlkVHlwZS5jaGFyQXQoMCkgPT09IFwiLlwiKSB7XHJcbiAgICAgICAgaWYgKGZpbGUubmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodmFsaWRUeXBlLnRvTG93ZXJDYXNlKCksIGZpbGUubmFtZS5sZW5ndGggLSB2YWxpZFR5cGUubGVuZ3RoKSAhPT0gLTEpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmICgvXFwvXFwqJC8udGVzdCh2YWxpZFR5cGUpKSB7XHJcbiAgICAgICAgaWYgKGJhc2VNaW1lVHlwZSA9PT0gdmFsaWRUeXBlLnJlcGxhY2UoL1xcLy4qJC8sIFwiXCIpKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKG1pbWVUeXBlID09PSB2YWxpZFR5cGUpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH07XHJcblxyXG4gIGlmICh0eXBlb2YgalF1ZXJ5ICE9PSBcInVuZGVmaW5lZFwiICYmIGpRdWVyeSAhPT0gbnVsbCkge1xyXG4gICAgalF1ZXJ5LmZuLmRyb3B6b25lID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRHJvcHpvbmUodGhpcywgb3B0aW9ucyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiICYmIG1vZHVsZSAhPT0gbnVsbCkge1xyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBEcm9wem9uZTtcclxuICB9IGVsc2Uge1xyXG4gICAgd2luZG93LkRyb3B6b25lID0gRHJvcHpvbmU7XHJcbiAgfVxyXG5cclxuICBEcm9wem9uZS5BRERFRCA9IFwiYWRkZWRcIjtcclxuXHJcbiAgRHJvcHpvbmUuUVVFVUVEID0gXCJxdWV1ZWRcIjtcclxuXHJcbiAgRHJvcHpvbmUuQUNDRVBURUQgPSBEcm9wem9uZS5RVUVVRUQ7XHJcblxyXG4gIERyb3B6b25lLlVQTE9BRElORyA9IFwidXBsb2FkaW5nXCI7XHJcblxyXG4gIERyb3B6b25lLlBST0NFU1NJTkcgPSBEcm9wem9uZS5VUExPQURJTkc7XHJcblxyXG4gIERyb3B6b25lLkNBTkNFTEVEID0gXCJjYW5jZWxlZFwiO1xyXG5cclxuICBEcm9wem9uZS5FUlJPUiA9IFwiZXJyb3JcIjtcclxuXHJcbiAgRHJvcHpvbmUuU1VDQ0VTUyA9IFwic3VjY2Vzc1wiO1xyXG5cclxuXHJcbiAgLypcclxuICBcclxuICBCdWdmaXggZm9yIGlPUyA2IGFuZCA3XHJcbiAgU291cmNlOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzExOTI5MDk5L2h0bWw1LWNhbnZhcy1kcmF3aW1hZ2UtcmF0aW8tYnVnLWlvc1xyXG4gIGJhc2VkIG9uIHRoZSB3b3JrIG9mIGh0dHBzOi8vZ2l0aHViLmNvbS9zdG9taXRhL2lvcy1pbWFnZWZpbGUtbWVnYXBpeGVsXHJcbiAgICovXHJcblxyXG4gIGRldGVjdFZlcnRpY2FsU3F1YXNoID0gZnVuY3Rpb24oaW1nKSB7XHJcbiAgICB2YXIgYWxwaGEsIGNhbnZhcywgY3R4LCBkYXRhLCBleSwgaWgsIGl3LCBweSwgcmF0aW8sIHN5O1xyXG4gICAgaXcgPSBpbWcubmF0dXJhbFdpZHRoO1xyXG4gICAgaWggPSBpbWcubmF0dXJhbEhlaWdodDtcclxuICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICBjYW52YXMud2lkdGggPSAxO1xyXG4gICAgY2FudmFzLmhlaWdodCA9IGloO1xyXG4gICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTtcclxuICAgIGRhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIDEsIGloKS5kYXRhO1xyXG4gICAgc3kgPSAwO1xyXG4gICAgZXkgPSBpaDtcclxuICAgIHB5ID0gaWg7XHJcbiAgICB3aGlsZSAocHkgPiBzeSkge1xyXG4gICAgICBhbHBoYSA9IGRhdGFbKHB5IC0gMSkgKiA0ICsgM107XHJcbiAgICAgIGlmIChhbHBoYSA9PT0gMCkge1xyXG4gICAgICAgIGV5ID0gcHk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3kgPSBweTtcclxuICAgICAgfVxyXG4gICAgICBweSA9IChleSArIHN5KSA+PiAxO1xyXG4gICAgfVxyXG4gICAgcmF0aW8gPSBweSAvIGloO1xyXG4gICAgaWYgKHJhdGlvID09PSAwKSB7XHJcbiAgICAgIHJldHVybiAxO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHJhdGlvO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGRyYXdJbWFnZUlPU0ZpeCA9IGZ1bmN0aW9uKGN0eCwgaW1nLCBzeCwgc3ksIHN3LCBzaCwgZHgsIGR5LCBkdywgZGgpIHtcclxuICAgIHZhciB2ZXJ0U3F1YXNoUmF0aW87XHJcbiAgICB2ZXJ0U3F1YXNoUmF0aW8gPSBkZXRlY3RWZXJ0aWNhbFNxdWFzaChpbWcpO1xyXG4gICAgcmV0dXJuIGN0eC5kcmF3SW1hZ2UoaW1nLCBzeCwgc3ksIHN3LCBzaCwgZHgsIGR5LCBkdywgZGggLyB2ZXJ0U3F1YXNoUmF0aW8pO1xyXG4gIH07XHJcblxyXG5cclxuICAvKlxyXG4gICAqIGNvbnRlbnRsb2FkZWQuanNcclxuICAgKlxyXG4gICAqIEF1dGhvcjogRGllZ28gUGVyaW5pIChkaWVnby5wZXJpbmkgYXQgZ21haWwuY29tKVxyXG4gICAqIFN1bW1hcnk6IGNyb3NzLWJyb3dzZXIgd3JhcHBlciBmb3IgRE9NQ29udGVudExvYWRlZFxyXG4gICAqIFVwZGF0ZWQ6IDIwMTAxMDIwXHJcbiAgICogTGljZW5zZTogTUlUXHJcbiAgICogVmVyc2lvbjogMS4yXHJcbiAgICpcclxuICAgKiBVUkw6XHJcbiAgICogaHR0cDovL2phdmFzY3JpcHQubndib3guY29tL0NvbnRlbnRMb2FkZWQvXHJcbiAgICogaHR0cDovL2phdmFzY3JpcHQubndib3guY29tL0NvbnRlbnRMb2FkZWQvTUlULUxJQ0VOU0VcclxuICAgKi9cclxuXHJcbiAgY29udGVudExvYWRlZCA9IGZ1bmN0aW9uKHdpbiwgZm4pIHtcclxuICAgIHZhciBhZGQsIGRvYywgZG9uZSwgaW5pdCwgcG9sbCwgcHJlLCByZW0sIHJvb3QsIHRvcDtcclxuICAgIGRvbmUgPSBmYWxzZTtcclxuICAgIHRvcCA9IHRydWU7XHJcbiAgICBkb2MgPSB3aW4uZG9jdW1lbnQ7XHJcbiAgICByb290ID0gZG9jLmRvY3VtZW50RWxlbWVudDtcclxuICAgIGFkZCA9IChkb2MuYWRkRXZlbnRMaXN0ZW5lciA/IFwiYWRkRXZlbnRMaXN0ZW5lclwiIDogXCJhdHRhY2hFdmVudFwiKTtcclxuICAgIHJlbSA9IChkb2MuYWRkRXZlbnRMaXN0ZW5lciA/IFwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiIDogXCJkZXRhY2hFdmVudFwiKTtcclxuICAgIHByZSA9IChkb2MuYWRkRXZlbnRMaXN0ZW5lciA/IFwiXCIgOiBcIm9uXCIpO1xyXG4gICAgaW5pdCA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgaWYgKGUudHlwZSA9PT0gXCJyZWFkeXN0YXRlY2hhbmdlXCIgJiYgZG9jLnJlYWR5U3RhdGUgIT09IFwiY29tcGxldGVcIikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICAoZS50eXBlID09PSBcImxvYWRcIiA/IHdpbiA6IGRvYylbcmVtXShwcmUgKyBlLnR5cGUsIGluaXQsIGZhbHNlKTtcclxuICAgICAgaWYgKCFkb25lICYmIChkb25lID0gdHJ1ZSkpIHtcclxuICAgICAgICByZXR1cm4gZm4uY2FsbCh3aW4sIGUudHlwZSB8fCBlKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHBvbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGU7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgcm9vdC5kb1Njcm9sbChcImxlZnRcIik7XHJcbiAgICAgIH0gY2F0Y2ggKF9lcnJvcikge1xyXG4gICAgICAgIGUgPSBfZXJyb3I7XHJcbiAgICAgICAgc2V0VGltZW91dChwb2xsLCA1MCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBpbml0KFwicG9sbFwiKTtcclxuICAgIH07XHJcbiAgICBpZiAoZG9jLnJlYWR5U3RhdGUgIT09IFwiY29tcGxldGVcIikge1xyXG4gICAgICBpZiAoZG9jLmNyZWF0ZUV2ZW50T2JqZWN0ICYmIHJvb3QuZG9TY3JvbGwpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdG9wID0gIXdpbi5mcmFtZUVsZW1lbnQ7XHJcbiAgICAgICAgfSBjYXRjaCAoX2Vycm9yKSB7fVxyXG4gICAgICAgIGlmICh0b3ApIHtcclxuICAgICAgICAgIHBvbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZG9jW2FkZF0ocHJlICsgXCJET01Db250ZW50TG9hZGVkXCIsIGluaXQsIGZhbHNlKTtcclxuICAgICAgZG9jW2FkZF0ocHJlICsgXCJyZWFkeXN0YXRlY2hhbmdlXCIsIGluaXQsIGZhbHNlKTtcclxuICAgICAgcmV0dXJuIHdpblthZGRdKHByZSArIFwibG9hZFwiLCBpbml0LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgRHJvcHpvbmUuX2F1dG9EaXNjb3ZlckZ1bmN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoRHJvcHpvbmUuYXV0b0Rpc2NvdmVyKSB7XHJcbiAgICAgIHJldHVybiBEcm9wem9uZS5kaXNjb3ZlcigpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnRlbnRMb2FkZWQod2luZG93LCBEcm9wem9uZS5fYXV0b0Rpc2NvdmVyRnVuY3Rpb24pO1xyXG5cclxufSkuY2FsbCh0aGlzKTtcclxuIl0sImZpbGUiOiJkcm9wem9uZS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

/*
 * jPlayer Plugin for jQuery JavaScript Library
 * http://www.jplayer.org
 *
 * Copyright (c) 2009 - 2014 Happyworm Ltd
 * Licensed under the MIT license.
 * http://opensource.org/licenses/MIT
 *
 * Author: Mark J Panaghiston
 * Version: 2.9.2
 * Date: 14th December 2014
 */

/* Support for Zepto 1.0 compiled with optional data module.
 * For AMD or NODE/CommonJS support, you will need to manually switch the related 2 lines in the code below.
 * Search terms: "jQuery Switch" and "Zepto Switch"
 */

(function (root, factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as an anonymous module.
		define(['jquery'], factory); // jQuery Switch
		// define(['zepto'], factory); // Zepto Switch
	} else if (typeof exports === 'object') {
		// Node/CommonJS
		factory(require('jquery')); // jQuery Switch
		//factory(require('zepto')); // Zepto Switch
	} else {
		// Browser globals
		if(root.jQuery) { // Use jQuery if available
			factory(root.jQuery);
		} else { // Otherwise, use Zepto
			factory(root.Zepto);
		}
	}
}(this, function ($, undefined) {

	// Adapted from jquery.ui.widget.js (1.8.7): $.widget.bridge - Tweaked $.data(this,XYZ) to $(this).data(XYZ) for Zepto
	$.fn.jPlayer = function( options ) {
		var name = "jPlayer";
		var isMethodCall = typeof options === "string",
			args = Array.prototype.slice.call( arguments, 1 ),
			returnValue = this;

		// allow multiple hashes to be passed on init
		options = !isMethodCall && args.length ?
			$.extend.apply( null, [ true, options ].concat(args) ) :
			options;

		// prevent calls to internal methods
		if ( isMethodCall && options.charAt( 0 ) === "_" ) {
			return returnValue;
		}

		if ( isMethodCall ) {
			this.each(function() {
				var instance = $(this).data( name ),
					methodValue = instance && $.isFunction( instance[options] ) ?
						instance[ options ].apply( instance, args ) :
						instance;
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue;
					return false;
				}
			});
		} else {
			this.each(function() {
				var instance = $(this).data( name );
				if ( instance ) {
					// instance.option( options || {} )._init(); // Orig jquery.ui.widget.js code: Not recommend for jPlayer. ie., Applying new options to an existing instance (via the jPlayer constructor) and performing the _init(). The _init() is what concerns me. It would leave a lot of event handlers acting on jPlayer instance and the interface.
					instance.option( options || {} ); // The new constructor only changes the options. Changing options only has basic support atm.
				} else {
					$(this).data( name, new $.jPlayer( options, this ) );
				}
			});
		}

		return returnValue;
	};

	$.jPlayer = function( options, element ) {
		// allow instantiation without initializing for simple inheritance
		if ( arguments.length ) {
			this.element = $(element);
			this.options = $.extend(true, {},
				this.options,
				options
			);
			var self = this;
			this.element.bind( "remove.jPlayer", function() {
				self.destroy();
			});
			this._init();
		}
	};
	// End of: (Adapted from jquery.ui.widget.js (1.8.7))

	// Zepto is missing one of the animation methods.
	if(typeof $.fn.stop !== 'function') {
		$.fn.stop = function() {};
	}

	// Emulated HTML5 methods and properties
	$.jPlayer.emulateMethods = "load play pause";
	$.jPlayer.emulateStatus = "src readyState networkState currentTime duration paused ended playbackRate";
	$.jPlayer.emulateOptions = "muted volume";

	// Reserved event names generated by jPlayer that are not part of the HTML5 Media element spec
	$.jPlayer.reservedEvent = "ready flashreset resize repeat error warning";

	// Events generated by jPlayer
	$.jPlayer.event = {};
	$.each(
		[
			'ready',
			'setmedia', // Fires when the media is set
			'flashreset', // Similar to the ready event if the Flash solution is set to display:none and then shown again or if it's reloaded for another reason by the browser. For example, using CSS position:fixed on Firefox for the full screen feature.
			'resize', // Occurs when the size changes through a full/restore screen operation or if the size/sizeFull options are changed.
			'repeat', // Occurs when the repeat status changes. Usually through clicks on the repeat button of the interface.
			'click', // Occurs when the user clicks on one of the following: poster image, html video, flash video.
			'error', // Event error code in event.jPlayer.error.type. See $.jPlayer.error
			'warning', // Event warning code in event.jPlayer.warning.type. See $.jPlayer.warning

			// Other events match HTML5 spec.
			'loadstart',
			'progress',
			'suspend',
			'abort',
			'emptied',
			'stalled',
			'play',
			'pause',
			'loadedmetadata',
			'loadeddata',
			'waiting',
			'playing',
			'canplay',
			'canplaythrough',
			'seeking',
			'seeked',
			'timeupdate',
			'ended',
			'ratechange',
			'durationchange',
			'volumechange'
		],
		function() {
			$.jPlayer.event[ this ] = 'jPlayer_' + this;
		}
	);

	$.jPlayer.htmlEvent = [ // These HTML events are bubbled through to the jPlayer event, without any internal action.
		"loadstart",
		// "progress", // jPlayer uses internally before bubbling.
		// "suspend", // jPlayer uses internally before bubbling.
		"abort",
		// "error", // jPlayer uses internally before bubbling.
		"emptied",
		"stalled",
		// "play", // jPlayer uses internally before bubbling.
		// "pause", // jPlayer uses internally before bubbling.
		"loadedmetadata",
		// "loadeddata", // jPlayer uses internally before bubbling.
		// "waiting", // jPlayer uses internally before bubbling.
		// "playing", // jPlayer uses internally before bubbling.
		"canplay",
		"canplaythrough"
		// "seeking", // jPlayer uses internally before bubbling.
		// "seeked", // jPlayer uses internally before bubbling.
		// "timeupdate", // jPlayer uses internally before bubbling.
		// "ended", // jPlayer uses internally before bubbling.
		// "ratechange" // jPlayer uses internally before bubbling.
		// "durationchange" // jPlayer uses internally before bubbling.
		// "volumechange" // jPlayer uses internally before bubbling.
	];

	$.jPlayer.pause = function() {
		$.jPlayer.prototype.destroyRemoved();
		$.each($.jPlayer.prototype.instances, function(i, element) {
			if(element.data("jPlayer").status.srcSet) { // Check that media is set otherwise would cause error event.
				element.jPlayer("pause");
			}
		});
	};

	// Default for jPlayer option.timeFormat
	$.jPlayer.timeFormat = {
		showHour: false,
		showMin: true,
		showSec: true,
		padHour: false,
		padMin: true,
		padSec: true,
		sepHour: ":",
		sepMin: ":",
		sepSec: ""
	};
	var ConvertTime = function() {
		this.init();
	};
	ConvertTime.prototype = {
		init: function() {
			this.options = {
				timeFormat: $.jPlayer.timeFormat
			};
		},
		time: function(s) { // function used on jPlayer.prototype._convertTime to enable per instance options.
			s = (s && typeof s === 'number') ? s : 0;

			var myTime = new Date(s * 1000),
				hour = myTime.getUTCHours(),
				min = this.options.timeFormat.showHour ? myTime.getUTCMinutes() : myTime.getUTCMinutes() + hour * 60,
				sec = this.options.timeFormat.showMin ? myTime.getUTCSeconds() : myTime.getUTCSeconds() + min * 60,
				strHour = (this.options.timeFormat.padHour && hour < 10) ? "0" + hour : hour,
				strMin = (this.options.timeFormat.padMin && min < 10) ? "0" + min : min,
				strSec = (this.options.timeFormat.padSec && sec < 10) ? "0" + sec : sec,
				strTime = "";

			strTime += this.options.timeFormat.showHour ? strHour + this.options.timeFormat.sepHour : "";
			strTime += this.options.timeFormat.showMin ? strMin + this.options.timeFormat.sepMin : "";
			strTime += this.options.timeFormat.showSec ? strSec + this.options.timeFormat.sepSec : "";

			return strTime;
		}
	};
	var myConvertTime = new ConvertTime();
	$.jPlayer.convertTime = function(s) {
		return myConvertTime.time(s);
	};

	// Adapting jQuery 1.4.4 code for jQuery.browser. Required since jQuery 1.3.2 does not detect Chrome as webkit.
	$.jPlayer.uaBrowser = function( userAgent ) {
		var ua = userAgent.toLowerCase();

		// Useragent RegExp
		var rwebkit = /(webkit)[ \/]([\w.]+)/;
		var ropera = /(opera)(?:.*version)?[ \/]([\w.]+)/;
		var rmsie = /(msie) ([\w.]+)/;
		var rmozilla = /(mozilla)(?:.*? rv:([\w.]+))?/;

		var match = rwebkit.exec( ua ) ||
			ropera.exec( ua ) ||
			rmsie.exec( ua ) ||
			ua.indexOf("compatible") < 0 && rmozilla.exec( ua ) ||
			[];

		return { browser: match[1] || "", version: match[2] || "0" };
	};

	// Platform sniffer for detecting mobile devices
	$.jPlayer.uaPlatform = function( userAgent ) {
		var ua = userAgent.toLowerCase();

		// Useragent RegExp
		var rplatform = /(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/;
		var rtablet = /(ipad|playbook)/;
		var randroid = /(android)/;
		var rmobile = /(mobile)/;

		var platform = rplatform.exec( ua ) || [];
		var tablet = rtablet.exec( ua ) ||
			!rmobile.exec( ua ) && randroid.exec( ua ) ||
			[];

		if(platform[1]) {
			platform[1] = platform[1].replace(/\s/g, "_"); // Change whitespace to underscore. Enables dot notation.
		}

		return { platform: platform[1] || "", tablet: tablet[1] || "" };
	};

	$.jPlayer.browser = {
	};
	$.jPlayer.platform = {
	};

	var browserMatch = $.jPlayer.uaBrowser(navigator.userAgent);
	if ( browserMatch.browser ) {
		$.jPlayer.browser[ browserMatch.browser ] = true;
		$.jPlayer.browser.version = browserMatch.version;
	}
	var platformMatch = $.jPlayer.uaPlatform(navigator.userAgent);
	if ( platformMatch.platform ) {
		$.jPlayer.platform[ platformMatch.platform ] = true;
		$.jPlayer.platform.mobile = !platformMatch.tablet;
		$.jPlayer.platform.tablet = !!platformMatch.tablet;
	}

	// Internet Explorer (IE) Browser Document Mode Sniffer. Based on code at:
	// http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx#GetMode
	$.jPlayer.getDocMode = function() {
		var docMode;
		if ($.jPlayer.browser.msie) {
			if (document.documentMode) { // IE8 or later
				docMode = document.documentMode;
			} else { // IE 5-7
				docMode = 5; // Assume quirks mode unless proven otherwise
				if (document.compatMode) {
					if (document.compatMode === "CSS1Compat") {
						docMode = 7; // standards mode
					}
				}
			}
		}
		return docMode;
	};
	$.jPlayer.browser.documentMode = $.jPlayer.getDocMode();

	$.jPlayer.nativeFeatures = {
		init: function() {

			/* Fullscreen function naming influenced by W3C naming.
			 * No support for: Mozilla Proposal: https://wiki.mozilla.org/Gecko:FullScreenAPI
			 */

			var d = document,
				v = d.createElement('video'),
				spec = {
					// http://www.w3.org/TR/fullscreen/
					w3c: [
						'fullscreenEnabled',
						'fullscreenElement',
						'requestFullscreen',
						'exitFullscreen',
						'fullscreenchange',
						'fullscreenerror'
					],
					// https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode
					moz: [
						'mozFullScreenEnabled',
						'mozFullScreenElement',
						'mozRequestFullScreen',
						'mozCancelFullScreen',
						'mozfullscreenchange',
						'mozfullscreenerror'
					],
					// http://developer.apple.com/library/safari/#documentation/WebKit/Reference/ElementClassRef/Element/Element.html
					// http://developer.apple.com/library/safari/#documentation/UserExperience/Reference/DocumentAdditionsReference/DocumentAdditions/DocumentAdditions.html
					webkit: [
						'',
						'webkitCurrentFullScreenElement',
						'webkitRequestFullScreen',
						'webkitCancelFullScreen',
						'webkitfullscreenchange',
						''
					],
					// http://developer.apple.com/library/safari/#documentation/AudioVideo/Reference/HTMLVideoElementClassReference/HTMLVideoElement/HTMLVideoElement.html
					// https://developer.apple.com/library/safari/samplecode/HTML5VideoEventFlow/Listings/events_js.html#//apple_ref/doc/uid/DTS40010085-events_js-DontLinkElementID_5
					// Events: 'webkitbeginfullscreen' and 'webkitendfullscreen'
					webkitVideo: [
						'webkitSupportsFullscreen',
						'webkitDisplayingFullscreen',
						'webkitEnterFullscreen',
						'webkitExitFullscreen',
						'',
						''
					],
					ms: [
						'',
						'msFullscreenElement',
						'msRequestFullscreen',
						'msExitFullscreen',
						'MSFullscreenChange',
						'MSFullscreenError'
					]
				},
				specOrder = [
					'w3c',
					'moz',
					'webkit',
					'webkitVideo',
					'ms'
				],
				fs, i, il;

			this.fullscreen = fs = {
				support: {
					w3c: !!d[spec.w3c[0]],
					moz: !!d[spec.moz[0]],
					webkit: typeof d[spec.webkit[3]] === 'function',
					webkitVideo: typeof v[spec.webkitVideo[2]] === 'function',
					ms: typeof v[spec.ms[2]] === 'function'
				},
				used: {}
			};

			// Store the name of the spec being used and as a handy boolean.
			for(i = 0, il = specOrder.length; i < il; i++) {
				var n = specOrder[i];
				if(fs.support[n]) {
					fs.spec = n;
					fs.used[n] = true;
					break;
				}
			}

			if(fs.spec) {
				var s = spec[fs.spec];
				fs.api = {
					fullscreenEnabled: true,
					fullscreenElement: function(elem) {
						elem = elem ? elem : d; // Video element required for webkitVideo
						return elem[s[1]];
					},
					requestFullscreen: function(elem) {
						return elem[s[2]](); // Chrome and Opera want parameter (Element.ALLOW_KEYBOARD_INPUT) but Safari fails if flag used.
					},
					exitFullscreen: function(elem) {
						elem = elem ? elem : d; // Video element required for webkitVideo
						return elem[s[3]]();
					}
				};
				fs.event = {
					fullscreenchange: s[4],
					fullscreenerror: s[5]
				};
			} else {
				fs.api = {
					fullscreenEnabled: false,
					fullscreenElement: function() {
						return null;
					},
					requestFullscreen: function() {},
					exitFullscreen: function() {}
				};
				fs.event = {};
			}
		}
	};
	$.jPlayer.nativeFeatures.init();

	// The keyboard control system.

	// The current jPlayer instance in focus.
	$.jPlayer.focus = null;

	// The list of element node names to ignore with key controls.
	$.jPlayer.keyIgnoreElementNames = "A INPUT TEXTAREA SELECT BUTTON";

	// The function that deals with key presses.
	var keyBindings = function(event) {
		var f = $.jPlayer.focus,
			ignoreKey;

		// A jPlayer instance must be in focus. ie., keyEnabled and the last one played.
		if(f) {
			// What generated the key press?
			$.each( $.jPlayer.keyIgnoreElementNames.split(/\s+/g), function(i, name) {
				// The strings should already be uppercase.
				if(event.target.nodeName.toUpperCase() === name.toUpperCase()) {
					ignoreKey = true;
					return false; // exit each.
				}
			});
			if(!ignoreKey) {
				// See if the key pressed matches any of the bindings.
				$.each(f.options.keyBindings, function(action, binding) {
					// The binding could be a null when the default has been disabled. ie., 1st clause in if()
					if(
						(binding && $.isFunction(binding.fn)) &&
						((typeof binding.key === 'number' && event.which === binding.key) ||
						(typeof binding.key === 'string' && event.key === binding.key))
					) {
						event.preventDefault(); // Key being used by jPlayer, so prevent default operation.
						binding.fn(f);
						return false; // exit each.
					}
				});
			}
		}
	};

	$.jPlayer.keys = function(en) {
		var event = "keydown.jPlayer";
		// Remove any binding, just in case enabled more than once.
		$(document.documentElement).unbind(event);
		if(en) {
			$(document.documentElement).bind(event, keyBindings);
		}
	};

	// Enable the global key control handler ready for any jPlayer instance with the keyEnabled option enabled.
	$.jPlayer.keys(true);

	$.jPlayer.prototype = {
		count: 0, // Static Variable: Change it via prototype.
		version: { // Static Object
			script: "2.9.2",
			needFlash: "2.9.0",
			flash: "unknown"
		},
		options: { // Instanced in $.jPlayer() constructor
			swfPath: "js", // Path to jquery.jplayer.swf. Can be relative, absolute or server root relative.
			solution: "html, flash", // Valid solutions: html, flash, aurora. Order defines priority. 1st is highest,
			supplied: "mp3", // Defines which formats jPlayer will try and support and the priority by the order. 1st is highest,
			auroraFormats: "wav", // List the aurora.js codecs being loaded externally. Its core supports "wav". Specify format in jPlayer context. EG., The aac.js codec gives the "m4a" format.
			preload: 'metadata',  // HTML5 Spec values: none, metadata, auto.
			volume: 0.8, // The volume. Number 0 to 1.
			muted: false,
			remainingDuration: false, // When true, the remaining time is shown in the duration GUI element.
			toggleDuration: false, // When true, clicks on the duration toggle between the duration and remaining display.
			captureDuration: true, // When true, clicks on the duration are captured and no longer propagate up the DOM.
			playbackRate: 1,
			defaultPlaybackRate: 1,
			minPlaybackRate: 0.5,
			maxPlaybackRate: 4,
			wmode: "opaque", // Valid wmode: window, transparent, opaque, direct, gpu. 
			backgroundColor: "#000000", // To define the jPlayer div and Flash background color.
			cssSelectorAncestor: "#jp_container_1",
			cssSelector: { // * denotes properties that should only be required when video media type required. _cssSelector() would require changes to enable splitting these into Audio and Video defaults.
				videoPlay: ".jp-video-play", // *
				play: ".jp-play",
				pause: ".jp-pause",
				stop: ".jp-stop",
				seekBar: ".jp-seek-bar",
				playBar: ".jp-play-bar",
				mute: ".jp-mute",
				unmute: ".jp-unmute",
				volumeBar: ".jp-volume-bar",
				volumeBarValue: ".jp-volume-bar-value",
				volumeMax: ".jp-volume-max",
				playbackRateBar: ".jp-playback-rate-bar",
				playbackRateBarValue: ".jp-playback-rate-bar-value",
				currentTime: ".jp-current-time",
				duration: ".jp-duration",
				title: ".jp-title",
				fullScreen: ".jp-full-screen", // *
				restoreScreen: ".jp-restore-screen", // *
				repeat: ".jp-repeat",
				repeatOff: ".jp-repeat-off",
				gui: ".jp-gui", // The interface used with autohide feature.
				noSolution: ".jp-no-solution" // For error feedback when jPlayer cannot find a solution.
			},
			stateClass: { // Classes added to the cssSelectorAncestor to indicate the state.
				playing: "jp-state-playing",
				seeking: "jp-state-seeking",
				muted: "jp-state-muted",
				looped: "jp-state-looped",
				fullScreen: "jp-state-full-screen",
				noVolume: "jp-state-no-volume"
			},
			useStateClassSkin: false, // A state class skin relies on the state classes to change the visual appearance. The single control toggles the effect, for example: play then pause, mute then unmute.
			autoBlur: true, // GUI control handlers will drop focus after clicks.
			smoothPlayBar: false, // Smooths the play bar transitions, which affects clicks and short media with big changes per second.
			fullScreen: false, // Native Full Screen
			fullWindow: false,
			autohide: {
				restored: false, // Controls the interface autohide feature.
				full: true, // Controls the interface autohide feature.
				fadeIn: 200, // Milliseconds. The period of the fadeIn anim.
				fadeOut: 600, // Milliseconds. The period of the fadeOut anim.
				hold: 1000 // Milliseconds. The period of the pause before autohide beings.
			},
			loop: false,
			repeat: function(event) { // The default jPlayer repeat event handler
				if(event.jPlayer.options.loop) {
					$(this).unbind(".jPlayerRepeat").bind($.jPlayer.event.ended + ".jPlayer.jPlayerRepeat", function() {
						$(this).jPlayer("play");
					});
				} else {
					$(this).unbind(".jPlayerRepeat");
				}
			},
			nativeVideoControls: {
				// Works well on standard browsers.
				// Phone and tablet browsers can have problems with the controls disappearing.
			},
			noFullWindow: {
				msie: /msie [0-6]\./,
				ipad: /ipad.*?os [0-4]\./,
				iphone: /iphone/,
				ipod: /ipod/,
				android_pad: /android [0-3]\.(?!.*?mobile)/,
				android_phone: /(?=.*android)(?!.*chrome)(?=.*mobile)/,
				blackberry: /blackberry/,
				windows_ce: /windows ce/,
				iemobile: /iemobile/,
				webos: /webos/
			},
			noVolume: {
				ipad: /ipad/,
				iphone: /iphone/,
				ipod: /ipod/,
				android_pad: /android(?!.*?mobile)/,
				android_phone: /android.*?mobile/,
				blackberry: /blackberry/,
				windows_ce: /windows ce/,
				iemobile: /iemobile/,
				webos: /webos/,
				playbook: /playbook/
			},
			timeFormat: {
				// Specific time format for this instance. The supported options are defined in $.jPlayer.timeFormat
				// For the undefined options we use the default from $.jPlayer.timeFormat
			},
			keyEnabled: false, // Enables keyboard controls.
			audioFullScreen: false, // Enables keyboard controls to enter full screen with audio media.
			keyBindings: { // The key control object, defining the key codes and the functions to execute.
				// The parameter, f = $.jPlayer.focus, will be checked truethy before attempting to call any of these functions.
				// Properties may be added to this object, in key/fn pairs, to enable other key controls. EG, for the playlist add-on.
				play: {
					key: 80, // p
					fn: function(f) {
						if(f.status.paused) {
							f.play();
						} else {
							f.pause();
						}
					}
				},
				fullScreen: {
					key: 70, // f
					fn: function(f) {
						if(f.status.video || f.options.audioFullScreen) {
							f._setOption("fullScreen", !f.options.fullScreen);
						}
					}
				},
				muted: {
					key: 77, // m
					fn: function(f) {
						f._muted(!f.options.muted);
					}
				},
				volumeUp: {
					key: 190, // .
					fn: function(f) {
						f.volume(f.options.volume + 0.1);
					}
				},
				volumeDown: {
					key: 188, // ,
					fn: function(f) {
						f.volume(f.options.volume - 0.1);
					}
				},
				loop: {
					key: 76, // l
					fn: function(f) {
						f._loop(!f.options.loop);
					}
				}
			},
			verticalVolume: false, // Calculate volume from the bottom of the volume bar. Default is from the left. Also volume affects either width or height.
			verticalPlaybackRate: false,
			globalVolume: false, // Set to make volume and muted changes affect all jPlayer instances with this option enabled
			idPrefix: "jp", // Prefix for the ids of html elements created by jPlayer. For flash, this must not include characters: . - + * / \
			noConflict: "jQuery",
			emulateHtml: false, // Emulates the HTML5 Media element on the jPlayer element.
			consoleAlerts: true, // Alerts are sent to the console.log() instead of alert().
			errorAlerts: false,
			warningAlerts: false
		},
		optionsAudio: {
			size: {
				width: "0px",
				height: "0px",
				cssClass: ""
			},
			sizeFull: {
				width: "0px",
				height: "0px",
				cssClass: ""
			}
		},
		optionsVideo: {
			size: {
				width: "480px",
				height: "270px",
				cssClass: "jp-video-270p"
			},
			sizeFull: {
				width: "100%",
				height: "100%",
				cssClass: "jp-video-full"
			}
		},
		instances: {}, // Static Object
		status: { // Instanced in _init()
			src: "",
			media: {},
			paused: true,
			format: {},
			formatType: "",
			waitForPlay: true, // Same as waitForLoad except in case where preloading.
			waitForLoad: true,
			srcSet: false,
			video: false, // True if playing a video
			seekPercent: 0,
			currentPercentRelative: 0,
			currentPercentAbsolute: 0,
			currentTime: 0,
			duration: 0,
			remaining: 0,
			videoWidth: 0, // Intrinsic width of the video in pixels.
			videoHeight: 0, // Intrinsic height of the video in pixels.
			readyState: 0,
			networkState: 0,
			playbackRate: 1, // Warning - Now both an option and a status property
			ended: 0

/*		Persistant status properties created dynamically at _init():
			width
			height
			cssClass
			nativeVideoControls
			noFullWindow
			noVolume
			playbackRateEnabled // Warning - Technically, we can have both Flash and HTML, so this might not be correct if the Flash is active. That is a niche case.
*/
		},

		internal: { // Instanced in _init()
			ready: false
			// instance: undefined
			// domNode: undefined
			// htmlDlyCmdId: undefined
			// autohideId: undefined
			// mouse: undefined
			// cmdsIgnored
		},
		solution: { // Static Object: Defines the solutions built in jPlayer.
			html: true,
			aurora: true,
			flash: true
		},
		// 'MPEG-4 support' : canPlayType('video/mp4; codecs="mp4v.20.8"')
		format: { // Static Object
			mp3: {
				codec: 'audio/mpeg',
				flashCanPlay: true,
				media: 'audio'
			},
			m4a: { // AAC / MP4
				codec: 'audio/mp4; codecs="mp4a.40.2"',
				flashCanPlay: true,
				media: 'audio'
			},
			m3u8a: { // AAC / MP4 / Apple HLS
				codec: 'application/vnd.apple.mpegurl; codecs="mp4a.40.2"',
				flashCanPlay: false,
				media: 'audio'
			},
			m3ua: { // M3U
				codec: 'audio/mpegurl',
				flashCanPlay: false,
				media: 'audio'
			},
			oga: { // OGG
				codec: 'audio/ogg; codecs="vorbis, opus"',
				flashCanPlay: false,
				media: 'audio'
			},
			flac: { // FLAC
				codec: 'audio/x-flac',
				flashCanPlay: false,
				media: 'audio'
			},
			wav: { // PCM
				codec: 'audio/wav; codecs="1"',
				flashCanPlay: false,
				media: 'audio'
			},
			webma: { // WEBM
				codec: 'audio/webm; codecs="vorbis"',
				flashCanPlay: false,
				media: 'audio'
			},
			fla: { // FLV / F4A
				codec: 'audio/x-flv',
				flashCanPlay: true,
				media: 'audio'
			},
			rtmpa: { // RTMP AUDIO
				codec: 'audio/rtmp; codecs="rtmp"',
				flashCanPlay: true,
				media: 'audio'
			},
			m4v: { // H.264 / MP4
				codec: 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',
				flashCanPlay: true,
				media: 'video'
			},
			m3u8v: { // H.264 / AAC / MP4 / Apple HLS
				codec: 'application/vnd.apple.mpegurl; codecs="avc1.42E01E, mp4a.40.2"',
				flashCanPlay: false,
				media: 'video'
			},
			m3uv: { // M3U
				codec: 'audio/mpegurl',
				flashCanPlay: false,
				media: 'video'
			},
			ogv: { // OGG
				codec: 'video/ogg; codecs="theora, vorbis"',
				flashCanPlay: false,
				media: 'video'
			},
			webmv: { // WEBM
				codec: 'video/webm; codecs="vorbis, vp8"',
				flashCanPlay: false,
				media: 'video'
			},
			flv: { // FLV / F4V
				codec: 'video/x-flv',
				flashCanPlay: true,
				media: 'video'
			},
			rtmpv: { // RTMP VIDEO
				codec: 'video/rtmp; codecs="rtmp"',
				flashCanPlay: true,
				media: 'video'
			}
		},
		_init: function() {
			var self = this;
			
			this.element.empty();
			
			this.status = $.extend({}, this.status); // Copy static to unique instance.
			this.internal = $.extend({}, this.internal); // Copy static to unique instance.

			// Initialize the time format
			this.options.timeFormat = $.extend({}, $.jPlayer.timeFormat, this.options.timeFormat);

			// On iOS, assume commands will be ignored before user initiates them.
			this.internal.cmdsIgnored = $.jPlayer.platform.ipad || $.jPlayer.platform.iphone || $.jPlayer.platform.ipod;

			this.internal.domNode = this.element.get(0);

			// Add key bindings focus to 1st jPlayer instanced with key control enabled.
			if(this.options.keyEnabled && !$.jPlayer.focus) {
				$.jPlayer.focus = this;
			}

			// A fix for Android where older (2.3) and even some 4.x devices fail to work when changing the *audio* SRC and then playing immediately.
			this.androidFix = {
				setMedia: false, // True when media set
				play: false, // True when a progress event will instruct the media to play
				pause: false, // True when a progress event will instruct the media to pause at a time.
				time: NaN // The play(time) parameter
			};
			if($.jPlayer.platform.android) {
				this.options.preload = this.options.preload !== 'auto' ? 'metadata' : 'auto'; // Default to metadata, but allow auto.
			}

			this.formats = []; // Array based on supplied string option. Order defines priority.
			this.solutions = []; // Array based on solution string option. Order defines priority.
			this.require = {}; // Which media types are required: video, audio.
			
			this.htmlElement = {}; // DOM elements created by jPlayer
			this.html = {}; // In _init()'s this.desired code and setmedia(): Accessed via this[solution], where solution from this.solutions array.
			this.html.audio = {};
			this.html.video = {};
			this.aurora = {}; // In _init()'s this.desired code and setmedia(): Accessed via this[solution], where solution from this.solutions array.
			this.aurora.formats = [];
			this.aurora.properties = [];
			this.flash = {}; // In _init()'s this.desired code and setmedia(): Accessed via this[solution], where solution from this.solutions array.
			
			this.css = {};
			this.css.cs = {}; // Holds the css selector strings
			this.css.jq = {}; // Holds jQuery selectors. ie., $(css.cs.method)

			this.ancestorJq = []; // Holds jQuery selector of cssSelectorAncestor. Init would use $() instead of [], but it is only 1.4+

			this.options.volume = this._limitValue(this.options.volume, 0, 1); // Limit volume value's bounds.

			// Create the formats array, with prority based on the order of the supplied formats string
			$.each(this.options.supplied.toLowerCase().split(","), function(index1, value1) {
				var format = value1.replace(/^\s+|\s+$/g, ""); //trim
				if(self.format[format]) { // Check format is valid.
					var dupFound = false;
					$.each(self.formats, function(index2, value2) { // Check for duplicates
						if(format === value2) {
							dupFound = true;
							return false;
						}
					});
					if(!dupFound) {
						self.formats.push(format);
					}
				}
			});

			// Create the solutions array, with prority based on the order of the solution string
			$.each(this.options.solution.toLowerCase().split(","), function(index1, value1) {
				var solution = value1.replace(/^\s+|\s+$/g, ""); //trim
				if(self.solution[solution]) { // Check solution is valid.
					var dupFound = false;
					$.each(self.solutions, function(index2, value2) { // Check for duplicates
						if(solution === value2) {
							dupFound = true;
							return false;
						}
					});
					if(!dupFound) {
						self.solutions.push(solution);
					}
				}
			});
				
			// Create Aurora.js formats array
			$.each(this.options.auroraFormats.toLowerCase().split(","), function(index1, value1) {
				var format = value1.replace(/^\s+|\s+$/g, ""); //trim
				if(self.format[format]) { // Check format is valid.
					var dupFound = false;
					$.each(self.aurora.formats, function(index2, value2) { // Check for duplicates
						if(format === value2) {
							dupFound = true;
							return false;
						}
					});
					if(!dupFound) {
						self.aurora.formats.push(format);
					}
				}
			});

			this.internal.instance = "jp_" + this.count;
			this.instances[this.internal.instance] = this.element;

			// Check the jPlayer div has an id and create one if required. Important for Flash to know the unique id for comms.
			if(!this.element.attr("id")) {
				this.element.attr("id", this.options.idPrefix + "_jplayer_" + this.count);
			}

			this.internal.self = $.extend({}, {
				id: this.element.attr("id"),
				jq: this.element
			});
			this.internal.audio = $.extend({}, {
				id: this.options.idPrefix + "_audio_" + this.count,
				jq: undefined
			});
			this.internal.video = $.extend({}, {
				id: this.options.idPrefix + "_video_" + this.count,
				jq: undefined
			});
			this.internal.flash = $.extend({}, {
				id: this.options.idPrefix + "_flash_" + this.count,
				jq: undefined,
				swf: this.options.swfPath + (this.options.swfPath.toLowerCase().slice(-4) !== ".swf" ? (this.options.swfPath && this.options.swfPath.slice(-1) !== "/" ? "/" : "") + "jquery.jplayer.swf" : "")
			});
			this.internal.poster = $.extend({}, {
				id: this.options.idPrefix + "_poster_" + this.count,
				jq: undefined
			});

			// Register listeners defined in the constructor
			$.each($.jPlayer.event, function(eventName,eventType) {
				if(self.options[eventName] !== undefined) {
					self.element.bind(eventType + ".jPlayer", self.options[eventName]); // With .jPlayer namespace.
					self.options[eventName] = undefined; // Destroy the handler pointer copy on the options. Reason, events can be added/removed in other ways so this could be obsolete and misleading.
				}
			});

			// Determine if we require solutions for audio, video or both media types.
			this.require.audio = false;
			this.require.video = false;
			$.each(this.formats, function(priority, format) {
				self.require[self.format[format].media] = true;
			});

			// Now required types are known, finish the options default settings.
			if(this.require.video) {
				this.options = $.extend(true, {},
					this.optionsVideo,
					this.options
				);
			} else {
				this.options = $.extend(true, {},
					this.optionsAudio,
					this.options
				);
			}
			this._setSize(); // update status and jPlayer element size

			// Determine the status for Blocklisted options.
			this.status.nativeVideoControls = this._uaBlocklist(this.options.nativeVideoControls);
			this.status.noFullWindow = this._uaBlocklist(this.options.noFullWindow);
			this.status.noVolume = this._uaBlocklist(this.options.noVolume);

			// Create event handlers if native fullscreen is supported
			if($.jPlayer.nativeFeatures.fullscreen.api.fullscreenEnabled) {
				this._fullscreenAddEventListeners();
			}

			// The native controls are only for video and are disabled when audio is also used.
			this._restrictNativeVideoControls();

			// Create the poster image.
			this.htmlElement.poster = document.createElement('img');
			this.htmlElement.poster.id = this.internal.poster.id;
			this.htmlElement.poster.onload = function() { // Note that this did not work on Firefox 3.6: poster.addEventListener("onload", function() {}, false); Did not investigate x-browser.
				if(!self.status.video || self.status.waitForPlay) {
					self.internal.poster.jq.show();
				}
			};
			this.element.append(this.htmlElement.poster);
			this.internal.poster.jq = $("#" + this.internal.poster.id);
			this.internal.poster.jq.css({'width': this.status.width, 'height': this.status.height});
			this.internal.poster.jq.hide();
			this.internal.poster.jq.bind("click.jPlayer", function() {
				self._trigger($.jPlayer.event.click);
			});
			
			// Generate the required media elements
			this.html.audio.available = false;
			if(this.require.audio) { // If a supplied format is audio
				this.htmlElement.audio = document.createElement('audio');
				this.htmlElement.audio.id = this.internal.audio.id;
				this.html.audio.available = !!this.htmlElement.audio.canPlayType && this._testCanPlayType(this.htmlElement.audio); // Test is for IE9 on Win Server 2008.
			}
			this.html.video.available = false;
			if(this.require.video) { // If a supplied format is video
				this.htmlElement.video = document.createElement('video');
				this.htmlElement.video.id = this.internal.video.id;
				this.html.video.available = !!this.htmlElement.video.canPlayType && this._testCanPlayType(this.htmlElement.video); // Test is for IE9 on Win Server 2008.
			}

			this.flash.available = this._checkForFlash(10.1);

			this.html.canPlay = {};
			this.aurora.canPlay = {};
			this.flash.canPlay = {};
			$.each(this.formats, function(priority, format) {
				self.html.canPlay[format] = self.html[self.format[format].media].available && "" !== self.htmlElement[self.format[format].media].canPlayType(self.format[format].codec);
				self.aurora.canPlay[format] = ($.inArray(format, self.aurora.formats) > -1);
				self.flash.canPlay[format] = self.format[format].flashCanPlay && self.flash.available;
			});
			this.html.desired = false;
			this.aurora.desired = false;
			this.flash.desired = false;
			$.each(this.solutions, function(solutionPriority, solution) {
				if(solutionPriority === 0) {
					self[solution].desired = true;
				} else {
					var audioCanPlay = false;
					var videoCanPlay = false;
					$.each(self.formats, function(formatPriority, format) {
						if(self[self.solutions[0]].canPlay[format]) { // The other solution can play
							if(self.format[format].media === 'video') {
								videoCanPlay = true;
							} else {
								audioCanPlay = true;
							}
						}
					});
					self[solution].desired = (self.require.audio && !audioCanPlay) || (self.require.video && !videoCanPlay);
				}
			});
			// This is what jPlayer will support, based on solution and supplied.
			this.html.support = {};
			this.aurora.support = {};
			this.flash.support = {};
			$.each(this.formats, function(priority, format) {
				self.html.support[format] = self.html.canPlay[format] && self.html.desired;
				self.aurora.support[format] = self.aurora.canPlay[format] && self.aurora.desired;
				self.flash.support[format] = self.flash.canPlay[format] && self.flash.desired;
			});
			// If jPlayer is supporting any format in a solution, then the solution is used.
			this.html.used = false;
			this.aurora.used = false;
			this.flash.used = false;
			$.each(this.solutions, function(solutionPriority, solution) {
				$.each(self.formats, function(formatPriority, format) {
					if(self[solution].support[format]) {
						self[solution].used = true;
						return false;
					}
				});
			});

			// Init solution active state and the event gates to false.
			this._resetActive();
			this._resetGate();

			// Set up the css selectors for the control and feedback entities.
			this._cssSelectorAncestor(this.options.cssSelectorAncestor);
			
			// If neither html nor aurora nor flash are being used by this browser, then media playback is not possible. Trigger an error event.
			if(!(this.html.used || this.aurora.used || this.flash.used)) {
				this._error( {
					type: $.jPlayer.error.NO_SOLUTION, 
					context: "{solution:'" + this.options.solution + "', supplied:'" + this.options.supplied + "'}",
					message: $.jPlayer.errorMsg.NO_SOLUTION,
					hint: $.jPlayer.errorHint.NO_SOLUTION
				});
				if(this.css.jq.noSolution.length) {
					this.css.jq.noSolution.show();
				}
			} else {
				if(this.css.jq.noSolution.length) {
					this.css.jq.noSolution.hide();
				}
			}

			// Add the flash solution if it is being used.
			if(this.flash.used) {
				var htmlObj,
				flashVars = 'jQuery=' + encodeURI(this.options.noConflict) + '&id=' + encodeURI(this.internal.self.id) + '&vol=' + this.options.volume + '&muted=' + this.options.muted;

				// Code influenced by SWFObject 2.2: http://code.google.com/p/swfobject/
				// Non IE browsers have an initial Flash size of 1 by 1 otherwise the wmode affected the Flash ready event. 

				if($.jPlayer.browser.msie && (Number($.jPlayer.browser.version) < 9 || $.jPlayer.browser.documentMode < 9)) {
					var objStr = '<object id="' + this.internal.flash.id + '" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0" tabindex="-1"></object>';

					var paramStr = [
						'<param name="movie" value="' + this.internal.flash.swf + '" />',
						'<param name="FlashVars" value="' + flashVars + '" />',
						'<param name="allowScriptAccess" value="always" />',
						'<param name="bgcolor" value="' + this.options.backgroundColor + '" />',
						'<param name="wmode" value="' + this.options.wmode + '" />'
					];

					htmlObj = document.createElement(objStr);
					for(var i=0; i < paramStr.length; i++) {
						htmlObj.appendChild(document.createElement(paramStr[i]));
					}
				} else {
					var createParam = function(el, n, v) {
						var p = document.createElement("param");
						p.setAttribute("name", n);	
						p.setAttribute("value", v);
						el.appendChild(p);
					};

					htmlObj = document.createElement("object");
					htmlObj.setAttribute("id", this.internal.flash.id);
					htmlObj.setAttribute("name", this.internal.flash.id);
					htmlObj.setAttribute("data", this.internal.flash.swf);
					htmlObj.setAttribute("type", "application/x-shockwave-flash");
					htmlObj.setAttribute("width", "1"); // Non-zero
					htmlObj.setAttribute("height", "1"); // Non-zero
					htmlObj.setAttribute("tabindex", "-1");
					createParam(htmlObj, "flashvars", flashVars);
					createParam(htmlObj, "allowscriptaccess", "always");
					createParam(htmlObj, "bgcolor", this.options.backgroundColor);
					createParam(htmlObj, "wmode", this.options.wmode);
				}

				this.element.append(htmlObj);
				this.internal.flash.jq = $(htmlObj);
			}

			// Setup playbackRate ability before using _addHtmlEventListeners()
			if(this.html.used && !this.flash.used) { // If only HTML
				// Using the audio element capabilities for playbackRate. ie., Assuming video element is the same.
				this.status.playbackRateEnabled = this._testPlaybackRate('audio');
			} else {
				this.status.playbackRateEnabled = false;
			}

			this._updatePlaybackRate();

			// Add the HTML solution if being used.
			if(this.html.used) {

				// The HTML Audio handlers
				if(this.html.audio.available) {
					this._addHtmlEventListeners(this.htmlElement.audio, this.html.audio);
					this.element.append(this.htmlElement.audio);
					this.internal.audio.jq = $("#" + this.internal.audio.id);
				}

				// The HTML Video handlers
				if(this.html.video.available) {
					this._addHtmlEventListeners(this.htmlElement.video, this.html.video);
					this.element.append(this.htmlElement.video);
					this.internal.video.jq = $("#" + this.internal.video.id);
					if(this.status.nativeVideoControls) {
						this.internal.video.jq.css({'width': this.status.width, 'height': this.status.height});
					} else {
						this.internal.video.jq.css({'width':'0px', 'height':'0px'}); // Using size 0x0 since a .hide() causes issues in iOS
					}
					this.internal.video.jq.bind("click.jPlayer", function() {
						self._trigger($.jPlayer.event.click);
					});
				}
			}
			
			// Add the Aurora.js solution if being used.
			if(this.aurora.used) {
				// Aurora.js player need to be created for each media, see setMedia function.
			}

			// Create the bridge that emulates the HTML Media element on the jPlayer DIV
			if( this.options.emulateHtml ) {
				this._emulateHtmlBridge();
			}

			if((this.html.used || this.aurora.used) && !this.flash.used) { // If only HTML, then emulate flash ready() call after 100ms.
				setTimeout( function() {
					self.internal.ready = true;
					self.version.flash = "n/a";
					self._trigger($.jPlayer.event.repeat); // Trigger the repeat event so its handler can initialize itself with the loop option.
					self._trigger($.jPlayer.event.ready);
				}, 100);
			}

			// Initialize the interface components with the options.
			this._updateNativeVideoControls();
			// The other controls are now setup in _cssSelectorAncestor()
			if(this.css.jq.videoPlay.length) {
				this.css.jq.videoPlay.hide();
			}

			$.jPlayer.prototype.count++; // Change static variable via prototype.
		},
		destroy: function() {
			// MJP: The background change remains. Would need to store the original to restore it correctly.
			// MJP: The jPlayer element's size change remains.

			// Clear the media to reset the GUI and stop any downloads. Streams on some browsers had persited. (Chrome)
			this.clearMedia();
			// Remove the size/sizeFull cssClass from the cssSelectorAncestor
			this._removeUiClass();
			// Remove the times from the GUI
			if(this.css.jq.currentTime.length) {
				this.css.jq.currentTime.text("");
			}
			if(this.css.jq.duration.length) {
				this.css.jq.duration.text("");
			}
			// Remove any bindings from the interface controls.
			$.each(this.css.jq, function(fn, jq) {
				// Check selector is valid before trying to execute method.
				if(jq.length) {
					jq.unbind(".jPlayer");
				}
			});
			// Remove the click handlers for $.jPlayer.event.click
			this.internal.poster.jq.unbind(".jPlayer");
			if(this.internal.video.jq) {
				this.internal.video.jq.unbind(".jPlayer");
			}
			// Remove the fullscreen event handlers
			this._fullscreenRemoveEventListeners();
			// Remove key bindings
			if(this === $.jPlayer.focus) {
				$.jPlayer.focus = null;
			}
			// Destroy the HTML bridge.
			if(this.options.emulateHtml) {
				this._destroyHtmlBridge();
			}
			this.element.removeData("jPlayer"); // Remove jPlayer data
			this.element.unbind(".jPlayer"); // Remove all event handlers created by the jPlayer constructor
			this.element.empty(); // Remove the inserted child elements
			
			delete this.instances[this.internal.instance]; // Clear the instance on the static instance object
		},
		destroyRemoved: function() { // Destroy any instances that have gone away.
			var self = this;
			$.each(this.instances, function(i, element) {
				if(self.element !== element) { // Do not destroy this instance.
					if(!element.data("jPlayer")) { // Check that element is a real jPlayer.
						element.jPlayer("destroy");
						delete self.instances[i];
					}
				}
			});
		},
		enable: function() { // Plan to implement
			// options.disabled = false
		},
		disable: function () { // Plan to implement
			// options.disabled = true
		},
		_testCanPlayType: function(elem) {
			// IE9 on Win Server 2008 did not implement canPlayType(), but it has the property.
			try {
				elem.canPlayType(this.format.mp3.codec); // The type is irrelevant.
				return true;
			} catch(err) {
				return false;
			}
		},
		_testPlaybackRate: function(type) {
			// type: String 'audio' or 'video'
			var el, rate = 0.5;
			type = typeof type === 'string' ? type : 'audio';
			el = document.createElement(type);
			// Wrapping in a try/catch, just in case older HTML5 browsers throw and error.
			try {
				if('playbackRate' in el) {
					el.playbackRate = rate;
					return el.playbackRate === rate;
				} else {
					return false;
				}
			} catch(err) {
				return false;
			}
		},
		_uaBlocklist: function(list) {
			// list : object with properties that are all regular expressions. Property names are irrelevant.
			// Returns true if the user agent is matched in list.
			var	ua = navigator.userAgent.toLowerCase(),
				block = false;

			$.each(list, function(p, re) {
				if(re && re.test(ua)) {
					block = true;
					return false; // exit $.each.
				}
			});
			return block;
		},
		_restrictNativeVideoControls: function() {
			// Fallback to noFullWindow when nativeVideoControls is true and audio media is being used. Affects when both media types are used.
			if(this.require.audio) {
				if(this.status.nativeVideoControls) {
					this.status.nativeVideoControls = false;
					this.status.noFullWindow = true;
				}
			}
		},
		_updateNativeVideoControls: function() {
			if(this.html.video.available && this.html.used) {
				// Turn the HTML Video controls on/off
				this.htmlElement.video.controls = this.status.nativeVideoControls;
				// Show/hide the jPlayer GUI.
				this._updateAutohide();
				// For when option changed. The poster image is not updated, as it is dealt with in setMedia(). Acceptable degradation since seriously doubt these options will change on the fly. Can again review later.
				if(this.status.nativeVideoControls && this.require.video) {
					this.internal.poster.jq.hide();
					this.internal.video.jq.css({'width': this.status.width, 'height': this.status.height});
				} else if(this.status.waitForPlay && this.status.video) {
					this.internal.poster.jq.show();
					this.internal.video.jq.css({'width': '0px', 'height': '0px'});
				}
			}
		},
		_addHtmlEventListeners: function(mediaElement, entity) {
			var self = this;
			mediaElement.preload = this.options.preload;
			mediaElement.muted = this.options.muted;
			mediaElement.volume = this.options.volume;

			if(this.status.playbackRateEnabled) {
				mediaElement.defaultPlaybackRate = this.options.defaultPlaybackRate;
				mediaElement.playbackRate = this.options.playbackRate;
			}

			// Create the event listeners
			// Only want the active entity to affect jPlayer and bubble events.
			// Using entity.gate so that object is referenced and gate property always current
			
			mediaElement.addEventListener("progress", function() {
				if(entity.gate) {
					if(self.internal.cmdsIgnored && this.readyState > 0) { // Detect iOS executed the command
						self.internal.cmdsIgnored = false;
					}
					self._getHtmlStatus(mediaElement);
					self._updateInterface();
					self._trigger($.jPlayer.event.progress);
				}
			}, false);
			mediaElement.addEventListener("loadeddata", function() {
				if(entity.gate) {
					self.androidFix.setMedia = false; // Disable the fix after the first progress event.
					if(self.androidFix.play) { // Play Android audio - performing the fix.
						self.androidFix.play = false;
						self.play(self.androidFix.time);
					}
					if(self.androidFix.pause) { // Pause Android audio at time - performing the fix.
						self.androidFix.pause = false;
						self.pause(self.androidFix.time);
					}
					self._trigger($.jPlayer.event.loadeddata);
				}
			}, false);
			mediaElement.addEventListener("timeupdate", function() {
				if(entity.gate) {
					self._getHtmlStatus(mediaElement);
					self._updateInterface();
					self._trigger($.jPlayer.event.timeupdate);
				}
			}, false);
			mediaElement.addEventListener("durationchange", function() {
				if(entity.gate) {
					self._getHtmlStatus(mediaElement);
					self._updateInterface();
					self._trigger($.jPlayer.event.durationchange);
				}
			}, false);
			mediaElement.addEventListener("play", function() {
				if(entity.gate) {
					self._updateButtons(true);
					self._html_checkWaitForPlay(); // So the native controls update this variable and puts the hidden interface in the correct state. Affects toggling native controls.
					self._trigger($.jPlayer.event.play);
				}
			}, false);
			mediaElement.addEventListener("playing", function() {
				if(entity.gate) {
					self._updateButtons(true);
					self._seeked();
					self._trigger($.jPlayer.event.playing);
				}
			}, false);
			mediaElement.addEventListener("pause", function() {
				if(entity.gate) {
					self._updateButtons(false);
					self._trigger($.jPlayer.event.pause);
				}
			}, false);
			mediaElement.addEventListener("waiting", function() {
				if(entity.gate) {
					self._seeking();
					self._trigger($.jPlayer.event.waiting);
				}
			}, false);
			mediaElement.addEventListener("seeking", function() {
				if(entity.gate) {
					self._seeking();
					self._trigger($.jPlayer.event.seeking);
				}
			}, false);
			mediaElement.addEventListener("seeked", function() {
				if(entity.gate) {
					self._seeked();
					self._trigger($.jPlayer.event.seeked);
				}
			}, false);
			mediaElement.addEventListener("volumechange", function() {
				if(entity.gate) {
					// Read the values back from the element as the Blackberry PlayBook shares the volume with the physical buttons master volume control.
					// However, when tested 6th July 2011, those buttons do not generate an event. The physical play/pause button does though.
					self.options.volume = mediaElement.volume;
					self.options.muted = mediaElement.muted;
					self._updateMute();
					self._updateVolume();
					self._trigger($.jPlayer.event.volumechange);
				}
			}, false);
			mediaElement.addEventListener("ratechange", function() {
				if(entity.gate) {
					self.options.defaultPlaybackRate = mediaElement.defaultPlaybackRate;
					self.options.playbackRate = mediaElement.playbackRate;
					self._updatePlaybackRate();
					self._trigger($.jPlayer.event.ratechange);
				}
			}, false);
			mediaElement.addEventListener("suspend", function() { // Seems to be the only way of capturing that the iOS4 browser did not actually play the media from the page code. ie., It needs a user gesture.
				if(entity.gate) {
					self._seeked();
					self._trigger($.jPlayer.event.suspend);
				}
			}, false);
			mediaElement.addEventListener("ended", function() {
				if(entity.gate) {
					// Order of the next few commands are important. Change the time and then pause.
					// Solves a bug in Firefox, where issuing pause 1st causes the media to play from the start. ie., The pause is ignored.
					if(!$.jPlayer.browser.webkit) { // Chrome crashes if you do this in conjunction with a setMedia command in an ended event handler. ie., The playlist demo.
						self.htmlElement.media.currentTime = 0; // Safari does not care about this command. ie., It works with or without this line. (Both Safari and Chrome are Webkit.)
					}
					self.htmlElement.media.pause(); // Pause otherwise a click on the progress bar will play from that point, when it shouldn't, since it stopped playback.
					self._updateButtons(false);
					self._getHtmlStatus(mediaElement, true); // With override true. Otherwise Chrome leaves progress at full.
					self._updateInterface();
					self._trigger($.jPlayer.event.ended);
				}
			}, false);
			mediaElement.addEventListener("error", function() {
				if(entity.gate) {
					self._updateButtons(false);
					self._seeked();
					if(self.status.srcSet) { // Deals with case of clearMedia() causing an error event.
						clearTimeout(self.internal.htmlDlyCmdId); // Clears any delayed commands used in the HTML solution.
						self.status.waitForLoad = true; // Allows the load operation to try again.
						self.status.waitForPlay = true; // Reset since a play was captured.
						if(self.status.video && !self.status.nativeVideoControls) {
							self.internal.video.jq.css({'width':'0px', 'height':'0px'});
						}
						if(self._validString(self.status.media.poster) && !self.status.nativeVideoControls) {
							self.internal.poster.jq.show();
						}
						if(self.css.jq.videoPlay.length) {
							self.css.jq.videoPlay.show();
						}
						self._error( {
							type: $.jPlayer.error.URL,
							context: self.status.src, // this.src shows absolute urls. Want context to show the url given.
							message: $.jPlayer.errorMsg.URL,
							hint: $.jPlayer.errorHint.URL
						});
					}
				}
			}, false);
			// Create all the other event listeners that bubble up to a jPlayer event from html, without being used by jPlayer.
			$.each($.jPlayer.htmlEvent, function(i, eventType) {
				mediaElement.addEventListener(this, function() {
					if(entity.gate) {
						self._trigger($.jPlayer.event[eventType]);
					}
				}, false);
			});
		},
		_addAuroraEventListeners : function(player, entity) {
			var self = this;
			//player.preload = this.options.preload;
			//player.muted = this.options.muted;
			player.volume = this.options.volume * 100;

			// Create the event listeners
			// Only want the active entity to affect jPlayer and bubble events.
			// Using entity.gate so that object is referenced and gate property always current
			
			player.on("progress", function() {
				if(entity.gate) {
					if(self.internal.cmdsIgnored && this.readyState > 0) { // Detect iOS executed the command
						self.internal.cmdsIgnored = false;
					}
					self._getAuroraStatus(player);
					self._updateInterface();
					self._trigger($.jPlayer.event.progress);
					// Progress with song duration, we estimate timeupdate need to be triggered too.
					if (player.duration > 0) {
						self._trigger($.jPlayer.event.timeupdate);
					}
				}
			}, false);
			player.on("ready", function() {
				if(entity.gate) {
					self._trigger($.jPlayer.event.loadeddata);
				}
			}, false);
			player.on("duration", function() {
				if(entity.gate) {
					self._getAuroraStatus(player);
					self._updateInterface();
					self._trigger($.jPlayer.event.durationchange);
				}
			}, false);
			player.on("end", function() {
				if(entity.gate) {
					// Order of the next few commands are important. Change the time and then pause.
					self._updateButtons(false);
					self._getAuroraStatus(player, true);
					self._updateInterface();
					self._trigger($.jPlayer.event.ended);
				}
			}, false);
			player.on("error", function() {
				if(entity.gate) {
					self._updateButtons(false);
					self._seeked();
					if(self.status.srcSet) { // Deals with case of clearMedia() causing an error event.
						self.status.waitForLoad = true; // Allows the load operation to try again.
						self.status.waitForPlay = true; // Reset since a play was captured.
						if(self.status.video && !self.status.nativeVideoControls) {
							self.internal.video.jq.css({'width':'0px', 'height':'0px'});
						}
						if(self._validString(self.status.media.poster) && !self.status.nativeVideoControls) {
							self.internal.poster.jq.show();
						}
						if(self.css.jq.videoPlay.length) {
							self.css.jq.videoPlay.show();
						}
						self._error( {
							type: $.jPlayer.error.URL,
							context: self.status.src, // this.src shows absolute urls. Want context to show the url given.
							message: $.jPlayer.errorMsg.URL,
							hint: $.jPlayer.errorHint.URL
						});
					}
				}
			}, false);
		},
		_getHtmlStatus: function(media, override) {
			var ct = 0, cpa = 0, sp = 0, cpr = 0;

			// Fixes the duration bug in iOS, where the durationchange event occurs when media.duration is not always correct.
			// Fixes the initial duration bug in BB OS7, where the media.duration is infinity and displays as NaN:NaN due to Date() using inifity.
			if(isFinite(media.duration)) {
				this.status.duration = media.duration;
			}

			ct = media.currentTime;
			cpa = (this.status.duration > 0) ? 100 * ct / this.status.duration : 0;
			if((typeof media.seekable === "object") && (media.seekable.length > 0)) {
				sp = (this.status.duration > 0) ? 100 * media.seekable.end(media.seekable.length-1) / this.status.duration : 100;
				cpr = (this.status.duration > 0) ? 100 * media.currentTime / media.seekable.end(media.seekable.length-1) : 0; // Duration conditional for iOS duration bug. ie., seekable.end is a NaN in that case.
			} else {
				sp = 100;
				cpr = cpa;
			}
			
			if(override) {
				ct = 0;
				cpr = 0;
				cpa = 0;
			}

			this.status.seekPercent = sp;
			this.status.currentPercentRelative = cpr;
			this.status.currentPercentAbsolute = cpa;
			this.status.currentTime = ct;

			this.status.remaining = this.status.duration - this.status.currentTime;

			this.status.videoWidth = media.videoWidth;
			this.status.videoHeight = media.videoHeight;

			this.status.readyState = media.readyState;
			this.status.networkState = media.networkState;
			this.status.playbackRate = media.playbackRate;
			this.status.ended = media.ended;
		},
		_getAuroraStatus: function(player, override) {
			var ct = 0, cpa = 0, sp = 0, cpr = 0;

			this.status.duration = player.duration / 1000;

			ct = player.currentTime / 1000;
			cpa = (this.status.duration > 0) ? 100 * ct / this.status.duration : 0;
			if(player.buffered > 0) {
				sp = (this.status.duration > 0) ? (player.buffered * this.status.duration) / this.status.duration : 100;
				cpr = (this.status.duration > 0) ? ct / (player.buffered * this.status.duration) : 0;
			} else {
				sp = 100;
				cpr = cpa;
			}
			
			if(override) {
				ct = 0;
				cpr = 0;
				cpa = 0;
			}

			this.status.seekPercent = sp;
			this.status.currentPercentRelative = cpr;
			this.status.currentPercentAbsolute = cpa;
			this.status.currentTime = ct;

			this.status.remaining = this.status.duration - this.status.currentTime;

			this.status.readyState = 4; // status.readyState;
			this.status.networkState = 0; // status.networkState;
			this.status.playbackRate = 1; // status.playbackRate;
			this.status.ended = false; // status.ended;
		},
		_resetStatus: function() {
			this.status = $.extend({}, this.status, $.jPlayer.prototype.status); // Maintains the status properties that persist through a reset.
		},
		_trigger: function(eventType, error, warning) { // eventType always valid as called using $.jPlayer.event.eventType
			var event = $.Event(eventType);
			event.jPlayer = {};
			event.jPlayer.version = $.extend({}, this.version);
			event.jPlayer.options = $.extend(true, {}, this.options); // Deep copy
			event.jPlayer.status = $.extend(true, {}, this.status); // Deep copy
			event.jPlayer.html = $.extend(true, {}, this.html); // Deep copy
			event.jPlayer.aurora = $.extend(true, {}, this.aurora); // Deep copy
			event.jPlayer.flash = $.extend(true, {}, this.flash); // Deep copy
			if(error) {
				event.jPlayer.error = $.extend({}, error);
			}
			if(warning) {
				event.jPlayer.warning = $.extend({}, warning);
			}
			this.element.trigger(event);
		},
		jPlayerFlashEvent: function(eventType, status) { // Called from Flash
			if(eventType === $.jPlayer.event.ready) {
				if(!this.internal.ready) {
					this.internal.ready = true;
					this.internal.flash.jq.css({'width':'0px', 'height':'0px'}); // Once Flash generates the ready event, minimise to zero as it is not affected by wmode anymore.

					this.version.flash = status.version;
					if(this.version.needFlash !== this.version.flash) {
						this._error( {
							type: $.jPlayer.error.VERSION,
							context: this.version.flash,
							message: $.jPlayer.errorMsg.VERSION + this.version.flash,
							hint: $.jPlayer.errorHint.VERSION
						});
					}
					this._trigger($.jPlayer.event.repeat); // Trigger the repeat event so its handler can initialize itself with the loop option.
					this._trigger(eventType);
				} else {
					// This condition occurs if the Flash is hidden and then shown again.
					// Firefox also reloads the Flash if the CSS position changes. position:fixed is used for full screen.

					// Only do this if the Flash is the solution being used at the moment. Affects Media players where both solution may be being used.
					if(this.flash.gate) {

						// Send the current status to the Flash now that it is ready (available) again.
						if(this.status.srcSet) {

							// Need to read original status before issuing the setMedia command.
							var	currentTime = this.status.currentTime,
								paused = this.status.paused; 

							this.setMedia(this.status.media);
							this.volumeWorker(this.options.volume);
							if(currentTime > 0) {
								if(paused) {
									this.pause(currentTime);
								} else {
									this.play(currentTime);
								}
							}
						}
						this._trigger($.jPlayer.event.flashreset);
					}
				}
			}
			if(this.flash.gate) {
				switch(eventType) {
					case $.jPlayer.event.progress:
						this._getFlashStatus(status);
						this._updateInterface();
						this._trigger(eventType);
						break;
					case $.jPlayer.event.timeupdate:
						this._getFlashStatus(status);
						this._updateInterface();
						this._trigger(eventType);
						break;
					case $.jPlayer.event.play:
						this._seeked();
						this._updateButtons(true);
						this._trigger(eventType);
						break;
					case $.jPlayer.event.pause:
						this._updateButtons(false);
						this._trigger(eventType);
						break;
					case $.jPlayer.event.ended:
						this._updateButtons(false);
						this._trigger(eventType);
						break;
					case $.jPlayer.event.click:
						this._trigger(eventType); // This could be dealt with by the default
						break;
					case $.jPlayer.event.error:
						this.status.waitForLoad = true; // Allows the load operation to try again.
						this.status.waitForPlay = true; // Reset since a play was captured.
						if(this.status.video) {
							this.internal.flash.jq.css({'width':'0px', 'height':'0px'});
						}
						if(this._validString(this.status.media.poster)) {
							this.internal.poster.jq.show();
						}
						if(this.css.jq.videoPlay.length && this.status.video) {
							this.css.jq.videoPlay.show();
						}
						if(this.status.video) { // Set up for another try. Execute before error event.
							this._flash_setVideo(this.status.media);
						} else {
							this._flash_setAudio(this.status.media);
						}
						this._updateButtons(false);
						this._error( {
							type: $.jPlayer.error.URL,
							context:status.src,
							message: $.jPlayer.errorMsg.URL,
							hint: $.jPlayer.errorHint.URL
						});
						break;
					case $.jPlayer.event.seeking:
						this._seeking();
						this._trigger(eventType);
						break;
					case $.jPlayer.event.seeked:
						this._seeked();
						this._trigger(eventType);
						break;
					case $.jPlayer.event.ready:
						// The ready event is handled outside the switch statement.
						// Captured here otherwise 2 ready events would be generated if the ready event handler used setMedia.
						break;
					default:
						this._trigger(eventType);
				}
			}
			return false;
		},
		_getFlashStatus: function(status) {
			this.status.seekPercent = status.seekPercent;
			this.status.currentPercentRelative = status.currentPercentRelative;
			this.status.currentPercentAbsolute = status.currentPercentAbsolute;
			this.status.currentTime = status.currentTime;
			this.status.duration = status.duration;
			this.status.remaining = status.duration - status.currentTime;

			this.status.videoWidth = status.videoWidth;
			this.status.videoHeight = status.videoHeight;

			// The Flash does not generate this information in this release
			this.status.readyState = 4; // status.readyState;
			this.status.networkState = 0; // status.networkState;
			this.status.playbackRate = 1; // status.playbackRate;
			this.status.ended = false; // status.ended;
		},
		_updateButtons: function(playing) {
			if(playing === undefined) {
				playing = !this.status.paused;
			} else {
				this.status.paused = !playing;
			}
			// Apply the state classes. (For the useStateClassSkin:true option)
			if(playing) {
				this.addStateClass('playing');
			} else {
				this.removeStateClass('playing');
			}
			if(!this.status.noFullWindow && this.options.fullWindow) {
				this.addStateClass('fullScreen');
			} else {
				this.removeStateClass('fullScreen');
			}
			if(this.options.loop) {
				this.addStateClass('looped');
			} else {
				this.removeStateClass('looped');
			}
			// Toggle the GUI element pairs. (For the useStateClassSkin:false option)
			if(this.css.jq.play.length && this.css.jq.pause.length) {
				if(playing) {
					this.css.jq.play.hide();
					this.css.jq.pause.show();
				} else {
					this.css.jq.play.show();
					this.css.jq.pause.hide();
				}
			}
			if(this.css.jq.restoreScreen.length && this.css.jq.fullScreen.length) {
				if(this.status.noFullWindow) {
					this.css.jq.fullScreen.hide();
					this.css.jq.restoreScreen.hide();
				} else if(this.options.fullWindow) {
					this.css.jq.fullScreen.hide();
					this.css.jq.restoreScreen.show();
				} else {
					this.css.jq.fullScreen.show();
					this.css.jq.restoreScreen.hide();
				}
			}
			if(this.css.jq.repeat.length && this.css.jq.repeatOff.length) {
				if(this.options.loop) {
					this.css.jq.repeat.hide();
					this.css.jq.repeatOff.show();
				} else {
					this.css.jq.repeat.show();
					this.css.jq.repeatOff.hide();
				}
			}
		},
		_updateInterface: function() {
			if(this.css.jq.seekBar.length) {
				this.css.jq.seekBar.width(this.status.seekPercent+"%");
			}
			if(this.css.jq.playBar.length) {
				if(this.options.smoothPlayBar) {
					this.css.jq.playBar.stop().animate({
						width: this.status.currentPercentAbsolute+"%"
					}, 250, "linear");
				} else {
					this.css.jq.playBar.width(this.status.currentPercentRelative+"%");
				}
			}
			var currentTimeText = '';
			if(this.css.jq.currentTime.length) {
				currentTimeText = this._convertTime(this.status.currentTime);
				if(currentTimeText !== this.css.jq.currentTime.text()) {
					this.css.jq.currentTime.text(this._convertTime(this.status.currentTime));
				}
			}
			var durationText = '',
				duration = this.status.duration,
				remaining = this.status.remaining;
			if(this.css.jq.duration.length) {
				if(typeof this.status.media.duration === 'string') {
					durationText = this.status.media.duration;
				} else {
					if(typeof this.status.media.duration === 'number') {
						duration = this.status.media.duration;
						remaining = duration - this.status.currentTime;
					}
					if(this.options.remainingDuration) {
						durationText = (remaining > 0 ? '-' : '') + this._convertTime(remaining);
					} else {
						durationText = this._convertTime(duration);
					}
				}
				if(durationText !== this.css.jq.duration.text()) {
					this.css.jq.duration.text(durationText);
				}
			}
		},
		_convertTime: ConvertTime.prototype.time,
		_seeking: function() {
			if(this.css.jq.seekBar.length) {
				this.css.jq.seekBar.addClass("jp-seeking-bg");
			}
			this.addStateClass('seeking');
		},
		_seeked: function() {
			if(this.css.jq.seekBar.length) {
				this.css.jq.seekBar.removeClass("jp-seeking-bg");
			}
			this.removeStateClass('seeking');
		},
		_resetGate: function() {
			this.html.audio.gate = false;
			this.html.video.gate = false;
			this.aurora.gate = false;
			this.flash.gate = false;
		},
		_resetActive: function() {
			this.html.active = false;
			this.aurora.active = false;
			this.flash.active = false;
		},
		_escapeHtml: function(s) {
			return s.split('&').join('&amp;').split('<').join('&lt;').split('>').join('&gt;').split('"').join('&quot;');
		},
		_qualifyURL: function(url) {
			var el = document.createElement('div');
			el.innerHTML= '<a href="' + this._escapeHtml(url) + '">x</a>';
			return el.firstChild.href;
		},
		_absoluteMediaUrls: function(media) {
			var self = this;
			$.each(media, function(type, url) {
				if(url && self.format[type] && url.substr(0, 5) !== "data:") {
					media[type] = self._qualifyURL(url);
				}
			});
			return media;
		},
		addStateClass: function(state) {
			if(this.ancestorJq.length) {
				this.ancestorJq.addClass(this.options.stateClass[state]);
			}
		},
		removeStateClass: function(state) {
			if(this.ancestorJq.length) {
				this.ancestorJq.removeClass(this.options.stateClass[state]);
			}
		},
		setMedia: function(media) {
		
			/*	media[format] = String: URL of format. Must contain all of the supplied option's video or audio formats.
			 *	media.poster = String: Video poster URL.
			 *	media.track = Array: Of objects defining the track element: kind, src, srclang, label, def.
			 *	media.stream = Boolean: * NOT IMPLEMENTED * Designating actual media streams. ie., "false/undefined" for files. Plan to refresh the flash every so often.
			 */

			var	self = this,
				supported = false,
				posterChanged = this.status.media.poster !== media.poster; // Compare before reset. Important for OSX Safari as this.htmlElement.poster.src is absolute, even if original poster URL was relative.

			this._resetMedia();
			this._resetGate();
			this._resetActive();

			// Clear the Android Fix.
			this.androidFix.setMedia = false;
			this.androidFix.play = false;
			this.androidFix.pause = false;

			// Convert all media URLs to absolute URLs.
			media = this._absoluteMediaUrls(media);

			$.each(this.formats, function(formatPriority, format) {
				var isVideo = self.format[format].media === 'video';
				$.each(self.solutions, function(solutionPriority, solution) {
					if(self[solution].support[format] && self._validString(media[format])) { // Format supported in solution and url given for format.
						var isHtml = solution === 'html';
						var isAurora = solution === 'aurora';

						if(isVideo) {
							if(isHtml) {
								self.html.video.gate = true;
								self._html_setVideo(media);
								self.html.active = true;
							} else {
								self.flash.gate = true;
								self._flash_setVideo(media);
								self.flash.active = true;
							}
							if(self.css.jq.videoPlay.length) {
								self.css.jq.videoPlay.show();
							}
							self.status.video = true;
						} else {
							if(isHtml) {
								self.html.audio.gate = true;
								self._html_setAudio(media);
								self.html.active = true;

								// Setup the Android Fix - Only for HTML audio.
								if($.jPlayer.platform.android) {
									self.androidFix.setMedia = true;
								}
							} else if(isAurora) {
								self.aurora.gate = true;
								self._aurora_setAudio(media);
								self.aurora.active = true;
							} else {
								self.flash.gate = true;
								self._flash_setAudio(media);
								self.flash.active = true;
							}
							if(self.css.jq.videoPlay.length) {
								self.css.jq.videoPlay.hide();
							}
							self.status.video = false;
						}
						
						supported = true;
						return false; // Exit $.each
					}
				});
				if(supported) {
					return false; // Exit $.each
				}
			});

			if(supported) {
				if(!(this.status.nativeVideoControls && this.html.video.gate)) {
					// Set poster IMG if native video controls are not being used
					// Note: With IE the IMG onload event occurs immediately when cached.
					// Note: Poster hidden by default in _resetMedia()
					if(this._validString(media.poster)) {
						if(posterChanged) { // Since some browsers do not generate img onload event.
							this.htmlElement.poster.src = media.poster;
						} else {
							this.internal.poster.jq.show();
						}
					}
				}
				if(typeof media.title === 'string') {
					if(this.css.jq.title.length) {
						this.css.jq.title.html(media.title);
					}
					if(this.htmlElement.audio) {
						this.htmlElement.audio.setAttribute('title', media.title);
					}
					if(this.htmlElement.video) {
						this.htmlElement.video.setAttribute('title', media.title);
					}
				}
				this.status.srcSet = true;
				this.status.media = $.extend({}, media);
				this._updateButtons(false);
				this._updateInterface();
				this._trigger($.jPlayer.event.setmedia);
			} else { // jPlayer cannot support any formats provided in this browser
				// Send an error event
				this._error( {
					type: $.jPlayer.error.NO_SUPPORT,
					context: "{supplied:'" + this.options.supplied + "'}",
					message: $.jPlayer.errorMsg.NO_SUPPORT,
					hint: $.jPlayer.errorHint.NO_SUPPORT
				});
			}
		},
		_resetMedia: function() {
			this._resetStatus();
			this._updateButtons(false);
			this._updateInterface();
			this._seeked();
			this.internal.poster.jq.hide();

			clearTimeout(this.internal.htmlDlyCmdId);

			if(this.html.active) {
				this._html_resetMedia();
			} else if(this.aurora.active) {
				this._aurora_resetMedia();
			} else if(this.flash.active) {
				this._flash_resetMedia();
			}
		},
		clearMedia: function() {
			this._resetMedia();

			if(this.html.active) {
				this._html_clearMedia();
			} else if(this.aurora.active) {
				this._aurora_clearMedia();
			} else if(this.flash.active) {
				this._flash_clearMedia();
			}

			this._resetGate();
			this._resetActive();
		},
		load: function() {
			if(this.status.srcSet) {
				if(this.html.active) {
					this._html_load();
				} else if(this.aurora.active) {
					this._aurora_load();
				} else if(this.flash.active) {
					this._flash_load();
				}
			} else {
				this._urlNotSetError("load");
			}
		},
		focus: function() {
			if(this.options.keyEnabled) {
				$.jPlayer.focus = this;
			}
		},
		play: function(time) {
			var guiAction = typeof time === "object"; // Flags GUI click events so we know this was not a direct command, but an action taken by the user on the GUI.
			if(guiAction && this.options.useStateClassSkin && !this.status.paused) {
				this.pause(time); // The time would be the click event, but passing it over so info is not lost.
			} else {
				time = (typeof time === "number") ? time : NaN; // Remove jQuery event from click handler
				if(this.status.srcSet) {
					this.focus();
					if(this.html.active) {
						this._html_play(time);
					} else if(this.aurora.active) {
						this._aurora_play(time);
					} else if(this.flash.active) {
						this._flash_play(time);
					}
				} else {
					this._urlNotSetError("play");
				}
			}
		},
		videoPlay: function() { // Handles clicks on the play button over the video poster
			this.play();
		},
		pause: function(time) {
			time = (typeof time === "number") ? time : NaN; // Remove jQuery event from click handler
			if(this.status.srcSet) {
				if(this.html.active) {
					this._html_pause(time);
				} else if(this.aurora.active) {
					this._aurora_pause(time);
				} else if(this.flash.active) {
					this._flash_pause(time);
				}
			} else {
				this._urlNotSetError("pause");
			}
		},
		tellOthers: function(command, conditions) {
			var self = this,
				hasConditions = typeof conditions === 'function',
				args = Array.prototype.slice.call(arguments); // Convert arguments to an Array.

			if(typeof command !== 'string') { // Ignore, since no command.
				return; // Return undefined to maintain chaining.
			}
			if(hasConditions) {
				args.splice(1, 1); // Remove the conditions from the arguments
			}

			$.jPlayer.prototype.destroyRemoved();
			$.each(this.instances, function() {
				// Remember that "this" is the instance's "element" in the $.each() loop.
				if(self.element !== this) { // Do not tell my instance.
					if(!hasConditions || conditions.call(this.data("jPlayer"), self)) {
						this.jPlayer.apply(this, args);
					}
				}
			});
		},
		pauseOthers: function(time) {
			this.tellOthers("pause", function() {
				// In the conditions function, the "this" context is the other instance's jPlayer object.
				return this.status.srcSet;
			}, time);
		},
		stop: function() {
			if(this.status.srcSet) {
				if(this.html.active) {
					this._html_pause(0);
				} else if(this.aurora.active) {
					this._aurora_pause(0);
				} else if(this.flash.active) {
					this._flash_pause(0);
				}
			} else {
				this._urlNotSetError("stop");
			}
		},
		playHead: function(p) {
			p = this._limitValue(p, 0, 100);
			if(this.status.srcSet) {
				if(this.html.active) {
					this._html_playHead(p);
				} else if(this.aurora.active) {
					this._aurora_playHead(p);
				} else if(this.flash.active) {
					this._flash_playHead(p);
				}
			} else {
				this._urlNotSetError("playHead");
			}
		},
		_muted: function(muted) {
			this.mutedWorker(muted);
			if(this.options.globalVolume) {
				this.tellOthers("mutedWorker", function() {
					// Check the other instance has global volume enabled.
					return this.options.globalVolume;
				}, muted);
			}
		},
		mutedWorker: function(muted) {
			this.options.muted = muted;
			if(this.html.used) {
				this._html_setProperty('muted', muted);
			}
			if(this.aurora.used) {
				this._aurora_mute(muted);
			}
			if(this.flash.used) {
				this._flash_mute(muted);
			}

			// The HTML solution generates this event from the media element itself.
			if(!this.html.video.gate && !this.html.audio.gate) {
				this._updateMute(muted);
				this._updateVolume(this.options.volume);
				this._trigger($.jPlayer.event.volumechange);
			}
		},
		mute: function(mute) { // mute is either: undefined (true), an event object (true) or a boolean (muted).
			var guiAction = typeof mute === "object"; // Flags GUI click events so we know this was not a direct command, but an action taken by the user on the GUI.
			if(guiAction && this.options.useStateClassSkin && this.options.muted) {
				this._muted(false);
			} else {
				mute = mute === undefined ? true : !!mute;
				this._muted(mute);
			}
		},
		unmute: function(unmute) { // unmute is either: undefined (true), an event object (true) or a boolean (!muted).
			unmute = unmute === undefined ? true : !!unmute;
			this._muted(!unmute);
		},
		_updateMute: function(mute) {
			if(mute === undefined) {
				mute = this.options.muted;
			}
			if(mute) {
				this.addStateClass('muted');
			} else {
				this.removeStateClass('muted');
			}
			if(this.css.jq.mute.length && this.css.jq.unmute.length) {
				if(this.status.noVolume) {
					this.css.jq.mute.hide();
					this.css.jq.unmute.hide();
				} else if(mute) {
					this.css.jq.mute.hide();
					this.css.jq.unmute.show();
				} else {
					this.css.jq.mute.show();
					this.css.jq.unmute.hide();
				}
			}
		},
		volume: function(v) {
			this.volumeWorker(v);
			if(this.options.globalVolume) {
				this.tellOthers("volumeWorker", function() {
					// Check the other instance has global volume enabled.
					return this.options.globalVolume;
				}, v);
			}
		},
		volumeWorker: function(v) {
			v = this._limitValue(v, 0, 1);
			this.options.volume = v;

			if(this.html.used) {
				this._html_setProperty('volume', v);
			}
			if(this.aurora.used) {
				this._aurora_volume(v);
			}
			if(this.flash.used) {
				this._flash_volume(v);
			}

			// The HTML solution generates this event from the media element itself.
			if(!this.html.video.gate && !this.html.audio.gate) {
				this._updateVolume(v);
				this._trigger($.jPlayer.event.volumechange);
			}
		},
		volumeBar: function(e) { // Handles clicks on the volumeBar
			if(this.css.jq.volumeBar.length) {
				// Using $(e.currentTarget) to enable multiple volume bars
				var $bar = $(e.currentTarget),
					offset = $bar.offset(),
					x = e.pageX - offset.left,
					w = $bar.width(),
					y = $bar.height() - e.pageY + offset.top,
					h = $bar.height();
				if(this.options.verticalVolume) {
					this.volume(y/h);
				} else {
					this.volume(x/w);
				}
			}
			if(this.options.muted) {
				this._muted(false);
			}
		},
		_updateVolume: function(v) {
			if(v === undefined) {
				v = this.options.volume;
			}
			v = this.options.muted ? 0 : v;

			if(this.status.noVolume) {
				this.addStateClass('noVolume');
				if(this.css.jq.volumeBar.length) {
					this.css.jq.volumeBar.hide();
				}
				if(this.css.jq.volumeBarValue.length) {
					this.css.jq.volumeBarValue.hide();
				}
				if(this.css.jq.volumeMax.length) {
					this.css.jq.volumeMax.hide();
				}
			} else {
				this.removeStateClass('noVolume');
				if(this.css.jq.volumeBar.length) {
					this.css.jq.volumeBar.show();
				}
				if(this.css.jq.volumeBarValue.length) {
					this.css.jq.volumeBarValue.show();
					this.css.jq.volumeBarValue[this.options.verticalVolume ? "height" : "width"]((v*100)+"%");
				}
				if(this.css.jq.volumeMax.length) {
					this.css.jq.volumeMax.show();
				}
			}
		},
		volumeMax: function() { // Handles clicks on the volume max
			this.volume(1);
			if(this.options.muted) {
				this._muted(false);
			}
		},
		_cssSelectorAncestor: function(ancestor) {
			var self = this;
			this.options.cssSelectorAncestor = ancestor;
			this._removeUiClass();
			this.ancestorJq = ancestor ? $(ancestor) : []; // Would use $() instead of [], but it is only 1.4+
			if(ancestor && this.ancestorJq.length !== 1) { // So empty strings do not generate the warning.
				this._warning( {
					type: $.jPlayer.warning.CSS_SELECTOR_COUNT,
					context: ancestor,
					message: $.jPlayer.warningMsg.CSS_SELECTOR_COUNT + this.ancestorJq.length + " found for cssSelectorAncestor.",
					hint: $.jPlayer.warningHint.CSS_SELECTOR_COUNT
				});
			}
			this._addUiClass();
			$.each(this.options.cssSelector, function(fn, cssSel) {
				self._cssSelector(fn, cssSel);
			});

			// Set the GUI to the current state.
			this._updateInterface();
			this._updateButtons();
			this._updateAutohide();
			this._updateVolume();
			this._updateMute();
		},
		_cssSelector: function(fn, cssSel) {
			var self = this;
			if(typeof cssSel === 'string') {
				if($.jPlayer.prototype.options.cssSelector[fn]) {
					if(this.css.jq[fn] && this.css.jq[fn].length) {
						this.css.jq[fn].unbind(".jPlayer");
					}
					this.options.cssSelector[fn] = cssSel;
					this.css.cs[fn] = this.options.cssSelectorAncestor + " " + cssSel;

					if(cssSel) { // Checks for empty string
						this.css.jq[fn] = $(this.css.cs[fn]);
					} else {
						this.css.jq[fn] = []; // To comply with the css.jq[fn].length check before its use. As of jQuery 1.4 could have used $() for an empty set. 
					}

					if(this.css.jq[fn].length && this[fn]) {
						var handler = function(e) {
							e.preventDefault();
							self[fn](e);
							if(self.options.autoBlur) {
								$(this).blur();
							} else {
								$(this).focus(); // Force focus for ARIA.
							}
						};
						this.css.jq[fn].bind("click.jPlayer", handler); // Using jPlayer namespace
					}

					if(cssSel && this.css.jq[fn].length !== 1) { // So empty strings do not generate the warning. ie., they just remove the old one.
						this._warning( {
							type: $.jPlayer.warning.CSS_SELECTOR_COUNT,
							context: this.css.cs[fn],
							message: $.jPlayer.warningMsg.CSS_SELECTOR_COUNT + this.css.jq[fn].length + " found for " + fn + " method.",
							hint: $.jPlayer.warningHint.CSS_SELECTOR_COUNT
						});
					}
				} else {
					this._warning( {
						type: $.jPlayer.warning.CSS_SELECTOR_METHOD,
						context: fn,
						message: $.jPlayer.warningMsg.CSS_SELECTOR_METHOD,
						hint: $.jPlayer.warningHint.CSS_SELECTOR_METHOD
					});
				}
			} else {
				this._warning( {
					type: $.jPlayer.warning.CSS_SELECTOR_STRING,
					context: cssSel,
					message: $.jPlayer.warningMsg.CSS_SELECTOR_STRING,
					hint: $.jPlayer.warningHint.CSS_SELECTOR_STRING
				});
			}
		},
		duration: function(e) {
			if(this.options.toggleDuration) {
				if(this.options.captureDuration) {
					e.stopPropagation();
				}
				this._setOption("remainingDuration", !this.options.remainingDuration);
			}
		},
		seekBar: function(e) { // Handles clicks on the seekBar
			if(this.css.jq.seekBar.length) {
				// Using $(e.currentTarget) to enable multiple seek bars
				var $bar = $(e.currentTarget),
					offset = $bar.offset(),
					x = e.pageX - offset.left,
					w = $bar.width(),
					p = 100 * x / w;
				this.playHead(p);
			}
		},
		playbackRate: function(pbr) {
			this._setOption("playbackRate", pbr);
		},
		playbackRateBar: function(e) { // Handles clicks on the playbackRateBar
			if(this.css.jq.playbackRateBar.length) {
				// Using $(e.currentTarget) to enable multiple playbackRate bars
				var $bar = $(e.currentTarget),
					offset = $bar.offset(),
					x = e.pageX - offset.left,
					w = $bar.width(),
					y = $bar.height() - e.pageY + offset.top,
					h = $bar.height(),
					ratio, pbr;
				if(this.options.verticalPlaybackRate) {
					ratio = y/h;
				} else {
					ratio = x/w;
				}
				pbr = ratio * (this.options.maxPlaybackRate - this.options.minPlaybackRate) + this.options.minPlaybackRate;
				this.playbackRate(pbr);
			}
		},
		_updatePlaybackRate: function() {
			var pbr = this.options.playbackRate,
				ratio = (pbr - this.options.minPlaybackRate) / (this.options.maxPlaybackRate - this.options.minPlaybackRate);
			if(this.status.playbackRateEnabled) {
				if(this.css.jq.playbackRateBar.length) {
					this.css.jq.playbackRateBar.show();
				}
				if(this.css.jq.playbackRateBarValue.length) {
					this.css.jq.playbackRateBarValue.show();
					this.css.jq.playbackRateBarValue[this.options.verticalPlaybackRate ? "height" : "width"]((ratio*100)+"%");
				}
			} else {
				if(this.css.jq.playbackRateBar.length) {
					this.css.jq.playbackRateBar.hide();
				}
				if(this.css.jq.playbackRateBarValue.length) {
					this.css.jq.playbackRateBarValue.hide();
				}
			}
		},
		repeat: function(event) { // Handle clicks on the repeat button
			var guiAction = typeof event === "object"; // Flags GUI click events so we know this was not a direct command, but an action taken by the user on the GUI.
			if(guiAction && this.options.useStateClassSkin && this.options.loop) {
				this._loop(false);
			} else {
				this._loop(true);
			}
		},
		repeatOff: function() { // Handle clicks on the repeatOff button
			this._loop(false);
		},
		_loop: function(loop) {
			if(this.options.loop !== loop) {
				this.options.loop = loop;
				this._updateButtons();
				this._trigger($.jPlayer.event.repeat);
			}
		},

		// Options code adapted from ui.widget.js (1.8.7).  Made changes so the key can use dot notation. To match previous getData solution in jPlayer 1.
		option: function(key, value) {
			var options = key;

			 // Enables use: options().  Returns a copy of options object
			if ( arguments.length === 0 ) {
				return $.extend( true, {}, this.options );
			}

			if(typeof key === "string") {
				var keys = key.split(".");

				 // Enables use: options("someOption")  Returns a copy of the option. Supports dot notation.
				if(value === undefined) {

					var opt = $.extend(true, {}, this.options);
					for(var i = 0; i < keys.length; i++) {
						if(opt[keys[i]] !== undefined) {
							opt = opt[keys[i]];
						} else {
							this._warning( {
								type: $.jPlayer.warning.OPTION_KEY,
								context: key,
								message: $.jPlayer.warningMsg.OPTION_KEY,
								hint: $.jPlayer.warningHint.OPTION_KEY
							});
							return undefined;
						}
					}
					return opt;
				}

				 // Enables use: options("someOptionObject", someObject}).  Creates: {someOptionObject:someObject}
				 // Enables use: options("someOption", someValue).  Creates: {someOption:someValue}
				 // Enables use: options("someOptionObject.someOption", someValue).  Creates: {someOptionObject:{someOption:someValue}}

				options = {};
				var opts = options;

				for(var j = 0; j < keys.length; j++) {
					if(j < keys.length - 1) {
						opts[keys[j]] = {};
						opts = opts[keys[j]];
					} else {
						opts[keys[j]] = value;
					}
				}
			}

			 // Otherwise enables use: options(optionObject).  Uses original object (the key)

			this._setOptions(options);

			return this;
		},
		_setOptions: function(options) {
			var self = this;
			$.each(options, function(key, value) { // This supports the 2 level depth that the options of jPlayer has. Would review if we ever need more depth.
				self._setOption(key, value);
			});

			return this;
		},
		_setOption: function(key, value) {
			var self = this;

			// The ability to set options is limited at this time.

			switch(key) {
				case "volume" :
					this.volume(value);
					break;
				case "muted" :
					this._muted(value);
					break;
				case "globalVolume" :
					this.options[key] = value;
					break;
				case "cssSelectorAncestor" :
					this._cssSelectorAncestor(value); // Set and refresh all associations for the new ancestor.
					break;
				case "cssSelector" :
					$.each(value, function(fn, cssSel) {
						self._cssSelector(fn, cssSel); // NB: The option is set inside this function, after further validity checks.
					});
					break;
				case "playbackRate" :
					this.options[key] = value = this._limitValue(value, this.options.minPlaybackRate, this.options.maxPlaybackRate);
					if(this.html.used) {
						this._html_setProperty('playbackRate', value);
					}
					this._updatePlaybackRate();
					break;
				case "defaultPlaybackRate" :
					this.options[key] = value = this._limitValue(value, this.options.minPlaybackRate, this.options.maxPlaybackRate);
					if(this.html.used) {
						this._html_setProperty('defaultPlaybackRate', value);
					}
					this._updatePlaybackRate();
					break;
				case "minPlaybackRate" :
					this.options[key] = value = this._limitValue(value, 0.1, this.options.maxPlaybackRate - 0.1);
					this._updatePlaybackRate();
					break;
				case "maxPlaybackRate" :
					this.options[key] = value = this._limitValue(value, this.options.minPlaybackRate + 0.1, 16);
					this._updatePlaybackRate();
					break;
				case "fullScreen" :
					if(this.options[key] !== value) { // if changed
						var wkv = $.jPlayer.nativeFeatures.fullscreen.used.webkitVideo;
						if(!wkv || wkv && !this.status.waitForPlay) {
							if(!wkv) { // No sensible way to unset option on these devices.
								this.options[key] = value;
							}
							if(value) {
								this._requestFullscreen();
							} else {
								this._exitFullscreen();
							}
							if(!wkv) {
								this._setOption("fullWindow", value);
							}
						}
					}
					break;
				case "fullWindow" :
					if(this.options[key] !== value) { // if changed
						this._removeUiClass();
						this.options[key] = value;
						this._refreshSize();
					}
					break;
				case "size" :
					if(!this.options.fullWindow && this.options[key].cssClass !== value.cssClass) {
						this._removeUiClass();
					}
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this._refreshSize();
					break;
				case "sizeFull" :
					if(this.options.fullWindow && this.options[key].cssClass !== value.cssClass) {
						this._removeUiClass();
					}
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this._refreshSize();
					break;
				case "autohide" :
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this._updateAutohide();
					break;
				case "loop" :
					this._loop(value);
					break;
				case "remainingDuration" :
					this.options[key] = value;
					this._updateInterface();
					break;
				case "toggleDuration" :
					this.options[key] = value;
					break;
				case "nativeVideoControls" :
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this.status.nativeVideoControls = this._uaBlocklist(this.options.nativeVideoControls);
					this._restrictNativeVideoControls();
					this._updateNativeVideoControls();
					break;
				case "noFullWindow" :
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this.status.nativeVideoControls = this._uaBlocklist(this.options.nativeVideoControls); // Need to check again as noFullWindow can depend on this flag and the restrict() can override it.
					this.status.noFullWindow = this._uaBlocklist(this.options.noFullWindow);
					this._restrictNativeVideoControls();
					this._updateButtons();
					break;
				case "noVolume" :
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					this.status.noVolume = this._uaBlocklist(this.options.noVolume);
					this._updateVolume();
					this._updateMute();
					break;
				case "emulateHtml" :
					if(this.options[key] !== value) { // To avoid multiple event handlers being created, if true already.
						this.options[key] = value;
						if(value) {
							this._emulateHtmlBridge();
						} else {
							this._destroyHtmlBridge();
						}
					}
					break;
				case "timeFormat" :
					this.options[key] = $.extend({}, this.options[key], value); // store a merged copy of it, incase not all properties changed.
					break;
				case "keyEnabled" :
					this.options[key] = value;
					if(!value && this === $.jPlayer.focus) {
						$.jPlayer.focus = null;
					}
					break;
				case "keyBindings" :
					this.options[key] = $.extend(true, {}, this.options[key], value); // store a merged DEEP copy of it, incase not all properties changed.
					break;
				case "audioFullScreen" :
					this.options[key] = value;
					break;
				case "autoBlur" :
					this.options[key] = value;
					break;
			}

			return this;
		},
		// End of: (Options code adapted from ui.widget.js)

		_refreshSize: function() {
			this._setSize(); // update status and jPlayer element size
			this._addUiClass(); // update the ui class
			this._updateSize(); // update internal sizes
			this._updateButtons();
			this._updateAutohide();
			this._trigger($.jPlayer.event.resize);
		},
		_setSize: function() {
			// Determine the current size from the options
			if(this.options.fullWindow) {
				this.status.width = this.options.sizeFull.width;
				this.status.height = this.options.sizeFull.height;
				this.status.cssClass = this.options.sizeFull.cssClass;
			} else {
				this.status.width = this.options.size.width;
				this.status.height = this.options.size.height;
				this.status.cssClass = this.options.size.cssClass;
			}

			// Set the size of the jPlayer area.
			this.element.css({'width': this.status.width, 'height': this.status.height});
		},
		_addUiClass: function() {
			if(this.ancestorJq.length) {
				this.ancestorJq.addClass(this.status.cssClass);
			}
		},
		_removeUiClass: function() {
			if(this.ancestorJq.length) {
				this.ancestorJq.removeClass(this.status.cssClass);
			}
		},
		_updateSize: function() {
			// The poster uses show/hide so can simply resize it.
			this.internal.poster.jq.css({'width': this.status.width, 'height': this.status.height});

			// Video html or flash resized if necessary at this time, or if native video controls being used.
			if(!this.status.waitForPlay && this.html.active && this.status.video || this.html.video.available && this.html.used && this.status.nativeVideoControls) {
				this.internal.video.jq.css({'width': this.status.width, 'height': this.status.height});
			}
			else if(!this.status.waitForPlay && this.flash.active && this.status.video) {
				this.internal.flash.jq.css({'width': this.status.width, 'height': this.status.height});
			}
		},
		_updateAutohide: function() {
			var	self = this,
				event = "mousemove.jPlayer",
				namespace = ".jPlayerAutohide",
				eventType = event + namespace,
				handler = function(event) {
					var moved = false,
						deltaX, deltaY;
					if(typeof self.internal.mouse !== "undefined") {
						//get the change from last position to this position
						deltaX = self.internal.mouse.x - event.pageX;
						deltaY = self.internal.mouse.y - event.pageY;
						moved = (Math.floor(deltaX) > 0) || (Math.floor(deltaY)>0); 
					} else {
						moved = true;
					}
					// store current position for next method execution
					self.internal.mouse = {
							x : event.pageX,
							y : event.pageY
					};
					// if mouse has been actually moved, do the gui fadeIn/fadeOut
					if (moved) {
						self.css.jq.gui.fadeIn(self.options.autohide.fadeIn, function() {
							clearTimeout(self.internal.autohideId);
							self.internal.autohideId = setTimeout( function() {
								self.css.jq.gui.fadeOut(self.options.autohide.fadeOut);
							}, self.options.autohide.hold);
						});
					}
				};

			if(this.css.jq.gui.length) {

				// End animations first so that its callback is executed now.
				// Otherwise an in progress fadeIn animation still has the callback to fadeOut again.
				this.css.jq.gui.stop(true, true);

				// Removes the fadeOut operation from the fadeIn callback.
				clearTimeout(this.internal.autohideId);
				// undefine mouse
				delete this.internal.mouse;

				this.element.unbind(namespace);
				this.css.jq.gui.unbind(namespace);

				if(!this.status.nativeVideoControls) {
					if(this.options.fullWindow && this.options.autohide.full || !this.options.fullWindow && this.options.autohide.restored) {
						this.element.bind(eventType, handler);
						this.css.jq.gui.bind(eventType, handler);
						this.css.jq.gui.hide();
					} else {
						this.css.jq.gui.show();
					}
				} else {
					this.css.jq.gui.hide();
				}
			}
		},
		fullScreen: function(event) {
			var guiAction = typeof event === "object"; // Flags GUI click events so we know this was not a direct command, but an action taken by the user on the GUI.
			if(guiAction && this.options.useStateClassSkin && this.options.fullScreen) {
				this._setOption("fullScreen", false);
			} else {
				this._setOption("fullScreen", true);
			}
		},
		restoreScreen: function() {
			this._setOption("fullScreen", false);
		},
		_fullscreenAddEventListeners: function() {
			var self = this,
				fs = $.jPlayer.nativeFeatures.fullscreen;

			if(fs.api.fullscreenEnabled) {
				if(fs.event.fullscreenchange) {
					// Create the event handler function and store it for removal.
					if(typeof this.internal.fullscreenchangeHandler !== 'function') {
						this.internal.fullscreenchangeHandler = function() {
							self._fullscreenchange();
						};
					}
					document.addEventListener(fs.event.fullscreenchange, this.internal.fullscreenchangeHandler, false);
				}
				// No point creating handler for fullscreenerror.
				// Either logic avoids fullscreen occurring (w3c/moz), or their is no event on the browser (webkit).
			}
		},
		_fullscreenRemoveEventListeners: function() {
			var fs = $.jPlayer.nativeFeatures.fullscreen;
			if(this.internal.fullscreenchangeHandler) {
				document.removeEventListener(fs.event.fullscreenchange, this.internal.fullscreenchangeHandler, false);
			}
		},
		_fullscreenchange: function() {
			// If nothing is fullscreen, then we cannot be in fullscreen mode.
			if(this.options.fullScreen && !$.jPlayer.nativeFeatures.fullscreen.api.fullscreenElement()) {
				this._setOption("fullScreen", false);
			}
		},
		_requestFullscreen: function() {
			// Either the container or the jPlayer div
			var e = this.ancestorJq.length ? this.ancestorJq[0] : this.element[0],
				fs = $.jPlayer.nativeFeatures.fullscreen;

			// This method needs the video element. For iOS and Android.
			if(fs.used.webkitVideo) {
				e = this.htmlElement.video;
			}

			if(fs.api.fullscreenEnabled) {
				fs.api.requestFullscreen(e);
			}
		},
		_exitFullscreen: function() {

			var fs = $.jPlayer.nativeFeatures.fullscreen,
				e;

			// This method needs the video element. For iOS and Android.
			if(fs.used.webkitVideo) {
				e = this.htmlElement.video;
			}

			if(fs.api.fullscreenEnabled) {
				fs.api.exitFullscreen(e);
			}
		},
		_html_initMedia: function(media) {
			// Remove any existing track elements
			var $media = $(this.htmlElement.media).empty();

			// Create any track elements given with the media, as an Array of track Objects.
			$.each(media.track || [], function(i,v) {
				var track = document.createElement('track');
				track.setAttribute("kind", v.kind ? v.kind : "");
				track.setAttribute("src", v.src ? v.src : "");
				track.setAttribute("srclang", v.srclang ? v.srclang : "");
				track.setAttribute("label", v.label ? v.label : "");
				if(v.def) {
					track.setAttribute("default", v.def);
				}
				$media.append(track);
			});

			this.htmlElement.media.src = this.status.src;

			if(this.options.preload !== 'none') {
				this._html_load(); // See function for comments
			}
			this._trigger($.jPlayer.event.timeupdate); // The flash generates this event for its solution.
		},
		_html_setFormat: function(media) {
			var self = this;
			// Always finds a format due to checks in setMedia()
			$.each(this.formats, function(priority, format) {
				if(self.html.support[format] && media[format]) {
					self.status.src = media[format];
					self.status.format[format] = true;
					self.status.formatType = format;
					return false;
				}
			});
		},
		_html_setAudio: function(media) {
			this._html_setFormat(media);
			this.htmlElement.media = this.htmlElement.audio;
			this._html_initMedia(media);
		},
		_html_setVideo: function(media) {
			this._html_setFormat(media);
			if(this.status.nativeVideoControls) {
				this.htmlElement.video.poster = this._validString(media.poster) ? media.poster : "";
			}
			this.htmlElement.media = this.htmlElement.video;
			this._html_initMedia(media);
		},
		_html_resetMedia: function() {
			if(this.htmlElement.media) {
				if(this.htmlElement.media.id === this.internal.video.id && !this.status.nativeVideoControls) {
					this.internal.video.jq.css({'width':'0px', 'height':'0px'});
				}
				this.htmlElement.media.pause();
			}
		},
		_html_clearMedia: function() {
			if(this.htmlElement.media) {
				this.htmlElement.media.src = "about:blank";
				// The following load() is only required for Firefox 3.6 (PowerMacs).
				// Recent HTMl5 browsers only require the src change. Due to changes in W3C spec and load() effect.
				this.htmlElement.media.load(); // Stops an old, "in progress" download from continuing the download. Triggers the loadstart, error and emptied events, due to the empty src. Also an abort event if a download was in progress.
			}
		},
		_html_load: function() {
			// This function remains to allow the early HTML5 browsers to work, such as Firefox 3.6
			// A change in the W3C spec for the media.load() command means that this is no longer necessary.
			// This command should be removed and actually causes minor undesirable effects on some browsers. Such as loading the whole file and not only the metadata.
			if(this.status.waitForLoad) {
				this.status.waitForLoad = false;
				this.htmlElement.media.load();
			}
			clearTimeout(this.internal.htmlDlyCmdId);
		},
		_html_play: function(time) {
			var self = this,
				media = this.htmlElement.media;

			this.androidFix.pause = false; // Cancel the pause fix.

			this._html_load(); // Loads if required and clears any delayed commands.

			// Setup the Android Fix.
			if(this.androidFix.setMedia) {
				this.androidFix.play = true;
				this.androidFix.time = time;

			} else if(!isNaN(time)) {

				// Attempt to play it, since iOS has been ignoring commands
				if(this.internal.cmdsIgnored) {
					media.play();
				}

				try {
					// !media.seekable is for old HTML5 browsers, like Firefox 3.6.
					// Checking seekable.length is important for iOS6 to work with setMedia().play(time)
					if(!media.seekable || typeof media.seekable === "object" && media.seekable.length > 0) {
						media.currentTime = time;
						media.play();
					} else {
						throw 1;
					}
				} catch(err) {
					this.internal.htmlDlyCmdId = setTimeout(function() {
						self.play(time);
					}, 250);
					return; // Cancel execution and wait for the delayed command.
				}
			} else {
				media.play();
			}
			this._html_checkWaitForPlay();
		},
		_html_pause: function(time) {
			var self = this,
				media = this.htmlElement.media;

			this.androidFix.play = false; // Cancel the play fix.

			if(time > 0) { // We do not want the stop() command, which does pause(0), causing a load operation.
				this._html_load(); // Loads if required and clears any delayed commands.
			} else {
				clearTimeout(this.internal.htmlDlyCmdId);
			}

			// Order of these commands is important for Safari (Win) and IE9. Pause then change currentTime.
			media.pause();

			// Setup the Android Fix.
			if(this.androidFix.setMedia) {
				this.androidFix.pause = true;
				this.androidFix.time = time;

			} else if(!isNaN(time)) {
				try {
					if(!media.seekable || typeof media.seekable === "object" && media.seekable.length > 0) {
						media.currentTime = time;
					} else {
						throw 1;
					}
				} catch(err) {
					this.internal.htmlDlyCmdId = setTimeout(function() {
						self.pause(time);
					}, 250);
					return; // Cancel execution and wait for the delayed command.
				}
			}
			if(time > 0) { // Avoids a setMedia() followed by stop() or pause(0) hiding the video play button.
				this._html_checkWaitForPlay();
			}
		},
		_html_playHead: function(percent) {
			var self = this,
				media = this.htmlElement.media;

			this._html_load(); // Loads if required and clears any delayed commands.

			// This playHead() method needs a refactor to apply the android fix.

			try {
				if(typeof media.seekable === "object" && media.seekable.length > 0) {
					media.currentTime = percent * media.seekable.end(media.seekable.length-1) / 100;
				} else if(media.duration > 0 && !isNaN(media.duration)) {
					media.currentTime = percent * media.duration / 100;
				} else {
					throw "e";
				}
			} catch(err) {
				this.internal.htmlDlyCmdId = setTimeout(function() {
					self.playHead(percent);
				}, 250);
				return; // Cancel execution and wait for the delayed command.
			}
			if(!this.status.waitForLoad) {
				this._html_checkWaitForPlay();
			}
		},
		_html_checkWaitForPlay: function() {
			if(this.status.waitForPlay) {
				this.status.waitForPlay = false;
				if(this.css.jq.videoPlay.length) {
					this.css.jq.videoPlay.hide();
				}
				if(this.status.video) {
					this.internal.poster.jq.hide();
					this.internal.video.jq.css({'width': this.status.width, 'height': this.status.height});
				}
			}
		},
		_html_setProperty: function(property, value) {
			if(this.html.audio.available) {
				this.htmlElement.audio[property] = value;
			}
			if(this.html.video.available) {
				this.htmlElement.video[property] = value;
			}
		},
		_aurora_setAudio: function(media) {
			var self = this;            
			
			// Always finds a format due to checks in setMedia()
			$.each(this.formats, function(priority, format) {
				if(self.aurora.support[format] && media[format]) {
					self.status.src = media[format];
					self.status.format[format] = true;
					self.status.formatType = format;
			
					return false;
				}
			});
			
			this.aurora.player = new AV.Player.fromURL(this.status.src);
			this._addAuroraEventListeners(this.aurora.player, this.aurora);

			if(this.options.preload === 'auto') {
				this._aurora_load();
				this.status.waitForLoad = false;
			}
		},
		_aurora_resetMedia: function() {
			if (this.aurora.player) {
				this.aurora.player.stop();
			}
		},
		_aurora_clearMedia: function() {
			// Nothing to clear.
		},
		_aurora_load: function() {
			if(this.status.waitForLoad) {
				this.status.waitForLoad = false;
				this.aurora.player.preload();
			}
		},
		_aurora_play: function(time) {
			if (!this.status.waitForLoad) {
				if (!isNaN(time)) {
					this.aurora.player.seek(time);
				}
			}
			if (!this.aurora.player.playing) {
				this.aurora.player.play();
			}
			this.status.waitForLoad = false;
			this._aurora_checkWaitForPlay();
			
			// No event from the player, update UI now.
			this._updateButtons(true);
			this._trigger($.jPlayer.event.play);
		},
		_aurora_pause: function(time) {
			if (!isNaN(time)) {
				this.aurora.player.seek(time * 1000);
			}
			this.aurora.player.pause();
			
			if(time > 0) { // Avoids a setMedia() followed by stop() or pause(0) hiding the video play button.
				this._aurora_checkWaitForPlay();
			}
			
			// No event from the player, update UI now.
			this._updateButtons(false);
			this._trigger($.jPlayer.event.pause);
		},
		_aurora_playHead: function(percent) {
			if(this.aurora.player.duration > 0) {
				// The seek() sould be in milliseconds, but the only codec that works with seek (aac.js) uses seconds.
				this.aurora.player.seek(percent * this.aurora.player.duration / 100); // Using seconds
			}
				
			if(!this.status.waitForLoad) {
				this._aurora_checkWaitForPlay();
			}
		},
		_aurora_checkWaitForPlay: function() {
			if(this.status.waitForPlay) {
				this.status.waitForPlay = false;
			}
		},
		_aurora_volume: function(v) {
			this.aurora.player.volume = v * 100;
		},
		_aurora_mute: function(m) {
			if (m) {
				this.aurora.properties.lastvolume = this.aurora.player.volume;
				this.aurora.player.volume = 0;
			} else {
				this.aurora.player.volume = this.aurora.properties.lastvolume;
			}
			this.aurora.properties.muted = m;
		},
		_flash_setAudio: function(media) {
			var self = this;
			try {
				// Always finds a format due to checks in setMedia()
				$.each(this.formats, function(priority, format) {
					if(self.flash.support[format] && media[format]) {
						switch (format) {
							case "m4a" :
							case "fla" :
								self._getMovie().fl_setAudio_m4a(media[format]);
								break;
							case "mp3" :
								self._getMovie().fl_setAudio_mp3(media[format]);
								break;
							case "rtmpa":
								self._getMovie().fl_setAudio_rtmp(media[format]);
								break;
						}
						self.status.src = media[format];
						self.status.format[format] = true;
						self.status.formatType = format;
						return false;
					}
				});

				if(this.options.preload === 'auto') {
					this._flash_load();
					this.status.waitForLoad = false;
				}
			} catch(err) { this._flashError(err); }
		},
		_flash_setVideo: function(media) {
			var self = this;
			try {
				// Always finds a format due to checks in setMedia()
				$.each(this.formats, function(priority, format) {
					if(self.flash.support[format] && media[format]) {
						switch (format) {
							case "m4v" :
							case "flv" :
								self._getMovie().fl_setVideo_m4v(media[format]);
								break;
							case "rtmpv":
								self._getMovie().fl_setVideo_rtmp(media[format]);
								break;		
						}
						self.status.src = media[format];
						self.status.format[format] = true;
						self.status.formatType = format;
						return false;
					}
				});

				if(this.options.preload === 'auto') {
					this._flash_load();
					this.status.waitForLoad = false;
				}
			} catch(err) { this._flashError(err); }
		},
		_flash_resetMedia: function() {
			this.internal.flash.jq.css({'width':'0px', 'height':'0px'}); // Must do via CSS as setting attr() to zero causes a jQuery error in IE.
			this._flash_pause(NaN);
		},
		_flash_clearMedia: function() {
			try {
				this._getMovie().fl_clearMedia();
			} catch(err) { this._flashError(err); }
		},
		_flash_load: function() {
			try {
				this._getMovie().fl_load();
			} catch(err) { this._flashError(err); }
			this.status.waitForLoad = false;
		},
		_flash_play: function(time) {
			try {
				this._getMovie().fl_play(time);
			} catch(err) { this._flashError(err); }
			this.status.waitForLoad = false;
			this._flash_checkWaitForPlay();
		},
		_flash_pause: function(time) {
			try {
				this._getMovie().fl_pause(time);
			} catch(err) { this._flashError(err); }
			if(time > 0) { // Avoids a setMedia() followed by stop() or pause(0) hiding the video play button.
				this.status.waitForLoad = false;
				this._flash_checkWaitForPlay();
			}
		},
		_flash_playHead: function(p) {
			try {
				this._getMovie().fl_play_head(p);
			} catch(err) { this._flashError(err); }
			if(!this.status.waitForLoad) {
				this._flash_checkWaitForPlay();
			}
		},
		_flash_checkWaitForPlay: function() {
			if(this.status.waitForPlay) {
				this.status.waitForPlay = false;
				if(this.css.jq.videoPlay.length) {
					this.css.jq.videoPlay.hide();
				}
				if(this.status.video) {
					this.internal.poster.jq.hide();
					this.internal.flash.jq.css({'width': this.status.width, 'height': this.status.height});
				}
			}
		},
		_flash_volume: function(v) {
			try {
				this._getMovie().fl_volume(v);
			} catch(err) { this._flashError(err); }
		},
		_flash_mute: function(m) {
			try {
				this._getMovie().fl_mute(m);
			} catch(err) { this._flashError(err); }
		},
		_getMovie: function() {
			return document[this.internal.flash.id];
		},
		_getFlashPluginVersion: function() {

			// _getFlashPluginVersion() code influenced by:
			// - FlashReplace 1.01: http://code.google.com/p/flashreplace/
			// - SWFObject 2.2: http://code.google.com/p/swfobject/

			var version = 0,
				flash;
			if(window.ActiveXObject) {
				try {
					flash = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
					if (flash) { // flash will return null when ActiveX is disabled
						var v = flash.GetVariable("$version");
						if(v) {
							v = v.split(" ")[1].split(",");
							version = parseInt(v[0], 10) + "." + parseInt(v[1], 10);
						}
					}
				} catch(e) {}
			}
			else if(navigator.plugins && navigator.mimeTypes.length > 0) {
				flash = navigator.plugins["Shockwave Flash"];
				if(flash) {
					version = navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/, "$1");
				}
			}
			return version * 1; // Converts to a number
		},
		_checkForFlash: function (version) {
			var flashOk = false;
			if(this._getFlashPluginVersion() >= version) {
				flashOk = true;
			}
			return flashOk;
		},
		_validString: function(url) {
			return (url && typeof url === "string"); // Empty strings return false
		},
		_limitValue: function(value, min, max) {
			return (value < min) ? min : ((value > max) ? max : value);
		},
		_urlNotSetError: function(context) {
			this._error( {
				type: $.jPlayer.error.URL_NOT_SET,
				context: context,
				message: $.jPlayer.errorMsg.URL_NOT_SET,
				hint: $.jPlayer.errorHint.URL_NOT_SET
			});
		},
		_flashError: function(error) {
			var errorType;
			if(!this.internal.ready) {
				errorType = "FLASH";
			} else {
				errorType = "FLASH_DISABLED";
			}
			this._error( {
				type: $.jPlayer.error[errorType],
				context: this.internal.flash.swf,
				message: $.jPlayer.errorMsg[errorType] + error.message,
				hint: $.jPlayer.errorHint[errorType]
			});
			// Allow the audio player to recover if display:none and then shown again, or with position:fixed on Firefox.
			// This really only affects audio in a media player, as an audio player could easily move the jPlayer element away from such issues.
			this.internal.flash.jq.css({'width':'1px', 'height':'1px'});
		},
		_error: function(error) {
			this._trigger($.jPlayer.event.error, error);
			if(this.options.errorAlerts) {
				this._alert("Error!" + (error.message ? "\n" + error.message : "") + (error.hint ? "\n" + error.hint : "") + "\nContext: " + error.context);
			}
		},
		_warning: function(warning) {
			this._trigger($.jPlayer.event.warning, undefined, warning);
			if(this.options.warningAlerts) {
				this._alert("Warning!" + (warning.message ? "\n" + warning.message : "") + (warning.hint ? "\n" + warning.hint : "") + "\nContext: " + warning.context);
			}
		},
		_alert: function(message) {
			var msg = "jPlayer " + this.version.script + " : id='" + this.internal.self.id +"' : " + message;
			if(!this.options.consoleAlerts) {
				alert(msg);
			} else if(window.console && window.console.log) {
				window.console.log(msg);
			}
		},
		_emulateHtmlBridge: function() {
			var self = this;

			// Emulate methods on jPlayer's DOM element.
			$.each( $.jPlayer.emulateMethods.split(/\s+/g), function(i, name) {
				self.internal.domNode[name] = function(arg) {
					self[name](arg);
				};

			});

			// Bubble jPlayer events to its DOM element.
			$.each($.jPlayer.event, function(eventName,eventType) {
				var nativeEvent = true;
				$.each( $.jPlayer.reservedEvent.split(/\s+/g), function(i, name) {
					if(name === eventName) {
						nativeEvent = false;
						return false;
					}
				});
				if(nativeEvent) {
					self.element.bind(eventType + ".jPlayer.jPlayerHtml", function() { // With .jPlayer & .jPlayerHtml namespaces.
						self._emulateHtmlUpdate();
						var domEvent = document.createEvent("Event");
						domEvent.initEvent(eventName, false, true);
						self.internal.domNode.dispatchEvent(domEvent);
					});
				}
				// The error event would require a special case
			});

			// IE9 has a readyState property on all elements. The document should have it, but all (except media) elements inherit it in IE9. This conflicts with Popcorn, which polls the readyState.
		},
		_emulateHtmlUpdate: function() {
			var self = this;

			$.each( $.jPlayer.emulateStatus.split(/\s+/g), function(i, name) {
				self.internal.domNode[name] = self.status[name];
			});
			$.each( $.jPlayer.emulateOptions.split(/\s+/g), function(i, name) {
				self.internal.domNode[name] = self.options[name];
			});
		},
		_destroyHtmlBridge: function() {
			var self = this;

			// Bridge event handlers are also removed by destroy() through .jPlayer namespace.
			this.element.unbind(".jPlayerHtml"); // Remove all event handlers created by the jPlayer bridge. So you can change the emulateHtml option.

			// Remove the methods and properties
			var emulated = $.jPlayer.emulateMethods + " " + $.jPlayer.emulateStatus + " " + $.jPlayer.emulateOptions;
			$.each( emulated.split(/\s+/g), function(i, name) {
				delete self.internal.domNode[name];
			});
		}
	};

	$.jPlayer.error = {
		FLASH: "e_flash",
		FLASH_DISABLED: "e_flash_disabled",
		NO_SOLUTION: "e_no_solution",
		NO_SUPPORT: "e_no_support",
		URL: "e_url",
		URL_NOT_SET: "e_url_not_set",
		VERSION: "e_version"
	};

	$.jPlayer.errorMsg = {
		FLASH: "jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ", // Used in: _flashError()
		FLASH_DISABLED: "jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ", // Used in: _flashError()
		NO_SOLUTION: "No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.", // Used in: _init()
		NO_SUPPORT: "It is not possible to play any media format provided in setMedia() on this browser using your current options.", // Used in: setMedia()
		URL: "Media URL could not be loaded.", // Used in: jPlayerFlashEvent() and _addHtmlEventListeners()
		URL_NOT_SET: "Attempt to issue media playback commands, while no media url is set.", // Used in: load(), play(), pause(), stop() and playHead()
		VERSION: "jPlayer " + $.jPlayer.prototype.version.script + " needs Jplayer.swf version " + $.jPlayer.prototype.version.needFlash + " but found " // Used in: jPlayerReady()
	};

	$.jPlayer.errorHint = {
		FLASH: "Check your swfPath option and that Jplayer.swf is there.",
		FLASH_DISABLED: "Check that you have not display:none; the jPlayer entity or any ancestor.",
		NO_SOLUTION: "Review the jPlayer options: support and supplied.",
		NO_SUPPORT: "Video or audio formats defined in the supplied option are missing.",
		URL: "Check media URL is valid.",
		URL_NOT_SET: "Use setMedia() to set the media URL.",
		VERSION: "Update jPlayer files."
	};

	$.jPlayer.warning = {
		CSS_SELECTOR_COUNT: "e_css_selector_count",
		CSS_SELECTOR_METHOD: "e_css_selector_method",
		CSS_SELECTOR_STRING: "e_css_selector_string",
		OPTION_KEY: "e_option_key"
	};

	$.jPlayer.warningMsg = {
		CSS_SELECTOR_COUNT: "The number of css selectors found did not equal one: ",
		CSS_SELECTOR_METHOD: "The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",
		CSS_SELECTOR_STRING: "The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",
		OPTION_KEY: "The option requested in jPlayer('option') is undefined."
	};

	$.jPlayer.warningHint = {
		CSS_SELECTOR_COUNT: "Check your css selector and the ancestor.",
		CSS_SELECTOR_METHOD: "Check your method name.",
		CSS_SELECTOR_STRING: "Check your css selector is a string.",
		OPTION_KEY: "Check your option name."
	};
}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJqcXVlcnkuanBsYXllci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBqUGxheWVyIFBsdWdpbiBmb3IgalF1ZXJ5IEphdmFTY3JpcHQgTGlicmFyeVxyXG4gKiBodHRwOi8vd3d3LmpwbGF5ZXIub3JnXHJcbiAqXHJcbiAqIENvcHlyaWdodCAoYykgMjAwOSAtIDIwMTQgSGFwcHl3b3JtIEx0ZFxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXHJcbiAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcclxuICpcclxuICogQXV0aG9yOiBNYXJrIEogUGFuYWdoaXN0b25cclxuICogVmVyc2lvbjogMi45LjJcclxuICogRGF0ZTogMTR0aCBEZWNlbWJlciAyMDE0XHJcbiAqL1xyXG5cclxuLyogU3VwcG9ydCBmb3IgWmVwdG8gMS4wIGNvbXBpbGVkIHdpdGggb3B0aW9uYWwgZGF0YSBtb2R1bGUuXHJcbiAqIEZvciBBTUQgb3IgTk9ERS9Db21tb25KUyBzdXBwb3J0LCB5b3Ugd2lsbCBuZWVkIHRvIG1hbnVhbGx5IHN3aXRjaCB0aGUgcmVsYXRlZCAyIGxpbmVzIGluIHRoZSBjb2RlIGJlbG93LlxyXG4gKiBTZWFyY2ggdGVybXM6IFwialF1ZXJ5IFN3aXRjaFwiIGFuZCBcIlplcHRvIFN3aXRjaFwiXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XHJcblx0aWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxyXG5cdFx0ZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpOyAvLyBqUXVlcnkgU3dpdGNoXHJcblx0XHQvLyBkZWZpbmUoWyd6ZXB0byddLCBmYWN0b3J5KTsgLy8gWmVwdG8gU3dpdGNoXHJcblx0fSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuXHRcdC8vIE5vZGUvQ29tbW9uSlNcclxuXHRcdGZhY3RvcnkocmVxdWlyZSgnanF1ZXJ5JykpOyAvLyBqUXVlcnkgU3dpdGNoXHJcblx0XHQvL2ZhY3RvcnkocmVxdWlyZSgnemVwdG8nKSk7IC8vIFplcHRvIFN3aXRjaFxyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcclxuXHRcdGlmKHJvb3QualF1ZXJ5KSB7IC8vIFVzZSBqUXVlcnkgaWYgYXZhaWxhYmxlXHJcblx0XHRcdGZhY3Rvcnkocm9vdC5qUXVlcnkpO1xyXG5cdFx0fSBlbHNlIHsgLy8gT3RoZXJ3aXNlLCB1c2UgWmVwdG9cclxuXHRcdFx0ZmFjdG9yeShyb290LlplcHRvKTtcclxuXHRcdH1cclxuXHR9XHJcbn0odGhpcywgZnVuY3Rpb24gKCQsIHVuZGVmaW5lZCkge1xyXG5cclxuXHQvLyBBZGFwdGVkIGZyb20ganF1ZXJ5LnVpLndpZGdldC5qcyAoMS44LjcpOiAkLndpZGdldC5icmlkZ2UgLSBUd2Vha2VkICQuZGF0YSh0aGlzLFhZWikgdG8gJCh0aGlzKS5kYXRhKFhZWikgZm9yIFplcHRvXHJcblx0JC5mbi5qUGxheWVyID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7XHJcblx0XHR2YXIgbmFtZSA9IFwialBsYXllclwiO1xyXG5cdFx0dmFyIGlzTWV0aG9kQ2FsbCA9IHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiLFxyXG5cdFx0XHRhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApLFxyXG5cdFx0XHRyZXR1cm5WYWx1ZSA9IHRoaXM7XHJcblxyXG5cdFx0Ly8gYWxsb3cgbXVsdGlwbGUgaGFzaGVzIHRvIGJlIHBhc3NlZCBvbiBpbml0XHJcblx0XHRvcHRpb25zID0gIWlzTWV0aG9kQ2FsbCAmJiBhcmdzLmxlbmd0aCA/XHJcblx0XHRcdCQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIHRydWUsIG9wdGlvbnMgXS5jb25jYXQoYXJncykgKSA6XHJcblx0XHRcdG9wdGlvbnM7XHJcblxyXG5cdFx0Ly8gcHJldmVudCBjYWxscyB0byBpbnRlcm5hbCBtZXRob2RzXHJcblx0XHRpZiAoIGlzTWV0aG9kQ2FsbCAmJiBvcHRpb25zLmNoYXJBdCggMCApID09PSBcIl9cIiApIHtcclxuXHRcdFx0cmV0dXJuIHJldHVyblZhbHVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggaXNNZXRob2RDYWxsICkge1xyXG5cdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJCh0aGlzKS5kYXRhKCBuYW1lICksXHJcblx0XHRcdFx0XHRtZXRob2RWYWx1ZSA9IGluc3RhbmNlICYmICQuaXNGdW5jdGlvbiggaW5zdGFuY2Vbb3B0aW9uc10gKSA/XHJcblx0XHRcdFx0XHRcdGluc3RhbmNlWyBvcHRpb25zIF0uYXBwbHkoIGluc3RhbmNlLCBhcmdzICkgOlxyXG5cdFx0XHRcdFx0XHRpbnN0YW5jZTtcclxuXHRcdFx0XHRpZiAoIG1ldGhvZFZhbHVlICE9PSBpbnN0YW5jZSAmJiBtZXRob2RWYWx1ZSAhPT0gdW5kZWZpbmVkICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBtZXRob2RWYWx1ZTtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQodGhpcykuZGF0YSggbmFtZSApO1xyXG5cdFx0XHRcdGlmICggaW5zdGFuY2UgKSB7XHJcblx0XHRcdFx0XHQvLyBpbnN0YW5jZS5vcHRpb24oIG9wdGlvbnMgfHwge30gKS5faW5pdCgpOyAvLyBPcmlnIGpxdWVyeS51aS53aWRnZXQuanMgY29kZTogTm90IHJlY29tbWVuZCBmb3IgalBsYXllci4gaWUuLCBBcHBseWluZyBuZXcgb3B0aW9ucyB0byBhbiBleGlzdGluZyBpbnN0YW5jZSAodmlhIHRoZSBqUGxheWVyIGNvbnN0cnVjdG9yKSBhbmQgcGVyZm9ybWluZyB0aGUgX2luaXQoKS4gVGhlIF9pbml0KCkgaXMgd2hhdCBjb25jZXJucyBtZS4gSXQgd291bGQgbGVhdmUgYSBsb3Qgb2YgZXZlbnQgaGFuZGxlcnMgYWN0aW5nIG9uIGpQbGF5ZXIgaW5zdGFuY2UgYW5kIHRoZSBpbnRlcmZhY2UuXHJcblx0XHRcdFx0XHRpbnN0YW5jZS5vcHRpb24oIG9wdGlvbnMgfHwge30gKTsgLy8gVGhlIG5ldyBjb25zdHJ1Y3RvciBvbmx5IGNoYW5nZXMgdGhlIG9wdGlvbnMuIENoYW5naW5nIG9wdGlvbnMgb25seSBoYXMgYmFzaWMgc3VwcG9ydCBhdG0uXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQodGhpcykuZGF0YSggbmFtZSwgbmV3ICQualBsYXllciggb3B0aW9ucywgdGhpcyApICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XHJcblx0fTtcclxuXHJcblx0JC5qUGxheWVyID0gZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XHJcblx0XHQvLyBhbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgaW5pdGlhbGl6aW5nIGZvciBzaW1wbGUgaW5oZXJpdGFuY2VcclxuXHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcclxuXHRcdFx0dGhpcy5lbGVtZW50ID0gJChlbGVtZW50KTtcclxuXHRcdFx0dGhpcy5vcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sXHJcblx0XHRcdFx0dGhpcy5vcHRpb25zLFxyXG5cdFx0XHRcdG9wdGlvbnNcclxuXHRcdFx0KTtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHR0aGlzLmVsZW1lbnQuYmluZCggXCJyZW1vdmUualBsYXllclwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzZWxmLmRlc3Ryb3koKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdHRoaXMuX2luaXQoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdC8vIEVuZCBvZjogKEFkYXB0ZWQgZnJvbSBqcXVlcnkudWkud2lkZ2V0LmpzICgxLjguNykpXHJcblxyXG5cdC8vIFplcHRvIGlzIG1pc3Npbmcgb25lIG9mIHRoZSBhbmltYXRpb24gbWV0aG9kcy5cclxuXHRpZih0eXBlb2YgJC5mbi5zdG9wICE9PSAnZnVuY3Rpb24nKSB7XHJcblx0XHQkLmZuLnN0b3AgPSBmdW5jdGlvbigpIHt9O1xyXG5cdH1cclxuXHJcblx0Ly8gRW11bGF0ZWQgSFRNTDUgbWV0aG9kcyBhbmQgcHJvcGVydGllc1xyXG5cdCQualBsYXllci5lbXVsYXRlTWV0aG9kcyA9IFwibG9hZCBwbGF5IHBhdXNlXCI7XHJcblx0JC5qUGxheWVyLmVtdWxhdGVTdGF0dXMgPSBcInNyYyByZWFkeVN0YXRlIG5ldHdvcmtTdGF0ZSBjdXJyZW50VGltZSBkdXJhdGlvbiBwYXVzZWQgZW5kZWQgcGxheWJhY2tSYXRlXCI7XHJcblx0JC5qUGxheWVyLmVtdWxhdGVPcHRpb25zID0gXCJtdXRlZCB2b2x1bWVcIjtcclxuXHJcblx0Ly8gUmVzZXJ2ZWQgZXZlbnQgbmFtZXMgZ2VuZXJhdGVkIGJ5IGpQbGF5ZXIgdGhhdCBhcmUgbm90IHBhcnQgb2YgdGhlIEhUTUw1IE1lZGlhIGVsZW1lbnQgc3BlY1xyXG5cdCQualBsYXllci5yZXNlcnZlZEV2ZW50ID0gXCJyZWFkeSBmbGFzaHJlc2V0IHJlc2l6ZSByZXBlYXQgZXJyb3Igd2FybmluZ1wiO1xyXG5cclxuXHQvLyBFdmVudHMgZ2VuZXJhdGVkIGJ5IGpQbGF5ZXJcclxuXHQkLmpQbGF5ZXIuZXZlbnQgPSB7fTtcclxuXHQkLmVhY2goXHJcblx0XHRbXHJcblx0XHRcdCdyZWFkeScsXHJcblx0XHRcdCdzZXRtZWRpYScsIC8vIEZpcmVzIHdoZW4gdGhlIG1lZGlhIGlzIHNldFxyXG5cdFx0XHQnZmxhc2hyZXNldCcsIC8vIFNpbWlsYXIgdG8gdGhlIHJlYWR5IGV2ZW50IGlmIHRoZSBGbGFzaCBzb2x1dGlvbiBpcyBzZXQgdG8gZGlzcGxheTpub25lIGFuZCB0aGVuIHNob3duIGFnYWluIG9yIGlmIGl0J3MgcmVsb2FkZWQgZm9yIGFub3RoZXIgcmVhc29uIGJ5IHRoZSBicm93c2VyLiBGb3IgZXhhbXBsZSwgdXNpbmcgQ1NTIHBvc2l0aW9uOmZpeGVkIG9uIEZpcmVmb3ggZm9yIHRoZSBmdWxsIHNjcmVlbiBmZWF0dXJlLlxyXG5cdFx0XHQncmVzaXplJywgLy8gT2NjdXJzIHdoZW4gdGhlIHNpemUgY2hhbmdlcyB0aHJvdWdoIGEgZnVsbC9yZXN0b3JlIHNjcmVlbiBvcGVyYXRpb24gb3IgaWYgdGhlIHNpemUvc2l6ZUZ1bGwgb3B0aW9ucyBhcmUgY2hhbmdlZC5cclxuXHRcdFx0J3JlcGVhdCcsIC8vIE9jY3VycyB3aGVuIHRoZSByZXBlYXQgc3RhdHVzIGNoYW5nZXMuIFVzdWFsbHkgdGhyb3VnaCBjbGlja3Mgb24gdGhlIHJlcGVhdCBidXR0b24gb2YgdGhlIGludGVyZmFjZS5cclxuXHRcdFx0J2NsaWNrJywgLy8gT2NjdXJzIHdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIG9uZSBvZiB0aGUgZm9sbG93aW5nOiBwb3N0ZXIgaW1hZ2UsIGh0bWwgdmlkZW8sIGZsYXNoIHZpZGVvLlxyXG5cdFx0XHQnZXJyb3InLCAvLyBFdmVudCBlcnJvciBjb2RlIGluIGV2ZW50LmpQbGF5ZXIuZXJyb3IudHlwZS4gU2VlICQualBsYXllci5lcnJvclxyXG5cdFx0XHQnd2FybmluZycsIC8vIEV2ZW50IHdhcm5pbmcgY29kZSBpbiBldmVudC5qUGxheWVyLndhcm5pbmcudHlwZS4gU2VlICQualBsYXllci53YXJuaW5nXHJcblxyXG5cdFx0XHQvLyBPdGhlciBldmVudHMgbWF0Y2ggSFRNTDUgc3BlYy5cclxuXHRcdFx0J2xvYWRzdGFydCcsXHJcblx0XHRcdCdwcm9ncmVzcycsXHJcblx0XHRcdCdzdXNwZW5kJyxcclxuXHRcdFx0J2Fib3J0JyxcclxuXHRcdFx0J2VtcHRpZWQnLFxyXG5cdFx0XHQnc3RhbGxlZCcsXHJcblx0XHRcdCdwbGF5JyxcclxuXHRcdFx0J3BhdXNlJyxcclxuXHRcdFx0J2xvYWRlZG1ldGFkYXRhJyxcclxuXHRcdFx0J2xvYWRlZGRhdGEnLFxyXG5cdFx0XHQnd2FpdGluZycsXHJcblx0XHRcdCdwbGF5aW5nJyxcclxuXHRcdFx0J2NhbnBsYXknLFxyXG5cdFx0XHQnY2FucGxheXRocm91Z2gnLFxyXG5cdFx0XHQnc2Vla2luZycsXHJcblx0XHRcdCdzZWVrZWQnLFxyXG5cdFx0XHQndGltZXVwZGF0ZScsXHJcblx0XHRcdCdlbmRlZCcsXHJcblx0XHRcdCdyYXRlY2hhbmdlJyxcclxuXHRcdFx0J2R1cmF0aW9uY2hhbmdlJyxcclxuXHRcdFx0J3ZvbHVtZWNoYW5nZSdcclxuXHRcdF0sXHJcblx0XHRmdW5jdGlvbigpIHtcclxuXHRcdFx0JC5qUGxheWVyLmV2ZW50WyB0aGlzIF0gPSAnalBsYXllcl8nICsgdGhpcztcclxuXHRcdH1cclxuXHQpO1xyXG5cclxuXHQkLmpQbGF5ZXIuaHRtbEV2ZW50ID0gWyAvLyBUaGVzZSBIVE1MIGV2ZW50cyBhcmUgYnViYmxlZCB0aHJvdWdoIHRvIHRoZSBqUGxheWVyIGV2ZW50LCB3aXRob3V0IGFueSBpbnRlcm5hbCBhY3Rpb24uXHJcblx0XHRcImxvYWRzdGFydFwiLFxyXG5cdFx0Ly8gXCJwcm9ncmVzc1wiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcInN1c3BlbmRcIiwgLy8galBsYXllciB1c2VzIGludGVybmFsbHkgYmVmb3JlIGJ1YmJsaW5nLlxyXG5cdFx0XCJhYm9ydFwiLFxyXG5cdFx0Ly8gXCJlcnJvclwiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHRcImVtcHRpZWRcIixcclxuXHRcdFwic3RhbGxlZFwiLFxyXG5cdFx0Ly8gXCJwbGF5XCIsIC8vIGpQbGF5ZXIgdXNlcyBpbnRlcm5hbGx5IGJlZm9yZSBidWJibGluZy5cclxuXHRcdC8vIFwicGF1c2VcIiwgLy8galBsYXllciB1c2VzIGludGVybmFsbHkgYmVmb3JlIGJ1YmJsaW5nLlxyXG5cdFx0XCJsb2FkZWRtZXRhZGF0YVwiLFxyXG5cdFx0Ly8gXCJsb2FkZWRkYXRhXCIsIC8vIGpQbGF5ZXIgdXNlcyBpbnRlcm5hbGx5IGJlZm9yZSBidWJibGluZy5cclxuXHRcdC8vIFwid2FpdGluZ1wiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcInBsYXlpbmdcIiwgLy8galBsYXllciB1c2VzIGludGVybmFsbHkgYmVmb3JlIGJ1YmJsaW5nLlxyXG5cdFx0XCJjYW5wbGF5XCIsXHJcblx0XHRcImNhbnBsYXl0aHJvdWdoXCJcclxuXHRcdC8vIFwic2Vla2luZ1wiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcInNlZWtlZFwiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcInRpbWV1cGRhdGVcIiwgLy8galBsYXllciB1c2VzIGludGVybmFsbHkgYmVmb3JlIGJ1YmJsaW5nLlxyXG5cdFx0Ly8gXCJlbmRlZFwiLCAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcInJhdGVjaGFuZ2VcIiAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XHQvLyBcImR1cmF0aW9uY2hhbmdlXCIgLy8galBsYXllciB1c2VzIGludGVybmFsbHkgYmVmb3JlIGJ1YmJsaW5nLlxyXG5cdFx0Ly8gXCJ2b2x1bWVjaGFuZ2VcIiAvLyBqUGxheWVyIHVzZXMgaW50ZXJuYWxseSBiZWZvcmUgYnViYmxpbmcuXHJcblx0XTtcclxuXHJcblx0JC5qUGxheWVyLnBhdXNlID0gZnVuY3Rpb24oKSB7XHJcblx0XHQkLmpQbGF5ZXIucHJvdG90eXBlLmRlc3Ryb3lSZW1vdmVkKCk7XHJcblx0XHQkLmVhY2goJC5qUGxheWVyLnByb3RvdHlwZS5pbnN0YW5jZXMsIGZ1bmN0aW9uKGksIGVsZW1lbnQpIHtcclxuXHRcdFx0aWYoZWxlbWVudC5kYXRhKFwialBsYXllclwiKS5zdGF0dXMuc3JjU2V0KSB7IC8vIENoZWNrIHRoYXQgbWVkaWEgaXMgc2V0IG90aGVyd2lzZSB3b3VsZCBjYXVzZSBlcnJvciBldmVudC5cclxuXHRcdFx0XHRlbGVtZW50LmpQbGF5ZXIoXCJwYXVzZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0Ly8gRGVmYXVsdCBmb3IgalBsYXllciBvcHRpb24udGltZUZvcm1hdFxyXG5cdCQualBsYXllci50aW1lRm9ybWF0ID0ge1xyXG5cdFx0c2hvd0hvdXI6IGZhbHNlLFxyXG5cdFx0c2hvd01pbjogdHJ1ZSxcclxuXHRcdHNob3dTZWM6IHRydWUsXHJcblx0XHRwYWRIb3VyOiBmYWxzZSxcclxuXHRcdHBhZE1pbjogdHJ1ZSxcclxuXHRcdHBhZFNlYzogdHJ1ZSxcclxuXHRcdHNlcEhvdXI6IFwiOlwiLFxyXG5cdFx0c2VwTWluOiBcIjpcIixcclxuXHRcdHNlcFNlYzogXCJcIlxyXG5cdH07XHJcblx0dmFyIENvbnZlcnRUaW1lID0gZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmluaXQoKTtcclxuXHR9O1xyXG5cdENvbnZlcnRUaW1lLnByb3RvdHlwZSA9IHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR0aGlzLm9wdGlvbnMgPSB7XHJcblx0XHRcdFx0dGltZUZvcm1hdDogJC5qUGxheWVyLnRpbWVGb3JtYXRcclxuXHRcdFx0fTtcclxuXHRcdH0sXHJcblx0XHR0aW1lOiBmdW5jdGlvbihzKSB7IC8vIGZ1bmN0aW9uIHVzZWQgb24galBsYXllci5wcm90b3R5cGUuX2NvbnZlcnRUaW1lIHRvIGVuYWJsZSBwZXIgaW5zdGFuY2Ugb3B0aW9ucy5cclxuXHRcdFx0cyA9IChzICYmIHR5cGVvZiBzID09PSAnbnVtYmVyJykgPyBzIDogMDtcclxuXHJcblx0XHRcdHZhciBteVRpbWUgPSBuZXcgRGF0ZShzICogMTAwMCksXHJcblx0XHRcdFx0aG91ciA9IG15VGltZS5nZXRVVENIb3VycygpLFxyXG5cdFx0XHRcdG1pbiA9IHRoaXMub3B0aW9ucy50aW1lRm9ybWF0LnNob3dIb3VyID8gbXlUaW1lLmdldFVUQ01pbnV0ZXMoKSA6IG15VGltZS5nZXRVVENNaW51dGVzKCkgKyBob3VyICogNjAsXHJcblx0XHRcdFx0c2VjID0gdGhpcy5vcHRpb25zLnRpbWVGb3JtYXQuc2hvd01pbiA/IG15VGltZS5nZXRVVENTZWNvbmRzKCkgOiBteVRpbWUuZ2V0VVRDU2Vjb25kcygpICsgbWluICogNjAsXHJcblx0XHRcdFx0c3RySG91ciA9ICh0aGlzLm9wdGlvbnMudGltZUZvcm1hdC5wYWRIb3VyICYmIGhvdXIgPCAxMCkgPyBcIjBcIiArIGhvdXIgOiBob3VyLFxyXG5cdFx0XHRcdHN0ck1pbiA9ICh0aGlzLm9wdGlvbnMudGltZUZvcm1hdC5wYWRNaW4gJiYgbWluIDwgMTApID8gXCIwXCIgKyBtaW4gOiBtaW4sXHJcblx0XHRcdFx0c3RyU2VjID0gKHRoaXMub3B0aW9ucy50aW1lRm9ybWF0LnBhZFNlYyAmJiBzZWMgPCAxMCkgPyBcIjBcIiArIHNlYyA6IHNlYyxcclxuXHRcdFx0XHRzdHJUaW1lID0gXCJcIjtcclxuXHJcblx0XHRcdHN0clRpbWUgKz0gdGhpcy5vcHRpb25zLnRpbWVGb3JtYXQuc2hvd0hvdXIgPyBzdHJIb3VyICsgdGhpcy5vcHRpb25zLnRpbWVGb3JtYXQuc2VwSG91ciA6IFwiXCI7XHJcblx0XHRcdHN0clRpbWUgKz0gdGhpcy5vcHRpb25zLnRpbWVGb3JtYXQuc2hvd01pbiA/IHN0ck1pbiArIHRoaXMub3B0aW9ucy50aW1lRm9ybWF0LnNlcE1pbiA6IFwiXCI7XHJcblx0XHRcdHN0clRpbWUgKz0gdGhpcy5vcHRpb25zLnRpbWVGb3JtYXQuc2hvd1NlYyA/IHN0clNlYyArIHRoaXMub3B0aW9ucy50aW1lRm9ybWF0LnNlcFNlYyA6IFwiXCI7XHJcblxyXG5cdFx0XHRyZXR1cm4gc3RyVGltZTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdHZhciBteUNvbnZlcnRUaW1lID0gbmV3IENvbnZlcnRUaW1lKCk7XHJcblx0JC5qUGxheWVyLmNvbnZlcnRUaW1lID0gZnVuY3Rpb24ocykge1xyXG5cdFx0cmV0dXJuIG15Q29udmVydFRpbWUudGltZShzKTtcclxuXHR9O1xyXG5cclxuXHQvLyBBZGFwdGluZyBqUXVlcnkgMS40LjQgY29kZSBmb3IgalF1ZXJ5LmJyb3dzZXIuIFJlcXVpcmVkIHNpbmNlIGpRdWVyeSAxLjMuMiBkb2VzIG5vdCBkZXRlY3QgQ2hyb21lIGFzIHdlYmtpdC5cclxuXHQkLmpQbGF5ZXIudWFCcm93c2VyID0gZnVuY3Rpb24oIHVzZXJBZ2VudCApIHtcclxuXHRcdHZhciB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xyXG5cclxuXHRcdC8vIFVzZXJhZ2VudCBSZWdFeHBcclxuXHRcdHZhciByd2Via2l0ID0gLyh3ZWJraXQpWyBcXC9dKFtcXHcuXSspLztcclxuXHRcdHZhciByb3BlcmEgPSAvKG9wZXJhKSg/Oi4qdmVyc2lvbik/WyBcXC9dKFtcXHcuXSspLztcclxuXHRcdHZhciBybXNpZSA9IC8obXNpZSkgKFtcXHcuXSspLztcclxuXHRcdHZhciBybW96aWxsYSA9IC8obW96aWxsYSkoPzouKj8gcnY6KFtcXHcuXSspKT8vO1xyXG5cclxuXHRcdHZhciBtYXRjaCA9IHJ3ZWJraXQuZXhlYyggdWEgKSB8fFxyXG5cdFx0XHRyb3BlcmEuZXhlYyggdWEgKSB8fFxyXG5cdFx0XHRybXNpZS5leGVjKCB1YSApIHx8XHJcblx0XHRcdHVhLmluZGV4T2YoXCJjb21wYXRpYmxlXCIpIDwgMCAmJiBybW96aWxsYS5leGVjKCB1YSApIHx8XHJcblx0XHRcdFtdO1xyXG5cclxuXHRcdHJldHVybiB7IGJyb3dzZXI6IG1hdGNoWzFdIHx8IFwiXCIsIHZlcnNpb246IG1hdGNoWzJdIHx8IFwiMFwiIH07XHJcblx0fTtcclxuXHJcblx0Ly8gUGxhdGZvcm0gc25pZmZlciBmb3IgZGV0ZWN0aW5nIG1vYmlsZSBkZXZpY2VzXHJcblx0JC5qUGxheWVyLnVhUGxhdGZvcm0gPSBmdW5jdGlvbiggdXNlckFnZW50ICkge1xyXG5cdFx0dmFyIHVhID0gdXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XHJcblxyXG5cdFx0Ly8gVXNlcmFnZW50IFJlZ0V4cFxyXG5cdFx0dmFyIHJwbGF0Zm9ybSA9IC8oaXBhZHxpcGhvbmV8aXBvZHxhbmRyb2lkfGJsYWNrYmVycnl8cGxheWJvb2t8d2luZG93cyBjZXx3ZWJvcykvO1xyXG5cdFx0dmFyIHJ0YWJsZXQgPSAvKGlwYWR8cGxheWJvb2spLztcclxuXHRcdHZhciByYW5kcm9pZCA9IC8oYW5kcm9pZCkvO1xyXG5cdFx0dmFyIHJtb2JpbGUgPSAvKG1vYmlsZSkvO1xyXG5cclxuXHRcdHZhciBwbGF0Zm9ybSA9IHJwbGF0Zm9ybS5leGVjKCB1YSApIHx8IFtdO1xyXG5cdFx0dmFyIHRhYmxldCA9IHJ0YWJsZXQuZXhlYyggdWEgKSB8fFxyXG5cdFx0XHQhcm1vYmlsZS5leGVjKCB1YSApICYmIHJhbmRyb2lkLmV4ZWMoIHVhICkgfHxcclxuXHRcdFx0W107XHJcblxyXG5cdFx0aWYocGxhdGZvcm1bMV0pIHtcclxuXHRcdFx0cGxhdGZvcm1bMV0gPSBwbGF0Zm9ybVsxXS5yZXBsYWNlKC9cXHMvZywgXCJfXCIpOyAvLyBDaGFuZ2Ugd2hpdGVzcGFjZSB0byB1bmRlcnNjb3JlLiBFbmFibGVzIGRvdCBub3RhdGlvbi5cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4geyBwbGF0Zm9ybTogcGxhdGZvcm1bMV0gfHwgXCJcIiwgdGFibGV0OiB0YWJsZXRbMV0gfHwgXCJcIiB9O1xyXG5cdH07XHJcblxyXG5cdCQualBsYXllci5icm93c2VyID0ge1xyXG5cdH07XHJcblx0JC5qUGxheWVyLnBsYXRmb3JtID0ge1xyXG5cdH07XHJcblxyXG5cdHZhciBicm93c2VyTWF0Y2ggPSAkLmpQbGF5ZXIudWFCcm93c2VyKG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5cdGlmICggYnJvd3Nlck1hdGNoLmJyb3dzZXIgKSB7XHJcblx0XHQkLmpQbGF5ZXIuYnJvd3NlclsgYnJvd3Nlck1hdGNoLmJyb3dzZXIgXSA9IHRydWU7XHJcblx0XHQkLmpQbGF5ZXIuYnJvd3Nlci52ZXJzaW9uID0gYnJvd3Nlck1hdGNoLnZlcnNpb247XHJcblx0fVxyXG5cdHZhciBwbGF0Zm9ybU1hdGNoID0gJC5qUGxheWVyLnVhUGxhdGZvcm0obmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcblx0aWYgKCBwbGF0Zm9ybU1hdGNoLnBsYXRmb3JtICkge1xyXG5cdFx0JC5qUGxheWVyLnBsYXRmb3JtWyBwbGF0Zm9ybU1hdGNoLnBsYXRmb3JtIF0gPSB0cnVlO1xyXG5cdFx0JC5qUGxheWVyLnBsYXRmb3JtLm1vYmlsZSA9ICFwbGF0Zm9ybU1hdGNoLnRhYmxldDtcclxuXHRcdCQualBsYXllci5wbGF0Zm9ybS50YWJsZXQgPSAhIXBsYXRmb3JtTWF0Y2gudGFibGV0O1xyXG5cdH1cclxuXHJcblx0Ly8gSW50ZXJuZXQgRXhwbG9yZXIgKElFKSBCcm93c2VyIERvY3VtZW50IE1vZGUgU25pZmZlci4gQmFzZWQgb24gY29kZSBhdDpcclxuXHQvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvY2MyODgzMjUlMjh2PXZzLjg1JTI5LmFzcHgjR2V0TW9kZVxyXG5cdCQualBsYXllci5nZXREb2NNb2RlID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZG9jTW9kZTtcclxuXHRcdGlmICgkLmpQbGF5ZXIuYnJvd3Nlci5tc2llKSB7XHJcblx0XHRcdGlmIChkb2N1bWVudC5kb2N1bWVudE1vZGUpIHsgLy8gSUU4IG9yIGxhdGVyXHJcblx0XHRcdFx0ZG9jTW9kZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZTtcclxuXHRcdFx0fSBlbHNlIHsgLy8gSUUgNS03XHJcblx0XHRcdFx0ZG9jTW9kZSA9IDU7IC8vIEFzc3VtZSBxdWlya3MgbW9kZSB1bmxlc3MgcHJvdmVuIG90aGVyd2lzZVxyXG5cdFx0XHRcdGlmIChkb2N1bWVudC5jb21wYXRNb2RlKSB7XHJcblx0XHRcdFx0XHRpZiAoZG9jdW1lbnQuY29tcGF0TW9kZSA9PT0gXCJDU1MxQ29tcGF0XCIpIHtcclxuXHRcdFx0XHRcdFx0ZG9jTW9kZSA9IDc7IC8vIHN0YW5kYXJkcyBtb2RlXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZG9jTW9kZTtcclxuXHR9O1xyXG5cdCQualBsYXllci5icm93c2VyLmRvY3VtZW50TW9kZSA9ICQualBsYXllci5nZXREb2NNb2RlKCk7XHJcblxyXG5cdCQualBsYXllci5uYXRpdmVGZWF0dXJlcyA9IHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0LyogRnVsbHNjcmVlbiBmdW5jdGlvbiBuYW1pbmcgaW5mbHVlbmNlZCBieSBXM0MgbmFtaW5nLlxyXG5cdFx0XHQgKiBObyBzdXBwb3J0IGZvcjogTW96aWxsYSBQcm9wb3NhbDogaHR0cHM6Ly93aWtpLm1vemlsbGEub3JnL0dlY2tvOkZ1bGxTY3JlZW5BUElcclxuXHRcdFx0ICovXHJcblxyXG5cdFx0XHR2YXIgZCA9IGRvY3VtZW50LFxyXG5cdFx0XHRcdHYgPSBkLmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXHJcblx0XHRcdFx0c3BlYyA9IHtcclxuXHRcdFx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2Z1bGxzY3JlZW4vXHJcblx0XHRcdFx0XHR3M2M6IFtcclxuXHRcdFx0XHRcdFx0J2Z1bGxzY3JlZW5FbmFibGVkJyxcclxuXHRcdFx0XHRcdFx0J2Z1bGxzY3JlZW5FbGVtZW50JyxcclxuXHRcdFx0XHRcdFx0J3JlcXVlc3RGdWxsc2NyZWVuJyxcclxuXHRcdFx0XHRcdFx0J2V4aXRGdWxsc2NyZWVuJyxcclxuXHRcdFx0XHRcdFx0J2Z1bGxzY3JlZW5jaGFuZ2UnLFxyXG5cdFx0XHRcdFx0XHQnZnVsbHNjcmVlbmVycm9yJ1xyXG5cdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvRE9NL1VzaW5nX2Z1bGxzY3JlZW5fbW9kZVxyXG5cdFx0XHRcdFx0bW96OiBbXHJcblx0XHRcdFx0XHRcdCdtb3pGdWxsU2NyZWVuRW5hYmxlZCcsXHJcblx0XHRcdFx0XHRcdCdtb3pGdWxsU2NyZWVuRWxlbWVudCcsXHJcblx0XHRcdFx0XHRcdCdtb3pSZXF1ZXN0RnVsbFNjcmVlbicsXHJcblx0XHRcdFx0XHRcdCdtb3pDYW5jZWxGdWxsU2NyZWVuJyxcclxuXHRcdFx0XHRcdFx0J21vemZ1bGxzY3JlZW5jaGFuZ2UnLFxyXG5cdFx0XHRcdFx0XHQnbW96ZnVsbHNjcmVlbmVycm9yJ1xyXG5cdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdC8vIGh0dHA6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2xpYnJhcnkvc2FmYXJpLyNkb2N1bWVudGF0aW9uL1dlYktpdC9SZWZlcmVuY2UvRWxlbWVudENsYXNzUmVmL0VsZW1lbnQvRWxlbWVudC5odG1sXHJcblx0XHRcdFx0XHQvLyBodHRwOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9saWJyYXJ5L3NhZmFyaS8jZG9jdW1lbnRhdGlvbi9Vc2VyRXhwZXJpZW5jZS9SZWZlcmVuY2UvRG9jdW1lbnRBZGRpdGlvbnNSZWZlcmVuY2UvRG9jdW1lbnRBZGRpdGlvbnMvRG9jdW1lbnRBZGRpdGlvbnMuaHRtbFxyXG5cdFx0XHRcdFx0d2Via2l0OiBbXHJcblx0XHRcdFx0XHRcdCcnLFxyXG5cdFx0XHRcdFx0XHQnd2Via2l0Q3VycmVudEZ1bGxTY3JlZW5FbGVtZW50JyxcclxuXHRcdFx0XHRcdFx0J3dlYmtpdFJlcXVlc3RGdWxsU2NyZWVuJyxcclxuXHRcdFx0XHRcdFx0J3dlYmtpdENhbmNlbEZ1bGxTY3JlZW4nLFxyXG5cdFx0XHRcdFx0XHQnd2Via2l0ZnVsbHNjcmVlbmNoYW5nZScsXHJcblx0XHRcdFx0XHRcdCcnXHJcblx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0Ly8gaHR0cDovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9zYWZhcmkvI2RvY3VtZW50YXRpb24vQXVkaW9WaWRlby9SZWZlcmVuY2UvSFRNTFZpZGVvRWxlbWVudENsYXNzUmVmZXJlbmNlL0hUTUxWaWRlb0VsZW1lbnQvSFRNTFZpZGVvRWxlbWVudC5odG1sXHJcblx0XHRcdFx0XHQvLyBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9zYWZhcmkvc2FtcGxlY29kZS9IVE1MNVZpZGVvRXZlbnRGbG93L0xpc3RpbmdzL2V2ZW50c19qcy5odG1sIy8vYXBwbGVfcmVmL2RvYy91aWQvRFRTNDAwMTAwODUtZXZlbnRzX2pzLURvbnRMaW5rRWxlbWVudElEXzVcclxuXHRcdFx0XHRcdC8vIEV2ZW50czogJ3dlYmtpdGJlZ2luZnVsbHNjcmVlbicgYW5kICd3ZWJraXRlbmRmdWxsc2NyZWVuJ1xyXG5cdFx0XHRcdFx0d2Via2l0VmlkZW86IFtcclxuXHRcdFx0XHRcdFx0J3dlYmtpdFN1cHBvcnRzRnVsbHNjcmVlbicsXHJcblx0XHRcdFx0XHRcdCd3ZWJraXREaXNwbGF5aW5nRnVsbHNjcmVlbicsXHJcblx0XHRcdFx0XHRcdCd3ZWJraXRFbnRlckZ1bGxzY3JlZW4nLFxyXG5cdFx0XHRcdFx0XHQnd2Via2l0RXhpdEZ1bGxzY3JlZW4nLFxyXG5cdFx0XHRcdFx0XHQnJyxcclxuXHRcdFx0XHRcdFx0JydcclxuXHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRtczogW1xyXG5cdFx0XHRcdFx0XHQnJyxcclxuXHRcdFx0XHRcdFx0J21zRnVsbHNjcmVlbkVsZW1lbnQnLFxyXG5cdFx0XHRcdFx0XHQnbXNSZXF1ZXN0RnVsbHNjcmVlbicsXHJcblx0XHRcdFx0XHRcdCdtc0V4aXRGdWxsc2NyZWVuJyxcclxuXHRcdFx0XHRcdFx0J01TRnVsbHNjcmVlbkNoYW5nZScsXHJcblx0XHRcdFx0XHRcdCdNU0Z1bGxzY3JlZW5FcnJvcidcclxuXHRcdFx0XHRcdF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHNwZWNPcmRlciA9IFtcclxuXHRcdFx0XHRcdCd3M2MnLFxyXG5cdFx0XHRcdFx0J21veicsXHJcblx0XHRcdFx0XHQnd2Via2l0JyxcclxuXHRcdFx0XHRcdCd3ZWJraXRWaWRlbycsXHJcblx0XHRcdFx0XHQnbXMnXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRmcywgaSwgaWw7XHJcblxyXG5cdFx0XHR0aGlzLmZ1bGxzY3JlZW4gPSBmcyA9IHtcclxuXHRcdFx0XHRzdXBwb3J0OiB7XHJcblx0XHRcdFx0XHR3M2M6ICEhZFtzcGVjLnczY1swXV0sXHJcblx0XHRcdFx0XHRtb3o6ICEhZFtzcGVjLm1velswXV0sXHJcblx0XHRcdFx0XHR3ZWJraXQ6IHR5cGVvZiBkW3NwZWMud2Via2l0WzNdXSA9PT0gJ2Z1bmN0aW9uJyxcclxuXHRcdFx0XHRcdHdlYmtpdFZpZGVvOiB0eXBlb2YgdltzcGVjLndlYmtpdFZpZGVvWzJdXSA9PT0gJ2Z1bmN0aW9uJyxcclxuXHRcdFx0XHRcdG1zOiB0eXBlb2YgdltzcGVjLm1zWzJdXSA9PT0gJ2Z1bmN0aW9uJ1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0dXNlZDoge31cclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdC8vIFN0b3JlIHRoZSBuYW1lIG9mIHRoZSBzcGVjIGJlaW5nIHVzZWQgYW5kIGFzIGEgaGFuZHkgYm9vbGVhbi5cclxuXHRcdFx0Zm9yKGkgPSAwLCBpbCA9IHNwZWNPcmRlci5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIG4gPSBzcGVjT3JkZXJbaV07XHJcblx0XHRcdFx0aWYoZnMuc3VwcG9ydFtuXSkge1xyXG5cdFx0XHRcdFx0ZnMuc3BlYyA9IG47XHJcblx0XHRcdFx0XHRmcy51c2VkW25dID0gdHJ1ZTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYoZnMuc3BlYykge1xyXG5cdFx0XHRcdHZhciBzID0gc3BlY1tmcy5zcGVjXTtcclxuXHRcdFx0XHRmcy5hcGkgPSB7XHJcblx0XHRcdFx0XHRmdWxsc2NyZWVuRW5hYmxlZDogdHJ1ZSxcclxuXHRcdFx0XHRcdGZ1bGxzY3JlZW5FbGVtZW50OiBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRcdFx0XHRcdGVsZW0gPSBlbGVtID8gZWxlbSA6IGQ7IC8vIFZpZGVvIGVsZW1lbnQgcmVxdWlyZWQgZm9yIHdlYmtpdFZpZGVvXHJcblx0XHRcdFx0XHRcdHJldHVybiBlbGVtW3NbMV1dO1xyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHJlcXVlc3RGdWxsc2NyZWVuOiBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBlbGVtW3NbMl1dKCk7IC8vIENocm9tZSBhbmQgT3BlcmEgd2FudCBwYXJhbWV0ZXIgKEVsZW1lbnQuQUxMT1dfS0VZQk9BUkRfSU5QVVQpIGJ1dCBTYWZhcmkgZmFpbHMgaWYgZmxhZyB1c2VkLlxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdGV4aXRGdWxsc2NyZWVuOiBmdW5jdGlvbihlbGVtKSB7XHJcblx0XHRcdFx0XHRcdGVsZW0gPSBlbGVtID8gZWxlbSA6IGQ7IC8vIFZpZGVvIGVsZW1lbnQgcmVxdWlyZWQgZm9yIHdlYmtpdFZpZGVvXHJcblx0XHRcdFx0XHRcdHJldHVybiBlbGVtW3NbM11dKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0XHRmcy5ldmVudCA9IHtcclxuXHRcdFx0XHRcdGZ1bGxzY3JlZW5jaGFuZ2U6IHNbNF0sXHJcblx0XHRcdFx0XHRmdWxsc2NyZWVuZXJyb3I6IHNbNV1cclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGZzLmFwaSA9IHtcclxuXHRcdFx0XHRcdGZ1bGxzY3JlZW5FbmFibGVkOiBmYWxzZSxcclxuXHRcdFx0XHRcdGZ1bGxzY3JlZW5FbGVtZW50OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0cmVxdWVzdEZ1bGxzY3JlZW46IGZ1bmN0aW9uKCkge30sXHJcblx0XHRcdFx0XHRleGl0RnVsbHNjcmVlbjogZnVuY3Rpb24oKSB7fVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdFx0ZnMuZXZlbnQgPSB7fTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblx0JC5qUGxheWVyLm5hdGl2ZUZlYXR1cmVzLmluaXQoKTtcclxuXHJcblx0Ly8gVGhlIGtleWJvYXJkIGNvbnRyb2wgc3lzdGVtLlxyXG5cclxuXHQvLyBUaGUgY3VycmVudCBqUGxheWVyIGluc3RhbmNlIGluIGZvY3VzLlxyXG5cdCQualBsYXllci5mb2N1cyA9IG51bGw7XHJcblxyXG5cdC8vIFRoZSBsaXN0IG9mIGVsZW1lbnQgbm9kZSBuYW1lcyB0byBpZ25vcmUgd2l0aCBrZXkgY29udHJvbHMuXHJcblx0JC5qUGxheWVyLmtleUlnbm9yZUVsZW1lbnROYW1lcyA9IFwiQSBJTlBVVCBURVhUQVJFQSBTRUxFQ1QgQlVUVE9OXCI7XHJcblxyXG5cdC8vIFRoZSBmdW5jdGlvbiB0aGF0IGRlYWxzIHdpdGgga2V5IHByZXNzZXMuXHJcblx0dmFyIGtleUJpbmRpbmdzID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHZhciBmID0gJC5qUGxheWVyLmZvY3VzLFxyXG5cdFx0XHRpZ25vcmVLZXk7XHJcblxyXG5cdFx0Ly8gQSBqUGxheWVyIGluc3RhbmNlIG11c3QgYmUgaW4gZm9jdXMuIGllLiwga2V5RW5hYmxlZCBhbmQgdGhlIGxhc3Qgb25lIHBsYXllZC5cclxuXHRcdGlmKGYpIHtcclxuXHRcdFx0Ly8gV2hhdCBnZW5lcmF0ZWQgdGhlIGtleSBwcmVzcz9cclxuXHRcdFx0JC5lYWNoKCAkLmpQbGF5ZXIua2V5SWdub3JlRWxlbWVudE5hbWVzLnNwbGl0KC9cXHMrL2cpLCBmdW5jdGlvbihpLCBuYW1lKSB7XHJcblx0XHRcdFx0Ly8gVGhlIHN0cmluZ3Mgc2hvdWxkIGFscmVhZHkgYmUgdXBwZXJjYXNlLlxyXG5cdFx0XHRcdGlmKGV2ZW50LnRhcmdldC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09PSBuYW1lLnRvVXBwZXJDYXNlKCkpIHtcclxuXHRcdFx0XHRcdGlnbm9yZUtleSA9IHRydWU7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7IC8vIGV4aXQgZWFjaC5cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRpZighaWdub3JlS2V5KSB7XHJcblx0XHRcdFx0Ly8gU2VlIGlmIHRoZSBrZXkgcHJlc3NlZCBtYXRjaGVzIGFueSBvZiB0aGUgYmluZGluZ3MuXHJcblx0XHRcdFx0JC5lYWNoKGYub3B0aW9ucy5rZXlCaW5kaW5ncywgZnVuY3Rpb24oYWN0aW9uLCBiaW5kaW5nKSB7XHJcblx0XHRcdFx0XHQvLyBUaGUgYmluZGluZyBjb3VsZCBiZSBhIG51bGwgd2hlbiB0aGUgZGVmYXVsdCBoYXMgYmVlbiBkaXNhYmxlZC4gaWUuLCAxc3QgY2xhdXNlIGluIGlmKClcclxuXHRcdFx0XHRcdGlmKFxyXG5cdFx0XHRcdFx0XHQoYmluZGluZyAmJiAkLmlzRnVuY3Rpb24oYmluZGluZy5mbikpICYmXHJcblx0XHRcdFx0XHRcdCgodHlwZW9mIGJpbmRpbmcua2V5ID09PSAnbnVtYmVyJyAmJiBldmVudC53aGljaCA9PT0gYmluZGluZy5rZXkpIHx8XHJcblx0XHRcdFx0XHRcdCh0eXBlb2YgYmluZGluZy5rZXkgPT09ICdzdHJpbmcnICYmIGV2ZW50LmtleSA9PT0gYmluZGluZy5rZXkpKVxyXG5cdFx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIEtleSBiZWluZyB1c2VkIGJ5IGpQbGF5ZXIsIHNvIHByZXZlbnQgZGVmYXVsdCBvcGVyYXRpb24uXHJcblx0XHRcdFx0XHRcdGJpbmRpbmcuZm4oZik7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTsgLy8gZXhpdCBlYWNoLlxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0JC5qUGxheWVyLmtleXMgPSBmdW5jdGlvbihlbikge1xyXG5cdFx0dmFyIGV2ZW50ID0gXCJrZXlkb3duLmpQbGF5ZXJcIjtcclxuXHRcdC8vIFJlbW92ZSBhbnkgYmluZGluZywganVzdCBpbiBjYXNlIGVuYWJsZWQgbW9yZSB0aGFuIG9uY2UuXHJcblx0XHQkKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkudW5iaW5kKGV2ZW50KTtcclxuXHRcdGlmKGVuKSB7XHJcblx0XHRcdCQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5iaW5kKGV2ZW50LCBrZXlCaW5kaW5ncyk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Ly8gRW5hYmxlIHRoZSBnbG9iYWwga2V5IGNvbnRyb2wgaGFuZGxlciByZWFkeSBmb3IgYW55IGpQbGF5ZXIgaW5zdGFuY2Ugd2l0aCB0aGUga2V5RW5hYmxlZCBvcHRpb24gZW5hYmxlZC5cclxuXHQkLmpQbGF5ZXIua2V5cyh0cnVlKTtcclxuXHJcblx0JC5qUGxheWVyLnByb3RvdHlwZSA9IHtcclxuXHRcdGNvdW50OiAwLCAvLyBTdGF0aWMgVmFyaWFibGU6IENoYW5nZSBpdCB2aWEgcHJvdG90eXBlLlxyXG5cdFx0dmVyc2lvbjogeyAvLyBTdGF0aWMgT2JqZWN0XHJcblx0XHRcdHNjcmlwdDogXCIyLjkuMlwiLFxyXG5cdFx0XHRuZWVkRmxhc2g6IFwiMi45LjBcIixcclxuXHRcdFx0Zmxhc2g6IFwidW5rbm93blwiXHJcblx0XHR9LFxyXG5cdFx0b3B0aW9uczogeyAvLyBJbnN0YW5jZWQgaW4gJC5qUGxheWVyKCkgY29uc3RydWN0b3JcclxuXHRcdFx0c3dmUGF0aDogXCJqc1wiLCAvLyBQYXRoIHRvIGpxdWVyeS5qcGxheWVyLnN3Zi4gQ2FuIGJlIHJlbGF0aXZlLCBhYnNvbHV0ZSBvciBzZXJ2ZXIgcm9vdCByZWxhdGl2ZS5cclxuXHRcdFx0c29sdXRpb246IFwiaHRtbCwgZmxhc2hcIiwgLy8gVmFsaWQgc29sdXRpb25zOiBodG1sLCBmbGFzaCwgYXVyb3JhLiBPcmRlciBkZWZpbmVzIHByaW9yaXR5LiAxc3QgaXMgaGlnaGVzdCxcclxuXHRcdFx0c3VwcGxpZWQ6IFwibXAzXCIsIC8vIERlZmluZXMgd2hpY2ggZm9ybWF0cyBqUGxheWVyIHdpbGwgdHJ5IGFuZCBzdXBwb3J0IGFuZCB0aGUgcHJpb3JpdHkgYnkgdGhlIG9yZGVyLiAxc3QgaXMgaGlnaGVzdCxcclxuXHRcdFx0YXVyb3JhRm9ybWF0czogXCJ3YXZcIiwgLy8gTGlzdCB0aGUgYXVyb3JhLmpzIGNvZGVjcyBiZWluZyBsb2FkZWQgZXh0ZXJuYWxseS4gSXRzIGNvcmUgc3VwcG9ydHMgXCJ3YXZcIi4gU3BlY2lmeSBmb3JtYXQgaW4galBsYXllciBjb250ZXh0LiBFRy4sIFRoZSBhYWMuanMgY29kZWMgZ2l2ZXMgdGhlIFwibTRhXCIgZm9ybWF0LlxyXG5cdFx0XHRwcmVsb2FkOiAnbWV0YWRhdGEnLCAgLy8gSFRNTDUgU3BlYyB2YWx1ZXM6IG5vbmUsIG1ldGFkYXRhLCBhdXRvLlxyXG5cdFx0XHR2b2x1bWU6IDAuOCwgLy8gVGhlIHZvbHVtZS4gTnVtYmVyIDAgdG8gMS5cclxuXHRcdFx0bXV0ZWQ6IGZhbHNlLFxyXG5cdFx0XHRyZW1haW5pbmdEdXJhdGlvbjogZmFsc2UsIC8vIFdoZW4gdHJ1ZSwgdGhlIHJlbWFpbmluZyB0aW1lIGlzIHNob3duIGluIHRoZSBkdXJhdGlvbiBHVUkgZWxlbWVudC5cclxuXHRcdFx0dG9nZ2xlRHVyYXRpb246IGZhbHNlLCAvLyBXaGVuIHRydWUsIGNsaWNrcyBvbiB0aGUgZHVyYXRpb24gdG9nZ2xlIGJldHdlZW4gdGhlIGR1cmF0aW9uIGFuZCByZW1haW5pbmcgZGlzcGxheS5cclxuXHRcdFx0Y2FwdHVyZUR1cmF0aW9uOiB0cnVlLCAvLyBXaGVuIHRydWUsIGNsaWNrcyBvbiB0aGUgZHVyYXRpb24gYXJlIGNhcHR1cmVkIGFuZCBubyBsb25nZXIgcHJvcGFnYXRlIHVwIHRoZSBET00uXHJcblx0XHRcdHBsYXliYWNrUmF0ZTogMSxcclxuXHRcdFx0ZGVmYXVsdFBsYXliYWNrUmF0ZTogMSxcclxuXHRcdFx0bWluUGxheWJhY2tSYXRlOiAwLjUsXHJcblx0XHRcdG1heFBsYXliYWNrUmF0ZTogNCxcclxuXHRcdFx0d21vZGU6IFwib3BhcXVlXCIsIC8vIFZhbGlkIHdtb2RlOiB3aW5kb3csIHRyYW5zcGFyZW50LCBvcGFxdWUsIGRpcmVjdCwgZ3B1LiBcclxuXHRcdFx0YmFja2dyb3VuZENvbG9yOiBcIiMwMDAwMDBcIiwgLy8gVG8gZGVmaW5lIHRoZSBqUGxheWVyIGRpdiBhbmQgRmxhc2ggYmFja2dyb3VuZCBjb2xvci5cclxuXHRcdFx0Y3NzU2VsZWN0b3JBbmNlc3RvcjogXCIjanBfY29udGFpbmVyXzFcIixcclxuXHRcdFx0Y3NzU2VsZWN0b3I6IHsgLy8gKiBkZW5vdGVzIHByb3BlcnRpZXMgdGhhdCBzaG91bGQgb25seSBiZSByZXF1aXJlZCB3aGVuIHZpZGVvIG1lZGlhIHR5cGUgcmVxdWlyZWQuIF9jc3NTZWxlY3RvcigpIHdvdWxkIHJlcXVpcmUgY2hhbmdlcyB0byBlbmFibGUgc3BsaXR0aW5nIHRoZXNlIGludG8gQXVkaW8gYW5kIFZpZGVvIGRlZmF1bHRzLlxyXG5cdFx0XHRcdHZpZGVvUGxheTogXCIuanAtdmlkZW8tcGxheVwiLCAvLyAqXHJcblx0XHRcdFx0cGxheTogXCIuanAtcGxheVwiLFxyXG5cdFx0XHRcdHBhdXNlOiBcIi5qcC1wYXVzZVwiLFxyXG5cdFx0XHRcdHN0b3A6IFwiLmpwLXN0b3BcIixcclxuXHRcdFx0XHRzZWVrQmFyOiBcIi5qcC1zZWVrLWJhclwiLFxyXG5cdFx0XHRcdHBsYXlCYXI6IFwiLmpwLXBsYXktYmFyXCIsXHJcblx0XHRcdFx0bXV0ZTogXCIuanAtbXV0ZVwiLFxyXG5cdFx0XHRcdHVubXV0ZTogXCIuanAtdW5tdXRlXCIsXHJcblx0XHRcdFx0dm9sdW1lQmFyOiBcIi5qcC12b2x1bWUtYmFyXCIsXHJcblx0XHRcdFx0dm9sdW1lQmFyVmFsdWU6IFwiLmpwLXZvbHVtZS1iYXItdmFsdWVcIixcclxuXHRcdFx0XHR2b2x1bWVNYXg6IFwiLmpwLXZvbHVtZS1tYXhcIixcclxuXHRcdFx0XHRwbGF5YmFja1JhdGVCYXI6IFwiLmpwLXBsYXliYWNrLXJhdGUtYmFyXCIsXHJcblx0XHRcdFx0cGxheWJhY2tSYXRlQmFyVmFsdWU6IFwiLmpwLXBsYXliYWNrLXJhdGUtYmFyLXZhbHVlXCIsXHJcblx0XHRcdFx0Y3VycmVudFRpbWU6IFwiLmpwLWN1cnJlbnQtdGltZVwiLFxyXG5cdFx0XHRcdGR1cmF0aW9uOiBcIi5qcC1kdXJhdGlvblwiLFxyXG5cdFx0XHRcdHRpdGxlOiBcIi5qcC10aXRsZVwiLFxyXG5cdFx0XHRcdGZ1bGxTY3JlZW46IFwiLmpwLWZ1bGwtc2NyZWVuXCIsIC8vICpcclxuXHRcdFx0XHRyZXN0b3JlU2NyZWVuOiBcIi5qcC1yZXN0b3JlLXNjcmVlblwiLCAvLyAqXHJcblx0XHRcdFx0cmVwZWF0OiBcIi5qcC1yZXBlYXRcIixcclxuXHRcdFx0XHRyZXBlYXRPZmY6IFwiLmpwLXJlcGVhdC1vZmZcIixcclxuXHRcdFx0XHRndWk6IFwiLmpwLWd1aVwiLCAvLyBUaGUgaW50ZXJmYWNlIHVzZWQgd2l0aCBhdXRvaGlkZSBmZWF0dXJlLlxyXG5cdFx0XHRcdG5vU29sdXRpb246IFwiLmpwLW5vLXNvbHV0aW9uXCIgLy8gRm9yIGVycm9yIGZlZWRiYWNrIHdoZW4galBsYXllciBjYW5ub3QgZmluZCBhIHNvbHV0aW9uLlxyXG5cdFx0XHR9LFxyXG5cdFx0XHRzdGF0ZUNsYXNzOiB7IC8vIENsYXNzZXMgYWRkZWQgdG8gdGhlIGNzc1NlbGVjdG9yQW5jZXN0b3IgdG8gaW5kaWNhdGUgdGhlIHN0YXRlLlxyXG5cdFx0XHRcdHBsYXlpbmc6IFwianAtc3RhdGUtcGxheWluZ1wiLFxyXG5cdFx0XHRcdHNlZWtpbmc6IFwianAtc3RhdGUtc2Vla2luZ1wiLFxyXG5cdFx0XHRcdG11dGVkOiBcImpwLXN0YXRlLW11dGVkXCIsXHJcblx0XHRcdFx0bG9vcGVkOiBcImpwLXN0YXRlLWxvb3BlZFwiLFxyXG5cdFx0XHRcdGZ1bGxTY3JlZW46IFwianAtc3RhdGUtZnVsbC1zY3JlZW5cIixcclxuXHRcdFx0XHRub1ZvbHVtZTogXCJqcC1zdGF0ZS1uby12b2x1bWVcIlxyXG5cdFx0XHR9LFxyXG5cdFx0XHR1c2VTdGF0ZUNsYXNzU2tpbjogZmFsc2UsIC8vIEEgc3RhdGUgY2xhc3Mgc2tpbiByZWxpZXMgb24gdGhlIHN0YXRlIGNsYXNzZXMgdG8gY2hhbmdlIHRoZSB2aXN1YWwgYXBwZWFyYW5jZS4gVGhlIHNpbmdsZSBjb250cm9sIHRvZ2dsZXMgdGhlIGVmZmVjdCwgZm9yIGV4YW1wbGU6IHBsYXkgdGhlbiBwYXVzZSwgbXV0ZSB0aGVuIHVubXV0ZS5cclxuXHRcdFx0YXV0b0JsdXI6IHRydWUsIC8vIEdVSSBjb250cm9sIGhhbmRsZXJzIHdpbGwgZHJvcCBmb2N1cyBhZnRlciBjbGlja3MuXHJcblx0XHRcdHNtb290aFBsYXlCYXI6IGZhbHNlLCAvLyBTbW9vdGhzIHRoZSBwbGF5IGJhciB0cmFuc2l0aW9ucywgd2hpY2ggYWZmZWN0cyBjbGlja3MgYW5kIHNob3J0IG1lZGlhIHdpdGggYmlnIGNoYW5nZXMgcGVyIHNlY29uZC5cclxuXHRcdFx0ZnVsbFNjcmVlbjogZmFsc2UsIC8vIE5hdGl2ZSBGdWxsIFNjcmVlblxyXG5cdFx0XHRmdWxsV2luZG93OiBmYWxzZSxcclxuXHRcdFx0YXV0b2hpZGU6IHtcclxuXHRcdFx0XHRyZXN0b3JlZDogZmFsc2UsIC8vIENvbnRyb2xzIHRoZSBpbnRlcmZhY2UgYXV0b2hpZGUgZmVhdHVyZS5cclxuXHRcdFx0XHRmdWxsOiB0cnVlLCAvLyBDb250cm9scyB0aGUgaW50ZXJmYWNlIGF1dG9oaWRlIGZlYXR1cmUuXHJcblx0XHRcdFx0ZmFkZUluOiAyMDAsIC8vIE1pbGxpc2Vjb25kcy4gVGhlIHBlcmlvZCBvZiB0aGUgZmFkZUluIGFuaW0uXHJcblx0XHRcdFx0ZmFkZU91dDogNjAwLCAvLyBNaWxsaXNlY29uZHMuIFRoZSBwZXJpb2Qgb2YgdGhlIGZhZGVPdXQgYW5pbS5cclxuXHRcdFx0XHRob2xkOiAxMDAwIC8vIE1pbGxpc2Vjb25kcy4gVGhlIHBlcmlvZCBvZiB0aGUgcGF1c2UgYmVmb3JlIGF1dG9oaWRlIGJlaW5ncy5cclxuXHRcdFx0fSxcclxuXHRcdFx0bG9vcDogZmFsc2UsXHJcblx0XHRcdHJlcGVhdDogZnVuY3Rpb24oZXZlbnQpIHsgLy8gVGhlIGRlZmF1bHQgalBsYXllciByZXBlYXQgZXZlbnQgaGFuZGxlclxyXG5cdFx0XHRcdGlmKGV2ZW50LmpQbGF5ZXIub3B0aW9ucy5sb29wKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLnVuYmluZChcIi5qUGxheWVyUmVwZWF0XCIpLmJpbmQoJC5qUGxheWVyLmV2ZW50LmVuZGVkICsgXCIualBsYXllci5qUGxheWVyUmVwZWF0XCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHQkKHRoaXMpLmpQbGF5ZXIoXCJwbGF5XCIpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQodGhpcykudW5iaW5kKFwiLmpQbGF5ZXJSZXBlYXRcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHRuYXRpdmVWaWRlb0NvbnRyb2xzOiB7XHJcblx0XHRcdFx0Ly8gV29ya3Mgd2VsbCBvbiBzdGFuZGFyZCBicm93c2Vycy5cclxuXHRcdFx0XHQvLyBQaG9uZSBhbmQgdGFibGV0IGJyb3dzZXJzIGNhbiBoYXZlIHByb2JsZW1zIHdpdGggdGhlIGNvbnRyb2xzIGRpc2FwcGVhcmluZy5cclxuXHRcdFx0fSxcclxuXHRcdFx0bm9GdWxsV2luZG93OiB7XHJcblx0XHRcdFx0bXNpZTogL21zaWUgWzAtNl1cXC4vLFxyXG5cdFx0XHRcdGlwYWQ6IC9pcGFkLio/b3MgWzAtNF1cXC4vLFxyXG5cdFx0XHRcdGlwaG9uZTogL2lwaG9uZS8sXHJcblx0XHRcdFx0aXBvZDogL2lwb2QvLFxyXG5cdFx0XHRcdGFuZHJvaWRfcGFkOiAvYW5kcm9pZCBbMC0zXVxcLig/IS4qP21vYmlsZSkvLFxyXG5cdFx0XHRcdGFuZHJvaWRfcGhvbmU6IC8oPz0uKmFuZHJvaWQpKD8hLipjaHJvbWUpKD89Liptb2JpbGUpLyxcclxuXHRcdFx0XHRibGFja2JlcnJ5OiAvYmxhY2tiZXJyeS8sXHJcblx0XHRcdFx0d2luZG93c19jZTogL3dpbmRvd3MgY2UvLFxyXG5cdFx0XHRcdGllbW9iaWxlOiAvaWVtb2JpbGUvLFxyXG5cdFx0XHRcdHdlYm9zOiAvd2Vib3MvXHJcblx0XHRcdH0sXHJcblx0XHRcdG5vVm9sdW1lOiB7XHJcblx0XHRcdFx0aXBhZDogL2lwYWQvLFxyXG5cdFx0XHRcdGlwaG9uZTogL2lwaG9uZS8sXHJcblx0XHRcdFx0aXBvZDogL2lwb2QvLFxyXG5cdFx0XHRcdGFuZHJvaWRfcGFkOiAvYW5kcm9pZCg/IS4qP21vYmlsZSkvLFxyXG5cdFx0XHRcdGFuZHJvaWRfcGhvbmU6IC9hbmRyb2lkLio/bW9iaWxlLyxcclxuXHRcdFx0XHRibGFja2JlcnJ5OiAvYmxhY2tiZXJyeS8sXHJcblx0XHRcdFx0d2luZG93c19jZTogL3dpbmRvd3MgY2UvLFxyXG5cdFx0XHRcdGllbW9iaWxlOiAvaWVtb2JpbGUvLFxyXG5cdFx0XHRcdHdlYm9zOiAvd2Vib3MvLFxyXG5cdFx0XHRcdHBsYXlib29rOiAvcGxheWJvb2svXHJcblx0XHRcdH0sXHJcblx0XHRcdHRpbWVGb3JtYXQ6IHtcclxuXHRcdFx0XHQvLyBTcGVjaWZpYyB0aW1lIGZvcm1hdCBmb3IgdGhpcyBpbnN0YW5jZS4gVGhlIHN1cHBvcnRlZCBvcHRpb25zIGFyZSBkZWZpbmVkIGluICQualBsYXllci50aW1lRm9ybWF0XHJcblx0XHRcdFx0Ly8gRm9yIHRoZSB1bmRlZmluZWQgb3B0aW9ucyB3ZSB1c2UgdGhlIGRlZmF1bHQgZnJvbSAkLmpQbGF5ZXIudGltZUZvcm1hdFxyXG5cdFx0XHR9LFxyXG5cdFx0XHRrZXlFbmFibGVkOiBmYWxzZSwgLy8gRW5hYmxlcyBrZXlib2FyZCBjb250cm9scy5cclxuXHRcdFx0YXVkaW9GdWxsU2NyZWVuOiBmYWxzZSwgLy8gRW5hYmxlcyBrZXlib2FyZCBjb250cm9scyB0byBlbnRlciBmdWxsIHNjcmVlbiB3aXRoIGF1ZGlvIG1lZGlhLlxyXG5cdFx0XHRrZXlCaW5kaW5nczogeyAvLyBUaGUga2V5IGNvbnRyb2wgb2JqZWN0LCBkZWZpbmluZyB0aGUga2V5IGNvZGVzIGFuZCB0aGUgZnVuY3Rpb25zIHRvIGV4ZWN1dGUuXHJcblx0XHRcdFx0Ly8gVGhlIHBhcmFtZXRlciwgZiA9ICQualBsYXllci5mb2N1cywgd2lsbCBiZSBjaGVja2VkIHRydWV0aHkgYmVmb3JlIGF0dGVtcHRpbmcgdG8gY2FsbCBhbnkgb2YgdGhlc2UgZnVuY3Rpb25zLlxyXG5cdFx0XHRcdC8vIFByb3BlcnRpZXMgbWF5IGJlIGFkZGVkIHRvIHRoaXMgb2JqZWN0LCBpbiBrZXkvZm4gcGFpcnMsIHRvIGVuYWJsZSBvdGhlciBrZXkgY29udHJvbHMuIEVHLCBmb3IgdGhlIHBsYXlsaXN0IGFkZC1vbi5cclxuXHRcdFx0XHRwbGF5OiB7XHJcblx0XHRcdFx0XHRrZXk6IDgwLCAvLyBwXHJcblx0XHRcdFx0XHRmbjogZnVuY3Rpb24oZikge1xyXG5cdFx0XHRcdFx0XHRpZihmLnN0YXR1cy5wYXVzZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRmLnBsYXkoKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRmLnBhdXNlKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bGxTY3JlZW46IHtcclxuXHRcdFx0XHRcdGtleTogNzAsIC8vIGZcclxuXHRcdFx0XHRcdGZuOiBmdW5jdGlvbihmKSB7XHJcblx0XHRcdFx0XHRcdGlmKGYuc3RhdHVzLnZpZGVvIHx8IGYub3B0aW9ucy5hdWRpb0Z1bGxTY3JlZW4pIHtcclxuXHRcdFx0XHRcdFx0XHRmLl9zZXRPcHRpb24oXCJmdWxsU2NyZWVuXCIsICFmLm9wdGlvbnMuZnVsbFNjcmVlbik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdG11dGVkOiB7XHJcblx0XHRcdFx0XHRrZXk6IDc3LCAvLyBtXHJcblx0XHRcdFx0XHRmbjogZnVuY3Rpb24oZikge1xyXG5cdFx0XHRcdFx0XHRmLl9tdXRlZCghZi5vcHRpb25zLm11dGVkKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHZvbHVtZVVwOiB7XHJcblx0XHRcdFx0XHRrZXk6IDE5MCwgLy8gLlxyXG5cdFx0XHRcdFx0Zm46IGZ1bmN0aW9uKGYpIHtcclxuXHRcdFx0XHRcdFx0Zi52b2x1bWUoZi5vcHRpb25zLnZvbHVtZSArIDAuMSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR2b2x1bWVEb3duOiB7XHJcblx0XHRcdFx0XHRrZXk6IDE4OCwgLy8gLFxyXG5cdFx0XHRcdFx0Zm46IGZ1bmN0aW9uKGYpIHtcclxuXHRcdFx0XHRcdFx0Zi52b2x1bWUoZi5vcHRpb25zLnZvbHVtZSAtIDAuMSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRsb29wOiB7XHJcblx0XHRcdFx0XHRrZXk6IDc2LCAvLyBsXHJcblx0XHRcdFx0XHRmbjogZnVuY3Rpb24oZikge1xyXG5cdFx0XHRcdFx0XHRmLl9sb29wKCFmLm9wdGlvbnMubG9vcCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR2ZXJ0aWNhbFZvbHVtZTogZmFsc2UsIC8vIENhbGN1bGF0ZSB2b2x1bWUgZnJvbSB0aGUgYm90dG9tIG9mIHRoZSB2b2x1bWUgYmFyLiBEZWZhdWx0IGlzIGZyb20gdGhlIGxlZnQuIEFsc28gdm9sdW1lIGFmZmVjdHMgZWl0aGVyIHdpZHRoIG9yIGhlaWdodC5cclxuXHRcdFx0dmVydGljYWxQbGF5YmFja1JhdGU6IGZhbHNlLFxyXG5cdFx0XHRnbG9iYWxWb2x1bWU6IGZhbHNlLCAvLyBTZXQgdG8gbWFrZSB2b2x1bWUgYW5kIG11dGVkIGNoYW5nZXMgYWZmZWN0IGFsbCBqUGxheWVyIGluc3RhbmNlcyB3aXRoIHRoaXMgb3B0aW9uIGVuYWJsZWRcclxuXHRcdFx0aWRQcmVmaXg6IFwianBcIiwgLy8gUHJlZml4IGZvciB0aGUgaWRzIG9mIGh0bWwgZWxlbWVudHMgY3JlYXRlZCBieSBqUGxheWVyLiBGb3IgZmxhc2gsIHRoaXMgbXVzdCBub3QgaW5jbHVkZSBjaGFyYWN0ZXJzOiAuIC0gKyAqIC8gXFxcclxuXHRcdFx0bm9Db25mbGljdDogXCJqUXVlcnlcIixcclxuXHRcdFx0ZW11bGF0ZUh0bWw6IGZhbHNlLCAvLyBFbXVsYXRlcyB0aGUgSFRNTDUgTWVkaWEgZWxlbWVudCBvbiB0aGUgalBsYXllciBlbGVtZW50LlxyXG5cdFx0XHRjb25zb2xlQWxlcnRzOiB0cnVlLCAvLyBBbGVydHMgYXJlIHNlbnQgdG8gdGhlIGNvbnNvbGUubG9nKCkgaW5zdGVhZCBvZiBhbGVydCgpLlxyXG5cdFx0XHRlcnJvckFsZXJ0czogZmFsc2UsXHJcblx0XHRcdHdhcm5pbmdBbGVydHM6IGZhbHNlXHJcblx0XHR9LFxyXG5cdFx0b3B0aW9uc0F1ZGlvOiB7XHJcblx0XHRcdHNpemU6IHtcclxuXHRcdFx0XHR3aWR0aDogXCIwcHhcIixcclxuXHRcdFx0XHRoZWlnaHQ6IFwiMHB4XCIsXHJcblx0XHRcdFx0Y3NzQ2xhc3M6IFwiXCJcclxuXHRcdFx0fSxcclxuXHRcdFx0c2l6ZUZ1bGw6IHtcclxuXHRcdFx0XHR3aWR0aDogXCIwcHhcIixcclxuXHRcdFx0XHRoZWlnaHQ6IFwiMHB4XCIsXHJcblx0XHRcdFx0Y3NzQ2xhc3M6IFwiXCJcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdG9wdGlvbnNWaWRlbzoge1xyXG5cdFx0XHRzaXplOiB7XHJcblx0XHRcdFx0d2lkdGg6IFwiNDgwcHhcIixcclxuXHRcdFx0XHRoZWlnaHQ6IFwiMjcwcHhcIixcclxuXHRcdFx0XHRjc3NDbGFzczogXCJqcC12aWRlby0yNzBwXCJcclxuXHRcdFx0fSxcclxuXHRcdFx0c2l6ZUZ1bGw6IHtcclxuXHRcdFx0XHR3aWR0aDogXCIxMDAlXCIsXHJcblx0XHRcdFx0aGVpZ2h0OiBcIjEwMCVcIixcclxuXHRcdFx0XHRjc3NDbGFzczogXCJqcC12aWRlby1mdWxsXCJcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGluc3RhbmNlczoge30sIC8vIFN0YXRpYyBPYmplY3RcclxuXHRcdHN0YXR1czogeyAvLyBJbnN0YW5jZWQgaW4gX2luaXQoKVxyXG5cdFx0XHRzcmM6IFwiXCIsXHJcblx0XHRcdG1lZGlhOiB7fSxcclxuXHRcdFx0cGF1c2VkOiB0cnVlLFxyXG5cdFx0XHRmb3JtYXQ6IHt9LFxyXG5cdFx0XHRmb3JtYXRUeXBlOiBcIlwiLFxyXG5cdFx0XHR3YWl0Rm9yUGxheTogdHJ1ZSwgLy8gU2FtZSBhcyB3YWl0Rm9yTG9hZCBleGNlcHQgaW4gY2FzZSB3aGVyZSBwcmVsb2FkaW5nLlxyXG5cdFx0XHR3YWl0Rm9yTG9hZDogdHJ1ZSxcclxuXHRcdFx0c3JjU2V0OiBmYWxzZSxcclxuXHRcdFx0dmlkZW86IGZhbHNlLCAvLyBUcnVlIGlmIHBsYXlpbmcgYSB2aWRlb1xyXG5cdFx0XHRzZWVrUGVyY2VudDogMCxcclxuXHRcdFx0Y3VycmVudFBlcmNlbnRSZWxhdGl2ZTogMCxcclxuXHRcdFx0Y3VycmVudFBlcmNlbnRBYnNvbHV0ZTogMCxcclxuXHRcdFx0Y3VycmVudFRpbWU6IDAsXHJcblx0XHRcdGR1cmF0aW9uOiAwLFxyXG5cdFx0XHRyZW1haW5pbmc6IDAsXHJcblx0XHRcdHZpZGVvV2lkdGg6IDAsIC8vIEludHJpbnNpYyB3aWR0aCBvZiB0aGUgdmlkZW8gaW4gcGl4ZWxzLlxyXG5cdFx0XHR2aWRlb0hlaWdodDogMCwgLy8gSW50cmluc2ljIGhlaWdodCBvZiB0aGUgdmlkZW8gaW4gcGl4ZWxzLlxyXG5cdFx0XHRyZWFkeVN0YXRlOiAwLFxyXG5cdFx0XHRuZXR3b3JrU3RhdGU6IDAsXHJcblx0XHRcdHBsYXliYWNrUmF0ZTogMSwgLy8gV2FybmluZyAtIE5vdyBib3RoIGFuIG9wdGlvbiBhbmQgYSBzdGF0dXMgcHJvcGVydHlcclxuXHRcdFx0ZW5kZWQ6IDBcclxuXHJcbi8qXHRcdFBlcnNpc3RhbnQgc3RhdHVzIHByb3BlcnRpZXMgY3JlYXRlZCBkeW5hbWljYWxseSBhdCBfaW5pdCgpOlxyXG5cdFx0XHR3aWR0aFxyXG5cdFx0XHRoZWlnaHRcclxuXHRcdFx0Y3NzQ2xhc3NcclxuXHRcdFx0bmF0aXZlVmlkZW9Db250cm9sc1xyXG5cdFx0XHRub0Z1bGxXaW5kb3dcclxuXHRcdFx0bm9Wb2x1bWVcclxuXHRcdFx0cGxheWJhY2tSYXRlRW5hYmxlZCAvLyBXYXJuaW5nIC0gVGVjaG5pY2FsbHksIHdlIGNhbiBoYXZlIGJvdGggRmxhc2ggYW5kIEhUTUwsIHNvIHRoaXMgbWlnaHQgbm90IGJlIGNvcnJlY3QgaWYgdGhlIEZsYXNoIGlzIGFjdGl2ZS4gVGhhdCBpcyBhIG5pY2hlIGNhc2UuXHJcbiovXHJcblx0XHR9LFxyXG5cclxuXHRcdGludGVybmFsOiB7IC8vIEluc3RhbmNlZCBpbiBfaW5pdCgpXHJcblx0XHRcdHJlYWR5OiBmYWxzZVxyXG5cdFx0XHQvLyBpbnN0YW5jZTogdW5kZWZpbmVkXHJcblx0XHRcdC8vIGRvbU5vZGU6IHVuZGVmaW5lZFxyXG5cdFx0XHQvLyBodG1sRGx5Q21kSWQ6IHVuZGVmaW5lZFxyXG5cdFx0XHQvLyBhdXRvaGlkZUlkOiB1bmRlZmluZWRcclxuXHRcdFx0Ly8gbW91c2U6IHVuZGVmaW5lZFxyXG5cdFx0XHQvLyBjbWRzSWdub3JlZFxyXG5cdFx0fSxcclxuXHRcdHNvbHV0aW9uOiB7IC8vIFN0YXRpYyBPYmplY3Q6IERlZmluZXMgdGhlIHNvbHV0aW9ucyBidWlsdCBpbiBqUGxheWVyLlxyXG5cdFx0XHRodG1sOiB0cnVlLFxyXG5cdFx0XHRhdXJvcmE6IHRydWUsXHJcblx0XHRcdGZsYXNoOiB0cnVlXHJcblx0XHR9LFxyXG5cdFx0Ly8gJ01QRUctNCBzdXBwb3J0JyA6IGNhblBsYXlUeXBlKCd2aWRlby9tcDQ7IGNvZGVjcz1cIm1wNHYuMjAuOFwiJylcclxuXHRcdGZvcm1hdDogeyAvLyBTdGF0aWMgT2JqZWN0XHJcblx0XHRcdG1wMzoge1xyXG5cdFx0XHRcdGNvZGVjOiAnYXVkaW8vbXBlZycsXHJcblx0XHRcdFx0Zmxhc2hDYW5QbGF5OiB0cnVlLFxyXG5cdFx0XHRcdG1lZGlhOiAnYXVkaW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdG00YTogeyAvLyBBQUMgLyBNUDRcclxuXHRcdFx0XHRjb2RlYzogJ2F1ZGlvL21wNDsgY29kZWNzPVwibXA0YS40MC4yXCInLFxyXG5cdFx0XHRcdGZsYXNoQ2FuUGxheTogdHJ1ZSxcclxuXHRcdFx0XHRtZWRpYTogJ2F1ZGlvJ1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRtM3U4YTogeyAvLyBBQUMgLyBNUDQgLyBBcHBsZSBITFNcclxuXHRcdFx0XHRjb2RlYzogJ2FwcGxpY2F0aW9uL3ZuZC5hcHBsZS5tcGVndXJsOyBjb2RlY3M9XCJtcDRhLjQwLjJcIicsXHJcblx0XHRcdFx0Zmxhc2hDYW5QbGF5OiBmYWxzZSxcclxuXHRcdFx0XHRtZWRpYTogJ2F1ZGlvJ1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRtM3VhOiB7IC8vIE0zVVxyXG5cdFx0XHRcdGNvZGVjOiAnYXVkaW8vbXBlZ3VybCcsXHJcblx0XHRcdFx0Zmxhc2hDYW5QbGF5OiBmYWxzZSxcclxuXHRcdFx0XHRtZWRpYTogJ2F1ZGlvJ1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRvZ2E6IHsgLy8gT0dHXHJcblx0XHRcdFx0Y29kZWM6ICdhdWRpby9vZ2c7IGNvZGVjcz1cInZvcmJpcywgb3B1c1wiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAnYXVkaW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdGZsYWM6IHsgLy8gRkxBQ1xyXG5cdFx0XHRcdGNvZGVjOiAnYXVkaW8veC1mbGFjJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAnYXVkaW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdHdhdjogeyAvLyBQQ01cclxuXHRcdFx0XHRjb2RlYzogJ2F1ZGlvL3dhdjsgY29kZWNzPVwiMVwiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAnYXVkaW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdHdlYm1hOiB7IC8vIFdFQk1cclxuXHRcdFx0XHRjb2RlYzogJ2F1ZGlvL3dlYm07IGNvZGVjcz1cInZvcmJpc1wiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAnYXVkaW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdGZsYTogeyAvLyBGTFYgLyBGNEFcclxuXHRcdFx0XHRjb2RlYzogJ2F1ZGlvL3gtZmx2JyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IHRydWUsXHJcblx0XHRcdFx0bWVkaWE6ICdhdWRpbydcclxuXHRcdFx0fSxcclxuXHRcdFx0cnRtcGE6IHsgLy8gUlRNUCBBVURJT1xyXG5cdFx0XHRcdGNvZGVjOiAnYXVkaW8vcnRtcDsgY29kZWNzPVwicnRtcFwiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IHRydWUsXHJcblx0XHRcdFx0bWVkaWE6ICdhdWRpbydcclxuXHRcdFx0fSxcclxuXHRcdFx0bTR2OiB7IC8vIEguMjY0IC8gTVA0XHJcblx0XHRcdFx0Y29kZWM6ICd2aWRlby9tcDQ7IGNvZGVjcz1cImF2YzEuNDJFMDFFLCBtcDRhLjQwLjJcIicsXHJcblx0XHRcdFx0Zmxhc2hDYW5QbGF5OiB0cnVlLFxyXG5cdFx0XHRcdG1lZGlhOiAndmlkZW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdG0zdTh2OiB7IC8vIEguMjY0IC8gQUFDIC8gTVA0IC8gQXBwbGUgSExTXHJcblx0XHRcdFx0Y29kZWM6ICdhcHBsaWNhdGlvbi92bmQuYXBwbGUubXBlZ3VybDsgY29kZWNzPVwiYXZjMS40MkUwMUUsIG1wNGEuNDAuMlwiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAndmlkZW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdG0zdXY6IHsgLy8gTTNVXHJcblx0XHRcdFx0Y29kZWM6ICdhdWRpby9tcGVndXJsJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAndmlkZW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdG9ndjogeyAvLyBPR0dcclxuXHRcdFx0XHRjb2RlYzogJ3ZpZGVvL29nZzsgY29kZWNzPVwidGhlb3JhLCB2b3JiaXNcIicsXHJcblx0XHRcdFx0Zmxhc2hDYW5QbGF5OiBmYWxzZSxcclxuXHRcdFx0XHRtZWRpYTogJ3ZpZGVvJ1xyXG5cdFx0XHR9LFxyXG5cdFx0XHR3ZWJtdjogeyAvLyBXRUJNXHJcblx0XHRcdFx0Y29kZWM6ICd2aWRlby93ZWJtOyBjb2RlY3M9XCJ2b3JiaXMsIHZwOFwiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IGZhbHNlLFxyXG5cdFx0XHRcdG1lZGlhOiAndmlkZW8nXHJcblx0XHRcdH0sXHJcblx0XHRcdGZsdjogeyAvLyBGTFYgLyBGNFZcclxuXHRcdFx0XHRjb2RlYzogJ3ZpZGVvL3gtZmx2JyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IHRydWUsXHJcblx0XHRcdFx0bWVkaWE6ICd2aWRlbydcclxuXHRcdFx0fSxcclxuXHRcdFx0cnRtcHY6IHsgLy8gUlRNUCBWSURFT1xyXG5cdFx0XHRcdGNvZGVjOiAndmlkZW8vcnRtcDsgY29kZWNzPVwicnRtcFwiJyxcclxuXHRcdFx0XHRmbGFzaENhblBsYXk6IHRydWUsXHJcblx0XHRcdFx0bWVkaWE6ICd2aWRlbydcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9pbml0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5lbGVtZW50LmVtcHR5KCk7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLnN0YXR1cyA9ICQuZXh0ZW5kKHt9LCB0aGlzLnN0YXR1cyk7IC8vIENvcHkgc3RhdGljIHRvIHVuaXF1ZSBpbnN0YW5jZS5cclxuXHRcdFx0dGhpcy5pbnRlcm5hbCA9ICQuZXh0ZW5kKHt9LCB0aGlzLmludGVybmFsKTsgLy8gQ29weSBzdGF0aWMgdG8gdW5pcXVlIGluc3RhbmNlLlxyXG5cclxuXHRcdFx0Ly8gSW5pdGlhbGl6ZSB0aGUgdGltZSBmb3JtYXRcclxuXHRcdFx0dGhpcy5vcHRpb25zLnRpbWVGb3JtYXQgPSAkLmV4dGVuZCh7fSwgJC5qUGxheWVyLnRpbWVGb3JtYXQsIHRoaXMub3B0aW9ucy50aW1lRm9ybWF0KTtcclxuXHJcblx0XHRcdC8vIE9uIGlPUywgYXNzdW1lIGNvbW1hbmRzIHdpbGwgYmUgaWdub3JlZCBiZWZvcmUgdXNlciBpbml0aWF0ZXMgdGhlbS5cclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5jbWRzSWdub3JlZCA9ICQualBsYXllci5wbGF0Zm9ybS5pcGFkIHx8ICQualBsYXllci5wbGF0Zm9ybS5pcGhvbmUgfHwgJC5qUGxheWVyLnBsYXRmb3JtLmlwb2Q7XHJcblxyXG5cdFx0XHR0aGlzLmludGVybmFsLmRvbU5vZGUgPSB0aGlzLmVsZW1lbnQuZ2V0KDApO1xyXG5cclxuXHRcdFx0Ly8gQWRkIGtleSBiaW5kaW5ncyBmb2N1cyB0byAxc3QgalBsYXllciBpbnN0YW5jZWQgd2l0aCBrZXkgY29udHJvbCBlbmFibGVkLlxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMua2V5RW5hYmxlZCAmJiAhJC5qUGxheWVyLmZvY3VzKSB7XHJcblx0XHRcdFx0JC5qUGxheWVyLmZvY3VzID0gdGhpcztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gQSBmaXggZm9yIEFuZHJvaWQgd2hlcmUgb2xkZXIgKDIuMykgYW5kIGV2ZW4gc29tZSA0LnggZGV2aWNlcyBmYWlsIHRvIHdvcmsgd2hlbiBjaGFuZ2luZyB0aGUgKmF1ZGlvKiBTUkMgYW5kIHRoZW4gcGxheWluZyBpbW1lZGlhdGVseS5cclxuXHRcdFx0dGhpcy5hbmRyb2lkRml4ID0ge1xyXG5cdFx0XHRcdHNldE1lZGlhOiBmYWxzZSwgLy8gVHJ1ZSB3aGVuIG1lZGlhIHNldFxyXG5cdFx0XHRcdHBsYXk6IGZhbHNlLCAvLyBUcnVlIHdoZW4gYSBwcm9ncmVzcyBldmVudCB3aWxsIGluc3RydWN0IHRoZSBtZWRpYSB0byBwbGF5XHJcblx0XHRcdFx0cGF1c2U6IGZhbHNlLCAvLyBUcnVlIHdoZW4gYSBwcm9ncmVzcyBldmVudCB3aWxsIGluc3RydWN0IHRoZSBtZWRpYSB0byBwYXVzZSBhdCBhIHRpbWUuXHJcblx0XHRcdFx0dGltZTogTmFOIC8vIFRoZSBwbGF5KHRpbWUpIHBhcmFtZXRlclxyXG5cdFx0XHR9O1xyXG5cdFx0XHRpZigkLmpQbGF5ZXIucGxhdGZvcm0uYW5kcm9pZCkge1xyXG5cdFx0XHRcdHRoaXMub3B0aW9ucy5wcmVsb2FkID0gdGhpcy5vcHRpb25zLnByZWxvYWQgIT09ICdhdXRvJyA/ICdtZXRhZGF0YScgOiAnYXV0byc7IC8vIERlZmF1bHQgdG8gbWV0YWRhdGEsIGJ1dCBhbGxvdyBhdXRvLlxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmZvcm1hdHMgPSBbXTsgLy8gQXJyYXkgYmFzZWQgb24gc3VwcGxpZWQgc3RyaW5nIG9wdGlvbi4gT3JkZXIgZGVmaW5lcyBwcmlvcml0eS5cclxuXHRcdFx0dGhpcy5zb2x1dGlvbnMgPSBbXTsgLy8gQXJyYXkgYmFzZWQgb24gc29sdXRpb24gc3RyaW5nIG9wdGlvbi4gT3JkZXIgZGVmaW5lcyBwcmlvcml0eS5cclxuXHRcdFx0dGhpcy5yZXF1aXJlID0ge307IC8vIFdoaWNoIG1lZGlhIHR5cGVzIGFyZSByZXF1aXJlZDogdmlkZW8sIGF1ZGlvLlxyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5odG1sRWxlbWVudCA9IHt9OyAvLyBET00gZWxlbWVudHMgY3JlYXRlZCBieSBqUGxheWVyXHJcblx0XHRcdHRoaXMuaHRtbCA9IHt9OyAvLyBJbiBfaW5pdCgpJ3MgdGhpcy5kZXNpcmVkIGNvZGUgYW5kIHNldG1lZGlhKCk6IEFjY2Vzc2VkIHZpYSB0aGlzW3NvbHV0aW9uXSwgd2hlcmUgc29sdXRpb24gZnJvbSB0aGlzLnNvbHV0aW9ucyBhcnJheS5cclxuXHRcdFx0dGhpcy5odG1sLmF1ZGlvID0ge307XHJcblx0XHRcdHRoaXMuaHRtbC52aWRlbyA9IHt9O1xyXG5cdFx0XHR0aGlzLmF1cm9yYSA9IHt9OyAvLyBJbiBfaW5pdCgpJ3MgdGhpcy5kZXNpcmVkIGNvZGUgYW5kIHNldG1lZGlhKCk6IEFjY2Vzc2VkIHZpYSB0aGlzW3NvbHV0aW9uXSwgd2hlcmUgc29sdXRpb24gZnJvbSB0aGlzLnNvbHV0aW9ucyBhcnJheS5cclxuXHRcdFx0dGhpcy5hdXJvcmEuZm9ybWF0cyA9IFtdO1xyXG5cdFx0XHR0aGlzLmF1cm9yYS5wcm9wZXJ0aWVzID0gW107XHJcblx0XHRcdHRoaXMuZmxhc2ggPSB7fTsgLy8gSW4gX2luaXQoKSdzIHRoaXMuZGVzaXJlZCBjb2RlIGFuZCBzZXRtZWRpYSgpOiBBY2Nlc3NlZCB2aWEgdGhpc1tzb2x1dGlvbl0sIHdoZXJlIHNvbHV0aW9uIGZyb20gdGhpcy5zb2x1dGlvbnMgYXJyYXkuXHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmNzcyA9IHt9O1xyXG5cdFx0XHR0aGlzLmNzcy5jcyA9IHt9OyAvLyBIb2xkcyB0aGUgY3NzIHNlbGVjdG9yIHN0cmluZ3NcclxuXHRcdFx0dGhpcy5jc3MuanEgPSB7fTsgLy8gSG9sZHMgalF1ZXJ5IHNlbGVjdG9ycy4gaWUuLCAkKGNzcy5jcy5tZXRob2QpXHJcblxyXG5cdFx0XHR0aGlzLmFuY2VzdG9ySnEgPSBbXTsgLy8gSG9sZHMgalF1ZXJ5IHNlbGVjdG9yIG9mIGNzc1NlbGVjdG9yQW5jZXN0b3IuIEluaXQgd291bGQgdXNlICQoKSBpbnN0ZWFkIG9mIFtdLCBidXQgaXQgaXMgb25seSAxLjQrXHJcblxyXG5cdFx0XHR0aGlzLm9wdGlvbnMudm9sdW1lID0gdGhpcy5fbGltaXRWYWx1ZSh0aGlzLm9wdGlvbnMudm9sdW1lLCAwLCAxKTsgLy8gTGltaXQgdm9sdW1lIHZhbHVlJ3MgYm91bmRzLlxyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIHRoZSBmb3JtYXRzIGFycmF5LCB3aXRoIHByb3JpdHkgYmFzZWQgb24gdGhlIG9yZGVyIG9mIHRoZSBzdXBwbGllZCBmb3JtYXRzIHN0cmluZ1xyXG5cdFx0XHQkLmVhY2godGhpcy5vcHRpb25zLnN1cHBsaWVkLnRvTG93ZXJDYXNlKCkuc3BsaXQoXCIsXCIpLCBmdW5jdGlvbihpbmRleDEsIHZhbHVlMSkge1xyXG5cdFx0XHRcdHZhciBmb3JtYXQgPSB2YWx1ZTEucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7IC8vdHJpbVxyXG5cdFx0XHRcdGlmKHNlbGYuZm9ybWF0W2Zvcm1hdF0pIHsgLy8gQ2hlY2sgZm9ybWF0IGlzIHZhbGlkLlxyXG5cdFx0XHRcdFx0dmFyIGR1cEZvdW5kID0gZmFsc2U7XHJcblx0XHRcdFx0XHQkLmVhY2goc2VsZi5mb3JtYXRzLCBmdW5jdGlvbihpbmRleDIsIHZhbHVlMikgeyAvLyBDaGVjayBmb3IgZHVwbGljYXRlc1xyXG5cdFx0XHRcdFx0XHRpZihmb3JtYXQgPT09IHZhbHVlMikge1xyXG5cdFx0XHRcdFx0XHRcdGR1cEZvdW5kID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aWYoIWR1cEZvdW5kKSB7XHJcblx0XHRcdFx0XHRcdHNlbGYuZm9ybWF0cy5wdXNoKGZvcm1hdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENyZWF0ZSB0aGUgc29sdXRpb25zIGFycmF5LCB3aXRoIHByb3JpdHkgYmFzZWQgb24gdGhlIG9yZGVyIG9mIHRoZSBzb2x1dGlvbiBzdHJpbmdcclxuXHRcdFx0JC5lYWNoKHRoaXMub3B0aW9ucy5zb2x1dGlvbi50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiLFwiKSwgZnVuY3Rpb24oaW5kZXgxLCB2YWx1ZTEpIHtcclxuXHRcdFx0XHR2YXIgc29sdXRpb24gPSB2YWx1ZTEucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7IC8vdHJpbVxyXG5cdFx0XHRcdGlmKHNlbGYuc29sdXRpb25bc29sdXRpb25dKSB7IC8vIENoZWNrIHNvbHV0aW9uIGlzIHZhbGlkLlxyXG5cdFx0XHRcdFx0dmFyIGR1cEZvdW5kID0gZmFsc2U7XHJcblx0XHRcdFx0XHQkLmVhY2goc2VsZi5zb2x1dGlvbnMsIGZ1bmN0aW9uKGluZGV4MiwgdmFsdWUyKSB7IC8vIENoZWNrIGZvciBkdXBsaWNhdGVzXHJcblx0XHRcdFx0XHRcdGlmKHNvbHV0aW9uID09PSB2YWx1ZTIpIHtcclxuXHRcdFx0XHRcdFx0XHRkdXBGb3VuZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGlmKCFkdXBGb3VuZCkge1xyXG5cdFx0XHRcdFx0XHRzZWxmLnNvbHV0aW9ucy5wdXNoKHNvbHV0aW9uKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHQvLyBDcmVhdGUgQXVyb3JhLmpzIGZvcm1hdHMgYXJyYXlcclxuXHRcdFx0JC5lYWNoKHRoaXMub3B0aW9ucy5hdXJvcmFGb3JtYXRzLnRvTG93ZXJDYXNlKCkuc3BsaXQoXCIsXCIpLCBmdW5jdGlvbihpbmRleDEsIHZhbHVlMSkge1xyXG5cdFx0XHRcdHZhciBmb3JtYXQgPSB2YWx1ZTEucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7IC8vdHJpbVxyXG5cdFx0XHRcdGlmKHNlbGYuZm9ybWF0W2Zvcm1hdF0pIHsgLy8gQ2hlY2sgZm9ybWF0IGlzIHZhbGlkLlxyXG5cdFx0XHRcdFx0dmFyIGR1cEZvdW5kID0gZmFsc2U7XHJcblx0XHRcdFx0XHQkLmVhY2goc2VsZi5hdXJvcmEuZm9ybWF0cywgZnVuY3Rpb24oaW5kZXgyLCB2YWx1ZTIpIHsgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZXNcclxuXHRcdFx0XHRcdFx0aWYoZm9ybWF0ID09PSB2YWx1ZTIpIHtcclxuXHRcdFx0XHRcdFx0XHRkdXBGb3VuZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGlmKCFkdXBGb3VuZCkge1xyXG5cdFx0XHRcdFx0XHRzZWxmLmF1cm9yYS5mb3JtYXRzLnB1c2goZm9ybWF0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5pbnN0YW5jZSA9IFwianBfXCIgKyB0aGlzLmNvdW50O1xyXG5cdFx0XHR0aGlzLmluc3RhbmNlc1t0aGlzLmludGVybmFsLmluc3RhbmNlXSA9IHRoaXMuZWxlbWVudDtcclxuXHJcblx0XHRcdC8vIENoZWNrIHRoZSBqUGxheWVyIGRpdiBoYXMgYW4gaWQgYW5kIGNyZWF0ZSBvbmUgaWYgcmVxdWlyZWQuIEltcG9ydGFudCBmb3IgRmxhc2ggdG8ga25vdyB0aGUgdW5pcXVlIGlkIGZvciBjb21tcy5cclxuXHRcdFx0aWYoIXRoaXMuZWxlbWVudC5hdHRyKFwiaWRcIikpIHtcclxuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYXR0cihcImlkXCIsIHRoaXMub3B0aW9ucy5pZFByZWZpeCArIFwiX2pwbGF5ZXJfXCIgKyB0aGlzLmNvdW50KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5zZWxmID0gJC5leHRlbmQoe30sIHtcclxuXHRcdFx0XHRpZDogdGhpcy5lbGVtZW50LmF0dHIoXCJpZFwiKSxcclxuXHRcdFx0XHRqcTogdGhpcy5lbGVtZW50XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLmludGVybmFsLmF1ZGlvID0gJC5leHRlbmQoe30sIHtcclxuXHRcdFx0XHRpZDogdGhpcy5vcHRpb25zLmlkUHJlZml4ICsgXCJfYXVkaW9fXCIgKyB0aGlzLmNvdW50LFxyXG5cdFx0XHRcdGpxOiB1bmRlZmluZWRcclxuXHRcdFx0fSk7XHJcblx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8gPSAkLmV4dGVuZCh7fSwge1xyXG5cdFx0XHRcdGlkOiB0aGlzLm9wdGlvbnMuaWRQcmVmaXggKyBcIl92aWRlb19cIiArIHRoaXMuY291bnQsXHJcblx0XHRcdFx0anE6IHVuZGVmaW5lZFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5mbGFzaCA9ICQuZXh0ZW5kKHt9LCB7XHJcblx0XHRcdFx0aWQ6IHRoaXMub3B0aW9ucy5pZFByZWZpeCArIFwiX2ZsYXNoX1wiICsgdGhpcy5jb3VudCxcclxuXHRcdFx0XHRqcTogdW5kZWZpbmVkLFxyXG5cdFx0XHRcdHN3ZjogdGhpcy5vcHRpb25zLnN3ZlBhdGggKyAodGhpcy5vcHRpb25zLnN3ZlBhdGgudG9Mb3dlckNhc2UoKS5zbGljZSgtNCkgIT09IFwiLnN3ZlwiID8gKHRoaXMub3B0aW9ucy5zd2ZQYXRoICYmIHRoaXMub3B0aW9ucy5zd2ZQYXRoLnNsaWNlKC0xKSAhPT0gXCIvXCIgPyBcIi9cIiA6IFwiXCIpICsgXCJqcXVlcnkuanBsYXllci5zd2ZcIiA6IFwiXCIpXHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLmludGVybmFsLnBvc3RlciA9ICQuZXh0ZW5kKHt9LCB7XHJcblx0XHRcdFx0aWQ6IHRoaXMub3B0aW9ucy5pZFByZWZpeCArIFwiX3Bvc3Rlcl9cIiArIHRoaXMuY291bnQsXHJcblx0XHRcdFx0anE6IHVuZGVmaW5lZFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJlZ2lzdGVyIGxpc3RlbmVycyBkZWZpbmVkIGluIHRoZSBjb25zdHJ1Y3RvclxyXG5cdFx0XHQkLmVhY2goJC5qUGxheWVyLmV2ZW50LCBmdW5jdGlvbihldmVudE5hbWUsZXZlbnRUeXBlKSB7XHJcblx0XHRcdFx0aWYoc2VsZi5vcHRpb25zW2V2ZW50TmFtZV0gIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0c2VsZi5lbGVtZW50LmJpbmQoZXZlbnRUeXBlICsgXCIualBsYXllclwiLCBzZWxmLm9wdGlvbnNbZXZlbnROYW1lXSk7IC8vIFdpdGggLmpQbGF5ZXIgbmFtZXNwYWNlLlxyXG5cdFx0XHRcdFx0c2VsZi5vcHRpb25zW2V2ZW50TmFtZV0gPSB1bmRlZmluZWQ7IC8vIERlc3Ryb3kgdGhlIGhhbmRsZXIgcG9pbnRlciBjb3B5IG9uIHRoZSBvcHRpb25zLiBSZWFzb24sIGV2ZW50cyBjYW4gYmUgYWRkZWQvcmVtb3ZlZCBpbiBvdGhlciB3YXlzIHNvIHRoaXMgY291bGQgYmUgb2Jzb2xldGUgYW5kIG1pc2xlYWRpbmcuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIERldGVybWluZSBpZiB3ZSByZXF1aXJlIHNvbHV0aW9ucyBmb3IgYXVkaW8sIHZpZGVvIG9yIGJvdGggbWVkaWEgdHlwZXMuXHJcblx0XHRcdHRoaXMucmVxdWlyZS5hdWRpbyA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLnJlcXVpcmUudmlkZW8gPSBmYWxzZTtcclxuXHRcdFx0JC5lYWNoKHRoaXMuZm9ybWF0cywgZnVuY3Rpb24ocHJpb3JpdHksIGZvcm1hdCkge1xyXG5cdFx0XHRcdHNlbGYucmVxdWlyZVtzZWxmLmZvcm1hdFtmb3JtYXRdLm1lZGlhXSA9IHRydWU7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gTm93IHJlcXVpcmVkIHR5cGVzIGFyZSBrbm93biwgZmluaXNoIHRoZSBvcHRpb25zIGRlZmF1bHQgc2V0dGluZ3MuXHJcblx0XHRcdGlmKHRoaXMucmVxdWlyZS52aWRlbykge1xyXG5cdFx0XHRcdHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LFxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zVmlkZW8sXHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LFxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zQXVkaW8sXHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX3NldFNpemUoKTsgLy8gdXBkYXRlIHN0YXR1cyBhbmQgalBsYXllciBlbGVtZW50IHNpemVcclxuXHJcblx0XHRcdC8vIERldGVybWluZSB0aGUgc3RhdHVzIGZvciBCbG9ja2xpc3RlZCBvcHRpb25zLlxyXG5cdFx0XHR0aGlzLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzID0gdGhpcy5fdWFCbG9ja2xpc3QodGhpcy5vcHRpb25zLm5hdGl2ZVZpZGVvQ29udHJvbHMpO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5ub0Z1bGxXaW5kb3cgPSB0aGlzLl91YUJsb2NrbGlzdCh0aGlzLm9wdGlvbnMubm9GdWxsV2luZG93KTtcclxuXHRcdFx0dGhpcy5zdGF0dXMubm9Wb2x1bWUgPSB0aGlzLl91YUJsb2NrbGlzdCh0aGlzLm9wdGlvbnMubm9Wb2x1bWUpO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIGV2ZW50IGhhbmRsZXJzIGlmIG5hdGl2ZSBmdWxsc2NyZWVuIGlzIHN1cHBvcnRlZFxyXG5cdFx0XHRpZigkLmpQbGF5ZXIubmF0aXZlRmVhdHVyZXMuZnVsbHNjcmVlbi5hcGkuZnVsbHNjcmVlbkVuYWJsZWQpIHtcclxuXHRcdFx0XHR0aGlzLl9mdWxsc2NyZWVuQWRkRXZlbnRMaXN0ZW5lcnMoKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gVGhlIG5hdGl2ZSBjb250cm9scyBhcmUgb25seSBmb3IgdmlkZW8gYW5kIGFyZSBkaXNhYmxlZCB3aGVuIGF1ZGlvIGlzIGFsc28gdXNlZC5cclxuXHRcdFx0dGhpcy5fcmVzdHJpY3ROYXRpdmVWaWRlb0NvbnRyb2xzKCk7XHJcblxyXG5cdFx0XHQvLyBDcmVhdGUgdGhlIHBvc3RlciBpbWFnZS5cclxuXHRcdFx0dGhpcy5odG1sRWxlbWVudC5wb3N0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHRcdFx0dGhpcy5odG1sRWxlbWVudC5wb3N0ZXIuaWQgPSB0aGlzLmludGVybmFsLnBvc3Rlci5pZDtcclxuXHRcdFx0dGhpcy5odG1sRWxlbWVudC5wb3N0ZXIub25sb2FkID0gZnVuY3Rpb24oKSB7IC8vIE5vdGUgdGhhdCB0aGlzIGRpZCBub3Qgd29yayBvbiBGaXJlZm94IDMuNjogcG9zdGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZnVuY3Rpb24oKSB7fSwgZmFsc2UpOyBEaWQgbm90IGludmVzdGlnYXRlIHgtYnJvd3Nlci5cclxuXHRcdFx0XHRpZighc2VsZi5zdGF0dXMudmlkZW8gfHwgc2VsZi5zdGF0dXMud2FpdEZvclBsYXkpIHtcclxuXHRcdFx0XHRcdHNlbGYuaW50ZXJuYWwucG9zdGVyLmpxLnNob3coKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblx0XHRcdHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy5odG1sRWxlbWVudC5wb3N0ZXIpO1xyXG5cdFx0XHR0aGlzLmludGVybmFsLnBvc3Rlci5qcSA9ICQoXCIjXCIgKyB0aGlzLmludGVybmFsLnBvc3Rlci5pZCk7XHJcblx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLmNzcyh7J3dpZHRoJzogdGhpcy5zdGF0dXMud2lkdGgsICdoZWlnaHQnOiB0aGlzLnN0YXR1cy5oZWlnaHR9KTtcclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5wb3N0ZXIuanEuaGlkZSgpO1xyXG5cdFx0XHR0aGlzLmludGVybmFsLnBvc3Rlci5qcS5iaW5kKFwiY2xpY2sualBsYXllclwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5jbGljayk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gR2VuZXJhdGUgdGhlIHJlcXVpcmVkIG1lZGlhIGVsZW1lbnRzXHJcblx0XHRcdHRoaXMuaHRtbC5hdWRpby5hdmFpbGFibGUgPSBmYWxzZTtcclxuXHRcdFx0aWYodGhpcy5yZXF1aXJlLmF1ZGlvKSB7IC8vIElmIGEgc3VwcGxpZWQgZm9ybWF0IGlzIGF1ZGlvXHJcblx0XHRcdFx0dGhpcy5odG1sRWxlbWVudC5hdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XHJcblx0XHRcdFx0dGhpcy5odG1sRWxlbWVudC5hdWRpby5pZCA9IHRoaXMuaW50ZXJuYWwuYXVkaW8uaWQ7XHJcblx0XHRcdFx0dGhpcy5odG1sLmF1ZGlvLmF2YWlsYWJsZSA9ICEhdGhpcy5odG1sRWxlbWVudC5hdWRpby5jYW5QbGF5VHlwZSAmJiB0aGlzLl90ZXN0Q2FuUGxheVR5cGUodGhpcy5odG1sRWxlbWVudC5hdWRpbyk7IC8vIFRlc3QgaXMgZm9yIElFOSBvbiBXaW4gU2VydmVyIDIwMDguXHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5odG1sLnZpZGVvLmF2YWlsYWJsZSA9IGZhbHNlO1xyXG5cdFx0XHRpZih0aGlzLnJlcXVpcmUudmlkZW8pIHsgLy8gSWYgYSBzdXBwbGllZCBmb3JtYXQgaXMgdmlkZW9cclxuXHRcdFx0XHR0aGlzLmh0bWxFbGVtZW50LnZpZGVvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcclxuXHRcdFx0XHR0aGlzLmh0bWxFbGVtZW50LnZpZGVvLmlkID0gdGhpcy5pbnRlcm5hbC52aWRlby5pZDtcclxuXHRcdFx0XHR0aGlzLmh0bWwudmlkZW8uYXZhaWxhYmxlID0gISF0aGlzLmh0bWxFbGVtZW50LnZpZGVvLmNhblBsYXlUeXBlICYmIHRoaXMuX3Rlc3RDYW5QbGF5VHlwZSh0aGlzLmh0bWxFbGVtZW50LnZpZGVvKTsgLy8gVGVzdCBpcyBmb3IgSUU5IG9uIFdpbiBTZXJ2ZXIgMjAwOC5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5mbGFzaC5hdmFpbGFibGUgPSB0aGlzLl9jaGVja0ZvckZsYXNoKDEwLjEpO1xyXG5cclxuXHRcdFx0dGhpcy5odG1sLmNhblBsYXkgPSB7fTtcclxuXHRcdFx0dGhpcy5hdXJvcmEuY2FuUGxheSA9IHt9O1xyXG5cdFx0XHR0aGlzLmZsYXNoLmNhblBsYXkgPSB7fTtcclxuXHRcdFx0JC5lYWNoKHRoaXMuZm9ybWF0cywgZnVuY3Rpb24ocHJpb3JpdHksIGZvcm1hdCkge1xyXG5cdFx0XHRcdHNlbGYuaHRtbC5jYW5QbGF5W2Zvcm1hdF0gPSBzZWxmLmh0bWxbc2VsZi5mb3JtYXRbZm9ybWF0XS5tZWRpYV0uYXZhaWxhYmxlICYmIFwiXCIgIT09IHNlbGYuaHRtbEVsZW1lbnRbc2VsZi5mb3JtYXRbZm9ybWF0XS5tZWRpYV0uY2FuUGxheVR5cGUoc2VsZi5mb3JtYXRbZm9ybWF0XS5jb2RlYyk7XHJcblx0XHRcdFx0c2VsZi5hdXJvcmEuY2FuUGxheVtmb3JtYXRdID0gKCQuaW5BcnJheShmb3JtYXQsIHNlbGYuYXVyb3JhLmZvcm1hdHMpID4gLTEpO1xyXG5cdFx0XHRcdHNlbGYuZmxhc2guY2FuUGxheVtmb3JtYXRdID0gc2VsZi5mb3JtYXRbZm9ybWF0XS5mbGFzaENhblBsYXkgJiYgc2VsZi5mbGFzaC5hdmFpbGFibGU7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0aGlzLmh0bWwuZGVzaXJlZCA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmF1cm9yYS5kZXNpcmVkID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuZmxhc2guZGVzaXJlZCA9IGZhbHNlO1xyXG5cdFx0XHQkLmVhY2godGhpcy5zb2x1dGlvbnMsIGZ1bmN0aW9uKHNvbHV0aW9uUHJpb3JpdHksIHNvbHV0aW9uKSB7XHJcblx0XHRcdFx0aWYoc29sdXRpb25Qcmlvcml0eSA9PT0gMCkge1xyXG5cdFx0XHRcdFx0c2VsZltzb2x1dGlvbl0uZGVzaXJlZCA9IHRydWU7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHZhciBhdWRpb0NhblBsYXkgPSBmYWxzZTtcclxuXHRcdFx0XHRcdHZhciB2aWRlb0NhblBsYXkgPSBmYWxzZTtcclxuXHRcdFx0XHRcdCQuZWFjaChzZWxmLmZvcm1hdHMsIGZ1bmN0aW9uKGZvcm1hdFByaW9yaXR5LCBmb3JtYXQpIHtcclxuXHRcdFx0XHRcdFx0aWYoc2VsZltzZWxmLnNvbHV0aW9uc1swXV0uY2FuUGxheVtmb3JtYXRdKSB7IC8vIFRoZSBvdGhlciBzb2x1dGlvbiBjYW4gcGxheVxyXG5cdFx0XHRcdFx0XHRcdGlmKHNlbGYuZm9ybWF0W2Zvcm1hdF0ubWVkaWEgPT09ICd2aWRlbycpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHZpZGVvQ2FuUGxheSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGF1ZGlvQ2FuUGxheSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHNlbGZbc29sdXRpb25dLmRlc2lyZWQgPSAoc2VsZi5yZXF1aXJlLmF1ZGlvICYmICFhdWRpb0NhblBsYXkpIHx8IChzZWxmLnJlcXVpcmUudmlkZW8gJiYgIXZpZGVvQ2FuUGxheSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0Ly8gVGhpcyBpcyB3aGF0IGpQbGF5ZXIgd2lsbCBzdXBwb3J0LCBiYXNlZCBvbiBzb2x1dGlvbiBhbmQgc3VwcGxpZWQuXHJcblx0XHRcdHRoaXMuaHRtbC5zdXBwb3J0ID0ge307XHJcblx0XHRcdHRoaXMuYXVyb3JhLnN1cHBvcnQgPSB7fTtcclxuXHRcdFx0dGhpcy5mbGFzaC5zdXBwb3J0ID0ge307XHJcblx0XHRcdCQuZWFjaCh0aGlzLmZvcm1hdHMsIGZ1bmN0aW9uKHByaW9yaXR5LCBmb3JtYXQpIHtcclxuXHRcdFx0XHRzZWxmLmh0bWwuc3VwcG9ydFtmb3JtYXRdID0gc2VsZi5odG1sLmNhblBsYXlbZm9ybWF0XSAmJiBzZWxmLmh0bWwuZGVzaXJlZDtcclxuXHRcdFx0XHRzZWxmLmF1cm9yYS5zdXBwb3J0W2Zvcm1hdF0gPSBzZWxmLmF1cm9yYS5jYW5QbGF5W2Zvcm1hdF0gJiYgc2VsZi5hdXJvcmEuZGVzaXJlZDtcclxuXHRcdFx0XHRzZWxmLmZsYXNoLnN1cHBvcnRbZm9ybWF0XSA9IHNlbGYuZmxhc2guY2FuUGxheVtmb3JtYXRdICYmIHNlbGYuZmxhc2guZGVzaXJlZDtcclxuXHRcdFx0fSk7XHJcblx0XHRcdC8vIElmIGpQbGF5ZXIgaXMgc3VwcG9ydGluZyBhbnkgZm9ybWF0IGluIGEgc29sdXRpb24sIHRoZW4gdGhlIHNvbHV0aW9uIGlzIHVzZWQuXHJcblx0XHRcdHRoaXMuaHRtbC51c2VkID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuYXVyb3JhLnVzZWQgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5mbGFzaC51c2VkID0gZmFsc2U7XHJcblx0XHRcdCQuZWFjaCh0aGlzLnNvbHV0aW9ucywgZnVuY3Rpb24oc29sdXRpb25Qcmlvcml0eSwgc29sdXRpb24pIHtcclxuXHRcdFx0XHQkLmVhY2goc2VsZi5mb3JtYXRzLCBmdW5jdGlvbihmb3JtYXRQcmlvcml0eSwgZm9ybWF0KSB7XHJcblx0XHRcdFx0XHRpZihzZWxmW3NvbHV0aW9uXS5zdXBwb3J0W2Zvcm1hdF0pIHtcclxuXHRcdFx0XHRcdFx0c2VsZltzb2x1dGlvbl0udXNlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBJbml0IHNvbHV0aW9uIGFjdGl2ZSBzdGF0ZSBhbmQgdGhlIGV2ZW50IGdhdGVzIHRvIGZhbHNlLlxyXG5cdFx0XHR0aGlzLl9yZXNldEFjdGl2ZSgpO1xyXG5cdFx0XHR0aGlzLl9yZXNldEdhdGUoKTtcclxuXHJcblx0XHRcdC8vIFNldCB1cCB0aGUgY3NzIHNlbGVjdG9ycyBmb3IgdGhlIGNvbnRyb2wgYW5kIGZlZWRiYWNrIGVudGl0aWVzLlxyXG5cdFx0XHR0aGlzLl9jc3NTZWxlY3RvckFuY2VzdG9yKHRoaXMub3B0aW9ucy5jc3NTZWxlY3RvckFuY2VzdG9yKTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIElmIG5laXRoZXIgaHRtbCBub3IgYXVyb3JhIG5vciBmbGFzaCBhcmUgYmVpbmcgdXNlZCBieSB0aGlzIGJyb3dzZXIsIHRoZW4gbWVkaWEgcGxheWJhY2sgaXMgbm90IHBvc3NpYmxlLiBUcmlnZ2VyIGFuIGVycm9yIGV2ZW50LlxyXG5cdFx0XHRpZighKHRoaXMuaHRtbC51c2VkIHx8IHRoaXMuYXVyb3JhLnVzZWQgfHwgdGhpcy5mbGFzaC51c2VkKSkge1xyXG5cdFx0XHRcdHRoaXMuX2Vycm9yKCB7XHJcblx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIuZXJyb3IuTk9fU09MVVRJT04sIFxyXG5cdFx0XHRcdFx0Y29udGV4dDogXCJ7c29sdXRpb246J1wiICsgdGhpcy5vcHRpb25zLnNvbHV0aW9uICsgXCInLCBzdXBwbGllZDonXCIgKyB0aGlzLm9wdGlvbnMuc3VwcGxpZWQgKyBcIid9XCIsXHJcblx0XHRcdFx0XHRtZXNzYWdlOiAkLmpQbGF5ZXIuZXJyb3JNc2cuTk9fU09MVVRJT04sXHJcblx0XHRcdFx0XHRoaW50OiAkLmpQbGF5ZXIuZXJyb3JIaW50Lk5PX1NPTFVUSU9OXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYodGhpcy5jc3MuanEubm9Tb2x1dGlvbi5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLm5vU29sdXRpb24uc2hvdygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZih0aGlzLmNzcy5qcS5ub1NvbHV0aW9uLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEubm9Tb2x1dGlvbi5oaWRlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBBZGQgdGhlIGZsYXNoIHNvbHV0aW9uIGlmIGl0IGlzIGJlaW5nIHVzZWQuXHJcblx0XHRcdGlmKHRoaXMuZmxhc2gudXNlZCkge1xyXG5cdFx0XHRcdHZhciBodG1sT2JqLFxyXG5cdFx0XHRcdGZsYXNoVmFycyA9ICdqUXVlcnk9JyArIGVuY29kZVVSSSh0aGlzLm9wdGlvbnMubm9Db25mbGljdCkgKyAnJmlkPScgKyBlbmNvZGVVUkkodGhpcy5pbnRlcm5hbC5zZWxmLmlkKSArICcmdm9sPScgKyB0aGlzLm9wdGlvbnMudm9sdW1lICsgJyZtdXRlZD0nICsgdGhpcy5vcHRpb25zLm11dGVkO1xyXG5cclxuXHRcdFx0XHQvLyBDb2RlIGluZmx1ZW5jZWQgYnkgU1dGT2JqZWN0IDIuMjogaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3N3Zm9iamVjdC9cclxuXHRcdFx0XHQvLyBOb24gSUUgYnJvd3NlcnMgaGF2ZSBhbiBpbml0aWFsIEZsYXNoIHNpemUgb2YgMSBieSAxIG90aGVyd2lzZSB0aGUgd21vZGUgYWZmZWN0ZWQgdGhlIEZsYXNoIHJlYWR5IGV2ZW50LiBcclxuXHJcblx0XHRcdFx0aWYoJC5qUGxheWVyLmJyb3dzZXIubXNpZSAmJiAoTnVtYmVyKCQualBsYXllci5icm93c2VyLnZlcnNpb24pIDwgOSB8fCAkLmpQbGF5ZXIuYnJvd3Nlci5kb2N1bWVudE1vZGUgPCA5KSkge1xyXG5cdFx0XHRcdFx0dmFyIG9ialN0ciA9ICc8b2JqZWN0IGlkPVwiJyArIHRoaXMuaW50ZXJuYWwuZmxhc2guaWQgKyAnXCIgY2xhc3NpZD1cImNsc2lkOmQyN2NkYjZlLWFlNmQtMTFjZi05NmI4LTQ0NDU1MzU0MDAwMFwiIHdpZHRoPVwiMFwiIGhlaWdodD1cIjBcIiB0YWJpbmRleD1cIi0xXCI+PC9vYmplY3Q+JztcclxuXHJcblx0XHRcdFx0XHR2YXIgcGFyYW1TdHIgPSBbXHJcblx0XHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIm1vdmllXCIgdmFsdWU9XCInICsgdGhpcy5pbnRlcm5hbC5mbGFzaC5zd2YgKyAnXCIgLz4nLFxyXG5cdFx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJGbGFzaFZhcnNcIiB2YWx1ZT1cIicgKyBmbGFzaFZhcnMgKyAnXCIgLz4nLFxyXG5cdFx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJhbGxvd1NjcmlwdEFjY2Vzc1wiIHZhbHVlPVwiYWx3YXlzXCIgLz4nLFxyXG5cdFx0XHRcdFx0XHQnPHBhcmFtIG5hbWU9XCJiZ2NvbG9yXCIgdmFsdWU9XCInICsgdGhpcy5vcHRpb25zLmJhY2tncm91bmRDb2xvciArICdcIiAvPicsXHJcblx0XHRcdFx0XHRcdCc8cGFyYW0gbmFtZT1cIndtb2RlXCIgdmFsdWU9XCInICsgdGhpcy5vcHRpb25zLndtb2RlICsgJ1wiIC8+J1xyXG5cdFx0XHRcdFx0XTtcclxuXHJcblx0XHRcdFx0XHRodG1sT2JqID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChvYmpTdHIpO1xyXG5cdFx0XHRcdFx0Zm9yKHZhciBpPTA7IGkgPCBwYXJhbVN0ci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRodG1sT2JqLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQocGFyYW1TdHJbaV0pKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dmFyIGNyZWF0ZVBhcmFtID0gZnVuY3Rpb24oZWwsIG4sIHYpIHtcclxuXHRcdFx0XHRcdFx0dmFyIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicGFyYW1cIik7XHJcblx0XHRcdFx0XHRcdHAuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBuKTtcdFxyXG5cdFx0XHRcdFx0XHRwLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIHYpO1xyXG5cdFx0XHRcdFx0XHRlbC5hcHBlbmRDaGlsZChwKTtcclxuXHRcdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdFx0aHRtbE9iaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvYmplY3RcIik7XHJcblx0XHRcdFx0XHRodG1sT2JqLnNldEF0dHJpYnV0ZShcImlkXCIsIHRoaXMuaW50ZXJuYWwuZmxhc2guaWQpO1xyXG5cdFx0XHRcdFx0aHRtbE9iai5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIHRoaXMuaW50ZXJuYWwuZmxhc2guaWQpO1xyXG5cdFx0XHRcdFx0aHRtbE9iai5zZXRBdHRyaWJ1dGUoXCJkYXRhXCIsIHRoaXMuaW50ZXJuYWwuZmxhc2guc3dmKTtcclxuXHRcdFx0XHRcdGh0bWxPYmouc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCIpO1xyXG5cdFx0XHRcdFx0aHRtbE9iai5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBcIjFcIik7IC8vIE5vbi16ZXJvXHJcblx0XHRcdFx0XHRodG1sT2JqLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBcIjFcIik7IC8vIE5vbi16ZXJvXHJcblx0XHRcdFx0XHRodG1sT2JqLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiLTFcIik7XHJcblx0XHRcdFx0XHRjcmVhdGVQYXJhbShodG1sT2JqLCBcImZsYXNodmFyc1wiLCBmbGFzaFZhcnMpO1xyXG5cdFx0XHRcdFx0Y3JlYXRlUGFyYW0oaHRtbE9iaiwgXCJhbGxvd3NjcmlwdGFjY2Vzc1wiLCBcImFsd2F5c1wiKTtcclxuXHRcdFx0XHRcdGNyZWF0ZVBhcmFtKGh0bWxPYmosIFwiYmdjb2xvclwiLCB0aGlzLm9wdGlvbnMuYmFja2dyb3VuZENvbG9yKTtcclxuXHRcdFx0XHRcdGNyZWF0ZVBhcmFtKGh0bWxPYmosIFwid21vZGVcIiwgdGhpcy5vcHRpb25zLndtb2RlKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHRoaXMuZWxlbWVudC5hcHBlbmQoaHRtbE9iaik7XHJcblx0XHRcdFx0dGhpcy5pbnRlcm5hbC5mbGFzaC5qcSA9ICQoaHRtbE9iaik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFNldHVwIHBsYXliYWNrUmF0ZSBhYmlsaXR5IGJlZm9yZSB1c2luZyBfYWRkSHRtbEV2ZW50TGlzdGVuZXJzKClcclxuXHRcdFx0aWYodGhpcy5odG1sLnVzZWQgJiYgIXRoaXMuZmxhc2gudXNlZCkgeyAvLyBJZiBvbmx5IEhUTUxcclxuXHRcdFx0XHQvLyBVc2luZyB0aGUgYXVkaW8gZWxlbWVudCBjYXBhYmlsaXRpZXMgZm9yIHBsYXliYWNrUmF0ZS4gaWUuLCBBc3N1bWluZyB2aWRlbyBlbGVtZW50IGlzIHRoZSBzYW1lLlxyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLnBsYXliYWNrUmF0ZUVuYWJsZWQgPSB0aGlzLl90ZXN0UGxheWJhY2tSYXRlKCdhdWRpbycpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLnBsYXliYWNrUmF0ZUVuYWJsZWQgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5fdXBkYXRlUGxheWJhY2tSYXRlKCk7XHJcblxyXG5cdFx0XHQvLyBBZGQgdGhlIEhUTUwgc29sdXRpb24gaWYgYmVpbmcgdXNlZC5cclxuXHRcdFx0aWYodGhpcy5odG1sLnVzZWQpIHtcclxuXHJcblx0XHRcdFx0Ly8gVGhlIEhUTUwgQXVkaW8gaGFuZGxlcnNcclxuXHRcdFx0XHRpZih0aGlzLmh0bWwuYXVkaW8uYXZhaWxhYmxlKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9hZGRIdG1sRXZlbnRMaXN0ZW5lcnModGhpcy5odG1sRWxlbWVudC5hdWRpbywgdGhpcy5odG1sLmF1ZGlvKTtcclxuXHRcdFx0XHRcdHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy5odG1sRWxlbWVudC5hdWRpbyk7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLmF1ZGlvLmpxID0gJChcIiNcIiArIHRoaXMuaW50ZXJuYWwuYXVkaW8uaWQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gVGhlIEhUTUwgVmlkZW8gaGFuZGxlcnNcclxuXHRcdFx0XHRpZih0aGlzLmh0bWwudmlkZW8uYXZhaWxhYmxlKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9hZGRIdG1sRXZlbnRMaXN0ZW5lcnModGhpcy5odG1sRWxlbWVudC52aWRlbywgdGhpcy5odG1sLnZpZGVvKTtcclxuXHRcdFx0XHRcdHRoaXMuZWxlbWVudC5hcHBlbmQodGhpcy5odG1sRWxlbWVudC52aWRlbyk7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLnZpZGVvLmpxID0gJChcIiNcIiArIHRoaXMuaW50ZXJuYWwudmlkZW8uaWQpO1xyXG5cdFx0XHRcdFx0aWYodGhpcy5zdGF0dXMubmF0aXZlVmlkZW9Db250cm9scykge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmludGVybmFsLnZpZGVvLmpxLmNzcyh7J3dpZHRoJzogdGhpcy5zdGF0dXMud2lkdGgsICdoZWlnaHQnOiB0aGlzLnN0YXR1cy5oZWlnaHR9KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8uanEuY3NzKHsnd2lkdGgnOicwcHgnLCAnaGVpZ2h0JzonMHB4J30pOyAvLyBVc2luZyBzaXplIDB4MCBzaW5jZSBhIC5oaWRlKCkgY2F1c2VzIGlzc3VlcyBpbiBpT1NcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8uanEuYmluZChcImNsaWNrLmpQbGF5ZXJcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmNsaWNrKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0Ly8gQWRkIHRoZSBBdXJvcmEuanMgc29sdXRpb24gaWYgYmVpbmcgdXNlZC5cclxuXHRcdFx0aWYodGhpcy5hdXJvcmEudXNlZCkge1xyXG5cdFx0XHRcdC8vIEF1cm9yYS5qcyBwbGF5ZXIgbmVlZCB0byBiZSBjcmVhdGVkIGZvciBlYWNoIG1lZGlhLCBzZWUgc2V0TWVkaWEgZnVuY3Rpb24uXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIENyZWF0ZSB0aGUgYnJpZGdlIHRoYXQgZW11bGF0ZXMgdGhlIEhUTUwgTWVkaWEgZWxlbWVudCBvbiB0aGUgalBsYXllciBESVZcclxuXHRcdFx0aWYoIHRoaXMub3B0aW9ucy5lbXVsYXRlSHRtbCApIHtcclxuXHRcdFx0XHR0aGlzLl9lbXVsYXRlSHRtbEJyaWRnZSgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZigodGhpcy5odG1sLnVzZWQgfHwgdGhpcy5hdXJvcmEudXNlZCkgJiYgIXRoaXMuZmxhc2gudXNlZCkgeyAvLyBJZiBvbmx5IEhUTUwsIHRoZW4gZW11bGF0ZSBmbGFzaCByZWFkeSgpIGNhbGwgYWZ0ZXIgMTAwbXMuXHJcblx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRzZWxmLmludGVybmFsLnJlYWR5ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHNlbGYudmVyc2lvbi5mbGFzaCA9IFwibi9hXCI7XHJcblx0XHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5yZXBlYXQpOyAvLyBUcmlnZ2VyIHRoZSByZXBlYXQgZXZlbnQgc28gaXRzIGhhbmRsZXIgY2FuIGluaXRpYWxpemUgaXRzZWxmIHdpdGggdGhlIGxvb3Agb3B0aW9uLlxyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucmVhZHkpO1xyXG5cdFx0XHRcdH0sIDEwMCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEluaXRpYWxpemUgdGhlIGludGVyZmFjZSBjb21wb25lbnRzIHdpdGggdGhlIG9wdGlvbnMuXHJcblx0XHRcdHRoaXMuX3VwZGF0ZU5hdGl2ZVZpZGVvQ29udHJvbHMoKTtcclxuXHRcdFx0Ly8gVGhlIG90aGVyIGNvbnRyb2xzIGFyZSBub3cgc2V0dXAgaW4gX2Nzc1NlbGVjdG9yQW5jZXN0b3IoKVxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS52aWRlb1BsYXkubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEudmlkZW9QbGF5LmhpZGUoKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0JC5qUGxheWVyLnByb3RvdHlwZS5jb3VudCsrOyAvLyBDaGFuZ2Ugc3RhdGljIHZhcmlhYmxlIHZpYSBwcm90b3R5cGUuXHJcblx0XHR9LFxyXG5cdFx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIE1KUDogVGhlIGJhY2tncm91bmQgY2hhbmdlIHJlbWFpbnMuIFdvdWxkIG5lZWQgdG8gc3RvcmUgdGhlIG9yaWdpbmFsIHRvIHJlc3RvcmUgaXQgY29ycmVjdGx5LlxyXG5cdFx0XHQvLyBNSlA6IFRoZSBqUGxheWVyIGVsZW1lbnQncyBzaXplIGNoYW5nZSByZW1haW5zLlxyXG5cclxuXHRcdFx0Ly8gQ2xlYXIgdGhlIG1lZGlhIHRvIHJlc2V0IHRoZSBHVUkgYW5kIHN0b3AgYW55IGRvd25sb2Fkcy4gU3RyZWFtcyBvbiBzb21lIGJyb3dzZXJzIGhhZCBwZXJzaXRlZC4gKENocm9tZSlcclxuXHRcdFx0dGhpcy5jbGVhck1lZGlhKCk7XHJcblx0XHRcdC8vIFJlbW92ZSB0aGUgc2l6ZS9zaXplRnVsbCBjc3NDbGFzcyBmcm9tIHRoZSBjc3NTZWxlY3RvckFuY2VzdG9yXHJcblx0XHRcdHRoaXMuX3JlbW92ZVVpQ2xhc3MoKTtcclxuXHRcdFx0Ly8gUmVtb3ZlIHRoZSB0aW1lcyBmcm9tIHRoZSBHVUlcclxuXHRcdFx0aWYodGhpcy5jc3MuanEuY3VycmVudFRpbWUubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEuY3VycmVudFRpbWUudGV4dChcIlwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS5kdXJhdGlvbi5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aGlzLmNzcy5qcS5kdXJhdGlvbi50ZXh0KFwiXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFJlbW92ZSBhbnkgYmluZGluZ3MgZnJvbSB0aGUgaW50ZXJmYWNlIGNvbnRyb2xzLlxyXG5cdFx0XHQkLmVhY2godGhpcy5jc3MuanEsIGZ1bmN0aW9uKGZuLCBqcSkge1xyXG5cdFx0XHRcdC8vIENoZWNrIHNlbGVjdG9yIGlzIHZhbGlkIGJlZm9yZSB0cnlpbmcgdG8gZXhlY3V0ZSBtZXRob2QuXHJcblx0XHRcdFx0aWYoanEubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRqcS51bmJpbmQoXCIualBsYXllclwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQvLyBSZW1vdmUgdGhlIGNsaWNrIGhhbmRsZXJzIGZvciAkLmpQbGF5ZXIuZXZlbnQuY2xpY2tcclxuXHRcdFx0dGhpcy5pbnRlcm5hbC5wb3N0ZXIuanEudW5iaW5kKFwiLmpQbGF5ZXJcIik7XHJcblx0XHRcdGlmKHRoaXMuaW50ZXJuYWwudmlkZW8uanEpIHtcclxuXHRcdFx0XHR0aGlzLmludGVybmFsLnZpZGVvLmpxLnVuYmluZChcIi5qUGxheWVyXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFJlbW92ZSB0aGUgZnVsbHNjcmVlbiBldmVudCBoYW5kbGVyc1xyXG5cdFx0XHR0aGlzLl9mdWxsc2NyZWVuUmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuXHRcdFx0Ly8gUmVtb3ZlIGtleSBiaW5kaW5nc1xyXG5cdFx0XHRpZih0aGlzID09PSAkLmpQbGF5ZXIuZm9jdXMpIHtcclxuXHRcdFx0XHQkLmpQbGF5ZXIuZm9jdXMgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIERlc3Ryb3kgdGhlIEhUTUwgYnJpZGdlLlxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuZW11bGF0ZUh0bWwpIHtcclxuXHRcdFx0XHR0aGlzLl9kZXN0cm95SHRtbEJyaWRnZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuZWxlbWVudC5yZW1vdmVEYXRhKFwialBsYXllclwiKTsgLy8gUmVtb3ZlIGpQbGF5ZXIgZGF0YVxyXG5cdFx0XHR0aGlzLmVsZW1lbnQudW5iaW5kKFwiLmpQbGF5ZXJcIik7IC8vIFJlbW92ZSBhbGwgZXZlbnQgaGFuZGxlcnMgY3JlYXRlZCBieSB0aGUgalBsYXllciBjb25zdHJ1Y3RvclxyXG5cdFx0XHR0aGlzLmVsZW1lbnQuZW1wdHkoKTsgLy8gUmVtb3ZlIHRoZSBpbnNlcnRlZCBjaGlsZCBlbGVtZW50c1xyXG5cdFx0XHRcclxuXHRcdFx0ZGVsZXRlIHRoaXMuaW5zdGFuY2VzW3RoaXMuaW50ZXJuYWwuaW5zdGFuY2VdOyAvLyBDbGVhciB0aGUgaW5zdGFuY2Ugb24gdGhlIHN0YXRpYyBpbnN0YW5jZSBvYmplY3RcclxuXHRcdH0sXHJcblx0XHRkZXN0cm95UmVtb3ZlZDogZnVuY3Rpb24oKSB7IC8vIERlc3Ryb3kgYW55IGluc3RhbmNlcyB0aGF0IGhhdmUgZ29uZSBhd2F5LlxyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdCQuZWFjaCh0aGlzLmluc3RhbmNlcywgZnVuY3Rpb24oaSwgZWxlbWVudCkge1xyXG5cdFx0XHRcdGlmKHNlbGYuZWxlbWVudCAhPT0gZWxlbWVudCkgeyAvLyBEbyBub3QgZGVzdHJveSB0aGlzIGluc3RhbmNlLlxyXG5cdFx0XHRcdFx0aWYoIWVsZW1lbnQuZGF0YShcImpQbGF5ZXJcIikpIHsgLy8gQ2hlY2sgdGhhdCBlbGVtZW50IGlzIGEgcmVhbCBqUGxheWVyLlxyXG5cdFx0XHRcdFx0XHRlbGVtZW50LmpQbGF5ZXIoXCJkZXN0cm95XCIpO1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgc2VsZi5pbnN0YW5jZXNbaV07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblx0XHRlbmFibGU6IGZ1bmN0aW9uKCkgeyAvLyBQbGFuIHRvIGltcGxlbWVudFxyXG5cdFx0XHQvLyBvcHRpb25zLmRpc2FibGVkID0gZmFsc2VcclxuXHRcdH0sXHJcblx0XHRkaXNhYmxlOiBmdW5jdGlvbiAoKSB7IC8vIFBsYW4gdG8gaW1wbGVtZW50XHJcblx0XHRcdC8vIG9wdGlvbnMuZGlzYWJsZWQgPSB0cnVlXHJcblx0XHR9LFxyXG5cdFx0X3Rlc3RDYW5QbGF5VHlwZTogZnVuY3Rpb24oZWxlbSkge1xyXG5cdFx0XHQvLyBJRTkgb24gV2luIFNlcnZlciAyMDA4IGRpZCBub3QgaW1wbGVtZW50IGNhblBsYXlUeXBlKCksIGJ1dCBpdCBoYXMgdGhlIHByb3BlcnR5LlxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGVsZW0uY2FuUGxheVR5cGUodGhpcy5mb3JtYXQubXAzLmNvZGVjKTsgLy8gVGhlIHR5cGUgaXMgaXJyZWxldmFudC5cclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fSBjYXRjaChlcnIpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfdGVzdFBsYXliYWNrUmF0ZTogZnVuY3Rpb24odHlwZSkge1xyXG5cdFx0XHQvLyB0eXBlOiBTdHJpbmcgJ2F1ZGlvJyBvciAndmlkZW8nXHJcblx0XHRcdHZhciBlbCwgcmF0ZSA9IDAuNTtcclxuXHRcdFx0dHlwZSA9IHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJyA/IHR5cGUgOiAnYXVkaW8nO1xyXG5cdFx0XHRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XHJcblx0XHRcdC8vIFdyYXBwaW5nIGluIGEgdHJ5L2NhdGNoLCBqdXN0IGluIGNhc2Ugb2xkZXIgSFRNTDUgYnJvd3NlcnMgdGhyb3cgYW5kIGVycm9yLlxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGlmKCdwbGF5YmFja1JhdGUnIGluIGVsKSB7XHJcblx0XHRcdFx0XHRlbC5wbGF5YmFja1JhdGUgPSByYXRlO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGVsLnBsYXliYWNrUmF0ZSA9PT0gcmF0ZTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaChlcnIpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfdWFCbG9ja2xpc3Q6IGZ1bmN0aW9uKGxpc3QpIHtcclxuXHRcdFx0Ly8gbGlzdCA6IG9iamVjdCB3aXRoIHByb3BlcnRpZXMgdGhhdCBhcmUgYWxsIHJlZ3VsYXIgZXhwcmVzc2lvbnMuIFByb3BlcnR5IG5hbWVzIGFyZSBpcnJlbGV2YW50LlxyXG5cdFx0XHQvLyBSZXR1cm5zIHRydWUgaWYgdGhlIHVzZXIgYWdlbnQgaXMgbWF0Y2hlZCBpbiBsaXN0LlxyXG5cdFx0XHR2YXJcdHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLFxyXG5cdFx0XHRcdGJsb2NrID0gZmFsc2U7XHJcblxyXG5cdFx0XHQkLmVhY2gobGlzdCwgZnVuY3Rpb24ocCwgcmUpIHtcclxuXHRcdFx0XHRpZihyZSAmJiByZS50ZXN0KHVhKSkge1xyXG5cdFx0XHRcdFx0YmxvY2sgPSB0cnVlO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlOyAvLyBleGl0ICQuZWFjaC5cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gYmxvY2s7XHJcblx0XHR9LFxyXG5cdFx0X3Jlc3RyaWN0TmF0aXZlVmlkZW9Db250cm9sczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIEZhbGxiYWNrIHRvIG5vRnVsbFdpbmRvdyB3aGVuIG5hdGl2ZVZpZGVvQ29udHJvbHMgaXMgdHJ1ZSBhbmQgYXVkaW8gbWVkaWEgaXMgYmVpbmcgdXNlZC4gQWZmZWN0cyB3aGVuIGJvdGggbWVkaWEgdHlwZXMgYXJlIHVzZWQuXHJcblx0XHRcdGlmKHRoaXMucmVxdWlyZS5hdWRpbykge1xyXG5cdFx0XHRcdGlmKHRoaXMuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMpIHtcclxuXHRcdFx0XHRcdHRoaXMuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMgPSBmYWxzZTtcclxuXHRcdFx0XHRcdHRoaXMuc3RhdHVzLm5vRnVsbFdpbmRvdyA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X3VwZGF0ZU5hdGl2ZVZpZGVvQ29udHJvbHM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLmh0bWwudmlkZW8uYXZhaWxhYmxlICYmIHRoaXMuaHRtbC51c2VkKSB7XHJcblx0XHRcdFx0Ly8gVHVybiB0aGUgSFRNTCBWaWRlbyBjb250cm9scyBvbi9vZmZcclxuXHRcdFx0XHR0aGlzLmh0bWxFbGVtZW50LnZpZGVvLmNvbnRyb2xzID0gdGhpcy5zdGF0dXMubmF0aXZlVmlkZW9Db250cm9scztcclxuXHRcdFx0XHQvLyBTaG93L2hpZGUgdGhlIGpQbGF5ZXIgR1VJLlxyXG5cdFx0XHRcdHRoaXMuX3VwZGF0ZUF1dG9oaWRlKCk7XHJcblx0XHRcdFx0Ly8gRm9yIHdoZW4gb3B0aW9uIGNoYW5nZWQuIFRoZSBwb3N0ZXIgaW1hZ2UgaXMgbm90IHVwZGF0ZWQsIGFzIGl0IGlzIGRlYWx0IHdpdGggaW4gc2V0TWVkaWEoKS4gQWNjZXB0YWJsZSBkZWdyYWRhdGlvbiBzaW5jZSBzZXJpb3VzbHkgZG91YnQgdGhlc2Ugb3B0aW9ucyB3aWxsIGNoYW5nZSBvbiB0aGUgZmx5LiBDYW4gYWdhaW4gcmV2aWV3IGxhdGVyLlxyXG5cdFx0XHRcdGlmKHRoaXMuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMgJiYgdGhpcy5yZXF1aXJlLnZpZGVvKSB7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLnBvc3Rlci5qcS5oaWRlKCk7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLnZpZGVvLmpxLmNzcyh7J3dpZHRoJzogdGhpcy5zdGF0dXMud2lkdGgsICdoZWlnaHQnOiB0aGlzLnN0YXR1cy5oZWlnaHR9KTtcclxuXHRcdFx0XHR9IGVsc2UgaWYodGhpcy5zdGF0dXMud2FpdEZvclBsYXkgJiYgdGhpcy5zdGF0dXMudmlkZW8pIHtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLnNob3coKTtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8uanEuY3NzKHsnd2lkdGgnOiAnMHB4JywgJ2hlaWdodCc6ICcwcHgnfSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2FkZEh0bWxFdmVudExpc3RlbmVyczogZnVuY3Rpb24obWVkaWFFbGVtZW50LCBlbnRpdHkpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQucHJlbG9hZCA9IHRoaXMub3B0aW9ucy5wcmVsb2FkO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQubXV0ZWQgPSB0aGlzLm9wdGlvbnMubXV0ZWQ7XHJcblx0XHRcdG1lZGlhRWxlbWVudC52b2x1bWUgPSB0aGlzLm9wdGlvbnMudm9sdW1lO1xyXG5cclxuXHRcdFx0aWYodGhpcy5zdGF0dXMucGxheWJhY2tSYXRlRW5hYmxlZCkge1xyXG5cdFx0XHRcdG1lZGlhRWxlbWVudC5kZWZhdWx0UGxheWJhY2tSYXRlID0gdGhpcy5vcHRpb25zLmRlZmF1bHRQbGF5YmFja1JhdGU7XHJcblx0XHRcdFx0bWVkaWFFbGVtZW50LnBsYXliYWNrUmF0ZSA9IHRoaXMub3B0aW9ucy5wbGF5YmFja1JhdGU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIENyZWF0ZSB0aGUgZXZlbnQgbGlzdGVuZXJzXHJcblx0XHRcdC8vIE9ubHkgd2FudCB0aGUgYWN0aXZlIGVudGl0eSB0byBhZmZlY3QgalBsYXllciBhbmQgYnViYmxlIGV2ZW50cy5cclxuXHRcdFx0Ly8gVXNpbmcgZW50aXR5LmdhdGUgc28gdGhhdCBvYmplY3QgaXMgcmVmZXJlbmNlZCBhbmQgZ2F0ZSBwcm9wZXJ0eSBhbHdheXMgY3VycmVudFxyXG5cdFx0XHRcclxuXHRcdFx0bWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwcm9ncmVzc1wiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0aWYoc2VsZi5pbnRlcm5hbC5jbWRzSWdub3JlZCAmJiB0aGlzLnJlYWR5U3RhdGUgPiAwKSB7IC8vIERldGVjdCBpT1MgZXhlY3V0ZWQgdGhlIGNvbW1hbmRcclxuXHRcdFx0XHRcdFx0c2VsZi5pbnRlcm5hbC5jbWRzSWdub3JlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c2VsZi5fZ2V0SHRtbFN0YXR1cyhtZWRpYUVsZW1lbnQpO1xyXG5cdFx0XHRcdFx0c2VsZi5fdXBkYXRlSW50ZXJmYWNlKCk7XHJcblx0XHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5wcm9ncmVzcyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCBmYWxzZSk7XHJcblx0XHRcdG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5hbmRyb2lkRml4LnNldE1lZGlhID0gZmFsc2U7IC8vIERpc2FibGUgdGhlIGZpeCBhZnRlciB0aGUgZmlyc3QgcHJvZ3Jlc3MgZXZlbnQuXHJcblx0XHRcdFx0XHRpZihzZWxmLmFuZHJvaWRGaXgucGxheSkgeyAvLyBQbGF5IEFuZHJvaWQgYXVkaW8gLSBwZXJmb3JtaW5nIHRoZSBmaXguXHJcblx0XHRcdFx0XHRcdHNlbGYuYW5kcm9pZEZpeC5wbGF5ID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdHNlbGYucGxheShzZWxmLmFuZHJvaWRGaXgudGltZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihzZWxmLmFuZHJvaWRGaXgucGF1c2UpIHsgLy8gUGF1c2UgQW5kcm9pZCBhdWRpbyBhdCB0aW1lIC0gcGVyZm9ybWluZyB0aGUgZml4LlxyXG5cdFx0XHRcdFx0XHRzZWxmLmFuZHJvaWRGaXgucGF1c2UgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0c2VsZi5wYXVzZShzZWxmLmFuZHJvaWRGaXgudGltZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5sb2FkZWRkYXRhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0bWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHRzZWxmLl9nZXRIdG1sU3RhdHVzKG1lZGlhRWxlbWVudCk7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnRpbWV1cGRhdGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImR1cmF0aW9uY2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHRzZWxmLl9nZXRIdG1sU3RhdHVzKG1lZGlhRWxlbWVudCk7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmR1cmF0aW9uY2hhbmdlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0bWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwbGF5XCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVCdXR0b25zKHRydWUpO1xyXG5cdFx0XHRcdFx0c2VsZi5faHRtbF9jaGVja1dhaXRGb3JQbGF5KCk7IC8vIFNvIHRoZSBuYXRpdmUgY29udHJvbHMgdXBkYXRlIHRoaXMgdmFyaWFibGUgYW5kIHB1dHMgdGhlIGhpZGRlbiBpbnRlcmZhY2UgaW4gdGhlIGNvcnJlY3Qgc3RhdGUuIEFmZmVjdHMgdG9nZ2xpbmcgbmF0aXZlIGNvbnRyb2xzLlxyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucGxheSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCBmYWxzZSk7XHJcblx0XHRcdG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicGxheWluZ1wiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5fdXBkYXRlQnV0dG9ucyh0cnVlKTtcclxuXHRcdFx0XHRcdHNlbGYuX3NlZWtlZCgpO1xyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucGxheWluZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCBmYWxzZSk7XHJcblx0XHRcdG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicGF1c2VcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoZW50aXR5LmdhdGUpIHtcclxuXHRcdFx0XHRcdHNlbGYuX3VwZGF0ZUJ1dHRvbnMoZmFsc2UpO1xyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucGF1c2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIndhaXRpbmdcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoZW50aXR5LmdhdGUpIHtcclxuXHRcdFx0XHRcdHNlbGYuX3NlZWtpbmcoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LndhaXRpbmcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNlZWtpbmdcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoZW50aXR5LmdhdGUpIHtcclxuXHRcdFx0XHRcdHNlbGYuX3NlZWtpbmcoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnNlZWtpbmcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNlZWtlZFwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5fc2Vla2VkKCk7XHJcblx0XHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5zZWVrZWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZvbHVtZWNoYW5nZVwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0Ly8gUmVhZCB0aGUgdmFsdWVzIGJhY2sgZnJvbSB0aGUgZWxlbWVudCBhcyB0aGUgQmxhY2tiZXJyeSBQbGF5Qm9vayBzaGFyZXMgdGhlIHZvbHVtZSB3aXRoIHRoZSBwaHlzaWNhbCBidXR0b25zIG1hc3RlciB2b2x1bWUgY29udHJvbC5cclxuXHRcdFx0XHRcdC8vIEhvd2V2ZXIsIHdoZW4gdGVzdGVkIDZ0aCBKdWx5IDIwMTEsIHRob3NlIGJ1dHRvbnMgZG8gbm90IGdlbmVyYXRlIGFuIGV2ZW50LiBUaGUgcGh5c2ljYWwgcGxheS9wYXVzZSBidXR0b24gZG9lcyB0aG91Z2guXHJcblx0XHRcdFx0XHRzZWxmLm9wdGlvbnMudm9sdW1lID0gbWVkaWFFbGVtZW50LnZvbHVtZTtcclxuXHRcdFx0XHRcdHNlbGYub3B0aW9ucy5tdXRlZCA9IG1lZGlhRWxlbWVudC5tdXRlZDtcclxuXHRcdFx0XHRcdHNlbGYuX3VwZGF0ZU11dGUoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3VwZGF0ZVZvbHVtZSgpO1xyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQudm9sdW1lY2hhbmdlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0bWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyYXRlY2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHRzZWxmLm9wdGlvbnMuZGVmYXVsdFBsYXliYWNrUmF0ZSA9IG1lZGlhRWxlbWVudC5kZWZhdWx0UGxheWJhY2tSYXRlO1xyXG5cdFx0XHRcdFx0c2VsZi5vcHRpb25zLnBsYXliYWNrUmF0ZSA9IG1lZGlhRWxlbWVudC5wbGF5YmFja1JhdGU7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVQbGF5YmFja1JhdGUoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnJhdGVjaGFuZ2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1c3BlbmRcIiwgZnVuY3Rpb24oKSB7IC8vIFNlZW1zIHRvIGJlIHRoZSBvbmx5IHdheSBvZiBjYXB0dXJpbmcgdGhhdCB0aGUgaU9TNCBicm93c2VyIGRpZCBub3QgYWN0dWFsbHkgcGxheSB0aGUgbWVkaWEgZnJvbSB0aGUgcGFnZSBjb2RlLiBpZS4sIEl0IG5lZWRzIGEgdXNlciBnZXN0dXJlLlxyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHRzZWxmLl9zZWVrZWQoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnN1c3BlbmQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHQvLyBPcmRlciBvZiB0aGUgbmV4dCBmZXcgY29tbWFuZHMgYXJlIGltcG9ydGFudC4gQ2hhbmdlIHRoZSB0aW1lIGFuZCB0aGVuIHBhdXNlLlxyXG5cdFx0XHRcdFx0Ly8gU29sdmVzIGEgYnVnIGluIEZpcmVmb3gsIHdoZXJlIGlzc3VpbmcgcGF1c2UgMXN0IGNhdXNlcyB0aGUgbWVkaWEgdG8gcGxheSBmcm9tIHRoZSBzdGFydC4gaWUuLCBUaGUgcGF1c2UgaXMgaWdub3JlZC5cclxuXHRcdFx0XHRcdGlmKCEkLmpQbGF5ZXIuYnJvd3Nlci53ZWJraXQpIHsgLy8gQ2hyb21lIGNyYXNoZXMgaWYgeW91IGRvIHRoaXMgaW4gY29uanVuY3Rpb24gd2l0aCBhIHNldE1lZGlhIGNvbW1hbmQgaW4gYW4gZW5kZWQgZXZlbnQgaGFuZGxlci4gaWUuLCBUaGUgcGxheWxpc3QgZGVtby5cclxuXHRcdFx0XHRcdFx0c2VsZi5odG1sRWxlbWVudC5tZWRpYS5jdXJyZW50VGltZSA9IDA7IC8vIFNhZmFyaSBkb2VzIG5vdCBjYXJlIGFib3V0IHRoaXMgY29tbWFuZC4gaWUuLCBJdCB3b3JrcyB3aXRoIG9yIHdpdGhvdXQgdGhpcyBsaW5lLiAoQm90aCBTYWZhcmkgYW5kIENocm9tZSBhcmUgV2Via2l0LilcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHNlbGYuaHRtbEVsZW1lbnQubWVkaWEucGF1c2UoKTsgLy8gUGF1c2Ugb3RoZXJ3aXNlIGEgY2xpY2sgb24gdGhlIHByb2dyZXNzIGJhciB3aWxsIHBsYXkgZnJvbSB0aGF0IHBvaW50LCB3aGVuIGl0IHNob3VsZG4ndCwgc2luY2UgaXQgc3RvcHBlZCBwbGF5YmFjay5cclxuXHRcdFx0XHRcdHNlbGYuX3VwZGF0ZUJ1dHRvbnMoZmFsc2UpO1xyXG5cdFx0XHRcdFx0c2VsZi5fZ2V0SHRtbFN0YXR1cyhtZWRpYUVsZW1lbnQsIHRydWUpOyAvLyBXaXRoIG92ZXJyaWRlIHRydWUuIE90aGVyd2lzZSBDaHJvbWUgbGVhdmVzIHByb2dyZXNzIGF0IGZ1bGwuXHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmVuZGVkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0bWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5fdXBkYXRlQnV0dG9ucyhmYWxzZSk7XHJcblx0XHRcdFx0XHRzZWxmLl9zZWVrZWQoKTtcclxuXHRcdFx0XHRcdGlmKHNlbGYuc3RhdHVzLnNyY1NldCkgeyAvLyBEZWFscyB3aXRoIGNhc2Ugb2YgY2xlYXJNZWRpYSgpIGNhdXNpbmcgYW4gZXJyb3IgZXZlbnQuXHJcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dChzZWxmLmludGVybmFsLmh0bWxEbHlDbWRJZCk7IC8vIENsZWFycyBhbnkgZGVsYXllZCBjb21tYW5kcyB1c2VkIGluIHRoZSBIVE1MIHNvbHV0aW9uLlxyXG5cdFx0XHRcdFx0XHRzZWxmLnN0YXR1cy53YWl0Rm9yTG9hZCA9IHRydWU7IC8vIEFsbG93cyB0aGUgbG9hZCBvcGVyYXRpb24gdG8gdHJ5IGFnYWluLlxyXG5cdFx0XHRcdFx0XHRzZWxmLnN0YXR1cy53YWl0Rm9yUGxheSA9IHRydWU7IC8vIFJlc2V0IHNpbmNlIGEgcGxheSB3YXMgY2FwdHVyZWQuXHJcblx0XHRcdFx0XHRcdGlmKHNlbGYuc3RhdHVzLnZpZGVvICYmICFzZWxmLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzKSB7XHJcblx0XHRcdFx0XHRcdFx0c2VsZi5pbnRlcm5hbC52aWRlby5qcS5jc3Moeyd3aWR0aCc6JzBweCcsICdoZWlnaHQnOicwcHgnfSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoc2VsZi5fdmFsaWRTdHJpbmcoc2VsZi5zdGF0dXMubWVkaWEucG9zdGVyKSAmJiAhc2VsZi5zdGF0dXMubmF0aXZlVmlkZW9Db250cm9scykge1xyXG5cdFx0XHRcdFx0XHRcdHNlbGYuaW50ZXJuYWwucG9zdGVyLmpxLnNob3coKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihzZWxmLmNzcy5qcS52aWRlb1BsYXkubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0c2VsZi5jc3MuanEudmlkZW9QbGF5LnNob3coKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRzZWxmLl9lcnJvcigge1xyXG5cdFx0XHRcdFx0XHRcdHR5cGU6ICQualBsYXllci5lcnJvci5VUkwsXHJcblx0XHRcdFx0XHRcdFx0Y29udGV4dDogc2VsZi5zdGF0dXMuc3JjLCAvLyB0aGlzLnNyYyBzaG93cyBhYnNvbHV0ZSB1cmxzLiBXYW50IGNvbnRleHQgdG8gc2hvdyB0aGUgdXJsIGdpdmVuLlxyXG5cdFx0XHRcdFx0XHRcdG1lc3NhZ2U6ICQualBsYXllci5lcnJvck1zZy5VUkwsXHJcblx0XHRcdFx0XHRcdFx0aGludDogJC5qUGxheWVyLmVycm9ySGludC5VUkxcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCBmYWxzZSk7XHJcblx0XHRcdC8vIENyZWF0ZSBhbGwgdGhlIG90aGVyIGV2ZW50IGxpc3RlbmVycyB0aGF0IGJ1YmJsZSB1cCB0byBhIGpQbGF5ZXIgZXZlbnQgZnJvbSBodG1sLCB3aXRob3V0IGJlaW5nIHVzZWQgYnkgalBsYXllci5cclxuXHRcdFx0JC5lYWNoKCQualBsYXllci5odG1sRXZlbnQsIGZ1bmN0aW9uKGksIGV2ZW50VHlwZSkge1xyXG5cdFx0XHRcdG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHRoaXMsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0aWYoZW50aXR5LmdhdGUpIHtcclxuXHRcdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnRbZXZlbnRUeXBlXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblx0XHRfYWRkQXVyb3JhRXZlbnRMaXN0ZW5lcnMgOiBmdW5jdGlvbihwbGF5ZXIsIGVudGl0eSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdC8vcGxheWVyLnByZWxvYWQgPSB0aGlzLm9wdGlvbnMucHJlbG9hZDtcclxuXHRcdFx0Ly9wbGF5ZXIubXV0ZWQgPSB0aGlzLm9wdGlvbnMubXV0ZWQ7XHJcblx0XHRcdHBsYXllci52b2x1bWUgPSB0aGlzLm9wdGlvbnMudm9sdW1lICogMTAwO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIHRoZSBldmVudCBsaXN0ZW5lcnNcclxuXHRcdFx0Ly8gT25seSB3YW50IHRoZSBhY3RpdmUgZW50aXR5IHRvIGFmZmVjdCBqUGxheWVyIGFuZCBidWJibGUgZXZlbnRzLlxyXG5cdFx0XHQvLyBVc2luZyBlbnRpdHkuZ2F0ZSBzbyB0aGF0IG9iamVjdCBpcyByZWZlcmVuY2VkIGFuZCBnYXRlIHByb3BlcnR5IGFsd2F5cyBjdXJyZW50XHJcblx0XHRcdFxyXG5cdFx0XHRwbGF5ZXIub24oXCJwcm9ncmVzc1wiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0aWYoc2VsZi5pbnRlcm5hbC5jbWRzSWdub3JlZCAmJiB0aGlzLnJlYWR5U3RhdGUgPiAwKSB7IC8vIERldGVjdCBpT1MgZXhlY3V0ZWQgdGhlIGNvbW1hbmRcclxuXHRcdFx0XHRcdFx0c2VsZi5pbnRlcm5hbC5jbWRzSWdub3JlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c2VsZi5fZ2V0QXVyb3JhU3RhdHVzKHBsYXllcik7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnByb2dyZXNzKTtcclxuXHRcdFx0XHRcdC8vIFByb2dyZXNzIHdpdGggc29uZyBkdXJhdGlvbiwgd2UgZXN0aW1hdGUgdGltZXVwZGF0ZSBuZWVkIHRvIGJlIHRyaWdnZXJlZCB0b28uXHJcblx0XHRcdFx0XHRpZiAocGxheWVyLmR1cmF0aW9uID4gMCkge1xyXG5cdFx0XHRcdFx0XHRzZWxmLl90cmlnZ2VyKCQualBsYXllci5ldmVudC50aW1ldXBkYXRlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0cGxheWVyLm9uKFwicmVhZHlcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoZW50aXR5LmdhdGUpIHtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmxvYWRlZGRhdGEpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRwbGF5ZXIub24oXCJkdXJhdGlvblwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5fZ2V0QXVyb3JhU3RhdHVzKHBsYXllcik7XHJcblx0XHRcdFx0XHRzZWxmLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdHNlbGYuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmR1cmF0aW9uY2hhbmdlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdFx0cGxheWVyLm9uKFwiZW5kXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmKGVudGl0eS5nYXRlKSB7XHJcblx0XHRcdFx0XHQvLyBPcmRlciBvZiB0aGUgbmV4dCBmZXcgY29tbWFuZHMgYXJlIGltcG9ydGFudC4gQ2hhbmdlIHRoZSB0aW1lIGFuZCB0aGVuIHBhdXNlLlxyXG5cdFx0XHRcdFx0c2VsZi5fdXBkYXRlQnV0dG9ucyhmYWxzZSk7XHJcblx0XHRcdFx0XHRzZWxmLl9nZXRBdXJvcmFTdGF0dXMocGxheWVyLCB0cnVlKTtcclxuXHRcdFx0XHRcdHNlbGYuX3VwZGF0ZUludGVyZmFjZSgpO1xyXG5cdFx0XHRcdFx0c2VsZi5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQuZW5kZWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgZmFsc2UpO1xyXG5cdFx0XHRwbGF5ZXIub24oXCJlcnJvclwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihlbnRpdHkuZ2F0ZSkge1xyXG5cdFx0XHRcdFx0c2VsZi5fdXBkYXRlQnV0dG9ucyhmYWxzZSk7XHJcblx0XHRcdFx0XHRzZWxmLl9zZWVrZWQoKTtcclxuXHRcdFx0XHRcdGlmKHNlbGYuc3RhdHVzLnNyY1NldCkgeyAvLyBEZWFscyB3aXRoIGNhc2Ugb2YgY2xlYXJNZWRpYSgpIGNhdXNpbmcgYW4gZXJyb3IgZXZlbnQuXHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLndhaXRGb3JMb2FkID0gdHJ1ZTsgLy8gQWxsb3dzIHRoZSBsb2FkIG9wZXJhdGlvbiB0byB0cnkgYWdhaW4uXHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLndhaXRGb3JQbGF5ID0gdHJ1ZTsgLy8gUmVzZXQgc2luY2UgYSBwbGF5IHdhcyBjYXB0dXJlZC5cclxuXHRcdFx0XHRcdFx0aWYoc2VsZi5zdGF0dXMudmlkZW8gJiYgIXNlbGYuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMpIHtcclxuXHRcdFx0XHRcdFx0XHRzZWxmLmludGVybmFsLnZpZGVvLmpxLmNzcyh7J3dpZHRoJzonMHB4JywgJ2hlaWdodCc6JzBweCd9KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZihzZWxmLl92YWxpZFN0cmluZyhzZWxmLnN0YXR1cy5tZWRpYS5wb3N0ZXIpICYmICFzZWxmLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzKSB7XHJcblx0XHRcdFx0XHRcdFx0c2VsZi5pbnRlcm5hbC5wb3N0ZXIuanEuc2hvdygpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKHNlbGYuY3NzLmpxLnZpZGVvUGxheS5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRzZWxmLmNzcy5qcS52aWRlb1BsYXkuc2hvdygpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHNlbGYuX2Vycm9yKCB7XHJcblx0XHRcdFx0XHRcdFx0dHlwZTogJC5qUGxheWVyLmVycm9yLlVSTCxcclxuXHRcdFx0XHRcdFx0XHRjb250ZXh0OiBzZWxmLnN0YXR1cy5zcmMsIC8vIHRoaXMuc3JjIHNob3dzIGFic29sdXRlIHVybHMuIFdhbnQgY29udGV4dCB0byBzaG93IHRoZSB1cmwgZ2l2ZW4uXHJcblx0XHRcdFx0XHRcdFx0bWVzc2FnZTogJC5qUGxheWVyLmVycm9yTXNnLlVSTCxcclxuXHRcdFx0XHRcdFx0XHRoaW50OiAkLmpQbGF5ZXIuZXJyb3JIaW50LlVSTFxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIGZhbHNlKTtcclxuXHRcdH0sXHJcblx0XHRfZ2V0SHRtbFN0YXR1czogZnVuY3Rpb24obWVkaWEsIG92ZXJyaWRlKSB7XHJcblx0XHRcdHZhciBjdCA9IDAsIGNwYSA9IDAsIHNwID0gMCwgY3ByID0gMDtcclxuXHJcblx0XHRcdC8vIEZpeGVzIHRoZSBkdXJhdGlvbiBidWcgaW4gaU9TLCB3aGVyZSB0aGUgZHVyYXRpb25jaGFuZ2UgZXZlbnQgb2NjdXJzIHdoZW4gbWVkaWEuZHVyYXRpb24gaXMgbm90IGFsd2F5cyBjb3JyZWN0LlxyXG5cdFx0XHQvLyBGaXhlcyB0aGUgaW5pdGlhbCBkdXJhdGlvbiBidWcgaW4gQkIgT1M3LCB3aGVyZSB0aGUgbWVkaWEuZHVyYXRpb24gaXMgaW5maW5pdHkgYW5kIGRpc3BsYXlzIGFzIE5hTjpOYU4gZHVlIHRvIERhdGUoKSB1c2luZyBpbmlmaXR5LlxyXG5cdFx0XHRpZihpc0Zpbml0ZShtZWRpYS5kdXJhdGlvbikpIHtcclxuXHRcdFx0XHR0aGlzLnN0YXR1cy5kdXJhdGlvbiA9IG1lZGlhLmR1cmF0aW9uO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRjdCA9IG1lZGlhLmN1cnJlbnRUaW1lO1xyXG5cdFx0XHRjcGEgPSAodGhpcy5zdGF0dXMuZHVyYXRpb24gPiAwKSA/IDEwMCAqIGN0IC8gdGhpcy5zdGF0dXMuZHVyYXRpb24gOiAwO1xyXG5cdFx0XHRpZigodHlwZW9mIG1lZGlhLnNlZWthYmxlID09PSBcIm9iamVjdFwiKSAmJiAobWVkaWEuc2Vla2FibGUubGVuZ3RoID4gMCkpIHtcclxuXHRcdFx0XHRzcCA9ICh0aGlzLnN0YXR1cy5kdXJhdGlvbiA+IDApID8gMTAwICogbWVkaWEuc2Vla2FibGUuZW5kKG1lZGlhLnNlZWthYmxlLmxlbmd0aC0xKSAvIHRoaXMuc3RhdHVzLmR1cmF0aW9uIDogMTAwO1xyXG5cdFx0XHRcdGNwciA9ICh0aGlzLnN0YXR1cy5kdXJhdGlvbiA+IDApID8gMTAwICogbWVkaWEuY3VycmVudFRpbWUgLyBtZWRpYS5zZWVrYWJsZS5lbmQobWVkaWEuc2Vla2FibGUubGVuZ3RoLTEpIDogMDsgLy8gRHVyYXRpb24gY29uZGl0aW9uYWwgZm9yIGlPUyBkdXJhdGlvbiBidWcuIGllLiwgc2Vla2FibGUuZW5kIGlzIGEgTmFOIGluIHRoYXQgY2FzZS5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzcCA9IDEwMDtcclxuXHRcdFx0XHRjcHIgPSBjcGE7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmKG92ZXJyaWRlKSB7XHJcblx0XHRcdFx0Y3QgPSAwO1xyXG5cdFx0XHRcdGNwciA9IDA7XHJcblx0XHRcdFx0Y3BhID0gMDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5zdGF0dXMuc2Vla1BlcmNlbnQgPSBzcDtcclxuXHRcdFx0dGhpcy5zdGF0dXMuY3VycmVudFBlcmNlbnRSZWxhdGl2ZSA9IGNwcjtcclxuXHRcdFx0dGhpcy5zdGF0dXMuY3VycmVudFBlcmNlbnRBYnNvbHV0ZSA9IGNwYTtcclxuXHRcdFx0dGhpcy5zdGF0dXMuY3VycmVudFRpbWUgPSBjdDtcclxuXHJcblx0XHRcdHRoaXMuc3RhdHVzLnJlbWFpbmluZyA9IHRoaXMuc3RhdHVzLmR1cmF0aW9uIC0gdGhpcy5zdGF0dXMuY3VycmVudFRpbWU7XHJcblxyXG5cdFx0XHR0aGlzLnN0YXR1cy52aWRlb1dpZHRoID0gbWVkaWEudmlkZW9XaWR0aDtcclxuXHRcdFx0dGhpcy5zdGF0dXMudmlkZW9IZWlnaHQgPSBtZWRpYS52aWRlb0hlaWdodDtcclxuXHJcblx0XHRcdHRoaXMuc3RhdHVzLnJlYWR5U3RhdGUgPSBtZWRpYS5yZWFkeVN0YXRlO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5uZXR3b3JrU3RhdGUgPSBtZWRpYS5uZXR3b3JrU3RhdGU7XHJcblx0XHRcdHRoaXMuc3RhdHVzLnBsYXliYWNrUmF0ZSA9IG1lZGlhLnBsYXliYWNrUmF0ZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMuZW5kZWQgPSBtZWRpYS5lbmRlZDtcclxuXHRcdH0sXHJcblx0XHRfZ2V0QXVyb3JhU3RhdHVzOiBmdW5jdGlvbihwbGF5ZXIsIG92ZXJyaWRlKSB7XHJcblx0XHRcdHZhciBjdCA9IDAsIGNwYSA9IDAsIHNwID0gMCwgY3ByID0gMDtcclxuXHJcblx0XHRcdHRoaXMuc3RhdHVzLmR1cmF0aW9uID0gcGxheWVyLmR1cmF0aW9uIC8gMTAwMDtcclxuXHJcblx0XHRcdGN0ID0gcGxheWVyLmN1cnJlbnRUaW1lIC8gMTAwMDtcclxuXHRcdFx0Y3BhID0gKHRoaXMuc3RhdHVzLmR1cmF0aW9uID4gMCkgPyAxMDAgKiBjdCAvIHRoaXMuc3RhdHVzLmR1cmF0aW9uIDogMDtcclxuXHRcdFx0aWYocGxheWVyLmJ1ZmZlcmVkID4gMCkge1xyXG5cdFx0XHRcdHNwID0gKHRoaXMuc3RhdHVzLmR1cmF0aW9uID4gMCkgPyAocGxheWVyLmJ1ZmZlcmVkICogdGhpcy5zdGF0dXMuZHVyYXRpb24pIC8gdGhpcy5zdGF0dXMuZHVyYXRpb24gOiAxMDA7XHJcblx0XHRcdFx0Y3ByID0gKHRoaXMuc3RhdHVzLmR1cmF0aW9uID4gMCkgPyBjdCAvIChwbGF5ZXIuYnVmZmVyZWQgKiB0aGlzLnN0YXR1cy5kdXJhdGlvbikgOiAwO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHNwID0gMTAwO1xyXG5cdFx0XHRcdGNwciA9IGNwYTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0aWYob3ZlcnJpZGUpIHtcclxuXHRcdFx0XHRjdCA9IDA7XHJcblx0XHRcdFx0Y3ByID0gMDtcclxuXHRcdFx0XHRjcGEgPSAwO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLnN0YXR1cy5zZWVrUGVyY2VudCA9IHNwO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5jdXJyZW50UGVyY2VudFJlbGF0aXZlID0gY3ByO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5jdXJyZW50UGVyY2VudEFic29sdXRlID0gY3BhO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5jdXJyZW50VGltZSA9IGN0O1xyXG5cclxuXHRcdFx0dGhpcy5zdGF0dXMucmVtYWluaW5nID0gdGhpcy5zdGF0dXMuZHVyYXRpb24gLSB0aGlzLnN0YXR1cy5jdXJyZW50VGltZTtcclxuXHJcblx0XHRcdHRoaXMuc3RhdHVzLnJlYWR5U3RhdGUgPSA0OyAvLyBzdGF0dXMucmVhZHlTdGF0ZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMubmV0d29ya1N0YXRlID0gMDsgLy8gc3RhdHVzLm5ldHdvcmtTdGF0ZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMucGxheWJhY2tSYXRlID0gMTsgLy8gc3RhdHVzLnBsYXliYWNrUmF0ZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMuZW5kZWQgPSBmYWxzZTsgLy8gc3RhdHVzLmVuZGVkO1xyXG5cdFx0fSxcclxuXHRcdF9yZXNldFN0YXR1czogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMuc3RhdHVzID0gJC5leHRlbmQoe30sIHRoaXMuc3RhdHVzLCAkLmpQbGF5ZXIucHJvdG90eXBlLnN0YXR1cyk7IC8vIE1haW50YWlucyB0aGUgc3RhdHVzIHByb3BlcnRpZXMgdGhhdCBwZXJzaXN0IHRocm91Z2ggYSByZXNldC5cclxuXHRcdH0sXHJcblx0XHRfdHJpZ2dlcjogZnVuY3Rpb24oZXZlbnRUeXBlLCBlcnJvciwgd2FybmluZykgeyAvLyBldmVudFR5cGUgYWx3YXlzIHZhbGlkIGFzIGNhbGxlZCB1c2luZyAkLmpQbGF5ZXIuZXZlbnQuZXZlbnRUeXBlXHJcblx0XHRcdHZhciBldmVudCA9ICQuRXZlbnQoZXZlbnRUeXBlKTtcclxuXHRcdFx0ZXZlbnQualBsYXllciA9IHt9O1xyXG5cdFx0XHRldmVudC5qUGxheWVyLnZlcnNpb24gPSAkLmV4dGVuZCh7fSwgdGhpcy52ZXJzaW9uKTtcclxuXHRcdFx0ZXZlbnQualBsYXllci5vcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sIHRoaXMub3B0aW9ucyk7IC8vIERlZXAgY29weVxyXG5cdFx0XHRldmVudC5qUGxheWVyLnN0YXR1cyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLnN0YXR1cyk7IC8vIERlZXAgY29weVxyXG5cdFx0XHRldmVudC5qUGxheWVyLmh0bWwgPSAkLmV4dGVuZCh0cnVlLCB7fSwgdGhpcy5odG1sKTsgLy8gRGVlcCBjb3B5XHJcblx0XHRcdGV2ZW50LmpQbGF5ZXIuYXVyb3JhID0gJC5leHRlbmQodHJ1ZSwge30sIHRoaXMuYXVyb3JhKTsgLy8gRGVlcCBjb3B5XHJcblx0XHRcdGV2ZW50LmpQbGF5ZXIuZmxhc2ggPSAkLmV4dGVuZCh0cnVlLCB7fSwgdGhpcy5mbGFzaCk7IC8vIERlZXAgY29weVxyXG5cdFx0XHRpZihlcnJvcikge1xyXG5cdFx0XHRcdGV2ZW50LmpQbGF5ZXIuZXJyb3IgPSAkLmV4dGVuZCh7fSwgZXJyb3IpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHdhcm5pbmcpIHtcclxuXHRcdFx0XHRldmVudC5qUGxheWVyLndhcm5pbmcgPSAkLmV4dGVuZCh7fSwgd2FybmluZyk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5lbGVtZW50LnRyaWdnZXIoZXZlbnQpO1xyXG5cdFx0fSxcclxuXHRcdGpQbGF5ZXJGbGFzaEV2ZW50OiBmdW5jdGlvbihldmVudFR5cGUsIHN0YXR1cykgeyAvLyBDYWxsZWQgZnJvbSBGbGFzaFxyXG5cdFx0XHRpZihldmVudFR5cGUgPT09ICQualBsYXllci5ldmVudC5yZWFkeSkge1xyXG5cdFx0XHRcdGlmKCF0aGlzLmludGVybmFsLnJlYWR5KSB7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLnJlYWR5ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwuZmxhc2guanEuY3NzKHsnd2lkdGgnOicwcHgnLCAnaGVpZ2h0JzonMHB4J30pOyAvLyBPbmNlIEZsYXNoIGdlbmVyYXRlcyB0aGUgcmVhZHkgZXZlbnQsIG1pbmltaXNlIHRvIHplcm8gYXMgaXQgaXMgbm90IGFmZmVjdGVkIGJ5IHdtb2RlIGFueW1vcmUuXHJcblxyXG5cdFx0XHRcdFx0dGhpcy52ZXJzaW9uLmZsYXNoID0gc3RhdHVzLnZlcnNpb247XHJcblx0XHRcdFx0XHRpZih0aGlzLnZlcnNpb24ubmVlZEZsYXNoICE9PSB0aGlzLnZlcnNpb24uZmxhc2gpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5fZXJyb3IoIHtcclxuXHRcdFx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIuZXJyb3IuVkVSU0lPTixcclxuXHRcdFx0XHRcdFx0XHRjb250ZXh0OiB0aGlzLnZlcnNpb24uZmxhc2gsXHJcblx0XHRcdFx0XHRcdFx0bWVzc2FnZTogJC5qUGxheWVyLmVycm9yTXNnLlZFUlNJT04gKyB0aGlzLnZlcnNpb24uZmxhc2gsXHJcblx0XHRcdFx0XHRcdFx0aGludDogJC5qUGxheWVyLmVycm9ySGludC5WRVJTSU9OXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucmVwZWF0KTsgLy8gVHJpZ2dlciB0aGUgcmVwZWF0IGV2ZW50IHNvIGl0cyBoYW5kbGVyIGNhbiBpbml0aWFsaXplIGl0c2VsZiB3aXRoIHRoZSBsb29wIG9wdGlvbi5cclxuXHRcdFx0XHRcdHRoaXMuX3RyaWdnZXIoZXZlbnRUeXBlKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gVGhpcyBjb25kaXRpb24gb2NjdXJzIGlmIHRoZSBGbGFzaCBpcyBoaWRkZW4gYW5kIHRoZW4gc2hvd24gYWdhaW4uXHJcblx0XHRcdFx0XHQvLyBGaXJlZm94IGFsc28gcmVsb2FkcyB0aGUgRmxhc2ggaWYgdGhlIENTUyBwb3NpdGlvbiBjaGFuZ2VzLiBwb3NpdGlvbjpmaXhlZCBpcyB1c2VkIGZvciBmdWxsIHNjcmVlbi5cclxuXHJcblx0XHRcdFx0XHQvLyBPbmx5IGRvIHRoaXMgaWYgdGhlIEZsYXNoIGlzIHRoZSBzb2x1dGlvbiBiZWluZyB1c2VkIGF0IHRoZSBtb21lbnQuIEFmZmVjdHMgTWVkaWEgcGxheWVycyB3aGVyZSBib3RoIHNvbHV0aW9uIG1heSBiZSBiZWluZyB1c2VkLlxyXG5cdFx0XHRcdFx0aWYodGhpcy5mbGFzaC5nYXRlKSB7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBTZW5kIHRoZSBjdXJyZW50IHN0YXR1cyB0byB0aGUgRmxhc2ggbm93IHRoYXQgaXQgaXMgcmVhZHkgKGF2YWlsYWJsZSkgYWdhaW4uXHJcblx0XHRcdFx0XHRcdGlmKHRoaXMuc3RhdHVzLnNyY1NldCkge1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlYWQgb3JpZ2luYWwgc3RhdHVzIGJlZm9yZSBpc3N1aW5nIHRoZSBzZXRNZWRpYSBjb21tYW5kLlxyXG5cdFx0XHRcdFx0XHRcdHZhclx0Y3VycmVudFRpbWUgPSB0aGlzLnN0YXR1cy5jdXJyZW50VGltZSxcclxuXHRcdFx0XHRcdFx0XHRcdHBhdXNlZCA9IHRoaXMuc3RhdHVzLnBhdXNlZDsgXHJcblxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuc2V0TWVkaWEodGhpcy5zdGF0dXMubWVkaWEpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudm9sdW1lV29ya2VyKHRoaXMub3B0aW9ucy52b2x1bWUpO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGN1cnJlbnRUaW1lID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYocGF1c2VkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGF1c2UoY3VycmVudFRpbWUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbGF5KGN1cnJlbnRUaW1lKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQuZmxhc2hyZXNldCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRoaXMuZmxhc2guZ2F0ZSkge1xyXG5cdFx0XHRcdHN3aXRjaChldmVudFR5cGUpIHtcclxuXHRcdFx0XHRcdGNhc2UgJC5qUGxheWVyLmV2ZW50LnByb2dyZXNzOlxyXG5cdFx0XHRcdFx0XHR0aGlzLl9nZXRGbGFzaFN0YXR1cyhzdGF0dXMpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcihldmVudFR5cGUpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJC5qUGxheWVyLmV2ZW50LnRpbWV1cGRhdGU6XHJcblx0XHRcdFx0XHRcdHRoaXMuX2dldEZsYXNoU3RhdHVzKHN0YXR1cyk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3VwZGF0ZUludGVyZmFjZSgpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLl90cmlnZ2VyKGV2ZW50VHlwZSk7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAkLmpQbGF5ZXIuZXZlbnQucGxheTpcclxuXHRcdFx0XHRcdFx0dGhpcy5fc2Vla2VkKCk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3VwZGF0ZUJ1dHRvbnModHJ1ZSk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3RyaWdnZXIoZXZlbnRUeXBlKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICQualBsYXllci5ldmVudC5wYXVzZTpcclxuXHRcdFx0XHRcdFx0dGhpcy5fdXBkYXRlQnV0dG9ucyhmYWxzZSk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3RyaWdnZXIoZXZlbnRUeXBlKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICQualBsYXllci5ldmVudC5lbmRlZDpcclxuXHRcdFx0XHRcdFx0dGhpcy5fdXBkYXRlQnV0dG9ucyhmYWxzZSk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3RyaWdnZXIoZXZlbnRUeXBlKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICQualBsYXllci5ldmVudC5jbGljazpcclxuXHRcdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcihldmVudFR5cGUpOyAvLyBUaGlzIGNvdWxkIGJlIGRlYWx0IHdpdGggYnkgdGhlIGRlZmF1bHRcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICQualBsYXllci5ldmVudC5lcnJvcjpcclxuXHRcdFx0XHRcdFx0dGhpcy5zdGF0dXMud2FpdEZvckxvYWQgPSB0cnVlOyAvLyBBbGxvd3MgdGhlIGxvYWQgb3BlcmF0aW9uIHRvIHRyeSBhZ2Fpbi5cclxuXHRcdFx0XHRcdFx0dGhpcy5zdGF0dXMud2FpdEZvclBsYXkgPSB0cnVlOyAvLyBSZXNldCBzaW5jZSBhIHBsYXkgd2FzIGNhcHR1cmVkLlxyXG5cdFx0XHRcdFx0XHRpZih0aGlzLnN0YXR1cy52aWRlbykge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwuZmxhc2guanEuY3NzKHsnd2lkdGgnOicwcHgnLCAnaGVpZ2h0JzonMHB4J30pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKHRoaXMuX3ZhbGlkU3RyaW5nKHRoaXMuc3RhdHVzLm1lZGlhLnBvc3RlcikpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmludGVybmFsLnBvc3Rlci5qcS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYodGhpcy5jc3MuanEudmlkZW9QbGF5Lmxlbmd0aCAmJiB0aGlzLnN0YXR1cy52aWRlbykge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuY3NzLmpxLnZpZGVvUGxheS5zaG93KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYodGhpcy5zdGF0dXMudmlkZW8pIHsgLy8gU2V0IHVwIGZvciBhbm90aGVyIHRyeS4gRXhlY3V0ZSBiZWZvcmUgZXJyb3IgZXZlbnQuXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5fZmxhc2hfc2V0VmlkZW8odGhpcy5zdGF0dXMubWVkaWEpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuX2ZsYXNoX3NldEF1ZGlvKHRoaXMuc3RhdHVzLm1lZGlhKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0aGlzLl91cGRhdGVCdXR0b25zKGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5fZXJyb3IoIHtcclxuXHRcdFx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIuZXJyb3IuVVJMLFxyXG5cdFx0XHRcdFx0XHRcdGNvbnRleHQ6c3RhdHVzLnNyYyxcclxuXHRcdFx0XHRcdFx0XHRtZXNzYWdlOiAkLmpQbGF5ZXIuZXJyb3JNc2cuVVJMLFxyXG5cdFx0XHRcdFx0XHRcdGhpbnQ6ICQualBsYXllci5lcnJvckhpbnQuVVJMXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJC5qUGxheWVyLmV2ZW50LnNlZWtpbmc6XHJcblx0XHRcdFx0XHRcdHRoaXMuX3NlZWtpbmcoKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcihldmVudFR5cGUpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgJC5qUGxheWVyLmV2ZW50LnNlZWtlZDpcclxuXHRcdFx0XHRcdFx0dGhpcy5fc2Vla2VkKCk7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3RyaWdnZXIoZXZlbnRUeXBlKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICQualBsYXllci5ldmVudC5yZWFkeTpcclxuXHRcdFx0XHRcdFx0Ly8gVGhlIHJlYWR5IGV2ZW50IGlzIGhhbmRsZWQgb3V0c2lkZSB0aGUgc3dpdGNoIHN0YXRlbWVudC5cclxuXHRcdFx0XHRcdFx0Ly8gQ2FwdHVyZWQgaGVyZSBvdGhlcndpc2UgMiByZWFkeSBldmVudHMgd291bGQgYmUgZ2VuZXJhdGVkIGlmIHRoZSByZWFkeSBldmVudCBoYW5kbGVyIHVzZWQgc2V0TWVkaWEuXHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdFx0dGhpcy5fdHJpZ2dlcihldmVudFR5cGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9LFxyXG5cdFx0X2dldEZsYXNoU3RhdHVzOiBmdW5jdGlvbihzdGF0dXMpIHtcclxuXHRcdFx0dGhpcy5zdGF0dXMuc2Vla1BlcmNlbnQgPSBzdGF0dXMuc2Vla1BlcmNlbnQ7XHJcblx0XHRcdHRoaXMuc3RhdHVzLmN1cnJlbnRQZXJjZW50UmVsYXRpdmUgPSBzdGF0dXMuY3VycmVudFBlcmNlbnRSZWxhdGl2ZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMuY3VycmVudFBlcmNlbnRBYnNvbHV0ZSA9IHN0YXR1cy5jdXJyZW50UGVyY2VudEFic29sdXRlO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5jdXJyZW50VGltZSA9IHN0YXR1cy5jdXJyZW50VGltZTtcclxuXHRcdFx0dGhpcy5zdGF0dXMuZHVyYXRpb24gPSBzdGF0dXMuZHVyYXRpb247XHJcblx0XHRcdHRoaXMuc3RhdHVzLnJlbWFpbmluZyA9IHN0YXR1cy5kdXJhdGlvbiAtIHN0YXR1cy5jdXJyZW50VGltZTtcclxuXHJcblx0XHRcdHRoaXMuc3RhdHVzLnZpZGVvV2lkdGggPSBzdGF0dXMudmlkZW9XaWR0aDtcclxuXHRcdFx0dGhpcy5zdGF0dXMudmlkZW9IZWlnaHQgPSBzdGF0dXMudmlkZW9IZWlnaHQ7XHJcblxyXG5cdFx0XHQvLyBUaGUgRmxhc2ggZG9lcyBub3QgZ2VuZXJhdGUgdGhpcyBpbmZvcm1hdGlvbiBpbiB0aGlzIHJlbGVhc2VcclxuXHRcdFx0dGhpcy5zdGF0dXMucmVhZHlTdGF0ZSA9IDQ7IC8vIHN0YXR1cy5yZWFkeVN0YXRlO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5uZXR3b3JrU3RhdGUgPSAwOyAvLyBzdGF0dXMubmV0d29ya1N0YXRlO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5wbGF5YmFja1JhdGUgPSAxOyAvLyBzdGF0dXMucGxheWJhY2tSYXRlO1xyXG5cdFx0XHR0aGlzLnN0YXR1cy5lbmRlZCA9IGZhbHNlOyAvLyBzdGF0dXMuZW5kZWQ7XHJcblx0XHR9LFxyXG5cdFx0X3VwZGF0ZUJ1dHRvbnM6IGZ1bmN0aW9uKHBsYXlpbmcpIHtcclxuXHRcdFx0aWYocGxheWluZyA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0cGxheWluZyA9ICF0aGlzLnN0YXR1cy5wYXVzZWQ7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0dXMucGF1c2VkID0gIXBsYXlpbmc7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gQXBwbHkgdGhlIHN0YXRlIGNsYXNzZXMuIChGb3IgdGhlIHVzZVN0YXRlQ2xhc3NTa2luOnRydWUgb3B0aW9uKVxyXG5cdFx0XHRpZihwbGF5aW5nKSB7XHJcblx0XHRcdFx0dGhpcy5hZGRTdGF0ZUNsYXNzKCdwbGF5aW5nJyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5yZW1vdmVTdGF0ZUNsYXNzKCdwbGF5aW5nJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIXRoaXMuc3RhdHVzLm5vRnVsbFdpbmRvdyAmJiB0aGlzLm9wdGlvbnMuZnVsbFdpbmRvdykge1xyXG5cdFx0XHRcdHRoaXMuYWRkU3RhdGVDbGFzcygnZnVsbFNjcmVlbicpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMucmVtb3ZlU3RhdGVDbGFzcygnZnVsbFNjcmVlbicpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5sb29wKSB7XHJcblx0XHRcdFx0dGhpcy5hZGRTdGF0ZUNsYXNzKCdsb29wZWQnKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLnJlbW92ZVN0YXRlQ2xhc3MoJ2xvb3BlZCcpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFRvZ2dsZSB0aGUgR1VJIGVsZW1lbnQgcGFpcnMuIChGb3IgdGhlIHVzZVN0YXRlQ2xhc3NTa2luOmZhbHNlIG9wdGlvbilcclxuXHRcdFx0aWYodGhpcy5jc3MuanEucGxheS5sZW5ndGggJiYgdGhpcy5jc3MuanEucGF1c2UubGVuZ3RoKSB7XHJcblx0XHRcdFx0aWYocGxheWluZykge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucGxheS5oaWRlKCk7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5wYXVzZS5zaG93KCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnBsYXkuc2hvdygpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucGF1c2UuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS5yZXN0b3JlU2NyZWVuLmxlbmd0aCAmJiB0aGlzLmNzcy5qcS5mdWxsU2NyZWVuLmxlbmd0aCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuc3RhdHVzLm5vRnVsbFdpbmRvdykge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEuZnVsbFNjcmVlbi5oaWRlKCk7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5yZXN0b3JlU2NyZWVuLmhpZGUoKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYodGhpcy5vcHRpb25zLmZ1bGxXaW5kb3cpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLmZ1bGxTY3JlZW4uaGlkZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucmVzdG9yZVNjcmVlbi5zaG93KCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLmZ1bGxTY3JlZW4uc2hvdygpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucmVzdG9yZVNjcmVlbi5oaWRlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLnJlcGVhdC5sZW5ndGggJiYgdGhpcy5jc3MuanEucmVwZWF0T2ZmLmxlbmd0aCkge1xyXG5cdFx0XHRcdGlmKHRoaXMub3B0aW9ucy5sb29wKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5yZXBlYXQuaGlkZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucmVwZWF0T2ZmLnNob3coKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucmVwZWF0LnNob3coKTtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnJlcGVhdE9mZi5oaWRlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X3VwZGF0ZUludGVyZmFjZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLnNlZWtCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEuc2Vla0Jhci53aWR0aCh0aGlzLnN0YXR1cy5zZWVrUGVyY2VudCtcIiVcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodGhpcy5jc3MuanEucGxheUJhci5sZW5ndGgpIHtcclxuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMuc21vb3RoUGxheUJhcikge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucGxheUJhci5zdG9wKCkuYW5pbWF0ZSh7XHJcblx0XHRcdFx0XHRcdHdpZHRoOiB0aGlzLnN0YXR1cy5jdXJyZW50UGVyY2VudEFic29sdXRlK1wiJVwiXHJcblx0XHRcdFx0XHR9LCAyNTAsIFwibGluZWFyXCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5wbGF5QmFyLndpZHRoKHRoaXMuc3RhdHVzLmN1cnJlbnRQZXJjZW50UmVsYXRpdmUrXCIlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgY3VycmVudFRpbWVUZXh0ID0gJyc7XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLmN1cnJlbnRUaW1lLmxlbmd0aCkge1xyXG5cdFx0XHRcdGN1cnJlbnRUaW1lVGV4dCA9IHRoaXMuX2NvbnZlcnRUaW1lKHRoaXMuc3RhdHVzLmN1cnJlbnRUaW1lKTtcclxuXHRcdFx0XHRpZihjdXJyZW50VGltZVRleHQgIT09IHRoaXMuY3NzLmpxLmN1cnJlbnRUaW1lLnRleHQoKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEuY3VycmVudFRpbWUudGV4dCh0aGlzLl9jb252ZXJ0VGltZSh0aGlzLnN0YXR1cy5jdXJyZW50VGltZSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgZHVyYXRpb25UZXh0ID0gJycsXHJcblx0XHRcdFx0ZHVyYXRpb24gPSB0aGlzLnN0YXR1cy5kdXJhdGlvbixcclxuXHRcdFx0XHRyZW1haW5pbmcgPSB0aGlzLnN0YXR1cy5yZW1haW5pbmc7XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLmR1cmF0aW9uLmxlbmd0aCkge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB0aGlzLnN0YXR1cy5tZWRpYS5kdXJhdGlvbiA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGR1cmF0aW9uVGV4dCA9IHRoaXMuc3RhdHVzLm1lZGlhLmR1cmF0aW9uO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZih0eXBlb2YgdGhpcy5zdGF0dXMubWVkaWEuZHVyYXRpb24gPT09ICdudW1iZXInKSB7XHJcblx0XHRcdFx0XHRcdGR1cmF0aW9uID0gdGhpcy5zdGF0dXMubWVkaWEuZHVyYXRpb247XHJcblx0XHRcdFx0XHRcdHJlbWFpbmluZyA9IGR1cmF0aW9uIC0gdGhpcy5zdGF0dXMuY3VycmVudFRpbWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0aGlzLm9wdGlvbnMucmVtYWluaW5nRHVyYXRpb24pIHtcclxuXHRcdFx0XHRcdFx0ZHVyYXRpb25UZXh0ID0gKHJlbWFpbmluZyA+IDAgPyAnLScgOiAnJykgKyB0aGlzLl9jb252ZXJ0VGltZShyZW1haW5pbmcpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0ZHVyYXRpb25UZXh0ID0gdGhpcy5fY29udmVydFRpbWUoZHVyYXRpb24pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihkdXJhdGlvblRleHQgIT09IHRoaXMuY3NzLmpxLmR1cmF0aW9uLnRleHQoKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEuZHVyYXRpb24udGV4dChkdXJhdGlvblRleHQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9jb252ZXJ0VGltZTogQ29udmVydFRpbWUucHJvdG90eXBlLnRpbWUsXHJcblx0XHRfc2Vla2luZzogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLnNlZWtCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEuc2Vla0Jhci5hZGRDbGFzcyhcImpwLXNlZWtpbmctYmdcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5hZGRTdGF0ZUNsYXNzKCdzZWVraW5nJyk7XHJcblx0XHR9LFxyXG5cdFx0X3NlZWtlZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMuY3NzLmpxLnNlZWtCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEuc2Vla0Jhci5yZW1vdmVDbGFzcyhcImpwLXNlZWtpbmctYmdcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5yZW1vdmVTdGF0ZUNsYXNzKCdzZWVraW5nJyk7XHJcblx0XHR9LFxyXG5cdFx0X3Jlc2V0R2F0ZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMuaHRtbC5hdWRpby5nYXRlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuaHRtbC52aWRlby5nYXRlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuYXVyb3JhLmdhdGUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5mbGFzaC5nYXRlID0gZmFsc2U7XHJcblx0XHR9LFxyXG5cdFx0X3Jlc2V0QWN0aXZlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5odG1sLmFjdGl2ZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmF1cm9yYS5hY3RpdmUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5mbGFzaC5hY3RpdmUgPSBmYWxzZTtcclxuXHRcdH0sXHJcblx0XHRfZXNjYXBlSHRtbDogZnVuY3Rpb24ocykge1xyXG5cdFx0XHRyZXR1cm4gcy5zcGxpdCgnJicpLmpvaW4oJyZhbXA7Jykuc3BsaXQoJzwnKS5qb2luKCcmbHQ7Jykuc3BsaXQoJz4nKS5qb2luKCcmZ3Q7Jykuc3BsaXQoJ1wiJykuam9pbignJnF1b3Q7Jyk7XHJcblx0XHR9LFxyXG5cdFx0X3F1YWxpZnlVUkw6IGZ1bmN0aW9uKHVybCkge1xyXG5cdFx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0ZWwuaW5uZXJIVE1MPSAnPGEgaHJlZj1cIicgKyB0aGlzLl9lc2NhcGVIdG1sKHVybCkgKyAnXCI+eDwvYT4nO1xyXG5cdFx0XHRyZXR1cm4gZWwuZmlyc3RDaGlsZC5ocmVmO1xyXG5cdFx0fSxcclxuXHRcdF9hYnNvbHV0ZU1lZGlhVXJsczogZnVuY3Rpb24obWVkaWEpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHQkLmVhY2gobWVkaWEsIGZ1bmN0aW9uKHR5cGUsIHVybCkge1xyXG5cdFx0XHRcdGlmKHVybCAmJiBzZWxmLmZvcm1hdFt0eXBlXSAmJiB1cmwuc3Vic3RyKDAsIDUpICE9PSBcImRhdGE6XCIpIHtcclxuXHRcdFx0XHRcdG1lZGlhW3R5cGVdID0gc2VsZi5fcXVhbGlmeVVSTCh1cmwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiBtZWRpYTtcclxuXHRcdH0sXHJcblx0XHRhZGRTdGF0ZUNsYXNzOiBmdW5jdGlvbihzdGF0ZSkge1xyXG5cdFx0XHRpZih0aGlzLmFuY2VzdG9ySnEubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5hbmNlc3RvckpxLmFkZENsYXNzKHRoaXMub3B0aW9ucy5zdGF0ZUNsYXNzW3N0YXRlXSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRyZW1vdmVTdGF0ZUNsYXNzOiBmdW5jdGlvbihzdGF0ZSkge1xyXG5cdFx0XHRpZih0aGlzLmFuY2VzdG9ySnEubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5hbmNlc3RvckpxLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5zdGF0ZUNsYXNzW3N0YXRlXSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRzZXRNZWRpYTogZnVuY3Rpb24obWVkaWEpIHtcclxuXHRcdFxyXG5cdFx0XHQvKlx0bWVkaWFbZm9ybWF0XSA9IFN0cmluZzogVVJMIG9mIGZvcm1hdC4gTXVzdCBjb250YWluIGFsbCBvZiB0aGUgc3VwcGxpZWQgb3B0aW9uJ3MgdmlkZW8gb3IgYXVkaW8gZm9ybWF0cy5cclxuXHRcdFx0ICpcdG1lZGlhLnBvc3RlciA9IFN0cmluZzogVmlkZW8gcG9zdGVyIFVSTC5cclxuXHRcdFx0ICpcdG1lZGlhLnRyYWNrID0gQXJyYXk6IE9mIG9iamVjdHMgZGVmaW5pbmcgdGhlIHRyYWNrIGVsZW1lbnQ6IGtpbmQsIHNyYywgc3JjbGFuZywgbGFiZWwsIGRlZi5cclxuXHRcdFx0ICpcdG1lZGlhLnN0cmVhbSA9IEJvb2xlYW46ICogTk9UIElNUExFTUVOVEVEICogRGVzaWduYXRpbmcgYWN0dWFsIG1lZGlhIHN0cmVhbXMuIGllLiwgXCJmYWxzZS91bmRlZmluZWRcIiBmb3IgZmlsZXMuIFBsYW4gdG8gcmVmcmVzaCB0aGUgZmxhc2ggZXZlcnkgc28gb2Z0ZW4uXHJcblx0XHRcdCAqL1xyXG5cclxuXHRcdFx0dmFyXHRzZWxmID0gdGhpcyxcclxuXHRcdFx0XHRzdXBwb3J0ZWQgPSBmYWxzZSxcclxuXHRcdFx0XHRwb3N0ZXJDaGFuZ2VkID0gdGhpcy5zdGF0dXMubWVkaWEucG9zdGVyICE9PSBtZWRpYS5wb3N0ZXI7IC8vIENvbXBhcmUgYmVmb3JlIHJlc2V0LiBJbXBvcnRhbnQgZm9yIE9TWCBTYWZhcmkgYXMgdGhpcy5odG1sRWxlbWVudC5wb3N0ZXIuc3JjIGlzIGFic29sdXRlLCBldmVuIGlmIG9yaWdpbmFsIHBvc3RlciBVUkwgd2FzIHJlbGF0aXZlLlxyXG5cclxuXHRcdFx0dGhpcy5fcmVzZXRNZWRpYSgpO1xyXG5cdFx0XHR0aGlzLl9yZXNldEdhdGUoKTtcclxuXHRcdFx0dGhpcy5fcmVzZXRBY3RpdmUoKTtcclxuXHJcblx0XHRcdC8vIENsZWFyIHRoZSBBbmRyb2lkIEZpeC5cclxuXHRcdFx0dGhpcy5hbmRyb2lkRml4LnNldE1lZGlhID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuYW5kcm9pZEZpeC5wbGF5ID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuYW5kcm9pZEZpeC5wYXVzZSA9IGZhbHNlO1xyXG5cclxuXHRcdFx0Ly8gQ29udmVydCBhbGwgbWVkaWEgVVJMcyB0byBhYnNvbHV0ZSBVUkxzLlxyXG5cdFx0XHRtZWRpYSA9IHRoaXMuX2Fic29sdXRlTWVkaWFVcmxzKG1lZGlhKTtcclxuXHJcblx0XHRcdCQuZWFjaCh0aGlzLmZvcm1hdHMsIGZ1bmN0aW9uKGZvcm1hdFByaW9yaXR5LCBmb3JtYXQpIHtcclxuXHRcdFx0XHR2YXIgaXNWaWRlbyA9IHNlbGYuZm9ybWF0W2Zvcm1hdF0ubWVkaWEgPT09ICd2aWRlbyc7XHJcblx0XHRcdFx0JC5lYWNoKHNlbGYuc29sdXRpb25zLCBmdW5jdGlvbihzb2x1dGlvblByaW9yaXR5LCBzb2x1dGlvbikge1xyXG5cdFx0XHRcdFx0aWYoc2VsZltzb2x1dGlvbl0uc3VwcG9ydFtmb3JtYXRdICYmIHNlbGYuX3ZhbGlkU3RyaW5nKG1lZGlhW2Zvcm1hdF0pKSB7IC8vIEZvcm1hdCBzdXBwb3J0ZWQgaW4gc29sdXRpb24gYW5kIHVybCBnaXZlbiBmb3IgZm9ybWF0LlxyXG5cdFx0XHRcdFx0XHR2YXIgaXNIdG1sID0gc29sdXRpb24gPT09ICdodG1sJztcclxuXHRcdFx0XHRcdFx0dmFyIGlzQXVyb3JhID0gc29sdXRpb24gPT09ICdhdXJvcmEnO1xyXG5cclxuXHRcdFx0XHRcdFx0aWYoaXNWaWRlbykge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGlzSHRtbCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5odG1sLnZpZGVvLmdhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5faHRtbF9zZXRWaWRlbyhtZWRpYSk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmh0bWwuYWN0aXZlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5mbGFzaC5nYXRlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuX2ZsYXNoX3NldFZpZGVvKG1lZGlhKTtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuZmxhc2guYWN0aXZlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoc2VsZi5jc3MuanEudmlkZW9QbGF5Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5jc3MuanEudmlkZW9QbGF5LnNob3coKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0c2VsZi5zdGF0dXMudmlkZW8gPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGlzSHRtbCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5odG1sLmF1ZGlvLmdhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5faHRtbF9zZXRBdWRpbyhtZWRpYSk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmh0bWwuYWN0aXZlID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvLyBTZXR1cCB0aGUgQW5kcm9pZCBGaXggLSBPbmx5IGZvciBIVE1MIGF1ZGlvLlxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoJC5qUGxheWVyLnBsYXRmb3JtLmFuZHJvaWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5hbmRyb2lkRml4LnNldE1lZGlhID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYoaXNBdXJvcmEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuYXVyb3JhLmdhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5fYXVyb3JhX3NldEF1ZGlvKG1lZGlhKTtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuYXVyb3JhLmFjdGl2ZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuZmxhc2guZ2F0ZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRzZWxmLl9mbGFzaF9zZXRBdWRpbyhtZWRpYSk7XHJcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmZsYXNoLmFjdGl2ZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdGlmKHNlbGYuY3NzLmpxLnZpZGVvUGxheS5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuY3NzLmpxLnZpZGVvUGxheS5oaWRlKCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLnZpZGVvID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdHN1cHBvcnRlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTsgLy8gRXhpdCAkLmVhY2hcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZihzdXBwb3J0ZWQpIHtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTsgLy8gRXhpdCAkLmVhY2hcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0aWYoc3VwcG9ydGVkKSB7XHJcblx0XHRcdFx0aWYoISh0aGlzLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzICYmIHRoaXMuaHRtbC52aWRlby5nYXRlKSkge1xyXG5cdFx0XHRcdFx0Ly8gU2V0IHBvc3RlciBJTUcgaWYgbmF0aXZlIHZpZGVvIGNvbnRyb2xzIGFyZSBub3QgYmVpbmcgdXNlZFxyXG5cdFx0XHRcdFx0Ly8gTm90ZTogV2l0aCBJRSB0aGUgSU1HIG9ubG9hZCBldmVudCBvY2N1cnMgaW1tZWRpYXRlbHkgd2hlbiBjYWNoZWQuXHJcblx0XHRcdFx0XHQvLyBOb3RlOiBQb3N0ZXIgaGlkZGVuIGJ5IGRlZmF1bHQgaW4gX3Jlc2V0TWVkaWEoKVxyXG5cdFx0XHRcdFx0aWYodGhpcy5fdmFsaWRTdHJpbmcobWVkaWEucG9zdGVyKSkge1xyXG5cdFx0XHRcdFx0XHRpZihwb3N0ZXJDaGFuZ2VkKSB7IC8vIFNpbmNlIHNvbWUgYnJvd3NlcnMgZG8gbm90IGdlbmVyYXRlIGltZyBvbmxvYWQgZXZlbnQuXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5odG1sRWxlbWVudC5wb3N0ZXIuc3JjID0gbWVkaWEucG9zdGVyO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLnNob3coKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0eXBlb2YgbWVkaWEudGl0bGUgPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRpZih0aGlzLmNzcy5qcS50aXRsZS5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5jc3MuanEudGl0bGUuaHRtbChtZWRpYS50aXRsZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0aGlzLmh0bWxFbGVtZW50LmF1ZGlvKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQuYXVkaW8uc2V0QXR0cmlidXRlKCd0aXRsZScsIG1lZGlhLnRpdGxlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKHRoaXMuaHRtbEVsZW1lbnQudmlkZW8pIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5odG1sRWxlbWVudC52aWRlby5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgbWVkaWEudGl0bGUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLnN0YXR1cy5zcmNTZXQgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLm1lZGlhID0gJC5leHRlbmQoe30sIG1lZGlhKTtcclxuXHRcdFx0XHR0aGlzLl91cGRhdGVCdXR0b25zKGZhbHNlKTtcclxuXHRcdFx0XHR0aGlzLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHR0aGlzLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5zZXRtZWRpYSk7XHJcblx0XHRcdH0gZWxzZSB7IC8vIGpQbGF5ZXIgY2Fubm90IHN1cHBvcnQgYW55IGZvcm1hdHMgcHJvdmlkZWQgaW4gdGhpcyBicm93c2VyXHJcblx0XHRcdFx0Ly8gU2VuZCBhbiBlcnJvciBldmVudFxyXG5cdFx0XHRcdHRoaXMuX2Vycm9yKCB7XHJcblx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIuZXJyb3IuTk9fU1VQUE9SVCxcclxuXHRcdFx0XHRcdGNvbnRleHQ6IFwie3N1cHBsaWVkOidcIiArIHRoaXMub3B0aW9ucy5zdXBwbGllZCArIFwiJ31cIixcclxuXHRcdFx0XHRcdG1lc3NhZ2U6ICQualBsYXllci5lcnJvck1zZy5OT19TVVBQT1JULFxyXG5cdFx0XHRcdFx0aGludDogJC5qUGxheWVyLmVycm9ySGludC5OT19TVVBQT1JUXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfcmVzZXRNZWRpYTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMuX3Jlc2V0U3RhdHVzKCk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZUJ1dHRvbnMoZmFsc2UpO1xyXG5cdFx0XHR0aGlzLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0dGhpcy5fc2Vla2VkKCk7XHJcblx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLmhpZGUoKTtcclxuXHJcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmludGVybmFsLmh0bWxEbHlDbWRJZCk7XHJcblxyXG5cdFx0XHRpZih0aGlzLmh0bWwuYWN0aXZlKSB7XHJcblx0XHRcdFx0dGhpcy5faHRtbF9yZXNldE1lZGlhKCk7XHJcblx0XHRcdH0gZWxzZSBpZih0aGlzLmF1cm9yYS5hY3RpdmUpIHtcclxuXHRcdFx0XHR0aGlzLl9hdXJvcmFfcmVzZXRNZWRpYSgpO1xyXG5cdFx0XHR9IGVsc2UgaWYodGhpcy5mbGFzaC5hY3RpdmUpIHtcclxuXHRcdFx0XHR0aGlzLl9mbGFzaF9yZXNldE1lZGlhKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRjbGVhck1lZGlhOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5fcmVzZXRNZWRpYSgpO1xyXG5cclxuXHRcdFx0aWYodGhpcy5odG1sLmFjdGl2ZSkge1xyXG5cdFx0XHRcdHRoaXMuX2h0bWxfY2xlYXJNZWRpYSgpO1xyXG5cdFx0XHR9IGVsc2UgaWYodGhpcy5hdXJvcmEuYWN0aXZlKSB7XHJcblx0XHRcdFx0dGhpcy5fYXVyb3JhX2NsZWFyTWVkaWEoKTtcclxuXHRcdFx0fSBlbHNlIGlmKHRoaXMuZmxhc2guYWN0aXZlKSB7XHJcblx0XHRcdFx0dGhpcy5fZmxhc2hfY2xlYXJNZWRpYSgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLl9yZXNldEdhdGUoKTtcclxuXHRcdFx0dGhpcy5fcmVzZXRBY3RpdmUoKTtcclxuXHRcdH0sXHJcblx0XHRsb2FkOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0dXMuc3JjU2V0KSB7XHJcblx0XHRcdFx0aWYodGhpcy5odG1sLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5faHRtbF9sb2FkKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuYXVyb3JhLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fYXVyb3JhX2xvYWQoKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYodGhpcy5mbGFzaC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2ZsYXNoX2xvYWQoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5fdXJsTm90U2V0RXJyb3IoXCJsb2FkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0Zm9jdXM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMua2V5RW5hYmxlZCkge1xyXG5cdFx0XHRcdCQualBsYXllci5mb2N1cyA9IHRoaXM7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRwbGF5OiBmdW5jdGlvbih0aW1lKSB7XHJcblx0XHRcdHZhciBndWlBY3Rpb24gPSB0eXBlb2YgdGltZSA9PT0gXCJvYmplY3RcIjsgLy8gRmxhZ3MgR1VJIGNsaWNrIGV2ZW50cyBzbyB3ZSBrbm93IHRoaXMgd2FzIG5vdCBhIGRpcmVjdCBjb21tYW5kLCBidXQgYW4gYWN0aW9uIHRha2VuIGJ5IHRoZSB1c2VyIG9uIHRoZSBHVUkuXHJcblx0XHRcdGlmKGd1aUFjdGlvbiAmJiB0aGlzLm9wdGlvbnMudXNlU3RhdGVDbGFzc1NraW4gJiYgIXRoaXMuc3RhdHVzLnBhdXNlZCkge1xyXG5cdFx0XHRcdHRoaXMucGF1c2UodGltZSk7IC8vIFRoZSB0aW1lIHdvdWxkIGJlIHRoZSBjbGljayBldmVudCwgYnV0IHBhc3NpbmcgaXQgb3ZlciBzbyBpbmZvIGlzIG5vdCBsb3N0LlxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRpbWUgPSAodHlwZW9mIHRpbWUgPT09IFwibnVtYmVyXCIpID8gdGltZSA6IE5hTjsgLy8gUmVtb3ZlIGpRdWVyeSBldmVudCBmcm9tIGNsaWNrIGhhbmRsZXJcclxuXHRcdFx0XHRpZih0aGlzLnN0YXR1cy5zcmNTZXQpIHtcclxuXHRcdFx0XHRcdHRoaXMuZm9jdXMoKTtcclxuXHRcdFx0XHRcdGlmKHRoaXMuaHRtbC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5faHRtbF9wbGF5KHRpbWUpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuYXVyb3JhLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLl9hdXJvcmFfcGxheSh0aW1lKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZih0aGlzLmZsYXNoLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLl9mbGFzaF9wbGF5KHRpbWUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLl91cmxOb3RTZXRFcnJvcihcInBsYXlcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0dmlkZW9QbGF5OiBmdW5jdGlvbigpIHsgLy8gSGFuZGxlcyBjbGlja3Mgb24gdGhlIHBsYXkgYnV0dG9uIG92ZXIgdGhlIHZpZGVvIHBvc3RlclxyXG5cdFx0XHR0aGlzLnBsYXkoKTtcclxuXHRcdH0sXHJcblx0XHRwYXVzZTogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR0aW1lID0gKHR5cGVvZiB0aW1lID09PSBcIm51bWJlclwiKSA/IHRpbWUgOiBOYU47IC8vIFJlbW92ZSBqUXVlcnkgZXZlbnQgZnJvbSBjbGljayBoYW5kbGVyXHJcblx0XHRcdGlmKHRoaXMuc3RhdHVzLnNyY1NldCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuaHRtbC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2h0bWxfcGF1c2UodGltZSk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuYXVyb3JhLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fYXVyb3JhX3BhdXNlKHRpbWUpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZih0aGlzLmZsYXNoLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fZmxhc2hfcGF1c2UodGltZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3VybE5vdFNldEVycm9yKFwicGF1c2VcIik7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHR0ZWxsT3RoZXJzOiBmdW5jdGlvbihjb21tYW5kLCBjb25kaXRpb25zKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcclxuXHRcdFx0XHRoYXNDb25kaXRpb25zID0gdHlwZW9mIGNvbmRpdGlvbnMgPT09ICdmdW5jdGlvbicsXHJcblx0XHRcdFx0YXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7IC8vIENvbnZlcnQgYXJndW1lbnRzIHRvIGFuIEFycmF5LlxyXG5cclxuXHRcdFx0aWYodHlwZW9mIGNvbW1hbmQgIT09ICdzdHJpbmcnKSB7IC8vIElnbm9yZSwgc2luY2Ugbm8gY29tbWFuZC5cclxuXHRcdFx0XHRyZXR1cm47IC8vIFJldHVybiB1bmRlZmluZWQgdG8gbWFpbnRhaW4gY2hhaW5pbmcuXHJcblx0XHRcdH1cclxuXHRcdFx0aWYoaGFzQ29uZGl0aW9ucykge1xyXG5cdFx0XHRcdGFyZ3Muc3BsaWNlKDEsIDEpOyAvLyBSZW1vdmUgdGhlIGNvbmRpdGlvbnMgZnJvbSB0aGUgYXJndW1lbnRzXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCQualBsYXllci5wcm90b3R5cGUuZGVzdHJveVJlbW92ZWQoKTtcclxuXHRcdFx0JC5lYWNoKHRoaXMuaW5zdGFuY2VzLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQvLyBSZW1lbWJlciB0aGF0IFwidGhpc1wiIGlzIHRoZSBpbnN0YW5jZSdzIFwiZWxlbWVudFwiIGluIHRoZSAkLmVhY2goKSBsb29wLlxyXG5cdFx0XHRcdGlmKHNlbGYuZWxlbWVudCAhPT0gdGhpcykgeyAvLyBEbyBub3QgdGVsbCBteSBpbnN0YW5jZS5cclxuXHRcdFx0XHRcdGlmKCFoYXNDb25kaXRpb25zIHx8IGNvbmRpdGlvbnMuY2FsbCh0aGlzLmRhdGEoXCJqUGxheWVyXCIpLCBzZWxmKSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmpQbGF5ZXIuYXBwbHkodGhpcywgYXJncyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblx0XHRwYXVzZU90aGVyczogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR0aGlzLnRlbGxPdGhlcnMoXCJwYXVzZVwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQvLyBJbiB0aGUgY29uZGl0aW9ucyBmdW5jdGlvbiwgdGhlIFwidGhpc1wiIGNvbnRleHQgaXMgdGhlIG90aGVyIGluc3RhbmNlJ3MgalBsYXllciBvYmplY3QuXHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuc3RhdHVzLnNyY1NldDtcclxuXHRcdFx0fSwgdGltZSk7XHJcblx0XHR9LFxyXG5cdFx0c3RvcDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMuc3RhdHVzLnNyY1NldCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuaHRtbC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2h0bWxfcGF1c2UoMCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuYXVyb3JhLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fYXVyb3JhX3BhdXNlKDApO1xyXG5cdFx0XHRcdH0gZWxzZSBpZih0aGlzLmZsYXNoLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fZmxhc2hfcGF1c2UoMCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3VybE5vdFNldEVycm9yKFwic3RvcFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHBsYXlIZWFkOiBmdW5jdGlvbihwKSB7XHJcblx0XHRcdHAgPSB0aGlzLl9saW1pdFZhbHVlKHAsIDAsIDEwMCk7XHJcblx0XHRcdGlmKHRoaXMuc3RhdHVzLnNyY1NldCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuaHRtbC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2h0bWxfcGxheUhlYWQocCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuYXVyb3JhLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fYXVyb3JhX3BsYXlIZWFkKHApO1xyXG5cdFx0XHRcdH0gZWxzZSBpZih0aGlzLmZsYXNoLmFjdGl2ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fZmxhc2hfcGxheUhlYWQocCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3VybE5vdFNldEVycm9yKFwicGxheUhlYWRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfbXV0ZWQ6IGZ1bmN0aW9uKG11dGVkKSB7XHJcblx0XHRcdHRoaXMubXV0ZWRXb3JrZXIobXV0ZWQpO1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuZ2xvYmFsVm9sdW1lKSB7XHJcblx0XHRcdFx0dGhpcy50ZWxsT3RoZXJzKFwibXV0ZWRXb3JrZXJcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBDaGVjayB0aGUgb3RoZXIgaW5zdGFuY2UgaGFzIGdsb2JhbCB2b2x1bWUgZW5hYmxlZC5cclxuXHRcdFx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnMuZ2xvYmFsVm9sdW1lO1xyXG5cdFx0XHRcdH0sIG11dGVkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdG11dGVkV29ya2VyOiBmdW5jdGlvbihtdXRlZCkge1xyXG5cdFx0XHR0aGlzLm9wdGlvbnMubXV0ZWQgPSBtdXRlZDtcclxuXHRcdFx0aWYodGhpcy5odG1sLnVzZWQpIHtcclxuXHRcdFx0XHR0aGlzLl9odG1sX3NldFByb3BlcnR5KCdtdXRlZCcsIG11dGVkKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmF1cm9yYS51c2VkKSB7XHJcblx0XHRcdFx0dGhpcy5fYXVyb3JhX211dGUobXV0ZWQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRoaXMuZmxhc2gudXNlZCkge1xyXG5cdFx0XHRcdHRoaXMuX2ZsYXNoX211dGUobXV0ZWQpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBUaGUgSFRNTCBzb2x1dGlvbiBnZW5lcmF0ZXMgdGhpcyBldmVudCBmcm9tIHRoZSBtZWRpYSBlbGVtZW50IGl0c2VsZi5cclxuXHRcdFx0aWYoIXRoaXMuaHRtbC52aWRlby5nYXRlICYmICF0aGlzLmh0bWwuYXVkaW8uZ2F0ZSkge1xyXG5cdFx0XHRcdHRoaXMuX3VwZGF0ZU11dGUobXV0ZWQpO1xyXG5cdFx0XHRcdHRoaXMuX3VwZGF0ZVZvbHVtZSh0aGlzLm9wdGlvbnMudm9sdW1lKTtcclxuXHRcdFx0XHR0aGlzLl90cmlnZ2VyKCQualBsYXllci5ldmVudC52b2x1bWVjaGFuZ2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0bXV0ZTogZnVuY3Rpb24obXV0ZSkgeyAvLyBtdXRlIGlzIGVpdGhlcjogdW5kZWZpbmVkICh0cnVlKSwgYW4gZXZlbnQgb2JqZWN0ICh0cnVlKSBvciBhIGJvb2xlYW4gKG11dGVkKS5cclxuXHRcdFx0dmFyIGd1aUFjdGlvbiA9IHR5cGVvZiBtdXRlID09PSBcIm9iamVjdFwiOyAvLyBGbGFncyBHVUkgY2xpY2sgZXZlbnRzIHNvIHdlIGtub3cgdGhpcyB3YXMgbm90IGEgZGlyZWN0IGNvbW1hbmQsIGJ1dCBhbiBhY3Rpb24gdGFrZW4gYnkgdGhlIHVzZXIgb24gdGhlIEdVSS5cclxuXHRcdFx0aWYoZ3VpQWN0aW9uICYmIHRoaXMub3B0aW9ucy51c2VTdGF0ZUNsYXNzU2tpbiAmJiB0aGlzLm9wdGlvbnMubXV0ZWQpIHtcclxuXHRcdFx0XHR0aGlzLl9tdXRlZChmYWxzZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bXV0ZSA9IG11dGUgPT09IHVuZGVmaW5lZCA/IHRydWUgOiAhIW11dGU7XHJcblx0XHRcdFx0dGhpcy5fbXV0ZWQobXV0ZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHR1bm11dGU6IGZ1bmN0aW9uKHVubXV0ZSkgeyAvLyB1bm11dGUgaXMgZWl0aGVyOiB1bmRlZmluZWQgKHRydWUpLCBhbiBldmVudCBvYmplY3QgKHRydWUpIG9yIGEgYm9vbGVhbiAoIW11dGVkKS5cclxuXHRcdFx0dW5tdXRlID0gdW5tdXRlID09PSB1bmRlZmluZWQgPyB0cnVlIDogISF1bm11dGU7XHJcblx0XHRcdHRoaXMuX211dGVkKCF1bm11dGUpO1xyXG5cdFx0fSxcclxuXHRcdF91cGRhdGVNdXRlOiBmdW5jdGlvbihtdXRlKSB7XHJcblx0XHRcdGlmKG11dGUgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdG11dGUgPSB0aGlzLm9wdGlvbnMubXV0ZWQ7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYobXV0ZSkge1xyXG5cdFx0XHRcdHRoaXMuYWRkU3RhdGVDbGFzcygnbXV0ZWQnKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLnJlbW92ZVN0YXRlQ2xhc3MoJ211dGVkJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodGhpcy5jc3MuanEubXV0ZS5sZW5ndGggJiYgdGhpcy5jc3MuanEudW5tdXRlLmxlbmd0aCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuc3RhdHVzLm5vVm9sdW1lKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5tdXRlLmhpZGUoKTtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnVubXV0ZS5oaWRlKCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKG11dGUpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLm11dGUuaGlkZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudW5tdXRlLnNob3coKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEubXV0ZS5zaG93KCk7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS51bm11dGUuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHZvbHVtZTogZnVuY3Rpb24odikge1xyXG5cdFx0XHR0aGlzLnZvbHVtZVdvcmtlcih2KTtcclxuXHRcdFx0aWYodGhpcy5vcHRpb25zLmdsb2JhbFZvbHVtZSkge1xyXG5cdFx0XHRcdHRoaXMudGVsbE90aGVycyhcInZvbHVtZVdvcmtlclwiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIENoZWNrIHRoZSBvdGhlciBpbnN0YW5jZSBoYXMgZ2xvYmFsIHZvbHVtZSBlbmFibGVkLlxyXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5nbG9iYWxWb2x1bWU7XHJcblx0XHRcdFx0fSwgdik7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHR2b2x1bWVXb3JrZXI6IGZ1bmN0aW9uKHYpIHtcclxuXHRcdFx0diA9IHRoaXMuX2xpbWl0VmFsdWUodiwgMCwgMSk7XHJcblx0XHRcdHRoaXMub3B0aW9ucy52b2x1bWUgPSB2O1xyXG5cclxuXHRcdFx0aWYodGhpcy5odG1sLnVzZWQpIHtcclxuXHRcdFx0XHR0aGlzLl9odG1sX3NldFByb3BlcnR5KCd2b2x1bWUnLCB2KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmF1cm9yYS51c2VkKSB7XHJcblx0XHRcdFx0dGhpcy5fYXVyb3JhX3ZvbHVtZSh2KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLmZsYXNoLnVzZWQpIHtcclxuXHRcdFx0XHR0aGlzLl9mbGFzaF92b2x1bWUodik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIFRoZSBIVE1MIHNvbHV0aW9uIGdlbmVyYXRlcyB0aGlzIGV2ZW50IGZyb20gdGhlIG1lZGlhIGVsZW1lbnQgaXRzZWxmLlxyXG5cdFx0XHRpZighdGhpcy5odG1sLnZpZGVvLmdhdGUgJiYgIXRoaXMuaHRtbC5hdWRpby5nYXRlKSB7XHJcblx0XHRcdFx0dGhpcy5fdXBkYXRlVm9sdW1lKHYpO1xyXG5cdFx0XHRcdHRoaXMuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnZvbHVtZWNoYW5nZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHR2b2x1bWVCYXI6IGZ1bmN0aW9uKGUpIHsgLy8gSGFuZGxlcyBjbGlja3Mgb24gdGhlIHZvbHVtZUJhclxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS52b2x1bWVCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0Ly8gVXNpbmcgJChlLmN1cnJlbnRUYXJnZXQpIHRvIGVuYWJsZSBtdWx0aXBsZSB2b2x1bWUgYmFyc1xyXG5cdFx0XHRcdHZhciAkYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpLFxyXG5cdFx0XHRcdFx0b2Zmc2V0ID0gJGJhci5vZmZzZXQoKSxcclxuXHRcdFx0XHRcdHggPSBlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQsXHJcblx0XHRcdFx0XHR3ID0gJGJhci53aWR0aCgpLFxyXG5cdFx0XHRcdFx0eSA9ICRiYXIuaGVpZ2h0KCkgLSBlLnBhZ2VZICsgb2Zmc2V0LnRvcCxcclxuXHRcdFx0XHRcdGggPSAkYmFyLmhlaWdodCgpO1xyXG5cdFx0XHRcdGlmKHRoaXMub3B0aW9ucy52ZXJ0aWNhbFZvbHVtZSkge1xyXG5cdFx0XHRcdFx0dGhpcy52b2x1bWUoeS9oKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy52b2x1bWUoeC93KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodGhpcy5vcHRpb25zLm11dGVkKSB7XHJcblx0XHRcdFx0dGhpcy5fbXV0ZWQoZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X3VwZGF0ZVZvbHVtZTogZnVuY3Rpb24odikge1xyXG5cdFx0XHRpZih2ID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHR2ID0gdGhpcy5vcHRpb25zLnZvbHVtZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2ID0gdGhpcy5vcHRpb25zLm11dGVkID8gMCA6IHY7XHJcblxyXG5cdFx0XHRpZih0aGlzLnN0YXR1cy5ub1ZvbHVtZSkge1xyXG5cdFx0XHRcdHRoaXMuYWRkU3RhdGVDbGFzcygnbm9Wb2x1bWUnKTtcclxuXHRcdFx0XHRpZih0aGlzLmNzcy5qcS52b2x1bWVCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS52b2x1bWVCYXIuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0aGlzLmNzcy5qcS52b2x1bWVCYXJWYWx1ZS5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnZvbHVtZUJhclZhbHVlLmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodGhpcy5jc3MuanEudm9sdW1lTWF4Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudm9sdW1lTWF4LmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5yZW1vdmVTdGF0ZUNsYXNzKCdub1ZvbHVtZScpO1xyXG5cdFx0XHRcdGlmKHRoaXMuY3NzLmpxLnZvbHVtZUJhci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnZvbHVtZUJhci5zaG93KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRoaXMuY3NzLmpxLnZvbHVtZUJhclZhbHVlLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudm9sdW1lQmFyVmFsdWUuc2hvdygpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudm9sdW1lQmFyVmFsdWVbdGhpcy5vcHRpb25zLnZlcnRpY2FsVm9sdW1lID8gXCJoZWlnaHRcIiA6IFwid2lkdGhcIl0oKHYqMTAwKStcIiVcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRoaXMuY3NzLmpxLnZvbHVtZU1heC5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnZvbHVtZU1heC5zaG93KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0dm9sdW1lTWF4OiBmdW5jdGlvbigpIHsgLy8gSGFuZGxlcyBjbGlja3Mgb24gdGhlIHZvbHVtZSBtYXhcclxuXHRcdFx0dGhpcy52b2x1bWUoMSk7XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5tdXRlZCkge1xyXG5cdFx0XHRcdHRoaXMuX211dGVkKGZhbHNlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9jc3NTZWxlY3RvckFuY2VzdG9yOiBmdW5jdGlvbihhbmNlc3Rvcikge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdHRoaXMub3B0aW9ucy5jc3NTZWxlY3RvckFuY2VzdG9yID0gYW5jZXN0b3I7XHJcblx0XHRcdHRoaXMuX3JlbW92ZVVpQ2xhc3MoKTtcclxuXHRcdFx0dGhpcy5hbmNlc3RvckpxID0gYW5jZXN0b3IgPyAkKGFuY2VzdG9yKSA6IFtdOyAvLyBXb3VsZCB1c2UgJCgpIGluc3RlYWQgb2YgW10sIGJ1dCBpdCBpcyBvbmx5IDEuNCtcclxuXHRcdFx0aWYoYW5jZXN0b3IgJiYgdGhpcy5hbmNlc3RvckpxLmxlbmd0aCAhPT0gMSkgeyAvLyBTbyBlbXB0eSBzdHJpbmdzIGRvIG5vdCBnZW5lcmF0ZSB0aGUgd2FybmluZy5cclxuXHRcdFx0XHR0aGlzLl93YXJuaW5nKCB7XHJcblx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIud2FybmluZy5DU1NfU0VMRUNUT1JfQ09VTlQsXHJcblx0XHRcdFx0XHRjb250ZXh0OiBhbmNlc3RvcixcclxuXHRcdFx0XHRcdG1lc3NhZ2U6ICQualBsYXllci53YXJuaW5nTXNnLkNTU19TRUxFQ1RPUl9DT1VOVCArIHRoaXMuYW5jZXN0b3JKcS5sZW5ndGggKyBcIiBmb3VuZCBmb3IgY3NzU2VsZWN0b3JBbmNlc3Rvci5cIixcclxuXHRcdFx0XHRcdGhpbnQ6ICQualBsYXllci53YXJuaW5nSGludC5DU1NfU0VMRUNUT1JfQ09VTlRcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9hZGRVaUNsYXNzKCk7XHJcblx0XHRcdCQuZWFjaCh0aGlzLm9wdGlvbnMuY3NzU2VsZWN0b3IsIGZ1bmN0aW9uKGZuLCBjc3NTZWwpIHtcclxuXHRcdFx0XHRzZWxmLl9jc3NTZWxlY3RvcihmbiwgY3NzU2VsKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTZXQgdGhlIEdVSSB0byB0aGUgY3VycmVudCBzdGF0ZS5cclxuXHRcdFx0dGhpcy5fdXBkYXRlSW50ZXJmYWNlKCk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZUJ1dHRvbnMoKTtcclxuXHRcdFx0dGhpcy5fdXBkYXRlQXV0b2hpZGUoKTtcclxuXHRcdFx0dGhpcy5fdXBkYXRlVm9sdW1lKCk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZU11dGUoKTtcclxuXHRcdH0sXHJcblx0XHRfY3NzU2VsZWN0b3I6IGZ1bmN0aW9uKGZuLCBjc3NTZWwpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRpZih0eXBlb2YgY3NzU2VsID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdGlmKCQualBsYXllci5wcm90b3R5cGUub3B0aW9ucy5jc3NTZWxlY3Rvcltmbl0pIHtcclxuXHRcdFx0XHRcdGlmKHRoaXMuY3NzLmpxW2ZuXSAmJiB0aGlzLmNzcy5qcVtmbl0ubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuY3NzLmpxW2ZuXS51bmJpbmQoXCIualBsYXllclwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5jc3NTZWxlY3Rvcltmbl0gPSBjc3NTZWw7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5jc1tmbl0gPSB0aGlzLm9wdGlvbnMuY3NzU2VsZWN0b3JBbmNlc3RvciArIFwiIFwiICsgY3NzU2VsO1xyXG5cclxuXHRcdFx0XHRcdGlmKGNzc1NlbCkgeyAvLyBDaGVja3MgZm9yIGVtcHR5IHN0cmluZ1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNzcy5qcVtmbl0gPSAkKHRoaXMuY3NzLmNzW2ZuXSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNzcy5qcVtmbl0gPSBbXTsgLy8gVG8gY29tcGx5IHdpdGggdGhlIGNzcy5qcVtmbl0ubGVuZ3RoIGNoZWNrIGJlZm9yZSBpdHMgdXNlLiBBcyBvZiBqUXVlcnkgMS40IGNvdWxkIGhhdmUgdXNlZCAkKCkgZm9yIGFuIGVtcHR5IHNldC4gXHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0aWYodGhpcy5jc3MuanFbZm5dLmxlbmd0aCAmJiB0aGlzW2ZuXSkge1xyXG5cdFx0XHRcdFx0XHR2YXIgaGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdFx0c2VsZltmbl0oZSk7XHJcblx0XHRcdFx0XHRcdFx0aWYoc2VsZi5vcHRpb25zLmF1dG9CbHVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQkKHRoaXMpLmJsdXIoKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0JCh0aGlzKS5mb2N1cygpOyAvLyBGb3JjZSBmb2N1cyBmb3IgQVJJQS5cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHRcdHRoaXMuY3NzLmpxW2ZuXS5iaW5kKFwiY2xpY2sualBsYXllclwiLCBoYW5kbGVyKTsgLy8gVXNpbmcgalBsYXllciBuYW1lc3BhY2VcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZihjc3NTZWwgJiYgdGhpcy5jc3MuanFbZm5dLmxlbmd0aCAhPT0gMSkgeyAvLyBTbyBlbXB0eSBzdHJpbmdzIGRvIG5vdCBnZW5lcmF0ZSB0aGUgd2FybmluZy4gaWUuLCB0aGV5IGp1c3QgcmVtb3ZlIHRoZSBvbGQgb25lLlxyXG5cdFx0XHRcdFx0XHR0aGlzLl93YXJuaW5nKCB7XHJcblx0XHRcdFx0XHRcdFx0dHlwZTogJC5qUGxheWVyLndhcm5pbmcuQ1NTX1NFTEVDVE9SX0NPVU5ULFxyXG5cdFx0XHRcdFx0XHRcdGNvbnRleHQ6IHRoaXMuY3NzLmNzW2ZuXSxcclxuXHRcdFx0XHRcdFx0XHRtZXNzYWdlOiAkLmpQbGF5ZXIud2FybmluZ01zZy5DU1NfU0VMRUNUT1JfQ09VTlQgKyB0aGlzLmNzcy5qcVtmbl0ubGVuZ3RoICsgXCIgZm91bmQgZm9yIFwiICsgZm4gKyBcIiBtZXRob2QuXCIsXHJcblx0XHRcdFx0XHRcdFx0aGludDogJC5qUGxheWVyLndhcm5pbmdIaW50LkNTU19TRUxFQ1RPUl9DT1VOVFxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy5fd2FybmluZygge1xyXG5cdFx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIud2FybmluZy5DU1NfU0VMRUNUT1JfTUVUSE9ELFxyXG5cdFx0XHRcdFx0XHRjb250ZXh0OiBmbixcclxuXHRcdFx0XHRcdFx0bWVzc2FnZTogJC5qUGxheWVyLndhcm5pbmdNc2cuQ1NTX1NFTEVDVE9SX01FVEhPRCxcclxuXHRcdFx0XHRcdFx0aGludDogJC5qUGxheWVyLndhcm5pbmdIaW50LkNTU19TRUxFQ1RPUl9NRVRIT0RcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLl93YXJuaW5nKCB7XHJcblx0XHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIud2FybmluZy5DU1NfU0VMRUNUT1JfU1RSSU5HLFxyXG5cdFx0XHRcdFx0Y29udGV4dDogY3NzU2VsLFxyXG5cdFx0XHRcdFx0bWVzc2FnZTogJC5qUGxheWVyLndhcm5pbmdNc2cuQ1NTX1NFTEVDVE9SX1NUUklORyxcclxuXHRcdFx0XHRcdGhpbnQ6ICQualBsYXllci53YXJuaW5nSGludC5DU1NfU0VMRUNUT1JfU1RSSU5HXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRkdXJhdGlvbjogZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMudG9nZ2xlRHVyYXRpb24pIHtcclxuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMuY2FwdHVyZUR1cmF0aW9uKSB7XHJcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLl9zZXRPcHRpb24oXCJyZW1haW5pbmdEdXJhdGlvblwiLCAhdGhpcy5vcHRpb25zLnJlbWFpbmluZ0R1cmF0aW9uKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHNlZWtCYXI6IGZ1bmN0aW9uKGUpIHsgLy8gSGFuZGxlcyBjbGlja3Mgb24gdGhlIHNlZWtCYXJcclxuXHRcdFx0aWYodGhpcy5jc3MuanEuc2Vla0Jhci5sZW5ndGgpIHtcclxuXHRcdFx0XHQvLyBVc2luZyAkKGUuY3VycmVudFRhcmdldCkgdG8gZW5hYmxlIG11bHRpcGxlIHNlZWsgYmFyc1xyXG5cdFx0XHRcdHZhciAkYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpLFxyXG5cdFx0XHRcdFx0b2Zmc2V0ID0gJGJhci5vZmZzZXQoKSxcclxuXHRcdFx0XHRcdHggPSBlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQsXHJcblx0XHRcdFx0XHR3ID0gJGJhci53aWR0aCgpLFxyXG5cdFx0XHRcdFx0cCA9IDEwMCAqIHggLyB3O1xyXG5cdFx0XHRcdHRoaXMucGxheUhlYWQocCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRwbGF5YmFja1JhdGU6IGZ1bmN0aW9uKHBicikge1xyXG5cdFx0XHR0aGlzLl9zZXRPcHRpb24oXCJwbGF5YmFja1JhdGVcIiwgcGJyKTtcclxuXHRcdH0sXHJcblx0XHRwbGF5YmFja1JhdGVCYXI6IGZ1bmN0aW9uKGUpIHsgLy8gSGFuZGxlcyBjbGlja3Mgb24gdGhlIHBsYXliYWNrUmF0ZUJhclxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS5wbGF5YmFja1JhdGVCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0Ly8gVXNpbmcgJChlLmN1cnJlbnRUYXJnZXQpIHRvIGVuYWJsZSBtdWx0aXBsZSBwbGF5YmFja1JhdGUgYmFyc1xyXG5cdFx0XHRcdHZhciAkYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpLFxyXG5cdFx0XHRcdFx0b2Zmc2V0ID0gJGJhci5vZmZzZXQoKSxcclxuXHRcdFx0XHRcdHggPSBlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQsXHJcblx0XHRcdFx0XHR3ID0gJGJhci53aWR0aCgpLFxyXG5cdFx0XHRcdFx0eSA9ICRiYXIuaGVpZ2h0KCkgLSBlLnBhZ2VZICsgb2Zmc2V0LnRvcCxcclxuXHRcdFx0XHRcdGggPSAkYmFyLmhlaWdodCgpLFxyXG5cdFx0XHRcdFx0cmF0aW8sIHBicjtcclxuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMudmVydGljYWxQbGF5YmFja1JhdGUpIHtcclxuXHRcdFx0XHRcdHJhdGlvID0geS9oO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyYXRpbyA9IHgvdztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cGJyID0gcmF0aW8gKiAodGhpcy5vcHRpb25zLm1heFBsYXliYWNrUmF0ZSAtIHRoaXMub3B0aW9ucy5taW5QbGF5YmFja1JhdGUpICsgdGhpcy5vcHRpb25zLm1pblBsYXliYWNrUmF0ZTtcclxuXHRcdFx0XHR0aGlzLnBsYXliYWNrUmF0ZShwYnIpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X3VwZGF0ZVBsYXliYWNrUmF0ZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBwYnIgPSB0aGlzLm9wdGlvbnMucGxheWJhY2tSYXRlLFxyXG5cdFx0XHRcdHJhdGlvID0gKHBiciAtIHRoaXMub3B0aW9ucy5taW5QbGF5YmFja1JhdGUpIC8gKHRoaXMub3B0aW9ucy5tYXhQbGF5YmFja1JhdGUgLSB0aGlzLm9wdGlvbnMubWluUGxheWJhY2tSYXRlKTtcclxuXHRcdFx0aWYodGhpcy5zdGF0dXMucGxheWJhY2tSYXRlRW5hYmxlZCkge1xyXG5cdFx0XHRcdGlmKHRoaXMuY3NzLmpxLnBsYXliYWNrUmF0ZUJhci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnBsYXliYWNrUmF0ZUJhci5zaG93KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRoaXMuY3NzLmpxLnBsYXliYWNrUmF0ZUJhclZhbHVlLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucGxheWJhY2tSYXRlQmFyVmFsdWUuc2hvdygpO1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEucGxheWJhY2tSYXRlQmFyVmFsdWVbdGhpcy5vcHRpb25zLnZlcnRpY2FsUGxheWJhY2tSYXRlID8gXCJoZWlnaHRcIiA6IFwid2lkdGhcIl0oKHJhdGlvKjEwMCkrXCIlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZih0aGlzLmNzcy5qcS5wbGF5YmFja1JhdGVCYXIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNzcy5qcS5wbGF5YmFja1JhdGVCYXIuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0aGlzLmNzcy5qcS5wbGF5YmFja1JhdGVCYXJWYWx1ZS5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuY3NzLmpxLnBsYXliYWNrUmF0ZUJhclZhbHVlLmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRyZXBlYXQ6IGZ1bmN0aW9uKGV2ZW50KSB7IC8vIEhhbmRsZSBjbGlja3Mgb24gdGhlIHJlcGVhdCBidXR0b25cclxuXHRcdFx0dmFyIGd1aUFjdGlvbiA9IHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIjsgLy8gRmxhZ3MgR1VJIGNsaWNrIGV2ZW50cyBzbyB3ZSBrbm93IHRoaXMgd2FzIG5vdCBhIGRpcmVjdCBjb21tYW5kLCBidXQgYW4gYWN0aW9uIHRha2VuIGJ5IHRoZSB1c2VyIG9uIHRoZSBHVUkuXHJcblx0XHRcdGlmKGd1aUFjdGlvbiAmJiB0aGlzLm9wdGlvbnMudXNlU3RhdGVDbGFzc1NraW4gJiYgdGhpcy5vcHRpb25zLmxvb3ApIHtcclxuXHRcdFx0XHR0aGlzLl9sb29wKGZhbHNlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLl9sb29wKHRydWUpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0cmVwZWF0T2ZmOiBmdW5jdGlvbigpIHsgLy8gSGFuZGxlIGNsaWNrcyBvbiB0aGUgcmVwZWF0T2ZmIGJ1dHRvblxyXG5cdFx0XHR0aGlzLl9sb29wKGZhbHNlKTtcclxuXHRcdH0sXHJcblx0XHRfbG9vcDogZnVuY3Rpb24obG9vcCkge1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMubG9vcCAhPT0gbG9vcCkge1xyXG5cdFx0XHRcdHRoaXMub3B0aW9ucy5sb29wID0gbG9vcDtcclxuXHRcdFx0XHR0aGlzLl91cGRhdGVCdXR0b25zKCk7XHJcblx0XHRcdFx0dGhpcy5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucmVwZWF0KTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHJcblx0XHQvLyBPcHRpb25zIGNvZGUgYWRhcHRlZCBmcm9tIHVpLndpZGdldC5qcyAoMS44LjcpLiAgTWFkZSBjaGFuZ2VzIHNvIHRoZSBrZXkgY2FuIHVzZSBkb3Qgbm90YXRpb24uIFRvIG1hdGNoIHByZXZpb3VzIGdldERhdGEgc29sdXRpb24gaW4galBsYXllciAxLlxyXG5cdFx0b3B0aW9uOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcblx0XHRcdHZhciBvcHRpb25zID0ga2V5O1xyXG5cclxuXHRcdFx0IC8vIEVuYWJsZXMgdXNlOiBvcHRpb25zKCkuICBSZXR1cm5zIGEgY29weSBvZiBvcHRpb25zIG9iamVjdFxyXG5cdFx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7XHJcblx0XHRcdFx0cmV0dXJuICQuZXh0ZW5kKCB0cnVlLCB7fSwgdGhpcy5vcHRpb25zICk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIpIHtcclxuXHRcdFx0XHR2YXIga2V5cyA9IGtleS5zcGxpdChcIi5cIik7XHJcblxyXG5cdFx0XHRcdCAvLyBFbmFibGVzIHVzZTogb3B0aW9ucyhcInNvbWVPcHRpb25cIikgIFJldHVybnMgYSBjb3B5IG9mIHRoZSBvcHRpb24uIFN1cHBvcnRzIGRvdCBub3RhdGlvbi5cclxuXHRcdFx0XHRpZih2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcblxyXG5cdFx0XHRcdFx0dmFyIG9wdCA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLm9wdGlvbnMpO1xyXG5cdFx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdFx0aWYob3B0W2tleXNbaV1dICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRvcHQgPSBvcHRba2V5c1tpXV07XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5fd2FybmluZygge1xyXG5cdFx0XHRcdFx0XHRcdFx0dHlwZTogJC5qUGxheWVyLndhcm5pbmcuT1BUSU9OX0tFWSxcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnRleHQ6IGtleSxcclxuXHRcdFx0XHRcdFx0XHRcdG1lc3NhZ2U6ICQualBsYXllci53YXJuaW5nTXNnLk9QVElPTl9LRVksXHJcblx0XHRcdFx0XHRcdFx0XHRoaW50OiAkLmpQbGF5ZXIud2FybmluZ0hpbnQuT1BUSU9OX0tFWVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB1bmRlZmluZWQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBvcHQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQgLy8gRW5hYmxlcyB1c2U6IG9wdGlvbnMoXCJzb21lT3B0aW9uT2JqZWN0XCIsIHNvbWVPYmplY3R9KS4gIENyZWF0ZXM6IHtzb21lT3B0aW9uT2JqZWN0OnNvbWVPYmplY3R9XHJcblx0XHRcdFx0IC8vIEVuYWJsZXMgdXNlOiBvcHRpb25zKFwic29tZU9wdGlvblwiLCBzb21lVmFsdWUpLiAgQ3JlYXRlczoge3NvbWVPcHRpb246c29tZVZhbHVlfVxyXG5cdFx0XHRcdCAvLyBFbmFibGVzIHVzZTogb3B0aW9ucyhcInNvbWVPcHRpb25PYmplY3Quc29tZU9wdGlvblwiLCBzb21lVmFsdWUpLiAgQ3JlYXRlczoge3NvbWVPcHRpb25PYmplY3Q6e3NvbWVPcHRpb246c29tZVZhbHVlfX1cclxuXHJcblx0XHRcdFx0b3B0aW9ucyA9IHt9O1xyXG5cdFx0XHRcdHZhciBvcHRzID0gb3B0aW9ucztcclxuXHJcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdGlmKGogPCBrZXlzLmxlbmd0aCAtIDEpIHtcclxuXHRcdFx0XHRcdFx0b3B0c1trZXlzW2pdXSA9IHt9O1xyXG5cdFx0XHRcdFx0XHRvcHRzID0gb3B0c1trZXlzW2pdXTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdG9wdHNba2V5c1tqXV0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCAvLyBPdGhlcndpc2UgZW5hYmxlcyB1c2U6IG9wdGlvbnMob3B0aW9uT2JqZWN0KS4gIFVzZXMgb3JpZ2luYWwgb2JqZWN0ICh0aGUga2V5KVxyXG5cclxuXHRcdFx0dGhpcy5fc2V0T3B0aW9ucyhvcHRpb25zKTtcclxuXHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHRcdF9zZXRPcHRpb25zOiBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpcztcclxuXHRcdFx0JC5lYWNoKG9wdGlvbnMsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgLy8gVGhpcyBzdXBwb3J0cyB0aGUgMiBsZXZlbCBkZXB0aCB0aGF0IHRoZSBvcHRpb25zIG9mIGpQbGF5ZXIgaGFzLiBXb3VsZCByZXZpZXcgaWYgd2UgZXZlciBuZWVkIG1vcmUgZGVwdGguXHJcblx0XHRcdFx0c2VsZi5fc2V0T3B0aW9uKGtleSwgdmFsdWUpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHRcdF9zZXRPcHRpb246IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHRcdFx0Ly8gVGhlIGFiaWxpdHkgdG8gc2V0IG9wdGlvbnMgaXMgbGltaXRlZCBhdCB0aGlzIHRpbWUuXHJcblxyXG5cdFx0XHRzd2l0Y2goa2V5KSB7XHJcblx0XHRcdFx0Y2FzZSBcInZvbHVtZVwiIDpcclxuXHRcdFx0XHRcdHRoaXMudm9sdW1lKHZhbHVlKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJtdXRlZFwiIDpcclxuXHRcdFx0XHRcdHRoaXMuX211dGVkKHZhbHVlKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJnbG9iYWxWb2x1bWVcIiA6XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImNzc1NlbGVjdG9yQW5jZXN0b3JcIiA6XHJcblx0XHRcdFx0XHR0aGlzLl9jc3NTZWxlY3RvckFuY2VzdG9yKHZhbHVlKTsgLy8gU2V0IGFuZCByZWZyZXNoIGFsbCBhc3NvY2lhdGlvbnMgZm9yIHRoZSBuZXcgYW5jZXN0b3IuXHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiY3NzU2VsZWN0b3JcIiA6XHJcblx0XHRcdFx0XHQkLmVhY2godmFsdWUsIGZ1bmN0aW9uKGZuLCBjc3NTZWwpIHtcclxuXHRcdFx0XHRcdFx0c2VsZi5fY3NzU2VsZWN0b3IoZm4sIGNzc1NlbCk7IC8vIE5COiBUaGUgb3B0aW9uIGlzIHNldCBpbnNpZGUgdGhpcyBmdW5jdGlvbiwgYWZ0ZXIgZnVydGhlciB2YWxpZGl0eSBjaGVja3MuXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJwbGF5YmFja1JhdGVcIiA6XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IHZhbHVlID0gdGhpcy5fbGltaXRWYWx1ZSh2YWx1ZSwgdGhpcy5vcHRpb25zLm1pblBsYXliYWNrUmF0ZSwgdGhpcy5vcHRpb25zLm1heFBsYXliYWNrUmF0ZSk7XHJcblx0XHRcdFx0XHRpZih0aGlzLmh0bWwudXNlZCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLl9odG1sX3NldFByb3BlcnR5KCdwbGF5YmFja1JhdGUnLCB2YWx1ZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLl91cGRhdGVQbGF5YmFja1JhdGUoKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJkZWZhdWx0UGxheWJhY2tSYXRlXCIgOlxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZSA9IHRoaXMuX2xpbWl0VmFsdWUodmFsdWUsIHRoaXMub3B0aW9ucy5taW5QbGF5YmFja1JhdGUsIHRoaXMub3B0aW9ucy5tYXhQbGF5YmFja1JhdGUpO1xyXG5cdFx0XHRcdFx0aWYodGhpcy5odG1sLnVzZWQpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5faHRtbF9zZXRQcm9wZXJ0eSgnZGVmYXVsdFBsYXliYWNrUmF0ZScsIHZhbHVlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMuX3VwZGF0ZVBsYXliYWNrUmF0ZSgpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcIm1pblBsYXliYWNrUmF0ZVwiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gdmFsdWUgPSB0aGlzLl9saW1pdFZhbHVlKHZhbHVlLCAwLjEsIHRoaXMub3B0aW9ucy5tYXhQbGF5YmFja1JhdGUgLSAwLjEpO1xyXG5cdFx0XHRcdFx0dGhpcy5fdXBkYXRlUGxheWJhY2tSYXRlKCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwibWF4UGxheWJhY2tSYXRlXCIgOlxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZSA9IHRoaXMuX2xpbWl0VmFsdWUodmFsdWUsIHRoaXMub3B0aW9ucy5taW5QbGF5YmFja1JhdGUgKyAwLjEsIDE2KTtcclxuXHRcdFx0XHRcdHRoaXMuX3VwZGF0ZVBsYXliYWNrUmF0ZSgpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImZ1bGxTY3JlZW5cIiA6XHJcblx0XHRcdFx0XHRpZih0aGlzLm9wdGlvbnNba2V5XSAhPT0gdmFsdWUpIHsgLy8gaWYgY2hhbmdlZFxyXG5cdFx0XHRcdFx0XHR2YXIgd2t2ID0gJC5qUGxheWVyLm5hdGl2ZUZlYXR1cmVzLmZ1bGxzY3JlZW4udXNlZC53ZWJraXRWaWRlbztcclxuXHRcdFx0XHRcdFx0aWYoIXdrdiB8fCB3a3YgJiYgIXRoaXMuc3RhdHVzLndhaXRGb3JQbGF5KSB7XHJcblx0XHRcdFx0XHRcdFx0aWYoIXdrdikgeyAvLyBObyBzZW5zaWJsZSB3YXkgdG8gdW5zZXQgb3B0aW9uIG9uIHRoZXNlIGRldmljZXMuXHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRpZih2YWx1ZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fcmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fZXhpdEZ1bGxzY3JlZW4oKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoIXdrdikge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fc2V0T3B0aW9uKFwiZnVsbFdpbmRvd1wiLCB2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiZnVsbFdpbmRvd1wiIDpcclxuXHRcdFx0XHRcdGlmKHRoaXMub3B0aW9uc1trZXldICE9PSB2YWx1ZSkgeyAvLyBpZiBjaGFuZ2VkXHJcblx0XHRcdFx0XHRcdHRoaXMuX3JlbW92ZVVpQ2xhc3MoKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0dGhpcy5fcmVmcmVzaFNpemUoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJzaXplXCIgOlxyXG5cdFx0XHRcdFx0aWYoIXRoaXMub3B0aW9ucy5mdWxsV2luZG93ICYmIHRoaXMub3B0aW9uc1trZXldLmNzc0NsYXNzICE9PSB2YWx1ZS5jc3NDbGFzcykge1xyXG5cdFx0XHRcdFx0XHR0aGlzLl9yZW1vdmVVaUNsYXNzKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnNba2V5XSwgdmFsdWUpOyAvLyBzdG9yZSBhIG1lcmdlZCBjb3B5IG9mIGl0LCBpbmNhc2Ugbm90IGFsbCBwcm9wZXJ0aWVzIGNoYW5nZWQuXHJcblx0XHRcdFx0XHR0aGlzLl9yZWZyZXNoU2l6ZSgpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcInNpemVGdWxsXCIgOlxyXG5cdFx0XHRcdFx0aWYodGhpcy5vcHRpb25zLmZ1bGxXaW5kb3cgJiYgdGhpcy5vcHRpb25zW2tleV0uY3NzQ2xhc3MgIT09IHZhbHVlLmNzc0NsYXNzKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuX3JlbW92ZVVpQ2xhc3MoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9uc1trZXldLCB2YWx1ZSk7IC8vIHN0b3JlIGEgbWVyZ2VkIGNvcHkgb2YgaXQsIGluY2FzZSBub3QgYWxsIHByb3BlcnRpZXMgY2hhbmdlZC5cclxuXHRcdFx0XHRcdHRoaXMuX3JlZnJlc2hTaXplKCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiYXV0b2hpZGVcIiA6XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnNba2V5XSwgdmFsdWUpOyAvLyBzdG9yZSBhIG1lcmdlZCBjb3B5IG9mIGl0LCBpbmNhc2Ugbm90IGFsbCBwcm9wZXJ0aWVzIGNoYW5nZWQuXHJcblx0XHRcdFx0XHR0aGlzLl91cGRhdGVBdXRvaGlkZSgpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImxvb3BcIiA6XHJcblx0XHRcdFx0XHR0aGlzLl9sb29wKHZhbHVlKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJyZW1haW5pbmdEdXJhdGlvblwiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gdmFsdWU7XHJcblx0XHRcdFx0XHR0aGlzLl91cGRhdGVJbnRlcmZhY2UoKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJ0b2dnbGVEdXJhdGlvblwiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gdmFsdWU7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwibmF0aXZlVmlkZW9Db250cm9sc1wiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9uc1trZXldLCB2YWx1ZSk7IC8vIHN0b3JlIGEgbWVyZ2VkIGNvcHkgb2YgaXQsIGluY2FzZSBub3QgYWxsIHByb3BlcnRpZXMgY2hhbmdlZC5cclxuXHRcdFx0XHRcdHRoaXMuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMgPSB0aGlzLl91YUJsb2NrbGlzdCh0aGlzLm9wdGlvbnMubmF0aXZlVmlkZW9Db250cm9scyk7XHJcblx0XHRcdFx0XHR0aGlzLl9yZXN0cmljdE5hdGl2ZVZpZGVvQ29udHJvbHMoKTtcclxuXHRcdFx0XHRcdHRoaXMuX3VwZGF0ZU5hdGl2ZVZpZGVvQ29udHJvbHMoKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJub0Z1bGxXaW5kb3dcIiA6XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnNba2V5XSwgdmFsdWUpOyAvLyBzdG9yZSBhIG1lcmdlZCBjb3B5IG9mIGl0LCBpbmNhc2Ugbm90IGFsbCBwcm9wZXJ0aWVzIGNoYW5nZWQuXHJcblx0XHRcdFx0XHR0aGlzLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzID0gdGhpcy5fdWFCbG9ja2xpc3QodGhpcy5vcHRpb25zLm5hdGl2ZVZpZGVvQ29udHJvbHMpOyAvLyBOZWVkIHRvIGNoZWNrIGFnYWluIGFzIG5vRnVsbFdpbmRvdyBjYW4gZGVwZW5kIG9uIHRoaXMgZmxhZyBhbmQgdGhlIHJlc3RyaWN0KCkgY2FuIG92ZXJyaWRlIGl0LlxyXG5cdFx0XHRcdFx0dGhpcy5zdGF0dXMubm9GdWxsV2luZG93ID0gdGhpcy5fdWFCbG9ja2xpc3QodGhpcy5vcHRpb25zLm5vRnVsbFdpbmRvdyk7XHJcblx0XHRcdFx0XHR0aGlzLl9yZXN0cmljdE5hdGl2ZVZpZGVvQ29udHJvbHMoKTtcclxuXHRcdFx0XHRcdHRoaXMuX3VwZGF0ZUJ1dHRvbnMoKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJub1ZvbHVtZVwiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9uc1trZXldLCB2YWx1ZSk7IC8vIHN0b3JlIGEgbWVyZ2VkIGNvcHkgb2YgaXQsIGluY2FzZSBub3QgYWxsIHByb3BlcnRpZXMgY2hhbmdlZC5cclxuXHRcdFx0XHRcdHRoaXMuc3RhdHVzLm5vVm9sdW1lID0gdGhpcy5fdWFCbG9ja2xpc3QodGhpcy5vcHRpb25zLm5vVm9sdW1lKTtcclxuXHRcdFx0XHRcdHRoaXMuX3VwZGF0ZVZvbHVtZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5fdXBkYXRlTXV0ZSgpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImVtdWxhdGVIdG1sXCIgOlxyXG5cdFx0XHRcdFx0aWYodGhpcy5vcHRpb25zW2tleV0gIT09IHZhbHVlKSB7IC8vIFRvIGF2b2lkIG11bHRpcGxlIGV2ZW50IGhhbmRsZXJzIGJlaW5nIGNyZWF0ZWQsIGlmIHRydWUgYWxyZWFkeS5cclxuXHRcdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0aWYodmFsdWUpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLl9lbXVsYXRlSHRtbEJyaWRnZSgpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuX2Rlc3Ryb3lIdG1sQnJpZGdlKCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJ0aW1lRm9ybWF0XCIgOlxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSAkLmV4dGVuZCh7fSwgdGhpcy5vcHRpb25zW2tleV0sIHZhbHVlKTsgLy8gc3RvcmUgYSBtZXJnZWQgY29weSBvZiBpdCwgaW5jYXNlIG5vdCBhbGwgcHJvcGVydGllcyBjaGFuZ2VkLlxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImtleUVuYWJsZWRcIiA6XHJcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0aWYoIXZhbHVlICYmIHRoaXMgPT09ICQualBsYXllci5mb2N1cykge1xyXG5cdFx0XHRcdFx0XHQkLmpQbGF5ZXIuZm9jdXMgPSBudWxsO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImtleUJpbmRpbmdzXCIgOlxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSAkLmV4dGVuZCh0cnVlLCB7fSwgdGhpcy5vcHRpb25zW2tleV0sIHZhbHVlKTsgLy8gc3RvcmUgYSBtZXJnZWQgREVFUCBjb3B5IG9mIGl0LCBpbmNhc2Ugbm90IGFsbCBwcm9wZXJ0aWVzIGNoYW5nZWQuXHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiYXVkaW9GdWxsU2NyZWVuXCIgOlxyXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zW2tleV0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJhdXRvQmx1clwiIDpcclxuXHRcdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gdmFsdWU7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cdFx0Ly8gRW5kIG9mOiAoT3B0aW9ucyBjb2RlIGFkYXB0ZWQgZnJvbSB1aS53aWRnZXQuanMpXHJcblxyXG5cdFx0X3JlZnJlc2hTaXplOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5fc2V0U2l6ZSgpOyAvLyB1cGRhdGUgc3RhdHVzIGFuZCBqUGxheWVyIGVsZW1lbnQgc2l6ZVxyXG5cdFx0XHR0aGlzLl9hZGRVaUNsYXNzKCk7IC8vIHVwZGF0ZSB0aGUgdWkgY2xhc3NcclxuXHRcdFx0dGhpcy5fdXBkYXRlU2l6ZSgpOyAvLyB1cGRhdGUgaW50ZXJuYWwgc2l6ZXNcclxuXHRcdFx0dGhpcy5fdXBkYXRlQnV0dG9ucygpO1xyXG5cdFx0XHR0aGlzLl91cGRhdGVBdXRvaGlkZSgpO1xyXG5cdFx0XHR0aGlzLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5yZXNpemUpO1xyXG5cdFx0fSxcclxuXHRcdF9zZXRTaXplOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0Ly8gRGV0ZXJtaW5lIHRoZSBjdXJyZW50IHNpemUgZnJvbSB0aGUgb3B0aW9uc1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuZnVsbFdpbmRvdykge1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLndpZHRoID0gdGhpcy5vcHRpb25zLnNpemVGdWxsLndpZHRoO1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLmhlaWdodCA9IHRoaXMub3B0aW9ucy5zaXplRnVsbC5oZWlnaHQ7XHJcblx0XHRcdFx0dGhpcy5zdGF0dXMuY3NzQ2xhc3MgPSB0aGlzLm9wdGlvbnMuc2l6ZUZ1bGwuY3NzQ2xhc3M7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0dXMud2lkdGggPSB0aGlzLm9wdGlvbnMuc2l6ZS53aWR0aDtcclxuXHRcdFx0XHR0aGlzLnN0YXR1cy5oZWlnaHQgPSB0aGlzLm9wdGlvbnMuc2l6ZS5oZWlnaHQ7XHJcblx0XHRcdFx0dGhpcy5zdGF0dXMuY3NzQ2xhc3MgPSB0aGlzLm9wdGlvbnMuc2l6ZS5jc3NDbGFzcztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU2V0IHRoZSBzaXplIG9mIHRoZSBqUGxheWVyIGFyZWEuXHJcblx0XHRcdHRoaXMuZWxlbWVudC5jc3Moeyd3aWR0aCc6IHRoaXMuc3RhdHVzLndpZHRoLCAnaGVpZ2h0JzogdGhpcy5zdGF0dXMuaGVpZ2h0fSk7XHJcblx0XHR9LFxyXG5cdFx0X2FkZFVpQ2xhc3M6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLmFuY2VzdG9ySnEubGVuZ3RoKSB7XHJcblx0XHRcdFx0dGhpcy5hbmNlc3RvckpxLmFkZENsYXNzKHRoaXMuc3RhdHVzLmNzc0NsYXNzKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9yZW1vdmVVaUNsYXNzOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5hbmNlc3RvckpxLmxlbmd0aCkge1xyXG5cdFx0XHRcdHRoaXMuYW5jZXN0b3JKcS5yZW1vdmVDbGFzcyh0aGlzLnN0YXR1cy5jc3NDbGFzcyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfdXBkYXRlU2l6ZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIFRoZSBwb3N0ZXIgdXNlcyBzaG93L2hpZGUgc28gY2FuIHNpbXBseSByZXNpemUgaXQuXHJcblx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLmNzcyh7J3dpZHRoJzogdGhpcy5zdGF0dXMud2lkdGgsICdoZWlnaHQnOiB0aGlzLnN0YXR1cy5oZWlnaHR9KTtcclxuXHJcblx0XHRcdC8vIFZpZGVvIGh0bWwgb3IgZmxhc2ggcmVzaXplZCBpZiBuZWNlc3NhcnkgYXQgdGhpcyB0aW1lLCBvciBpZiBuYXRpdmUgdmlkZW8gY29udHJvbHMgYmVpbmcgdXNlZC5cclxuXHRcdFx0aWYoIXRoaXMuc3RhdHVzLndhaXRGb3JQbGF5ICYmIHRoaXMuaHRtbC5hY3RpdmUgJiYgdGhpcy5zdGF0dXMudmlkZW8gfHwgdGhpcy5odG1sLnZpZGVvLmF2YWlsYWJsZSAmJiB0aGlzLmh0bWwudXNlZCAmJiB0aGlzLnN0YXR1cy5uYXRpdmVWaWRlb0NvbnRyb2xzKSB7XHJcblx0XHRcdFx0dGhpcy5pbnRlcm5hbC52aWRlby5qcS5jc3Moeyd3aWR0aCc6IHRoaXMuc3RhdHVzLndpZHRoLCAnaGVpZ2h0JzogdGhpcy5zdGF0dXMuaGVpZ2h0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZighdGhpcy5zdGF0dXMud2FpdEZvclBsYXkgJiYgdGhpcy5mbGFzaC5hY3RpdmUgJiYgdGhpcy5zdGF0dXMudmlkZW8pIHtcclxuXHRcdFx0XHR0aGlzLmludGVybmFsLmZsYXNoLmpxLmNzcyh7J3dpZHRoJzogdGhpcy5zdGF0dXMud2lkdGgsICdoZWlnaHQnOiB0aGlzLnN0YXR1cy5oZWlnaHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF91cGRhdGVBdXRvaGlkZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhclx0c2VsZiA9IHRoaXMsXHJcblx0XHRcdFx0ZXZlbnQgPSBcIm1vdXNlbW92ZS5qUGxheWVyXCIsXHJcblx0XHRcdFx0bmFtZXNwYWNlID0gXCIualBsYXllckF1dG9oaWRlXCIsXHJcblx0XHRcdFx0ZXZlbnRUeXBlID0gZXZlbnQgKyBuYW1lc3BhY2UsXHJcblx0XHRcdFx0aGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdFx0XHR2YXIgbW92ZWQgPSBmYWxzZSxcclxuXHRcdFx0XHRcdFx0ZGVsdGFYLCBkZWx0YVk7XHJcblx0XHRcdFx0XHRpZih0eXBlb2Ygc2VsZi5pbnRlcm5hbC5tb3VzZSAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRcdFx0XHQvL2dldCB0aGUgY2hhbmdlIGZyb20gbGFzdCBwb3NpdGlvbiB0byB0aGlzIHBvc2l0aW9uXHJcblx0XHRcdFx0XHRcdGRlbHRhWCA9IHNlbGYuaW50ZXJuYWwubW91c2UueCAtIGV2ZW50LnBhZ2VYO1xyXG5cdFx0XHRcdFx0XHRkZWx0YVkgPSBzZWxmLmludGVybmFsLm1vdXNlLnkgLSBldmVudC5wYWdlWTtcclxuXHRcdFx0XHRcdFx0bW92ZWQgPSAoTWF0aC5mbG9vcihkZWx0YVgpID4gMCkgfHwgKE1hdGguZmxvb3IoZGVsdGFZKT4wKTsgXHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRtb3ZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBzdG9yZSBjdXJyZW50IHBvc2l0aW9uIGZvciBuZXh0IG1ldGhvZCBleGVjdXRpb25cclxuXHRcdFx0XHRcdHNlbGYuaW50ZXJuYWwubW91c2UgPSB7XHJcblx0XHRcdFx0XHRcdFx0eCA6IGV2ZW50LnBhZ2VYLFxyXG5cdFx0XHRcdFx0XHRcdHkgOiBldmVudC5wYWdlWVxyXG5cdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdC8vIGlmIG1vdXNlIGhhcyBiZWVuIGFjdHVhbGx5IG1vdmVkLCBkbyB0aGUgZ3VpIGZhZGVJbi9mYWRlT3V0XHJcblx0XHRcdFx0XHRpZiAobW92ZWQpIHtcclxuXHRcdFx0XHRcdFx0c2VsZi5jc3MuanEuZ3VpLmZhZGVJbihzZWxmLm9wdGlvbnMuYXV0b2hpZGUuZmFkZUluLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQoc2VsZi5pbnRlcm5hbC5hdXRvaGlkZUlkKTtcclxuXHRcdFx0XHRcdFx0XHRzZWxmLmludGVybmFsLmF1dG9oaWRlSWQgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuY3NzLmpxLmd1aS5mYWRlT3V0KHNlbGYub3B0aW9ucy5hdXRvaGlkZS5mYWRlT3V0KTtcclxuXHRcdFx0XHRcdFx0XHR9LCBzZWxmLm9wdGlvbnMuYXV0b2hpZGUuaG9sZCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHRpZih0aGlzLmNzcy5qcS5ndWkubGVuZ3RoKSB7XHJcblxyXG5cdFx0XHRcdC8vIEVuZCBhbmltYXRpb25zIGZpcnN0IHNvIHRoYXQgaXRzIGNhbGxiYWNrIGlzIGV4ZWN1dGVkIG5vdy5cclxuXHRcdFx0XHQvLyBPdGhlcndpc2UgYW4gaW4gcHJvZ3Jlc3MgZmFkZUluIGFuaW1hdGlvbiBzdGlsbCBoYXMgdGhlIGNhbGxiYWNrIHRvIGZhZGVPdXQgYWdhaW4uXHJcblx0XHRcdFx0dGhpcy5jc3MuanEuZ3VpLnN0b3AodHJ1ZSwgdHJ1ZSk7XHJcblxyXG5cdFx0XHRcdC8vIFJlbW92ZXMgdGhlIGZhZGVPdXQgb3BlcmF0aW9uIGZyb20gdGhlIGZhZGVJbiBjYWxsYmFjay5cclxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5pbnRlcm5hbC5hdXRvaGlkZUlkKTtcclxuXHRcdFx0XHQvLyB1bmRlZmluZSBtb3VzZVxyXG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmludGVybmFsLm1vdXNlO1xyXG5cclxuXHRcdFx0XHR0aGlzLmVsZW1lbnQudW5iaW5kKG5hbWVzcGFjZSk7XHJcblx0XHRcdFx0dGhpcy5jc3MuanEuZ3VpLnVuYmluZChuYW1lc3BhY2UpO1xyXG5cclxuXHRcdFx0XHRpZighdGhpcy5zdGF0dXMubmF0aXZlVmlkZW9Db250cm9scykge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5vcHRpb25zLmZ1bGxXaW5kb3cgJiYgdGhpcy5vcHRpb25zLmF1dG9oaWRlLmZ1bGwgfHwgIXRoaXMub3B0aW9ucy5mdWxsV2luZG93ICYmIHRoaXMub3B0aW9ucy5hdXRvaGlkZS5yZXN0b3JlZCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnQuYmluZChldmVudFR5cGUsIGhhbmRsZXIpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNzcy5qcS5ndWkuYmluZChldmVudFR5cGUsIGhhbmRsZXIpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNzcy5qcS5ndWkuaGlkZSgpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5jc3MuanEuZ3VpLnNob3coKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEuZ3VpLmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRmdWxsU2NyZWVuOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHR2YXIgZ3VpQWN0aW9uID0gdHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiOyAvLyBGbGFncyBHVUkgY2xpY2sgZXZlbnRzIHNvIHdlIGtub3cgdGhpcyB3YXMgbm90IGEgZGlyZWN0IGNvbW1hbmQsIGJ1dCBhbiBhY3Rpb24gdGFrZW4gYnkgdGhlIHVzZXIgb24gdGhlIEdVSS5cclxuXHRcdFx0aWYoZ3VpQWN0aW9uICYmIHRoaXMub3B0aW9ucy51c2VTdGF0ZUNsYXNzU2tpbiAmJiB0aGlzLm9wdGlvbnMuZnVsbFNjcmVlbikge1xyXG5cdFx0XHRcdHRoaXMuX3NldE9wdGlvbihcImZ1bGxTY3JlZW5cIiwgZmFsc2UpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3NldE9wdGlvbihcImZ1bGxTY3JlZW5cIiwgdHJ1ZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRyZXN0b3JlU2NyZWVuOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5fc2V0T3B0aW9uKFwiZnVsbFNjcmVlblwiLCBmYWxzZSk7XHJcblx0XHR9LFxyXG5cdFx0X2Z1bGxzY3JlZW5BZGRFdmVudExpc3RlbmVyczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcclxuXHRcdFx0XHRmcyA9ICQualBsYXllci5uYXRpdmVGZWF0dXJlcy5mdWxsc2NyZWVuO1xyXG5cclxuXHRcdFx0aWYoZnMuYXBpLmZ1bGxzY3JlZW5FbmFibGVkKSB7XHJcblx0XHRcdFx0aWYoZnMuZXZlbnQuZnVsbHNjcmVlbmNoYW5nZSkge1xyXG5cdFx0XHRcdFx0Ly8gQ3JlYXRlIHRoZSBldmVudCBoYW5kbGVyIGZ1bmN0aW9uIGFuZCBzdG9yZSBpdCBmb3IgcmVtb3ZhbC5cclxuXHRcdFx0XHRcdGlmKHR5cGVvZiB0aGlzLmludGVybmFsLmZ1bGxzY3JlZW5jaGFuZ2VIYW5kbGVyICE9PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwuZnVsbHNjcmVlbmNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRzZWxmLl9mdWxsc2NyZWVuY2hhbmdlKCk7XHJcblx0XHRcdFx0XHRcdH07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGZzLmV2ZW50LmZ1bGxzY3JlZW5jaGFuZ2UsIHRoaXMuaW50ZXJuYWwuZnVsbHNjcmVlbmNoYW5nZUhhbmRsZXIsIGZhbHNlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gTm8gcG9pbnQgY3JlYXRpbmcgaGFuZGxlciBmb3IgZnVsbHNjcmVlbmVycm9yLlxyXG5cdFx0XHRcdC8vIEVpdGhlciBsb2dpYyBhdm9pZHMgZnVsbHNjcmVlbiBvY2N1cnJpbmcgKHczYy9tb3opLCBvciB0aGVpciBpcyBubyBldmVudCBvbiB0aGUgYnJvd3NlciAod2Via2l0KS5cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9mdWxsc2NyZWVuUmVtb3ZlRXZlbnRMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgZnMgPSAkLmpQbGF5ZXIubmF0aXZlRmVhdHVyZXMuZnVsbHNjcmVlbjtcclxuXHRcdFx0aWYodGhpcy5pbnRlcm5hbC5mdWxsc2NyZWVuY2hhbmdlSGFuZGxlcikge1xyXG5cdFx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZnMuZXZlbnQuZnVsbHNjcmVlbmNoYW5nZSwgdGhpcy5pbnRlcm5hbC5mdWxsc2NyZWVuY2hhbmdlSGFuZGxlciwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2Z1bGxzY3JlZW5jaGFuZ2U6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBJZiBub3RoaW5nIGlzIGZ1bGxzY3JlZW4sIHRoZW4gd2UgY2Fubm90IGJlIGluIGZ1bGxzY3JlZW4gbW9kZS5cclxuXHRcdFx0aWYodGhpcy5vcHRpb25zLmZ1bGxTY3JlZW4gJiYgISQualBsYXllci5uYXRpdmVGZWF0dXJlcy5mdWxsc2NyZWVuLmFwaS5mdWxsc2NyZWVuRWxlbWVudCgpKSB7XHJcblx0XHRcdFx0dGhpcy5fc2V0T3B0aW9uKFwiZnVsbFNjcmVlblwiLCBmYWxzZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfcmVxdWVzdEZ1bGxzY3JlZW46IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBFaXRoZXIgdGhlIGNvbnRhaW5lciBvciB0aGUgalBsYXllciBkaXZcclxuXHRcdFx0dmFyIGUgPSB0aGlzLmFuY2VzdG9ySnEubGVuZ3RoID8gdGhpcy5hbmNlc3RvckpxWzBdIDogdGhpcy5lbGVtZW50WzBdLFxyXG5cdFx0XHRcdGZzID0gJC5qUGxheWVyLm5hdGl2ZUZlYXR1cmVzLmZ1bGxzY3JlZW47XHJcblxyXG5cdFx0XHQvLyBUaGlzIG1ldGhvZCBuZWVkcyB0aGUgdmlkZW8gZWxlbWVudC4gRm9yIGlPUyBhbmQgQW5kcm9pZC5cclxuXHRcdFx0aWYoZnMudXNlZC53ZWJraXRWaWRlbykge1xyXG5cdFx0XHRcdGUgPSB0aGlzLmh0bWxFbGVtZW50LnZpZGVvO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihmcy5hcGkuZnVsbHNjcmVlbkVuYWJsZWQpIHtcclxuXHRcdFx0XHRmcy5hcGkucmVxdWVzdEZ1bGxzY3JlZW4oZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfZXhpdEZ1bGxzY3JlZW46IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdFx0dmFyIGZzID0gJC5qUGxheWVyLm5hdGl2ZUZlYXR1cmVzLmZ1bGxzY3JlZW4sXHJcblx0XHRcdFx0ZTtcclxuXHJcblx0XHRcdC8vIFRoaXMgbWV0aG9kIG5lZWRzIHRoZSB2aWRlbyBlbGVtZW50LiBGb3IgaU9TIGFuZCBBbmRyb2lkLlxyXG5cdFx0XHRpZihmcy51c2VkLndlYmtpdFZpZGVvKSB7XHJcblx0XHRcdFx0ZSA9IHRoaXMuaHRtbEVsZW1lbnQudmlkZW87XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKGZzLmFwaS5mdWxsc2NyZWVuRW5hYmxlZCkge1xyXG5cdFx0XHRcdGZzLmFwaS5leGl0RnVsbHNjcmVlbihlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9odG1sX2luaXRNZWRpYTogZnVuY3Rpb24obWVkaWEpIHtcclxuXHRcdFx0Ly8gUmVtb3ZlIGFueSBleGlzdGluZyB0cmFjayBlbGVtZW50c1xyXG5cdFx0XHR2YXIgJG1lZGlhID0gJCh0aGlzLmh0bWxFbGVtZW50Lm1lZGlhKS5lbXB0eSgpO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRlIGFueSB0cmFjayBlbGVtZW50cyBnaXZlbiB3aXRoIHRoZSBtZWRpYSwgYXMgYW4gQXJyYXkgb2YgdHJhY2sgT2JqZWN0cy5cclxuXHRcdFx0JC5lYWNoKG1lZGlhLnRyYWNrIHx8IFtdLCBmdW5jdGlvbihpLHYpIHtcclxuXHRcdFx0XHR2YXIgdHJhY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cmFjaycpO1xyXG5cdFx0XHRcdHRyYWNrLnNldEF0dHJpYnV0ZShcImtpbmRcIiwgdi5raW5kID8gdi5raW5kIDogXCJcIik7XHJcblx0XHRcdFx0dHJhY2suc2V0QXR0cmlidXRlKFwic3JjXCIsIHYuc3JjID8gdi5zcmMgOiBcIlwiKTtcclxuXHRcdFx0XHR0cmFjay5zZXRBdHRyaWJ1dGUoXCJzcmNsYW5nXCIsIHYuc3JjbGFuZyA/IHYuc3JjbGFuZyA6IFwiXCIpO1xyXG5cdFx0XHRcdHRyYWNrLnNldEF0dHJpYnV0ZShcImxhYmVsXCIsIHYubGFiZWwgPyB2LmxhYmVsIDogXCJcIik7XHJcblx0XHRcdFx0aWYodi5kZWYpIHtcclxuXHRcdFx0XHRcdHRyYWNrLnNldEF0dHJpYnV0ZShcImRlZmF1bHRcIiwgdi5kZWYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQkbWVkaWEuYXBwZW5kKHRyYWNrKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR0aGlzLmh0bWxFbGVtZW50Lm1lZGlhLnNyYyA9IHRoaXMuc3RhdHVzLnNyYztcclxuXHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5wcmVsb2FkICE9PSAnbm9uZScpIHtcclxuXHRcdFx0XHR0aGlzLl9odG1sX2xvYWQoKTsgLy8gU2VlIGZ1bmN0aW9uIGZvciBjb21tZW50c1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LnRpbWV1cGRhdGUpOyAvLyBUaGUgZmxhc2ggZ2VuZXJhdGVzIHRoaXMgZXZlbnQgZm9yIGl0cyBzb2x1dGlvbi5cclxuXHRcdH0sXHJcblx0XHRfaHRtbF9zZXRGb3JtYXQ6IGZ1bmN0aW9uKG1lZGlhKSB7XHJcblx0XHRcdHZhciBzZWxmID0gdGhpcztcclxuXHRcdFx0Ly8gQWx3YXlzIGZpbmRzIGEgZm9ybWF0IGR1ZSB0byBjaGVja3MgaW4gc2V0TWVkaWEoKVxyXG5cdFx0XHQkLmVhY2godGhpcy5mb3JtYXRzLCBmdW5jdGlvbihwcmlvcml0eSwgZm9ybWF0KSB7XHJcblx0XHRcdFx0aWYoc2VsZi5odG1sLnN1cHBvcnRbZm9ybWF0XSAmJiBtZWRpYVtmb3JtYXRdKSB7XHJcblx0XHRcdFx0XHRzZWxmLnN0YXR1cy5zcmMgPSBtZWRpYVtmb3JtYXRdO1xyXG5cdFx0XHRcdFx0c2VsZi5zdGF0dXMuZm9ybWF0W2Zvcm1hdF0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0c2VsZi5zdGF0dXMuZm9ybWF0VHlwZSA9IGZvcm1hdDtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHRcdF9odG1sX3NldEF1ZGlvOiBmdW5jdGlvbihtZWRpYSkge1xyXG5cdFx0XHR0aGlzLl9odG1sX3NldEZvcm1hdChtZWRpYSk7XHJcblx0XHRcdHRoaXMuaHRtbEVsZW1lbnQubWVkaWEgPSB0aGlzLmh0bWxFbGVtZW50LmF1ZGlvO1xyXG5cdFx0XHR0aGlzLl9odG1sX2luaXRNZWRpYShtZWRpYSk7XHJcblx0XHR9LFxyXG5cdFx0X2h0bWxfc2V0VmlkZW86IGZ1bmN0aW9uKG1lZGlhKSB7XHJcblx0XHRcdHRoaXMuX2h0bWxfc2V0Rm9ybWF0KG1lZGlhKTtcclxuXHRcdFx0aWYodGhpcy5zdGF0dXMubmF0aXZlVmlkZW9Db250cm9scykge1xyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQudmlkZW8ucG9zdGVyID0gdGhpcy5fdmFsaWRTdHJpbmcobWVkaWEucG9zdGVyKSA/IG1lZGlhLnBvc3RlciA6IFwiXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5odG1sRWxlbWVudC5tZWRpYSA9IHRoaXMuaHRtbEVsZW1lbnQudmlkZW87XHJcblx0XHRcdHRoaXMuX2h0bWxfaW5pdE1lZGlhKG1lZGlhKTtcclxuXHRcdH0sXHJcblx0XHRfaHRtbF9yZXNldE1lZGlhOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5odG1sRWxlbWVudC5tZWRpYSkge1xyXG5cdFx0XHRcdGlmKHRoaXMuaHRtbEVsZW1lbnQubWVkaWEuaWQgPT09IHRoaXMuaW50ZXJuYWwudmlkZW8uaWQgJiYgIXRoaXMuc3RhdHVzLm5hdGl2ZVZpZGVvQ29udHJvbHMpIHtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8uanEuY3NzKHsnd2lkdGgnOicwcHgnLCAnaGVpZ2h0JzonMHB4J30pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLmh0bWxFbGVtZW50Lm1lZGlhLnBhdXNlKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfaHRtbF9jbGVhck1lZGlhOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5odG1sRWxlbWVudC5tZWRpYSkge1xyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQubWVkaWEuc3JjID0gXCJhYm91dDpibGFua1wiO1xyXG5cdFx0XHRcdC8vIFRoZSBmb2xsb3dpbmcgbG9hZCgpIGlzIG9ubHkgcmVxdWlyZWQgZm9yIEZpcmVmb3ggMy42IChQb3dlck1hY3MpLlxyXG5cdFx0XHRcdC8vIFJlY2VudCBIVE1sNSBicm93c2VycyBvbmx5IHJlcXVpcmUgdGhlIHNyYyBjaGFuZ2UuIER1ZSB0byBjaGFuZ2VzIGluIFczQyBzcGVjIGFuZCBsb2FkKCkgZWZmZWN0LlxyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQubWVkaWEubG9hZCgpOyAvLyBTdG9wcyBhbiBvbGQsIFwiaW4gcHJvZ3Jlc3NcIiBkb3dubG9hZCBmcm9tIGNvbnRpbnVpbmcgdGhlIGRvd25sb2FkLiBUcmlnZ2VycyB0aGUgbG9hZHN0YXJ0LCBlcnJvciBhbmQgZW1wdGllZCBldmVudHMsIGR1ZSB0byB0aGUgZW1wdHkgc3JjLiBBbHNvIGFuIGFib3J0IGV2ZW50IGlmIGEgZG93bmxvYWQgd2FzIGluIHByb2dyZXNzLlxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2h0bWxfbG9hZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIFRoaXMgZnVuY3Rpb24gcmVtYWlucyB0byBhbGxvdyB0aGUgZWFybHkgSFRNTDUgYnJvd3NlcnMgdG8gd29yaywgc3VjaCBhcyBGaXJlZm94IDMuNlxyXG5cdFx0XHQvLyBBIGNoYW5nZSBpbiB0aGUgVzNDIHNwZWMgZm9yIHRoZSBtZWRpYS5sb2FkKCkgY29tbWFuZCBtZWFucyB0aGF0IHRoaXMgaXMgbm8gbG9uZ2VyIG5lY2Vzc2FyeS5cclxuXHRcdFx0Ly8gVGhpcyBjb21tYW5kIHNob3VsZCBiZSByZW1vdmVkIGFuZCBhY3R1YWxseSBjYXVzZXMgbWlub3IgdW5kZXNpcmFibGUgZWZmZWN0cyBvbiBzb21lIGJyb3dzZXJzLiBTdWNoIGFzIGxvYWRpbmcgdGhlIHdob2xlIGZpbGUgYW5kIG5vdCBvbmx5IHRoZSBtZXRhZGF0YS5cclxuXHRcdFx0aWYodGhpcy5zdGF0dXMud2FpdEZvckxvYWQpIHtcclxuXHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yTG9hZCA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQubWVkaWEubG9hZCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmludGVybmFsLmh0bWxEbHlDbWRJZCk7XHJcblx0XHR9LFxyXG5cdFx0X2h0bWxfcGxheTogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXHJcblx0XHRcdFx0bWVkaWEgPSB0aGlzLmh0bWxFbGVtZW50Lm1lZGlhO1xyXG5cclxuXHRcdFx0dGhpcy5hbmRyb2lkRml4LnBhdXNlID0gZmFsc2U7IC8vIENhbmNlbCB0aGUgcGF1c2UgZml4LlxyXG5cclxuXHRcdFx0dGhpcy5faHRtbF9sb2FkKCk7IC8vIExvYWRzIGlmIHJlcXVpcmVkIGFuZCBjbGVhcnMgYW55IGRlbGF5ZWQgY29tbWFuZHMuXHJcblxyXG5cdFx0XHQvLyBTZXR1cCB0aGUgQW5kcm9pZCBGaXguXHJcblx0XHRcdGlmKHRoaXMuYW5kcm9pZEZpeC5zZXRNZWRpYSkge1xyXG5cdFx0XHRcdHRoaXMuYW5kcm9pZEZpeC5wbGF5ID0gdHJ1ZTtcclxuXHRcdFx0XHR0aGlzLmFuZHJvaWRGaXgudGltZSA9IHRpbWU7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYoIWlzTmFOKHRpbWUpKSB7XHJcblxyXG5cdFx0XHRcdC8vIEF0dGVtcHQgdG8gcGxheSBpdCwgc2luY2UgaU9TIGhhcyBiZWVuIGlnbm9yaW5nIGNvbW1hbmRzXHJcblx0XHRcdFx0aWYodGhpcy5pbnRlcm5hbC5jbWRzSWdub3JlZCkge1xyXG5cdFx0XHRcdFx0bWVkaWEucGxheSgpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdC8vICFtZWRpYS5zZWVrYWJsZSBpcyBmb3Igb2xkIEhUTUw1IGJyb3dzZXJzLCBsaWtlIEZpcmVmb3ggMy42LlxyXG5cdFx0XHRcdFx0Ly8gQ2hlY2tpbmcgc2Vla2FibGUubGVuZ3RoIGlzIGltcG9ydGFudCBmb3IgaU9TNiB0byB3b3JrIHdpdGggc2V0TWVkaWEoKS5wbGF5KHRpbWUpXHJcblx0XHRcdFx0XHRpZighbWVkaWEuc2Vla2FibGUgfHwgdHlwZW9mIG1lZGlhLnNlZWthYmxlID09PSBcIm9iamVjdFwiICYmIG1lZGlhLnNlZWthYmxlLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdFx0bWVkaWEuY3VycmVudFRpbWUgPSB0aW1lO1xyXG5cdFx0XHRcdFx0XHRtZWRpYS5wbGF5KCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0aHJvdyAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gY2F0Y2goZXJyKSB7XHJcblx0XHRcdFx0XHR0aGlzLmludGVybmFsLmh0bWxEbHlDbWRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdHNlbGYucGxheSh0aW1lKTtcclxuXHRcdFx0XHRcdH0sIDI1MCk7XHJcblx0XHRcdFx0XHRyZXR1cm47IC8vIENhbmNlbCBleGVjdXRpb24gYW5kIHdhaXQgZm9yIHRoZSBkZWxheWVkIGNvbW1hbmQuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG1lZGlhLnBsYXkoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9odG1sX2NoZWNrV2FpdEZvclBsYXkoKTtcclxuXHRcdH0sXHJcblx0XHRfaHRtbF9wYXVzZTogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXHJcblx0XHRcdFx0bWVkaWEgPSB0aGlzLmh0bWxFbGVtZW50Lm1lZGlhO1xyXG5cclxuXHRcdFx0dGhpcy5hbmRyb2lkRml4LnBsYXkgPSBmYWxzZTsgLy8gQ2FuY2VsIHRoZSBwbGF5IGZpeC5cclxuXHJcblx0XHRcdGlmKHRpbWUgPiAwKSB7IC8vIFdlIGRvIG5vdCB3YW50IHRoZSBzdG9wKCkgY29tbWFuZCwgd2hpY2ggZG9lcyBwYXVzZSgwKSwgY2F1c2luZyBhIGxvYWQgb3BlcmF0aW9uLlxyXG5cdFx0XHRcdHRoaXMuX2h0bWxfbG9hZCgpOyAvLyBMb2FkcyBpZiByZXF1aXJlZCBhbmQgY2xlYXJzIGFueSBkZWxheWVkIGNvbW1hbmRzLlxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmludGVybmFsLmh0bWxEbHlDbWRJZCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIE9yZGVyIG9mIHRoZXNlIGNvbW1hbmRzIGlzIGltcG9ydGFudCBmb3IgU2FmYXJpIChXaW4pIGFuZCBJRTkuIFBhdXNlIHRoZW4gY2hhbmdlIGN1cnJlbnRUaW1lLlxyXG5cdFx0XHRtZWRpYS5wYXVzZSgpO1xyXG5cclxuXHRcdFx0Ly8gU2V0dXAgdGhlIEFuZHJvaWQgRml4LlxyXG5cdFx0XHRpZih0aGlzLmFuZHJvaWRGaXguc2V0TWVkaWEpIHtcclxuXHRcdFx0XHR0aGlzLmFuZHJvaWRGaXgucGF1c2UgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMuYW5kcm9pZEZpeC50aW1lID0gdGltZTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZighaXNOYU4odGltZSkpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0aWYoIW1lZGlhLnNlZWthYmxlIHx8IHR5cGVvZiBtZWRpYS5zZWVrYWJsZSA9PT0gXCJvYmplY3RcIiAmJiBtZWRpYS5zZWVrYWJsZS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRcdG1lZGlhLmN1cnJlbnRUaW1lID0gdGltZTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRocm93IDE7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBjYXRjaChlcnIpIHtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwuaHRtbERseUNtZElkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0c2VsZi5wYXVzZSh0aW1lKTtcclxuXHRcdFx0XHRcdH0sIDI1MCk7XHJcblx0XHRcdFx0XHRyZXR1cm47IC8vIENhbmNlbCBleGVjdXRpb24gYW5kIHdhaXQgZm9yIHRoZSBkZWxheWVkIGNvbW1hbmQuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRpbWUgPiAwKSB7IC8vIEF2b2lkcyBhIHNldE1lZGlhKCkgZm9sbG93ZWQgYnkgc3RvcCgpIG9yIHBhdXNlKDApIGhpZGluZyB0aGUgdmlkZW8gcGxheSBidXR0b24uXHJcblx0XHRcdFx0dGhpcy5faHRtbF9jaGVja1dhaXRGb3JQbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfaHRtbF9wbGF5SGVhZDogZnVuY3Rpb24ocGVyY2VudCkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXHJcblx0XHRcdFx0bWVkaWEgPSB0aGlzLmh0bWxFbGVtZW50Lm1lZGlhO1xyXG5cclxuXHRcdFx0dGhpcy5faHRtbF9sb2FkKCk7IC8vIExvYWRzIGlmIHJlcXVpcmVkIGFuZCBjbGVhcnMgYW55IGRlbGF5ZWQgY29tbWFuZHMuXHJcblxyXG5cdFx0XHQvLyBUaGlzIHBsYXlIZWFkKCkgbWV0aG9kIG5lZWRzIGEgcmVmYWN0b3IgdG8gYXBwbHkgdGhlIGFuZHJvaWQgZml4LlxyXG5cclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgbWVkaWEuc2Vla2FibGUgPT09IFwib2JqZWN0XCIgJiYgbWVkaWEuc2Vla2FibGUubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0bWVkaWEuY3VycmVudFRpbWUgPSBwZXJjZW50ICogbWVkaWEuc2Vla2FibGUuZW5kKG1lZGlhLnNlZWthYmxlLmxlbmd0aC0xKSAvIDEwMDtcclxuXHRcdFx0XHR9IGVsc2UgaWYobWVkaWEuZHVyYXRpb24gPiAwICYmICFpc05hTihtZWRpYS5kdXJhdGlvbikpIHtcclxuXHRcdFx0XHRcdG1lZGlhLmN1cnJlbnRUaW1lID0gcGVyY2VudCAqIG1lZGlhLmR1cmF0aW9uIC8gMTAwO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR0aHJvdyBcImVcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2goZXJyKSB7XHJcblx0XHRcdFx0dGhpcy5pbnRlcm5hbC5odG1sRGx5Q21kSWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0c2VsZi5wbGF5SGVhZChwZXJjZW50KTtcclxuXHRcdFx0XHR9LCAyNTApO1xyXG5cdFx0XHRcdHJldHVybjsgLy8gQ2FuY2VsIGV4ZWN1dGlvbiBhbmQgd2FpdCBmb3IgdGhlIGRlbGF5ZWQgY29tbWFuZC5cclxuXHRcdFx0fVxyXG5cdFx0XHRpZighdGhpcy5zdGF0dXMud2FpdEZvckxvYWQpIHtcclxuXHRcdFx0XHR0aGlzLl9odG1sX2NoZWNrV2FpdEZvclBsYXkoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9odG1sX2NoZWNrV2FpdEZvclBsYXk6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnN0YXR1cy53YWl0Rm9yUGxheSkge1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLndhaXRGb3JQbGF5ID0gZmFsc2U7XHJcblx0XHRcdFx0aWYodGhpcy5jc3MuanEudmlkZW9QbGF5Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudmlkZW9QbGF5LmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodGhpcy5zdGF0dXMudmlkZW8pIHtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLmhpZGUoKTtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwudmlkZW8uanEuY3NzKHsnd2lkdGgnOiB0aGlzLnN0YXR1cy53aWR0aCwgJ2hlaWdodCc6IHRoaXMuc3RhdHVzLmhlaWdodH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9odG1sX3NldFByb3BlcnR5OiBmdW5jdGlvbihwcm9wZXJ0eSwgdmFsdWUpIHtcclxuXHRcdFx0aWYodGhpcy5odG1sLmF1ZGlvLmF2YWlsYWJsZSkge1xyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQuYXVkaW9bcHJvcGVydHldID0gdmFsdWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodGhpcy5odG1sLnZpZGVvLmF2YWlsYWJsZSkge1xyXG5cdFx0XHRcdHRoaXMuaHRtbEVsZW1lbnQudmlkZW9bcHJvcGVydHldID0gdmFsdWU7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfYXVyb3JhX3NldEF1ZGlvOiBmdW5jdGlvbihtZWRpYSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7ICAgICAgICAgICAgXHJcblx0XHRcdFxyXG5cdFx0XHQvLyBBbHdheXMgZmluZHMgYSBmb3JtYXQgZHVlIHRvIGNoZWNrcyBpbiBzZXRNZWRpYSgpXHJcblx0XHRcdCQuZWFjaCh0aGlzLmZvcm1hdHMsIGZ1bmN0aW9uKHByaW9yaXR5LCBmb3JtYXQpIHtcclxuXHRcdFx0XHRpZihzZWxmLmF1cm9yYS5zdXBwb3J0W2Zvcm1hdF0gJiYgbWVkaWFbZm9ybWF0XSkge1xyXG5cdFx0XHRcdFx0c2VsZi5zdGF0dXMuc3JjID0gbWVkaWFbZm9ybWF0XTtcclxuXHRcdFx0XHRcdHNlbGYuc3RhdHVzLmZvcm1hdFtmb3JtYXRdID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHNlbGYuc3RhdHVzLmZvcm1hdFR5cGUgPSBmb3JtYXQ7XHJcblx0XHRcdFxyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmF1cm9yYS5wbGF5ZXIgPSBuZXcgQVYuUGxheWVyLmZyb21VUkwodGhpcy5zdGF0dXMuc3JjKTtcclxuXHRcdFx0dGhpcy5fYWRkQXVyb3JhRXZlbnRMaXN0ZW5lcnModGhpcy5hdXJvcmEucGxheWVyLCB0aGlzLmF1cm9yYSk7XHJcblxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMucHJlbG9hZCA9PT0gJ2F1dG8nKSB7XHJcblx0XHRcdFx0dGhpcy5fYXVyb3JhX2xvYWQoKTtcclxuXHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yTG9hZCA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9yZXNldE1lZGlhOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKHRoaXMuYXVyb3JhLnBsYXllcikge1xyXG5cdFx0XHRcdHRoaXMuYXVyb3JhLnBsYXllci5zdG9wKCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfYXVyb3JhX2NsZWFyTWVkaWE6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBOb3RoaW5nIHRvIGNsZWFyLlxyXG5cdFx0fSxcclxuXHRcdF9hdXJvcmFfbG9hZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmKHRoaXMuc3RhdHVzLndhaXRGb3JMb2FkKSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0dXMud2FpdEZvckxvYWQgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLmF1cm9yYS5wbGF5ZXIucHJlbG9hZCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9wbGF5OiBmdW5jdGlvbih0aW1lKSB7XHJcblx0XHRcdGlmICghdGhpcy5zdGF0dXMud2FpdEZvckxvYWQpIHtcclxuXHRcdFx0XHRpZiAoIWlzTmFOKHRpbWUpKSB7XHJcblx0XHRcdFx0XHR0aGlzLmF1cm9yYS5wbGF5ZXIuc2Vlayh0aW1lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCF0aGlzLmF1cm9yYS5wbGF5ZXIucGxheWluZykge1xyXG5cdFx0XHRcdHRoaXMuYXVyb3JhLnBsYXllci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5zdGF0dXMud2FpdEZvckxvYWQgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5fYXVyb3JhX2NoZWNrV2FpdEZvclBsYXkoKTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIE5vIGV2ZW50IGZyb20gdGhlIHBsYXllciwgdXBkYXRlIFVJIG5vdy5cclxuXHRcdFx0dGhpcy5fdXBkYXRlQnV0dG9ucyh0cnVlKTtcclxuXHRcdFx0dGhpcy5fdHJpZ2dlcigkLmpQbGF5ZXIuZXZlbnQucGxheSk7XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9wYXVzZTogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHRpZiAoIWlzTmFOKHRpbWUpKSB7XHJcblx0XHRcdFx0dGhpcy5hdXJvcmEucGxheWVyLnNlZWsodGltZSAqIDEwMDApO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuYXVyb3JhLnBsYXllci5wYXVzZSgpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYodGltZSA+IDApIHsgLy8gQXZvaWRzIGEgc2V0TWVkaWEoKSBmb2xsb3dlZCBieSBzdG9wKCkgb3IgcGF1c2UoMCkgaGlkaW5nIHRoZSB2aWRlbyBwbGF5IGJ1dHRvbi5cclxuXHRcdFx0XHR0aGlzLl9hdXJvcmFfY2hlY2tXYWl0Rm9yUGxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBObyBldmVudCBmcm9tIHRoZSBwbGF5ZXIsIHVwZGF0ZSBVSSBub3cuXHJcblx0XHRcdHRoaXMuX3VwZGF0ZUJ1dHRvbnMoZmFsc2UpO1xyXG5cdFx0XHR0aGlzLl90cmlnZ2VyKCQualBsYXllci5ldmVudC5wYXVzZSk7XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9wbGF5SGVhZDogZnVuY3Rpb24ocGVyY2VudCkge1xyXG5cdFx0XHRpZih0aGlzLmF1cm9yYS5wbGF5ZXIuZHVyYXRpb24gPiAwKSB7XHJcblx0XHRcdFx0Ly8gVGhlIHNlZWsoKSBzb3VsZCBiZSBpbiBtaWxsaXNlY29uZHMsIGJ1dCB0aGUgb25seSBjb2RlYyB0aGF0IHdvcmtzIHdpdGggc2VlayAoYWFjLmpzKSB1c2VzIHNlY29uZHMuXHJcblx0XHRcdFx0dGhpcy5hdXJvcmEucGxheWVyLnNlZWsocGVyY2VudCAqIHRoaXMuYXVyb3JhLnBsYXllci5kdXJhdGlvbiAvIDEwMCk7IC8vIFVzaW5nIHNlY29uZHNcclxuXHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRpZighdGhpcy5zdGF0dXMud2FpdEZvckxvYWQpIHtcclxuXHRcdFx0XHR0aGlzLl9hdXJvcmFfY2hlY2tXYWl0Rm9yUGxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9jaGVja1dhaXRGb3JQbGF5OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0dXMud2FpdEZvclBsYXkpIHtcclxuXHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yUGxheSA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV92b2x1bWU6IGZ1bmN0aW9uKHYpIHtcclxuXHRcdFx0dGhpcy5hdXJvcmEucGxheWVyLnZvbHVtZSA9IHYgKiAxMDA7XHJcblx0XHR9LFxyXG5cdFx0X2F1cm9yYV9tdXRlOiBmdW5jdGlvbihtKSB7XHJcblx0XHRcdGlmIChtKSB7XHJcblx0XHRcdFx0dGhpcy5hdXJvcmEucHJvcGVydGllcy5sYXN0dm9sdW1lID0gdGhpcy5hdXJvcmEucGxheWVyLnZvbHVtZTtcclxuXHRcdFx0XHR0aGlzLmF1cm9yYS5wbGF5ZXIudm9sdW1lID0gMDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLmF1cm9yYS5wbGF5ZXIudm9sdW1lID0gdGhpcy5hdXJvcmEucHJvcGVydGllcy5sYXN0dm9sdW1lO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuYXVyb3JhLnByb3BlcnRpZXMubXV0ZWQgPSBtO1xyXG5cdFx0fSxcclxuXHRcdF9mbGFzaF9zZXRBdWRpbzogZnVuY3Rpb24obWVkaWEpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdC8vIEFsd2F5cyBmaW5kcyBhIGZvcm1hdCBkdWUgdG8gY2hlY2tzIGluIHNldE1lZGlhKClcclxuXHRcdFx0XHQkLmVhY2godGhpcy5mb3JtYXRzLCBmdW5jdGlvbihwcmlvcml0eSwgZm9ybWF0KSB7XHJcblx0XHRcdFx0XHRpZihzZWxmLmZsYXNoLnN1cHBvcnRbZm9ybWF0XSAmJiBtZWRpYVtmb3JtYXRdKSB7XHJcblx0XHRcdFx0XHRcdHN3aXRjaCAoZm9ybWF0KSB7XHJcblx0XHRcdFx0XHRcdFx0Y2FzZSBcIm00YVwiIDpcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwiZmxhXCIgOlxyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5fZ2V0TW92aWUoKS5mbF9zZXRBdWRpb19tNGEobWVkaWFbZm9ybWF0XSk7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwibXAzXCIgOlxyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5fZ2V0TW92aWUoKS5mbF9zZXRBdWRpb19tcDMobWVkaWFbZm9ybWF0XSk7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwicnRtcGFcIjpcclxuXHRcdFx0XHRcdFx0XHRcdHNlbGYuX2dldE1vdmllKCkuZmxfc2V0QXVkaW9fcnRtcChtZWRpYVtmb3JtYXRdKTtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLnNyYyA9IG1lZGlhW2Zvcm1hdF07XHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLmZvcm1hdFtmb3JtYXRdID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0c2VsZi5zdGF0dXMuZm9ybWF0VHlwZSA9IGZvcm1hdDtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMucHJlbG9hZCA9PT0gJ2F1dG8nKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9mbGFzaF9sb2FkKCk7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yTG9hZCA9IGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaChlcnIpIHsgdGhpcy5fZmxhc2hFcnJvcihlcnIpOyB9XHJcblx0XHR9LFxyXG5cdFx0X2ZsYXNoX3NldFZpZGVvOiBmdW5jdGlvbihtZWRpYSkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Ly8gQWx3YXlzIGZpbmRzIGEgZm9ybWF0IGR1ZSB0byBjaGVja3MgaW4gc2V0TWVkaWEoKVxyXG5cdFx0XHRcdCQuZWFjaCh0aGlzLmZvcm1hdHMsIGZ1bmN0aW9uKHByaW9yaXR5LCBmb3JtYXQpIHtcclxuXHRcdFx0XHRcdGlmKHNlbGYuZmxhc2guc3VwcG9ydFtmb3JtYXRdICYmIG1lZGlhW2Zvcm1hdF0pIHtcclxuXHRcdFx0XHRcdFx0c3dpdGNoIChmb3JtYXQpIHtcclxuXHRcdFx0XHRcdFx0XHRjYXNlIFwibTR2XCIgOlxyXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJmbHZcIiA6XHJcblx0XHRcdFx0XHRcdFx0XHRzZWxmLl9nZXRNb3ZpZSgpLmZsX3NldFZpZGVvX200dihtZWRpYVtmb3JtYXRdKTtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdGNhc2UgXCJydG1wdlwiOlxyXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5fZ2V0TW92aWUoKS5mbF9zZXRWaWRlb19ydG1wKG1lZGlhW2Zvcm1hdF0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHRcdFxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLnNyYyA9IG1lZGlhW2Zvcm1hdF07XHJcblx0XHRcdFx0XHRcdHNlbGYuc3RhdHVzLmZvcm1hdFtmb3JtYXRdID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0c2VsZi5zdGF0dXMuZm9ybWF0VHlwZSA9IGZvcm1hdDtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMucHJlbG9hZCA9PT0gJ2F1dG8nKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9mbGFzaF9sb2FkKCk7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yTG9hZCA9IGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBjYXRjaChlcnIpIHsgdGhpcy5fZmxhc2hFcnJvcihlcnIpOyB9XHJcblx0XHR9LFxyXG5cdFx0X2ZsYXNoX3Jlc2V0TWVkaWE6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR0aGlzLmludGVybmFsLmZsYXNoLmpxLmNzcyh7J3dpZHRoJzonMHB4JywgJ2hlaWdodCc6JzBweCd9KTsgLy8gTXVzdCBkbyB2aWEgQ1NTIGFzIHNldHRpbmcgYXR0cigpIHRvIHplcm8gY2F1c2VzIGEgalF1ZXJ5IGVycm9yIGluIElFLlxyXG5cdFx0XHR0aGlzLl9mbGFzaF9wYXVzZShOYU4pO1xyXG5cdFx0fSxcclxuXHRcdF9mbGFzaF9jbGVhck1lZGlhOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHR0aGlzLl9nZXRNb3ZpZSgpLmZsX2NsZWFyTWVkaWEoKTtcclxuXHRcdFx0fSBjYXRjaChlcnIpIHsgdGhpcy5fZmxhc2hFcnJvcihlcnIpOyB9XHJcblx0XHR9LFxyXG5cdFx0X2ZsYXNoX2xvYWQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdHRoaXMuX2dldE1vdmllKCkuZmxfbG9hZCgpO1xyXG5cdFx0XHR9IGNhdGNoKGVycikgeyB0aGlzLl9mbGFzaEVycm9yKGVycik7IH1cclxuXHRcdFx0dGhpcy5zdGF0dXMud2FpdEZvckxvYWQgPSBmYWxzZTtcclxuXHRcdH0sXHJcblx0XHRfZmxhc2hfcGxheTogZnVuY3Rpb24odGltZSkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdHRoaXMuX2dldE1vdmllKCkuZmxfcGxheSh0aW1lKTtcclxuXHRcdFx0fSBjYXRjaChlcnIpIHsgdGhpcy5fZmxhc2hFcnJvcihlcnIpOyB9XHJcblx0XHRcdHRoaXMuc3RhdHVzLndhaXRGb3JMb2FkID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuX2ZsYXNoX2NoZWNrV2FpdEZvclBsYXkoKTtcclxuXHRcdH0sXHJcblx0XHRfZmxhc2hfcGF1c2U6IGZ1bmN0aW9uKHRpbWUpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHR0aGlzLl9nZXRNb3ZpZSgpLmZsX3BhdXNlKHRpbWUpO1xyXG5cdFx0XHR9IGNhdGNoKGVycikgeyB0aGlzLl9mbGFzaEVycm9yKGVycik7IH1cclxuXHRcdFx0aWYodGltZSA+IDApIHsgLy8gQXZvaWRzIGEgc2V0TWVkaWEoKSBmb2xsb3dlZCBieSBzdG9wKCkgb3IgcGF1c2UoMCkgaGlkaW5nIHRoZSB2aWRlbyBwbGF5IGJ1dHRvbi5cclxuXHRcdFx0XHR0aGlzLnN0YXR1cy53YWl0Rm9yTG9hZCA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuX2ZsYXNoX2NoZWNrV2FpdEZvclBsYXkoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9mbGFzaF9wbGF5SGVhZDogZnVuY3Rpb24ocCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdHRoaXMuX2dldE1vdmllKCkuZmxfcGxheV9oZWFkKHApO1xyXG5cdFx0XHR9IGNhdGNoKGVycikgeyB0aGlzLl9mbGFzaEVycm9yKGVycik7IH1cclxuXHRcdFx0aWYoIXRoaXMuc3RhdHVzLndhaXRGb3JMb2FkKSB7XHJcblx0XHRcdFx0dGhpcy5fZmxhc2hfY2hlY2tXYWl0Rm9yUGxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0X2ZsYXNoX2NoZWNrV2FpdEZvclBsYXk6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnN0YXR1cy53YWl0Rm9yUGxheSkge1xyXG5cdFx0XHRcdHRoaXMuc3RhdHVzLndhaXRGb3JQbGF5ID0gZmFsc2U7XHJcblx0XHRcdFx0aWYodGhpcy5jc3MuanEudmlkZW9QbGF5Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5jc3MuanEudmlkZW9QbGF5LmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodGhpcy5zdGF0dXMudmlkZW8pIHtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwucG9zdGVyLmpxLmhpZGUoKTtcclxuXHRcdFx0XHRcdHRoaXMuaW50ZXJuYWwuZmxhc2guanEuY3NzKHsnd2lkdGgnOiB0aGlzLnN0YXR1cy53aWR0aCwgJ2hlaWdodCc6IHRoaXMuc3RhdHVzLmhlaWdodH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdF9mbGFzaF92b2x1bWU6IGZ1bmN0aW9uKHYpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHR0aGlzLl9nZXRNb3ZpZSgpLmZsX3ZvbHVtZSh2KTtcclxuXHRcdFx0fSBjYXRjaChlcnIpIHsgdGhpcy5fZmxhc2hFcnJvcihlcnIpOyB9XHJcblx0XHR9LFxyXG5cdFx0X2ZsYXNoX211dGU6IGZ1bmN0aW9uKG0pIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHR0aGlzLl9nZXRNb3ZpZSgpLmZsX211dGUobSk7XHJcblx0XHRcdH0gY2F0Y2goZXJyKSB7IHRoaXMuX2ZsYXNoRXJyb3IoZXJyKTsgfVxyXG5cdFx0fSxcclxuXHRcdF9nZXRNb3ZpZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiBkb2N1bWVudFt0aGlzLmludGVybmFsLmZsYXNoLmlkXTtcclxuXHRcdH0sXHJcblx0XHRfZ2V0Rmxhc2hQbHVnaW5WZXJzaW9uOiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdC8vIF9nZXRGbGFzaFBsdWdpblZlcnNpb24oKSBjb2RlIGluZmx1ZW5jZWQgYnk6XHJcblx0XHRcdC8vIC0gRmxhc2hSZXBsYWNlIDEuMDE6IGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9mbGFzaHJlcGxhY2UvXHJcblx0XHRcdC8vIC0gU1dGT2JqZWN0IDIuMjogaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3N3Zm9iamVjdC9cclxuXHJcblx0XHRcdHZhciB2ZXJzaW9uID0gMCxcclxuXHRcdFx0XHRmbGFzaDtcclxuXHRcdFx0aWYod2luZG93LkFjdGl2ZVhPYmplY3QpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0Zmxhc2ggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoXCIpO1xyXG5cdFx0XHRcdFx0aWYgKGZsYXNoKSB7IC8vIGZsYXNoIHdpbGwgcmV0dXJuIG51bGwgd2hlbiBBY3RpdmVYIGlzIGRpc2FibGVkXHJcblx0XHRcdFx0XHRcdHZhciB2ID0gZmxhc2guR2V0VmFyaWFibGUoXCIkdmVyc2lvblwiKTtcclxuXHRcdFx0XHRcdFx0aWYodikge1xyXG5cdFx0XHRcdFx0XHRcdHYgPSB2LnNwbGl0KFwiIFwiKVsxXS5zcGxpdChcIixcIik7XHJcblx0XHRcdFx0XHRcdFx0dmVyc2lvbiA9IHBhcnNlSW50KHZbMF0sIDEwKSArIFwiLlwiICsgcGFyc2VJbnQodlsxXSwgMTApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBjYXRjaChlKSB7fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYobmF2aWdhdG9yLnBsdWdpbnMgJiYgbmF2aWdhdG9yLm1pbWVUeXBlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0Zmxhc2ggPSBuYXZpZ2F0b3IucGx1Z2luc1tcIlNob2Nrd2F2ZSBGbGFzaFwiXTtcclxuXHRcdFx0XHRpZihmbGFzaCkge1xyXG5cdFx0XHRcdFx0dmVyc2lvbiA9IG5hdmlnYXRvci5wbHVnaW5zW1wiU2hvY2t3YXZlIEZsYXNoXCJdLmRlc2NyaXB0aW9uLnJlcGxhY2UoLy4qXFxzKFxcZCtcXC5cXGQrKS4qLywgXCIkMVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHZlcnNpb24gKiAxOyAvLyBDb252ZXJ0cyB0byBhIG51bWJlclxyXG5cdFx0fSxcclxuXHRcdF9jaGVja0ZvckZsYXNoOiBmdW5jdGlvbiAodmVyc2lvbikge1xyXG5cdFx0XHR2YXIgZmxhc2hPayA9IGZhbHNlO1xyXG5cdFx0XHRpZih0aGlzLl9nZXRGbGFzaFBsdWdpblZlcnNpb24oKSA+PSB2ZXJzaW9uKSB7XHJcblx0XHRcdFx0Zmxhc2hPayA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGZsYXNoT2s7XHJcblx0XHR9LFxyXG5cdFx0X3ZhbGlkU3RyaW5nOiBmdW5jdGlvbih1cmwpIHtcclxuXHRcdFx0cmV0dXJuICh1cmwgJiYgdHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIik7IC8vIEVtcHR5IHN0cmluZ3MgcmV0dXJuIGZhbHNlXHJcblx0XHR9LFxyXG5cdFx0X2xpbWl0VmFsdWU6IGZ1bmN0aW9uKHZhbHVlLCBtaW4sIG1heCkge1xyXG5cdFx0XHRyZXR1cm4gKHZhbHVlIDwgbWluKSA/IG1pbiA6ICgodmFsdWUgPiBtYXgpID8gbWF4IDogdmFsdWUpO1xyXG5cdFx0fSxcclxuXHRcdF91cmxOb3RTZXRFcnJvcjogZnVuY3Rpb24oY29udGV4dCkge1xyXG5cdFx0XHR0aGlzLl9lcnJvcigge1xyXG5cdFx0XHRcdHR5cGU6ICQualBsYXllci5lcnJvci5VUkxfTk9UX1NFVCxcclxuXHRcdFx0XHRjb250ZXh0OiBjb250ZXh0LFxyXG5cdFx0XHRcdG1lc3NhZ2U6ICQualBsYXllci5lcnJvck1zZy5VUkxfTk9UX1NFVCxcclxuXHRcdFx0XHRoaW50OiAkLmpQbGF5ZXIuZXJyb3JIaW50LlVSTF9OT1RfU0VUXHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHRcdF9mbGFzaEVycm9yOiBmdW5jdGlvbihlcnJvcikge1xyXG5cdFx0XHR2YXIgZXJyb3JUeXBlO1xyXG5cdFx0XHRpZighdGhpcy5pbnRlcm5hbC5yZWFkeSkge1xyXG5cdFx0XHRcdGVycm9yVHlwZSA9IFwiRkxBU0hcIjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRlcnJvclR5cGUgPSBcIkZMQVNIX0RJU0FCTEVEXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5fZXJyb3IoIHtcclxuXHRcdFx0XHR0eXBlOiAkLmpQbGF5ZXIuZXJyb3JbZXJyb3JUeXBlXSxcclxuXHRcdFx0XHRjb250ZXh0OiB0aGlzLmludGVybmFsLmZsYXNoLnN3ZixcclxuXHRcdFx0XHRtZXNzYWdlOiAkLmpQbGF5ZXIuZXJyb3JNc2dbZXJyb3JUeXBlXSArIGVycm9yLm1lc3NhZ2UsXHJcblx0XHRcdFx0aGludDogJC5qUGxheWVyLmVycm9ySGludFtlcnJvclR5cGVdXHJcblx0XHRcdH0pO1xyXG5cdFx0XHQvLyBBbGxvdyB0aGUgYXVkaW8gcGxheWVyIHRvIHJlY292ZXIgaWYgZGlzcGxheTpub25lIGFuZCB0aGVuIHNob3duIGFnYWluLCBvciB3aXRoIHBvc2l0aW9uOmZpeGVkIG9uIEZpcmVmb3guXHJcblx0XHRcdC8vIFRoaXMgcmVhbGx5IG9ubHkgYWZmZWN0cyBhdWRpbyBpbiBhIG1lZGlhIHBsYXllciwgYXMgYW4gYXVkaW8gcGxheWVyIGNvdWxkIGVhc2lseSBtb3ZlIHRoZSBqUGxheWVyIGVsZW1lbnQgYXdheSBmcm9tIHN1Y2ggaXNzdWVzLlxyXG5cdFx0XHR0aGlzLmludGVybmFsLmZsYXNoLmpxLmNzcyh7J3dpZHRoJzonMXB4JywgJ2hlaWdodCc6JzFweCd9KTtcclxuXHRcdH0sXHJcblx0XHRfZXJyb3I6IGZ1bmN0aW9uKGVycm9yKSB7XHJcblx0XHRcdHRoaXMuX3RyaWdnZXIoJC5qUGxheWVyLmV2ZW50LmVycm9yLCBlcnJvcik7XHJcblx0XHRcdGlmKHRoaXMub3B0aW9ucy5lcnJvckFsZXJ0cykge1xyXG5cdFx0XHRcdHRoaXMuX2FsZXJ0KFwiRXJyb3IhXCIgKyAoZXJyb3IubWVzc2FnZSA/IFwiXFxuXCIgKyBlcnJvci5tZXNzYWdlIDogXCJcIikgKyAoZXJyb3IuaGludCA/IFwiXFxuXCIgKyBlcnJvci5oaW50IDogXCJcIikgKyBcIlxcbkNvbnRleHQ6IFwiICsgZXJyb3IuY29udGV4dCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfd2FybmluZzogZnVuY3Rpb24od2FybmluZykge1xyXG5cdFx0XHR0aGlzLl90cmlnZ2VyKCQualBsYXllci5ldmVudC53YXJuaW5nLCB1bmRlZmluZWQsIHdhcm5pbmcpO1xyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMud2FybmluZ0FsZXJ0cykge1xyXG5cdFx0XHRcdHRoaXMuX2FsZXJ0KFwiV2FybmluZyFcIiArICh3YXJuaW5nLm1lc3NhZ2UgPyBcIlxcblwiICsgd2FybmluZy5tZXNzYWdlIDogXCJcIikgKyAod2FybmluZy5oaW50ID8gXCJcXG5cIiArIHdhcm5pbmcuaGludCA6IFwiXCIpICsgXCJcXG5Db250ZXh0OiBcIiArIHdhcm5pbmcuY29udGV4dCk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfYWxlcnQ6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcclxuXHRcdFx0dmFyIG1zZyA9IFwialBsYXllciBcIiArIHRoaXMudmVyc2lvbi5zY3JpcHQgKyBcIiA6IGlkPSdcIiArIHRoaXMuaW50ZXJuYWwuc2VsZi5pZCArXCInIDogXCIgKyBtZXNzYWdlO1xyXG5cdFx0XHRpZighdGhpcy5vcHRpb25zLmNvbnNvbGVBbGVydHMpIHtcclxuXHRcdFx0XHRhbGVydChtc2cpO1xyXG5cdFx0XHR9IGVsc2UgaWYod2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUubG9nKSB7XHJcblx0XHRcdFx0d2luZG93LmNvbnNvbGUubG9nKG1zZyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRfZW11bGF0ZUh0bWxCcmlkZ2U6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG5cdFx0XHQvLyBFbXVsYXRlIG1ldGhvZHMgb24galBsYXllcidzIERPTSBlbGVtZW50LlxyXG5cdFx0XHQkLmVhY2goICQualBsYXllci5lbXVsYXRlTWV0aG9kcy5zcGxpdCgvXFxzKy9nKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xyXG5cdFx0XHRcdHNlbGYuaW50ZXJuYWwuZG9tTm9kZVtuYW1lXSA9IGZ1bmN0aW9uKGFyZykge1xyXG5cdFx0XHRcdFx0c2VsZltuYW1lXShhcmcpO1xyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEJ1YmJsZSBqUGxheWVyIGV2ZW50cyB0byBpdHMgRE9NIGVsZW1lbnQuXHJcblx0XHRcdCQuZWFjaCgkLmpQbGF5ZXIuZXZlbnQsIGZ1bmN0aW9uKGV2ZW50TmFtZSxldmVudFR5cGUpIHtcclxuXHRcdFx0XHR2YXIgbmF0aXZlRXZlbnQgPSB0cnVlO1xyXG5cdFx0XHRcdCQuZWFjaCggJC5qUGxheWVyLnJlc2VydmVkRXZlbnQuc3BsaXQoL1xccysvZyksIGZ1bmN0aW9uKGksIG5hbWUpIHtcclxuXHRcdFx0XHRcdGlmKG5hbWUgPT09IGV2ZW50TmFtZSkge1xyXG5cdFx0XHRcdFx0XHRuYXRpdmVFdmVudCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYobmF0aXZlRXZlbnQpIHtcclxuXHRcdFx0XHRcdHNlbGYuZWxlbWVudC5iaW5kKGV2ZW50VHlwZSArIFwiLmpQbGF5ZXIualBsYXllckh0bWxcIiwgZnVuY3Rpb24oKSB7IC8vIFdpdGggLmpQbGF5ZXIgJiAualBsYXllckh0bWwgbmFtZXNwYWNlcy5cclxuXHRcdFx0XHRcdFx0c2VsZi5fZW11bGF0ZUh0bWxVcGRhdGUoKTtcclxuXHRcdFx0XHRcdFx0dmFyIGRvbUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcclxuXHRcdFx0XHRcdFx0ZG9tRXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSwgZmFsc2UsIHRydWUpO1xyXG5cdFx0XHRcdFx0XHRzZWxmLmludGVybmFsLmRvbU5vZGUuZGlzcGF0Y2hFdmVudChkb21FdmVudCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gVGhlIGVycm9yIGV2ZW50IHdvdWxkIHJlcXVpcmUgYSBzcGVjaWFsIGNhc2VcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBJRTkgaGFzIGEgcmVhZHlTdGF0ZSBwcm9wZXJ0eSBvbiBhbGwgZWxlbWVudHMuIFRoZSBkb2N1bWVudCBzaG91bGQgaGF2ZSBpdCwgYnV0IGFsbCAoZXhjZXB0IG1lZGlhKSBlbGVtZW50cyBpbmhlcml0IGl0IGluIElFOS4gVGhpcyBjb25mbGljdHMgd2l0aCBQb3Bjb3JuLCB3aGljaCBwb2xscyB0aGUgcmVhZHlTdGF0ZS5cclxuXHRcdH0sXHJcblx0XHRfZW11bGF0ZUh0bWxVcGRhdGU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG5cdFx0XHQkLmVhY2goICQualBsYXllci5lbXVsYXRlU3RhdHVzLnNwbGl0KC9cXHMrL2cpLCBmdW5jdGlvbihpLCBuYW1lKSB7XHJcblx0XHRcdFx0c2VsZi5pbnRlcm5hbC5kb21Ob2RlW25hbWVdID0gc2VsZi5zdGF0dXNbbmFtZV07XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQkLmVhY2goICQualBsYXllci5lbXVsYXRlT3B0aW9ucy5zcGxpdCgvXFxzKy9nKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xyXG5cdFx0XHRcdHNlbGYuaW50ZXJuYWwuZG9tTm9kZVtuYW1lXSA9IHNlbGYub3B0aW9uc1tuYW1lXTtcclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cdFx0X2Rlc3Ryb3lIdG1sQnJpZGdlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHRcdFx0Ly8gQnJpZGdlIGV2ZW50IGhhbmRsZXJzIGFyZSBhbHNvIHJlbW92ZWQgYnkgZGVzdHJveSgpIHRocm91Z2ggLmpQbGF5ZXIgbmFtZXNwYWNlLlxyXG5cdFx0XHR0aGlzLmVsZW1lbnQudW5iaW5kKFwiLmpQbGF5ZXJIdG1sXCIpOyAvLyBSZW1vdmUgYWxsIGV2ZW50IGhhbmRsZXJzIGNyZWF0ZWQgYnkgdGhlIGpQbGF5ZXIgYnJpZGdlLiBTbyB5b3UgY2FuIGNoYW5nZSB0aGUgZW11bGF0ZUh0bWwgb3B0aW9uLlxyXG5cclxuXHRcdFx0Ly8gUmVtb3ZlIHRoZSBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzXHJcblx0XHRcdHZhciBlbXVsYXRlZCA9ICQualBsYXllci5lbXVsYXRlTWV0aG9kcyArIFwiIFwiICsgJC5qUGxheWVyLmVtdWxhdGVTdGF0dXMgKyBcIiBcIiArICQualBsYXllci5lbXVsYXRlT3B0aW9ucztcclxuXHRcdFx0JC5lYWNoKCBlbXVsYXRlZC5zcGxpdCgvXFxzKy9nKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xyXG5cdFx0XHRcdGRlbGV0ZSBzZWxmLmludGVybmFsLmRvbU5vZGVbbmFtZV07XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdCQualBsYXllci5lcnJvciA9IHtcclxuXHRcdEZMQVNIOiBcImVfZmxhc2hcIixcclxuXHRcdEZMQVNIX0RJU0FCTEVEOiBcImVfZmxhc2hfZGlzYWJsZWRcIixcclxuXHRcdE5PX1NPTFVUSU9OOiBcImVfbm9fc29sdXRpb25cIixcclxuXHRcdE5PX1NVUFBPUlQ6IFwiZV9ub19zdXBwb3J0XCIsXHJcblx0XHRVUkw6IFwiZV91cmxcIixcclxuXHRcdFVSTF9OT1RfU0VUOiBcImVfdXJsX25vdF9zZXRcIixcclxuXHRcdFZFUlNJT046IFwiZV92ZXJzaW9uXCJcclxuXHR9O1xyXG5cclxuXHQkLmpQbGF5ZXIuZXJyb3JNc2cgPSB7XHJcblx0XHRGTEFTSDogXCJqUGxheWVyJ3MgRmxhc2ggZmFsbGJhY2sgaXMgbm90IGNvbmZpZ3VyZWQgY29ycmVjdGx5LCBvciBhIGNvbW1hbmQgd2FzIGlzc3VlZCBiZWZvcmUgdGhlIGpQbGF5ZXIgUmVhZHkgZXZlbnQuIERldGFpbHM6IFwiLCAvLyBVc2VkIGluOiBfZmxhc2hFcnJvcigpXHJcblx0XHRGTEFTSF9ESVNBQkxFRDogXCJqUGxheWVyJ3MgRmxhc2ggZmFsbGJhY2sgaGFzIGJlZW4gZGlzYWJsZWQgYnkgdGhlIGJyb3dzZXIgZHVlIHRvIHRoZSBDU1MgcnVsZXMgeW91IGhhdmUgdXNlZC4gRGV0YWlsczogXCIsIC8vIFVzZWQgaW46IF9mbGFzaEVycm9yKClcclxuXHRcdE5PX1NPTFVUSU9OOiBcIk5vIHNvbHV0aW9uIGNhbiBiZSBmb3VuZCBieSBqUGxheWVyIGluIHRoaXMgYnJvd3Nlci4gTmVpdGhlciBIVE1MIG5vciBGbGFzaCBjYW4gYmUgdXNlZC5cIiwgLy8gVXNlZCBpbjogX2luaXQoKVxyXG5cdFx0Tk9fU1VQUE9SVDogXCJJdCBpcyBub3QgcG9zc2libGUgdG8gcGxheSBhbnkgbWVkaWEgZm9ybWF0IHByb3ZpZGVkIGluIHNldE1lZGlhKCkgb24gdGhpcyBicm93c2VyIHVzaW5nIHlvdXIgY3VycmVudCBvcHRpb25zLlwiLCAvLyBVc2VkIGluOiBzZXRNZWRpYSgpXHJcblx0XHRVUkw6IFwiTWVkaWEgVVJMIGNvdWxkIG5vdCBiZSBsb2FkZWQuXCIsIC8vIFVzZWQgaW46IGpQbGF5ZXJGbGFzaEV2ZW50KCkgYW5kIF9hZGRIdG1sRXZlbnRMaXN0ZW5lcnMoKVxyXG5cdFx0VVJMX05PVF9TRVQ6IFwiQXR0ZW1wdCB0byBpc3N1ZSBtZWRpYSBwbGF5YmFjayBjb21tYW5kcywgd2hpbGUgbm8gbWVkaWEgdXJsIGlzIHNldC5cIiwgLy8gVXNlZCBpbjogbG9hZCgpLCBwbGF5KCksIHBhdXNlKCksIHN0b3AoKSBhbmQgcGxheUhlYWQoKVxyXG5cdFx0VkVSU0lPTjogXCJqUGxheWVyIFwiICsgJC5qUGxheWVyLnByb3RvdHlwZS52ZXJzaW9uLnNjcmlwdCArIFwiIG5lZWRzIEpwbGF5ZXIuc3dmIHZlcnNpb24gXCIgKyAkLmpQbGF5ZXIucHJvdG90eXBlLnZlcnNpb24ubmVlZEZsYXNoICsgXCIgYnV0IGZvdW5kIFwiIC8vIFVzZWQgaW46IGpQbGF5ZXJSZWFkeSgpXHJcblx0fTtcclxuXHJcblx0JC5qUGxheWVyLmVycm9ySGludCA9IHtcclxuXHRcdEZMQVNIOiBcIkNoZWNrIHlvdXIgc3dmUGF0aCBvcHRpb24gYW5kIHRoYXQgSnBsYXllci5zd2YgaXMgdGhlcmUuXCIsXHJcblx0XHRGTEFTSF9ESVNBQkxFRDogXCJDaGVjayB0aGF0IHlvdSBoYXZlIG5vdCBkaXNwbGF5Om5vbmU7IHRoZSBqUGxheWVyIGVudGl0eSBvciBhbnkgYW5jZXN0b3IuXCIsXHJcblx0XHROT19TT0xVVElPTjogXCJSZXZpZXcgdGhlIGpQbGF5ZXIgb3B0aW9uczogc3VwcG9ydCBhbmQgc3VwcGxpZWQuXCIsXHJcblx0XHROT19TVVBQT1JUOiBcIlZpZGVvIG9yIGF1ZGlvIGZvcm1hdHMgZGVmaW5lZCBpbiB0aGUgc3VwcGxpZWQgb3B0aW9uIGFyZSBtaXNzaW5nLlwiLFxyXG5cdFx0VVJMOiBcIkNoZWNrIG1lZGlhIFVSTCBpcyB2YWxpZC5cIixcclxuXHRcdFVSTF9OT1RfU0VUOiBcIlVzZSBzZXRNZWRpYSgpIHRvIHNldCB0aGUgbWVkaWEgVVJMLlwiLFxyXG5cdFx0VkVSU0lPTjogXCJVcGRhdGUgalBsYXllciBmaWxlcy5cIlxyXG5cdH07XHJcblxyXG5cdCQualBsYXllci53YXJuaW5nID0ge1xyXG5cdFx0Q1NTX1NFTEVDVE9SX0NPVU5UOiBcImVfY3NzX3NlbGVjdG9yX2NvdW50XCIsXHJcblx0XHRDU1NfU0VMRUNUT1JfTUVUSE9EOiBcImVfY3NzX3NlbGVjdG9yX21ldGhvZFwiLFxyXG5cdFx0Q1NTX1NFTEVDVE9SX1NUUklORzogXCJlX2Nzc19zZWxlY3Rvcl9zdHJpbmdcIixcclxuXHRcdE9QVElPTl9LRVk6IFwiZV9vcHRpb25fa2V5XCJcclxuXHR9O1xyXG5cclxuXHQkLmpQbGF5ZXIud2FybmluZ01zZyA9IHtcclxuXHRcdENTU19TRUxFQ1RPUl9DT1VOVDogXCJUaGUgbnVtYmVyIG9mIGNzcyBzZWxlY3RvcnMgZm91bmQgZGlkIG5vdCBlcXVhbCBvbmU6IFwiLFxyXG5cdFx0Q1NTX1NFTEVDVE9SX01FVEhPRDogXCJUaGUgbWV0aG9kTmFtZSBnaXZlbiBpbiBqUGxheWVyKCdjc3NTZWxlY3RvcicpIGlzIG5vdCBhIHZhbGlkIGpQbGF5ZXIgbWV0aG9kLlwiLFxyXG5cdFx0Q1NTX1NFTEVDVE9SX1NUUklORzogXCJUaGUgbWV0aG9kQ3NzU2VsZWN0b3IgZ2l2ZW4gaW4galBsYXllcignY3NzU2VsZWN0b3InKSBpcyBub3QgYSBTdHJpbmcgb3IgaXMgZW1wdHkuXCIsXHJcblx0XHRPUFRJT05fS0VZOiBcIlRoZSBvcHRpb24gcmVxdWVzdGVkIGluIGpQbGF5ZXIoJ29wdGlvbicpIGlzIHVuZGVmaW5lZC5cIlxyXG5cdH07XHJcblxyXG5cdCQualBsYXllci53YXJuaW5nSGludCA9IHtcclxuXHRcdENTU19TRUxFQ1RPUl9DT1VOVDogXCJDaGVjayB5b3VyIGNzcyBzZWxlY3RvciBhbmQgdGhlIGFuY2VzdG9yLlwiLFxyXG5cdFx0Q1NTX1NFTEVDVE9SX01FVEhPRDogXCJDaGVjayB5b3VyIG1ldGhvZCBuYW1lLlwiLFxyXG5cdFx0Q1NTX1NFTEVDVE9SX1NUUklORzogXCJDaGVjayB5b3VyIGNzcyBzZWxlY3RvciBpcyBhIHN0cmluZy5cIixcclxuXHRcdE9QVElPTl9LRVk6IFwiQ2hlY2sgeW91ciBvcHRpb24gbmFtZS5cIlxyXG5cdH07XHJcbn0pKTtcclxuIl0sImZpbGUiOiJqcXVlcnkuanBsYXllci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

/*
 * jPlayerInspector Plugin for jPlayer Plugin for jQuery JavaScript Library
 * http://www.jplayer.org
 *
 * Copyright (c) 2009 - 2014 Happyworm Ltd
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/MIT
 *
 * Author: Mark J Panaghiston
 * Version: 1.0.5
 * Date: 1st April 2014
 *
 * For use with jPlayer Version: 2.6.0+
 *
 * Note: Declare inspector instances after jPlayer instances. ie., Otherwise the jPlayer instance is nonsense.
 */

(function($, undefined) {
	$.jPlayerInspector = {};
	$.jPlayerInspector.i = 0;
	$.jPlayerInspector.defaults = {
		jPlayer: undefined, // The jQuery selector of the jPlayer instance to inspect.
		idPrefix: "jplayer_inspector_",
		visible: false
	};
	
	var methods = {
		init: function(options) {
			var self = this;
			var $this = $(this);
			
			var config = $.extend({}, $.jPlayerInspector.defaults, options);
			$(this).data("jPlayerInspector", config);

			config.id = $(this).attr("id");
			config.jPlayerId = config.jPlayer.attr("id");

			config.windowId = config.idPrefix + "window_" + $.jPlayerInspector.i;
			config.statusId = config.idPrefix + "status_" + $.jPlayerInspector.i;
			config.configId = config.idPrefix + "config_" + $.jPlayerInspector.i;
			config.toggleId = config.idPrefix + "toggle_" + $.jPlayerInspector.i;
			config.eventResetId = config.idPrefix + "event_reset_" + $.jPlayerInspector.i;
			config.updateId = config.idPrefix + "update_" + $.jPlayerInspector.i;
			config.eventWindowId = config.idPrefix + "event_window_" + $.jPlayerInspector.i;
			
			config.eventId = {};
			config.eventJq = {};
			config.eventTimeout = {};
			config.eventOccurrence = {};
			
			$.each($.jPlayer.event, function(eventName,eventType) {
				config.eventId[eventType] = config.idPrefix + "event_" + eventName + "_" + $.jPlayerInspector.i;
				config.eventOccurrence[eventType] = 0;
			});
			
			var structure = 
				'<p><a href="#" id="' + config.toggleId + '">' + (config.visible ? "Hide" : "Show") + '</a> jPlayer Inspector</p>' 
				+ '<div id="' + config.windowId + '">'
					+ '<div id="' + config.statusId + '"></div>'
					+ '<div id="' + config.eventWindowId + '" style="padding:5px 5px 0 5px;background-color:#eee;border:1px dotted #000;">'
						+ '<p style="margin:0 0 10px 0;"><strong>jPlayer events that have occurred over the past 1 second:</strong>'
						+ '<br />(Backgrounds: <span style="padding:0 5px;background-color:#eee;border:1px dotted #000;">Never occurred</span> <span style="padding:0 5px;background-color:#fff;border:1px dotted #000;">Occurred before</span> <span style="padding:0 5px;background-color:#9f9;border:1px dotted #000;">Occurred</span> <span style="padding:0 5px;background-color:#ff9;border:1px dotted #000;">Multiple occurrences</span> <a href="#" id="' + config.eventResetId + '">reset</a>)</p>';
			
			// MJP: Would use the next 3 lines for ease, but the events are just slapped on the page.
			// $.each($.jPlayer.event, function(eventName,eventType) {
			// 	structure += '<div id="' + config.eventId[eventType] + '" style="float:left;">' + eventName + '</div>';
			// });
			
			var eventStyle = "float:left;margin:0 5px 5px 0;padding:0 5px;border:1px dotted #000;";
			// MJP: Doing it longhand so order and layout easier to control.
			structure +=
						'<div id="' + config.eventId[$.jPlayer.event.ready] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.setmedia] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.flashreset] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.resize] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.repeat] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.click] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.warning] + '" style="' + eventStyle + '"></div>'

						+ '<div id="' + config.eventId[$.jPlayer.event.loadstart] + '" style="clear:left;' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.progress] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.timeupdate] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.volumechange] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.error] + '" style="' + eventStyle + '"></div>'

						+ '<div id="' + config.eventId[$.jPlayer.event.play] + '" style="clear:left;' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.pause] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.waiting] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.playing] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.seeking] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.seeked] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.ended] + '" style="' + eventStyle + '"></div>'

						+ '<div id="' + config.eventId[$.jPlayer.event.loadeddata] + '" style="clear:left;' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.loadedmetadata] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.canplay] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.canplaythrough] + '" style="' + eventStyle + '"></div>'

						+ '<div id="' + config.eventId[$.jPlayer.event.suspend] + '" style="clear:left;' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.abort] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.emptied] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.stalled] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.ratechange] + '" style="' + eventStyle + '"></div>'
						+ '<div id="' + config.eventId[$.jPlayer.event.durationchange] + '" style="' + eventStyle + '"></div>'

						+ '<div style="clear:both"></div>';

			// MJP: Would like a check here in case we missed an event.

			// MJP: Check fails, since it is not on the page yet.
/*			$.each($.jPlayer.event, function(eventName,eventType) {
				if($("#" + config.eventId[eventType])[0] === undefined) {
					structure += '<div id="' + config.eventId[eventType] + '" style="clear:left;' + eventStyle + '">' + eventName + '</div>';
				}
			});
*/
			structure +=
					'</div>'
					+ '<p><a href="#" id="' + config.updateId + '">Update</a> jPlayer Inspector</p>'
					+ '<div id="' + config.configId + '"></div>'
				+ '</div>';
			$(this).html(structure);
			
			config.windowJq = $("#" + config.windowId);
			config.statusJq = $("#" + config.statusId);
			config.configJq = $("#" + config.configId);
			config.toggleJq = $("#" + config.toggleId);
			config.eventResetJq = $("#" + config.eventResetId);
			config.updateJq = $("#" + config.updateId);

			$.each($.jPlayer.event, function(eventName,eventType) {
				config.eventJq[eventType] = $("#" + config.eventId[eventType]);
				config.eventJq[eventType].text(eventName + " (" + config.eventOccurrence[eventType] + ")"); // Sets the text to the event name and (0);
				
				config.jPlayer.bind(eventType + ".jPlayerInspector", function(e) {
					config.eventOccurrence[e.type]++;
					if(config.eventOccurrence[e.type] > 1) {
						config.eventJq[e.type].css("background-color","#ff9");
					} else {
						config.eventJq[e.type].css("background-color","#9f9");
					}
					config.eventJq[e.type].text(eventName + " (" + config.eventOccurrence[e.type] + ")");
					// The timer to handle the color
					clearTimeout(config.eventTimeout[e.type]);
					config.eventTimeout[e.type] = setTimeout(function() {
						config.eventJq[e.type].css("background-color","#fff");
					}, 1000);
					// The timer to handle the occurences.
					setTimeout(function() {
						config.eventOccurrence[e.type]--;
						config.eventJq[e.type].text(eventName + " (" + config.eventOccurrence[e.type] + ")");
					}, 1000);
					if(config.visible) { // Update the status, if inspector open.
						$this.jPlayerInspector("updateStatus");
					}
				});
			});

			config.jPlayer.bind($.jPlayer.event.ready + ".jPlayerInspector", function(e) {
				$this.jPlayerInspector("updateConfig");
			});

			config.toggleJq.click(function() {
				if(config.visible) {
					$(this).text("Show");
					config.windowJq.hide();
					config.statusJq.empty();
					config.configJq.empty();
				} else {
					$(this).text("Hide");
					config.windowJq.show();
					config.updateJq.click();
				}
				config.visible = !config.visible;
				$(this).blur();
				return false;
			});

			config.eventResetJq.click(function() {
				$.each($.jPlayer.event, function(eventName,eventType) {
					config.eventJq[eventType].css("background-color","#eee");
				});
				$(this).blur();
				return false;
			});

			config.updateJq.click(function() {
				$this.jPlayerInspector("updateStatus");
				$this.jPlayerInspector("updateConfig");
				return false;
			});

			if(!config.visible) {
				config.windowJq.hide();
			} else {
				// config.updateJq.click();
			}
			
			$.jPlayerInspector.i++;

			return this;
		},
		destroy: function() {
			$(this).data("jPlayerInspector") && $(this).data("jPlayerInspector").jPlayer.unbind(".jPlayerInspector");
			$(this).empty();
		},
		updateConfig: function() { // This displays information about jPlayer's configuration in inspector
		
			var jPlayerInfo = "<p>This jPlayer instance is running in your browser where:<br />"

			for(i = 0; i < $(this).data("jPlayerInspector").jPlayer.data("jPlayer").solutions.length; i++) {
				var solution = $(this).data("jPlayerInspector").jPlayer.data("jPlayer").solutions[i];
				jPlayerInfo += "&nbsp;jPlayer's <strong>" + solution + "</strong> solution is";				
				if($(this).data("jPlayerInspector").jPlayer.data("jPlayer")[solution].used) {
					jPlayerInfo += " being <strong>used</strong> and will support:<strong>";
					for(format in $(this).data("jPlayerInspector").jPlayer.data("jPlayer")[solution].support) {
						if($(this).data("jPlayerInspector").jPlayer.data("jPlayer")[solution].support[format]) {
							jPlayerInfo += " " + format;
						}
					}
					jPlayerInfo += "</strong><br />";
				} else {
					jPlayerInfo += " <strong>not required</strong><br />";
				}
			}
			jPlayerInfo += "</p>";

			if($(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.active) {
				if($(this).data("jPlayerInspector").jPlayer.data("jPlayer").flash.active) {
					jPlayerInfo += "<strong>Problem with jPlayer since both HTML5 and Flash are active.</strong>";
				} else {
					jPlayerInfo += "The <strong>HTML5 is active</strong>.";
				}
			} else {
				if($(this).data("jPlayerInspector").jPlayer.data("jPlayer").flash.active) {
					jPlayerInfo += "The <strong>Flash is active</strong>.";
				} else {
					jPlayerInfo += "No solution is currently active. jPlayer needs a setMedia().";
				}
			}
			jPlayerInfo += "</p>";

			var formatType = $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.formatType;
			jPlayerInfo += "<p><code>status.formatType = '" + formatType + "'</code><br />";
			if(formatType) {
				jPlayerInfo += "<code>Browser canPlay('" + $.jPlayer.prototype.format[formatType].codec + "')</code>";
			} else {
				jPlayerInfo += "</p>";
			}
			
			jPlayerInfo += "<p><code>status.src = '" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.src + "'</code></p>";

			jPlayerInfo += "<p><code>status.media = {<br />";
			for(prop in $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.media) {
				jPlayerInfo += "&nbsp;" + prop + ": " + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.media[prop] + "<br />"; // Some are strings
			}
			jPlayerInfo += "};</code></p>"

			jPlayerInfo += "<p>";
			jPlayerInfo += "<code>status.videoWidth = '" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.videoWidth + "'</code>";
			jPlayerInfo += " | <code>status.videoHeight = '" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.videoHeight + "'</code>";
			jPlayerInfo += "<br /><code>status.width = '" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.width + "'</code>";
			jPlayerInfo += " | <code>status.height = '" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.height + "'</code>";
			jPlayerInfo += "</p>";

			+ "<p>Raw browser test for HTML5 support. Should equal a function if HTML5 is available.<br />";
			if($(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.audio.available) {
				jPlayerInfo += "<code>htmlElement.audio.canPlayType = " + (typeof $(this).data("jPlayerInspector").jPlayer.data("jPlayer").htmlElement.audio.canPlayType) +"</code><br />"
			}
			if($(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.video.available) {
				jPlayerInfo += "<code>htmlElement.video.canPlayType = " + (typeof $(this).data("jPlayerInspector").jPlayer.data("jPlayer").htmlElement.video.canPlayType) +"</code>";
			}
			jPlayerInfo += "</p>";

			jPlayerInfo += "<p>This instance is using the constructor options:<br />"
			+ "<code>$('#" + $(this).data("jPlayerInspector").jPlayer.data("jPlayer").internal.self.id + "').jPlayer({<br />"

			+ "&nbsp;swfPath: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "swfPath") + "',<br />"

			+ "&nbsp;solution: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "solution") + "',<br />"

			+ "&nbsp;supplied: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "supplied") + "',<br />"

			+ "&nbsp;preload: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "preload") + "',<br />"
			
			+ "&nbsp;volume: " + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "volume") + ",<br />"
			
			+ "&nbsp;muted: " + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "muted") + ",<br />"

			+ "&nbsp;backgroundColor: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "backgroundColor") + "',<br />"

			+ "&nbsp;cssSelectorAncestor: '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "cssSelectorAncestor") + "',<br />"

			+ "&nbsp;cssSelector: {";

			var cssSelector = $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "cssSelector");
			for(prop in cssSelector) {
				
				// jPlayerInfo += "<br />&nbsp;&nbsp;" + prop + ": '" + cssSelector[prop] + "'," // This works too of course, but want to use option method for deep keys.
				jPlayerInfo += "<br />&nbsp;&nbsp;" + prop + ": '" + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "cssSelector." + prop) + "',"
			}

			jPlayerInfo = jPlayerInfo.slice(0, -1); // Because the sloppy comma was bugging me.

			jPlayerInfo += "<br />&nbsp;},<br />"

			+ "&nbsp;errorAlerts: " + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "errorAlerts") + ",<br />"
			
			+ "&nbsp;warningAlerts: " + $(this).data("jPlayerInspector").jPlayer.jPlayer("option", "warningAlerts") + "<br />"

			+ "});</code></p>";
			$(this).data("jPlayerInspector").configJq.html(jPlayerInfo);
			return this;
		},
		updateStatus: function() { // This displays information about jPlayer's status in the inspector
			$(this).data("jPlayerInspector").statusJq.html(
				"<p>jPlayer is " +
				($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.paused ? "paused" : "playing") +
				" at time: " + Math.floor($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentTime*10)/10 + "s." +
				" (d: " + Math.floor($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.duration*10)/10 + "s" +
				", sp: " + Math.floor($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.seekPercent) + "%" +
				", cpr: " + Math.floor($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentPercentRelative) + "%" +
				", cpa: " + Math.floor($(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentPercentAbsolute) + "%)</p>"
			);
			return this;
		}
	};
	$.fn.jPlayerInspector = function( method ) {
		// Method calling logic
		if ( methods[method] ) {
			return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
		} else if ( typeof method === 'object' || ! method ) {
			return methods.init.apply( this, arguments );
		} else {
			$.error( 'Method ' +  method + ' does not exist on jQuery.jPlayerInspector' );
		}    
	};
})(jQuery);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJqcXVlcnkuanBsYXllci5pbnNwZWN0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogalBsYXllckluc3BlY3RvciBQbHVnaW4gZm9yIGpQbGF5ZXIgUGx1Z2luIGZvciBqUXVlcnkgSmF2YVNjcmlwdCBMaWJyYXJ5XHJcbiAqIGh0dHA6Ly93d3cuanBsYXllci5vcmdcclxuICpcclxuICogQ29weXJpZ2h0IChjKSAyMDA5IC0gMjAxNCBIYXBweXdvcm0gTHRkXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cclxuICogaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcclxuICpcclxuICogQXV0aG9yOiBNYXJrIEogUGFuYWdoaXN0b25cclxuICogVmVyc2lvbjogMS4wLjVcclxuICogRGF0ZTogMXN0IEFwcmlsIDIwMTRcclxuICpcclxuICogRm9yIHVzZSB3aXRoIGpQbGF5ZXIgVmVyc2lvbjogMi42LjArXHJcbiAqXHJcbiAqIE5vdGU6IERlY2xhcmUgaW5zcGVjdG9yIGluc3RhbmNlcyBhZnRlciBqUGxheWVyIGluc3RhbmNlcy4gaWUuLCBPdGhlcndpc2UgdGhlIGpQbGF5ZXIgaW5zdGFuY2UgaXMgbm9uc2Vuc2UuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCQsIHVuZGVmaW5lZCkge1xyXG5cdCQualBsYXllckluc3BlY3RvciA9IHt9O1xyXG5cdCQualBsYXllckluc3BlY3Rvci5pID0gMDtcclxuXHQkLmpQbGF5ZXJJbnNwZWN0b3IuZGVmYXVsdHMgPSB7XHJcblx0XHRqUGxheWVyOiB1bmRlZmluZWQsIC8vIFRoZSBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIGpQbGF5ZXIgaW5zdGFuY2UgdG8gaW5zcGVjdC5cclxuXHRcdGlkUHJlZml4OiBcImpwbGF5ZXJfaW5zcGVjdG9yX1wiLFxyXG5cdFx0dmlzaWJsZTogZmFsc2VcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBtZXRob2RzID0ge1xyXG5cdFx0aW5pdDogZnVuY3Rpb24ob3B0aW9ucykge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdHZhciAkdGhpcyA9ICQodGhpcyk7XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgY29uZmlnID0gJC5leHRlbmQoe30sICQualBsYXllckluc3BlY3Rvci5kZWZhdWx0cywgb3B0aW9ucyk7XHJcblx0XHRcdCQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIiwgY29uZmlnKTtcclxuXHJcblx0XHRcdGNvbmZpZy5pZCA9ICQodGhpcykuYXR0cihcImlkXCIpO1xyXG5cdFx0XHRjb25maWcualBsYXllcklkID0gY29uZmlnLmpQbGF5ZXIuYXR0cihcImlkXCIpO1xyXG5cclxuXHRcdFx0Y29uZmlnLndpbmRvd0lkID0gY29uZmlnLmlkUHJlZml4ICsgXCJ3aW5kb3dfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLnN0YXR1c0lkID0gY29uZmlnLmlkUHJlZml4ICsgXCJzdGF0dXNfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLmNvbmZpZ0lkID0gY29uZmlnLmlkUHJlZml4ICsgXCJjb25maWdfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLnRvZ2dsZUlkID0gY29uZmlnLmlkUHJlZml4ICsgXCJ0b2dnbGVfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLmV2ZW50UmVzZXRJZCA9IGNvbmZpZy5pZFByZWZpeCArIFwiZXZlbnRfcmVzZXRfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLnVwZGF0ZUlkID0gY29uZmlnLmlkUHJlZml4ICsgXCJ1cGRhdGVfXCIgKyAkLmpQbGF5ZXJJbnNwZWN0b3IuaTtcclxuXHRcdFx0Y29uZmlnLmV2ZW50V2luZG93SWQgPSBjb25maWcuaWRQcmVmaXggKyBcImV2ZW50X3dpbmRvd19cIiArICQualBsYXllckluc3BlY3Rvci5pO1xyXG5cdFx0XHRcclxuXHRcdFx0Y29uZmlnLmV2ZW50SWQgPSB7fTtcclxuXHRcdFx0Y29uZmlnLmV2ZW50SnEgPSB7fTtcclxuXHRcdFx0Y29uZmlnLmV2ZW50VGltZW91dCA9IHt9O1xyXG5cdFx0XHRjb25maWcuZXZlbnRPY2N1cnJlbmNlID0ge307XHJcblx0XHRcdFxyXG5cdFx0XHQkLmVhY2goJC5qUGxheWVyLmV2ZW50LCBmdW5jdGlvbihldmVudE5hbWUsZXZlbnRUeXBlKSB7XHJcblx0XHRcdFx0Y29uZmlnLmV2ZW50SWRbZXZlbnRUeXBlXSA9IGNvbmZpZy5pZFByZWZpeCArIFwiZXZlbnRfXCIgKyBldmVudE5hbWUgKyBcIl9cIiArICQualBsYXllckluc3BlY3Rvci5pO1xyXG5cdFx0XHRcdGNvbmZpZy5ldmVudE9jY3VycmVuY2VbZXZlbnRUeXBlXSA9IDA7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0dmFyIHN0cnVjdHVyZSA9IFxyXG5cdFx0XHRcdCc8cD48YSBocmVmPVwiI1wiIGlkPVwiJyArIGNvbmZpZy50b2dnbGVJZCArICdcIj4nICsgKGNvbmZpZy52aXNpYmxlID8gXCJIaWRlXCIgOiBcIlNob3dcIikgKyAnPC9hPiBqUGxheWVyIEluc3BlY3RvcjwvcD4nIFxyXG5cdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLndpbmRvd0lkICsgJ1wiPidcclxuXHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLnN0YXR1c0lkICsgJ1wiPjwvZGl2PidcclxuXHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50V2luZG93SWQgKyAnXCIgc3R5bGU9XCJwYWRkaW5nOjVweCA1cHggMCA1cHg7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlcjoxcHggZG90dGVkICMwMDA7XCI+J1xyXG5cdFx0XHRcdFx0XHQrICc8cCBzdHlsZT1cIm1hcmdpbjowIDAgMTBweCAwO1wiPjxzdHJvbmc+alBsYXllciBldmVudHMgdGhhdCBoYXZlIG9jY3VycmVkIG92ZXIgdGhlIHBhc3QgMSBzZWNvbmQ6PC9zdHJvbmc+J1xyXG5cdFx0XHRcdFx0XHQrICc8YnIgLz4oQmFja2dyb3VuZHM6IDxzcGFuIHN0eWxlPVwicGFkZGluZzowIDVweDtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyOjFweCBkb3R0ZWQgIzAwMDtcIj5OZXZlciBvY2N1cnJlZDwvc3Bhbj4gPHNwYW4gc3R5bGU9XCJwYWRkaW5nOjAgNXB4O2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3JkZXI6MXB4IGRvdHRlZCAjMDAwO1wiPk9jY3VycmVkIGJlZm9yZTwvc3Bhbj4gPHNwYW4gc3R5bGU9XCJwYWRkaW5nOjAgNXB4O2JhY2tncm91bmQtY29sb3I6IzlmOTtib3JkZXI6MXB4IGRvdHRlZCAjMDAwO1wiPk9jY3VycmVkPC9zcGFuPiA8c3BhbiBzdHlsZT1cInBhZGRpbmc6MCA1cHg7YmFja2dyb3VuZC1jb2xvcjojZmY5O2JvcmRlcjoxcHggZG90dGVkICMwMDA7XCI+TXVsdGlwbGUgb2NjdXJyZW5jZXM8L3NwYW4+IDxhIGhyZWY9XCIjXCIgaWQ9XCInICsgY29uZmlnLmV2ZW50UmVzZXRJZCArICdcIj5yZXNldDwvYT4pPC9wPic7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBNSlA6IFdvdWxkIHVzZSB0aGUgbmV4dCAzIGxpbmVzIGZvciBlYXNlLCBidXQgdGhlIGV2ZW50cyBhcmUganVzdCBzbGFwcGVkIG9uIHRoZSBwYWdlLlxyXG5cdFx0XHQvLyAkLmVhY2goJC5qUGxheWVyLmV2ZW50LCBmdW5jdGlvbihldmVudE5hbWUsZXZlbnRUeXBlKSB7XHJcblx0XHRcdC8vIFx0c3RydWN0dXJlICs9ICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkW2V2ZW50VHlwZV0gKyAnXCIgc3R5bGU9XCJmbG9hdDpsZWZ0O1wiPicgKyBldmVudE5hbWUgKyAnPC9kaXY+JztcclxuXHRcdFx0Ly8gfSk7XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgZXZlbnRTdHlsZSA9IFwiZmxvYXQ6bGVmdDttYXJnaW46MCA1cHggNXB4IDA7cGFkZGluZzowIDVweDtib3JkZXI6MXB4IGRvdHRlZCAjMDAwO1wiO1xyXG5cdFx0XHQvLyBNSlA6IERvaW5nIGl0IGxvbmdoYW5kIHNvIG9yZGVyIGFuZCBsYXlvdXQgZWFzaWVyIHRvIGNvbnRyb2wuXHJcblx0XHRcdHN0cnVjdHVyZSArPVxyXG5cdFx0XHRcdFx0XHQnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQucmVhZHldICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5zZXRtZWRpYV0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmZsYXNocmVzZXRdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5yZXNpemVdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5yZXBlYXRdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5jbGlja10gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50Lndhcm5pbmddICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQubG9hZHN0YXJ0XSArICdcIiBzdHlsZT1cImNsZWFyOmxlZnQ7JyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5wcm9ncmVzc10gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LnRpbWV1cGRhdGVdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC52b2x1bWVjaGFuZ2VdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5lcnJvcl0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblxyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5wbGF5XSArICdcIiBzdHlsZT1cImNsZWFyOmxlZnQ7JyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5wYXVzZV0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LndhaXRpbmddICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5wbGF5aW5nXSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQuc2Vla2luZ10gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LnNlZWtlZF0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmVuZGVkXSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmxvYWRlZGRhdGFdICsgJ1wiIHN0eWxlPVwiY2xlYXI6bGVmdDsnICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmxvYWRlZG1ldGFkYXRhXSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQuY2FucGxheV0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmNhbnBsYXl0aHJvdWdoXSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LnN1c3BlbmRdICsgJ1wiIHN0eWxlPVwiY2xlYXI6bGVmdDsnICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LmFib3J0XSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQuZW1wdGllZF0gKyAnXCIgc3R5bGU9XCInICsgZXZlbnRTdHlsZSArICdcIj48L2Rpdj4nXHJcblx0XHRcdFx0XHRcdCsgJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbJC5qUGxheWVyLmV2ZW50LnN0YWxsZWRdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdFx0XHQrICc8ZGl2IGlkPVwiJyArIGNvbmZpZy5ldmVudElkWyQualBsYXllci5ldmVudC5yYXRlY2hhbmdlXSArICdcIiBzdHlsZT1cIicgKyBldmVudFN0eWxlICsgJ1wiPjwvZGl2PidcclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuZXZlbnRJZFskLmpQbGF5ZXIuZXZlbnQuZHVyYXRpb25jaGFuZ2VdICsgJ1wiIHN0eWxlPVwiJyArIGV2ZW50U3R5bGUgKyAnXCI+PC9kaXY+J1xyXG5cclxuXHRcdFx0XHRcdFx0KyAnPGRpdiBzdHlsZT1cImNsZWFyOmJvdGhcIj48L2Rpdj4nO1xyXG5cclxuXHRcdFx0Ly8gTUpQOiBXb3VsZCBsaWtlIGEgY2hlY2sgaGVyZSBpbiBjYXNlIHdlIG1pc3NlZCBhbiBldmVudC5cclxuXHJcblx0XHRcdC8vIE1KUDogQ2hlY2sgZmFpbHMsIHNpbmNlIGl0IGlzIG5vdCBvbiB0aGUgcGFnZSB5ZXQuXHJcbi8qXHRcdFx0JC5lYWNoKCQualBsYXllci5ldmVudCwgZnVuY3Rpb24oZXZlbnROYW1lLGV2ZW50VHlwZSkge1xyXG5cdFx0XHRcdGlmKCQoXCIjXCIgKyBjb25maWcuZXZlbnRJZFtldmVudFR5cGVdKVswXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0XHRzdHJ1Y3R1cmUgKz0gJzxkaXYgaWQ9XCInICsgY29uZmlnLmV2ZW50SWRbZXZlbnRUeXBlXSArICdcIiBzdHlsZT1cImNsZWFyOmxlZnQ7JyArIGV2ZW50U3R5bGUgKyAnXCI+JyArIGV2ZW50TmFtZSArICc8L2Rpdj4nO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcbiovXHJcblx0XHRcdHN0cnVjdHVyZSArPVxyXG5cdFx0XHRcdFx0JzwvZGl2PidcclxuXHRcdFx0XHRcdCsgJzxwPjxhIGhyZWY9XCIjXCIgaWQ9XCInICsgY29uZmlnLnVwZGF0ZUlkICsgJ1wiPlVwZGF0ZTwvYT4galBsYXllciBJbnNwZWN0b3I8L3A+J1xyXG5cdFx0XHRcdFx0KyAnPGRpdiBpZD1cIicgKyBjb25maWcuY29uZmlnSWQgKyAnXCI+PC9kaXY+J1xyXG5cdFx0XHRcdCsgJzwvZGl2Pic7XHJcblx0XHRcdCQodGhpcykuaHRtbChzdHJ1Y3R1cmUpO1xyXG5cdFx0XHRcclxuXHRcdFx0Y29uZmlnLndpbmRvd0pxID0gJChcIiNcIiArIGNvbmZpZy53aW5kb3dJZCk7XHJcblx0XHRcdGNvbmZpZy5zdGF0dXNKcSA9ICQoXCIjXCIgKyBjb25maWcuc3RhdHVzSWQpO1xyXG5cdFx0XHRjb25maWcuY29uZmlnSnEgPSAkKFwiI1wiICsgY29uZmlnLmNvbmZpZ0lkKTtcclxuXHRcdFx0Y29uZmlnLnRvZ2dsZUpxID0gJChcIiNcIiArIGNvbmZpZy50b2dnbGVJZCk7XHJcblx0XHRcdGNvbmZpZy5ldmVudFJlc2V0SnEgPSAkKFwiI1wiICsgY29uZmlnLmV2ZW50UmVzZXRJZCk7XHJcblx0XHRcdGNvbmZpZy51cGRhdGVKcSA9ICQoXCIjXCIgKyBjb25maWcudXBkYXRlSWQpO1xyXG5cclxuXHRcdFx0JC5lYWNoKCQualBsYXllci5ldmVudCwgZnVuY3Rpb24oZXZlbnROYW1lLGV2ZW50VHlwZSkge1xyXG5cdFx0XHRcdGNvbmZpZy5ldmVudEpxW2V2ZW50VHlwZV0gPSAkKFwiI1wiICsgY29uZmlnLmV2ZW50SWRbZXZlbnRUeXBlXSk7XHJcblx0XHRcdFx0Y29uZmlnLmV2ZW50SnFbZXZlbnRUeXBlXS50ZXh0KGV2ZW50TmFtZSArIFwiIChcIiArIGNvbmZpZy5ldmVudE9jY3VycmVuY2VbZXZlbnRUeXBlXSArIFwiKVwiKTsgLy8gU2V0cyB0aGUgdGV4dCB0byB0aGUgZXZlbnQgbmFtZSBhbmQgKDApO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNvbmZpZy5qUGxheWVyLmJpbmQoZXZlbnRUeXBlICsgXCIualBsYXllckluc3BlY3RvclwiLCBmdW5jdGlvbihlKSB7XHJcblx0XHRcdFx0XHRjb25maWcuZXZlbnRPY2N1cnJlbmNlW2UudHlwZV0rKztcclxuXHRcdFx0XHRcdGlmKGNvbmZpZy5ldmVudE9jY3VycmVuY2VbZS50eXBlXSA+IDEpIHtcclxuXHRcdFx0XHRcdFx0Y29uZmlnLmV2ZW50SnFbZS50eXBlXS5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsXCIjZmY5XCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Y29uZmlnLmV2ZW50SnFbZS50eXBlXS5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsXCIjOWY5XCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Y29uZmlnLmV2ZW50SnFbZS50eXBlXS50ZXh0KGV2ZW50TmFtZSArIFwiIChcIiArIGNvbmZpZy5ldmVudE9jY3VycmVuY2VbZS50eXBlXSArIFwiKVwiKTtcclxuXHRcdFx0XHRcdC8vIFRoZSB0aW1lciB0byBoYW5kbGUgdGhlIGNvbG9yXHJcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQoY29uZmlnLmV2ZW50VGltZW91dFtlLnR5cGVdKTtcclxuXHRcdFx0XHRcdGNvbmZpZy5ldmVudFRpbWVvdXRbZS50eXBlXSA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGNvbmZpZy5ldmVudEpxW2UudHlwZV0uY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLFwiI2ZmZlwiKTtcclxuXHRcdFx0XHRcdH0sIDEwMDApO1xyXG5cdFx0XHRcdFx0Ly8gVGhlIHRpbWVyIHRvIGhhbmRsZSB0aGUgb2NjdXJlbmNlcy5cclxuXHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGNvbmZpZy5ldmVudE9jY3VycmVuY2VbZS50eXBlXS0tO1xyXG5cdFx0XHRcdFx0XHRjb25maWcuZXZlbnRKcVtlLnR5cGVdLnRleHQoZXZlbnROYW1lICsgXCIgKFwiICsgY29uZmlnLmV2ZW50T2NjdXJyZW5jZVtlLnR5cGVdICsgXCIpXCIpO1xyXG5cdFx0XHRcdFx0fSwgMTAwMCk7XHJcblx0XHRcdFx0XHRpZihjb25maWcudmlzaWJsZSkgeyAvLyBVcGRhdGUgdGhlIHN0YXR1cywgaWYgaW5zcGVjdG9yIG9wZW4uXHJcblx0XHRcdFx0XHRcdCR0aGlzLmpQbGF5ZXJJbnNwZWN0b3IoXCJ1cGRhdGVTdGF0dXNcIik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y29uZmlnLmpQbGF5ZXIuYmluZCgkLmpQbGF5ZXIuZXZlbnQucmVhZHkgKyBcIi5qUGxheWVySW5zcGVjdG9yXCIsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHQkdGhpcy5qUGxheWVySW5zcGVjdG9yKFwidXBkYXRlQ29uZmlnXCIpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGNvbmZpZy50b2dnbGVKcS5jbGljayhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZihjb25maWcudmlzaWJsZSkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS50ZXh0KFwiU2hvd1wiKTtcclxuXHRcdFx0XHRcdGNvbmZpZy53aW5kb3dKcS5oaWRlKCk7XHJcblx0XHRcdFx0XHRjb25maWcuc3RhdHVzSnEuZW1wdHkoKTtcclxuXHRcdFx0XHRcdGNvbmZpZy5jb25maWdKcS5lbXB0eSgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLnRleHQoXCJIaWRlXCIpO1xyXG5cdFx0XHRcdFx0Y29uZmlnLndpbmRvd0pxLnNob3coKTtcclxuXHRcdFx0XHRcdGNvbmZpZy51cGRhdGVKcS5jbGljaygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjb25maWcudmlzaWJsZSA9ICFjb25maWcudmlzaWJsZTtcclxuXHRcdFx0XHQkKHRoaXMpLmJsdXIoKTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y29uZmlnLmV2ZW50UmVzZXRKcS5jbGljayhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkLmVhY2goJC5qUGxheWVyLmV2ZW50LCBmdW5jdGlvbihldmVudE5hbWUsZXZlbnRUeXBlKSB7XHJcblx0XHRcdFx0XHRjb25maWcuZXZlbnRKcVtldmVudFR5cGVdLmNzcyhcImJhY2tncm91bmQtY29sb3JcIixcIiNlZWVcIik7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JCh0aGlzKS5ibHVyKCk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGNvbmZpZy51cGRhdGVKcS5jbGljayhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkdGhpcy5qUGxheWVySW5zcGVjdG9yKFwidXBkYXRlU3RhdHVzXCIpO1xyXG5cdFx0XHRcdCR0aGlzLmpQbGF5ZXJJbnNwZWN0b3IoXCJ1cGRhdGVDb25maWdcIik7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmKCFjb25maWcudmlzaWJsZSkge1xyXG5cdFx0XHRcdGNvbmZpZy53aW5kb3dKcS5oaWRlKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gY29uZmlnLnVwZGF0ZUpxLmNsaWNrKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdCQualBsYXllckluc3BlY3Rvci5pKys7XHJcblxyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblx0XHRkZXN0cm95OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0JCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKSAmJiAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIudW5iaW5kKFwiLmpQbGF5ZXJJbnNwZWN0b3JcIik7XHJcblx0XHRcdCQodGhpcykuZW1wdHkoKTtcclxuXHRcdH0sXHJcblx0XHR1cGRhdGVDb25maWc6IGZ1bmN0aW9uKCkgeyAvLyBUaGlzIGRpc3BsYXlzIGluZm9ybWF0aW9uIGFib3V0IGpQbGF5ZXIncyBjb25maWd1cmF0aW9uIGluIGluc3BlY3RvclxyXG5cdFx0XHJcblx0XHRcdHZhciBqUGxheWVySW5mbyA9IFwiPHA+VGhpcyBqUGxheWVyIGluc3RhbmNlIGlzIHJ1bm5pbmcgaW4geW91ciBicm93c2VyIHdoZXJlOjxiciAvPlwiXHJcblxyXG5cdFx0XHRmb3IoaSA9IDA7IGkgPCAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc29sdXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIHNvbHV0aW9uID0gJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnNvbHV0aW9uc1tpXTtcclxuXHRcdFx0XHRqUGxheWVySW5mbyArPSBcIiZuYnNwO2pQbGF5ZXIncyA8c3Ryb25nPlwiICsgc29sdXRpb24gKyBcIjwvc3Ryb25nPiBzb2x1dGlvbiBpc1wiO1x0XHRcdFx0XHJcblx0XHRcdFx0aWYoJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpW3NvbHV0aW9uXS51c2VkKSB7XHJcblx0XHRcdFx0XHRqUGxheWVySW5mbyArPSBcIiBiZWluZyA8c3Ryb25nPnVzZWQ8L3N0cm9uZz4gYW5kIHdpbGwgc3VwcG9ydDo8c3Ryb25nPlwiO1xyXG5cdFx0XHRcdFx0Zm9yKGZvcm1hdCBpbiAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIilbc29sdXRpb25dLnN1cHBvcnQpIHtcclxuXHRcdFx0XHRcdFx0aWYoJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpW3NvbHV0aW9uXS5zdXBwb3J0W2Zvcm1hdF0pIHtcclxuXHRcdFx0XHRcdFx0XHRqUGxheWVySW5mbyArPSBcIiBcIiArIGZvcm1hdDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0alBsYXllckluZm8gKz0gXCI8L3N0cm9uZz48YnIgLz5cIjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0alBsYXllckluZm8gKz0gXCIgPHN0cm9uZz5ub3QgcmVxdWlyZWQ8L3N0cm9uZz48YnIgLz5cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0alBsYXllckluZm8gKz0gXCI8L3A+XCI7XHJcblxyXG5cdFx0XHRpZigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuaHRtbC5hY3RpdmUpIHtcclxuXHRcdFx0XHRpZigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuZmxhc2guYWN0aXZlKSB7XHJcblx0XHRcdFx0XHRqUGxheWVySW5mbyArPSBcIjxzdHJvbmc+UHJvYmxlbSB3aXRoIGpQbGF5ZXIgc2luY2UgYm90aCBIVE1MNSBhbmQgRmxhc2ggYXJlIGFjdGl2ZS48L3N0cm9uZz5cIjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0alBsYXllckluZm8gKz0gXCJUaGUgPHN0cm9uZz5IVE1MNSBpcyBhY3RpdmU8L3N0cm9uZz4uXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmKCQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5kYXRhKFwialBsYXllclwiKS5mbGFzaC5hY3RpdmUpIHtcclxuXHRcdFx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiVGhlIDxzdHJvbmc+Rmxhc2ggaXMgYWN0aXZlPC9zdHJvbmc+LlwiO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRqUGxheWVySW5mbyArPSBcIk5vIHNvbHV0aW9uIGlzIGN1cnJlbnRseSBhY3RpdmUuIGpQbGF5ZXIgbmVlZHMgYSBzZXRNZWRpYSgpLlwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRqUGxheWVySW5mbyArPSBcIjwvcD5cIjtcclxuXHJcblx0XHRcdHZhciBmb3JtYXRUeXBlID0gJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnN0YXR1cy5mb3JtYXRUeXBlO1xyXG5cdFx0XHRqUGxheWVySW5mbyArPSBcIjxwPjxjb2RlPnN0YXR1cy5mb3JtYXRUeXBlID0gJ1wiICsgZm9ybWF0VHlwZSArIFwiJzwvY29kZT48YnIgLz5cIjtcclxuXHRcdFx0aWYoZm9ybWF0VHlwZSkge1xyXG5cdFx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiPGNvZGU+QnJvd3NlciBjYW5QbGF5KCdcIiArICQualBsYXllci5wcm90b3R5cGUuZm9ybWF0W2Zvcm1hdFR5cGVdLmNvZGVjICsgXCInKTwvY29kZT5cIjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRqUGxheWVySW5mbyArPSBcIjwvcD5cIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0alBsYXllckluZm8gKz0gXCI8cD48Y29kZT5zdGF0dXMuc3JjID0gJ1wiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnN0YXR1cy5zcmMgKyBcIic8L2NvZGU+PC9wPlwiO1xyXG5cclxuXHRcdFx0alBsYXllckluZm8gKz0gXCI8cD48Y29kZT5zdGF0dXMubWVkaWEgPSB7PGJyIC8+XCI7XHJcblx0XHRcdGZvcihwcm9wIGluICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5kYXRhKFwialBsYXllclwiKS5zdGF0dXMubWVkaWEpIHtcclxuXHRcdFx0XHRqUGxheWVySW5mbyArPSBcIiZuYnNwO1wiICsgcHJvcCArIFwiOiBcIiArICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5kYXRhKFwialBsYXllclwiKS5zdGF0dXMubWVkaWFbcHJvcF0gKyBcIjxiciAvPlwiOyAvLyBTb21lIGFyZSBzdHJpbmdzXHJcblx0XHRcdH1cclxuXHRcdFx0alBsYXllckluZm8gKz0gXCJ9OzwvY29kZT48L3A+XCJcclxuXHJcblx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiPHA+XCI7XHJcblx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiPGNvZGU+c3RhdHVzLnZpZGVvV2lkdGggPSAnXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLnZpZGVvV2lkdGggKyBcIic8L2NvZGU+XCI7XHJcblx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiIHwgPGNvZGU+c3RhdHVzLnZpZGVvSGVpZ2h0ID0gJ1wiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnN0YXR1cy52aWRlb0hlaWdodCArIFwiJzwvY29kZT5cIjtcclxuXHRcdFx0alBsYXllckluZm8gKz0gXCI8YnIgLz48Y29kZT5zdGF0dXMud2lkdGggPSAnXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLndpZHRoICsgXCInPC9jb2RlPlwiO1xyXG5cdFx0XHRqUGxheWVySW5mbyArPSBcIiB8IDxjb2RlPnN0YXR1cy5oZWlnaHQgPSAnXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLmhlaWdodCArIFwiJzwvY29kZT5cIjtcclxuXHRcdFx0alBsYXllckluZm8gKz0gXCI8L3A+XCI7XHJcblxyXG5cdFx0XHQrIFwiPHA+UmF3IGJyb3dzZXIgdGVzdCBmb3IgSFRNTDUgc3VwcG9ydC4gU2hvdWxkIGVxdWFsIGEgZnVuY3Rpb24gaWYgSFRNTDUgaXMgYXZhaWxhYmxlLjxiciAvPlwiO1xyXG5cdFx0XHRpZigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuaHRtbC5hdWRpby5hdmFpbGFibGUpIHtcclxuXHRcdFx0XHRqUGxheWVySW5mbyArPSBcIjxjb2RlPmh0bWxFbGVtZW50LmF1ZGlvLmNhblBsYXlUeXBlID0gXCIgKyAodHlwZW9mICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5kYXRhKFwialBsYXllclwiKS5odG1sRWxlbWVudC5hdWRpby5jYW5QbGF5VHlwZSkgK1wiPC9jb2RlPjxiciAvPlwiXHJcblx0XHRcdH1cclxuXHRcdFx0aWYoJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLmh0bWwudmlkZW8uYXZhaWxhYmxlKSB7XHJcblx0XHRcdFx0alBsYXllckluZm8gKz0gXCI8Y29kZT5odG1sRWxlbWVudC52aWRlby5jYW5QbGF5VHlwZSA9IFwiICsgKHR5cGVvZiAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuaHRtbEVsZW1lbnQudmlkZW8uY2FuUGxheVR5cGUpICtcIjwvY29kZT5cIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRqUGxheWVySW5mbyArPSBcIjwvcD5cIjtcclxuXHJcblx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiPHA+VGhpcyBpbnN0YW5jZSBpcyB1c2luZyB0aGUgY29uc3RydWN0b3Igb3B0aW9uczo8YnIgLz5cIlxyXG5cdFx0XHQrIFwiPGNvZGU+JCgnI1wiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLmludGVybmFsLnNlbGYuaWQgKyBcIicpLmpQbGF5ZXIoezxiciAvPlwiXHJcblxyXG5cdFx0XHQrIFwiJm5ic3A7c3dmUGF0aDogJ1wiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmpQbGF5ZXIoXCJvcHRpb25cIiwgXCJzd2ZQYXRoXCIpICsgXCInLDxiciAvPlwiXHJcblxyXG5cdFx0XHQrIFwiJm5ic3A7c29sdXRpb246ICdcIiArICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5qUGxheWVyKFwib3B0aW9uXCIsIFwic29sdXRpb25cIikgKyBcIicsPGJyIC8+XCJcclxuXHJcblx0XHRcdCsgXCImbmJzcDtzdXBwbGllZDogJ1wiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmpQbGF5ZXIoXCJvcHRpb25cIiwgXCJzdXBwbGllZFwiKSArIFwiJyw8YnIgLz5cIlxyXG5cclxuXHRcdFx0KyBcIiZuYnNwO3ByZWxvYWQ6ICdcIiArICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5qUGxheWVyKFwib3B0aW9uXCIsIFwicHJlbG9hZFwiKSArIFwiJyw8YnIgLz5cIlxyXG5cdFx0XHRcclxuXHRcdFx0KyBcIiZuYnNwO3ZvbHVtZTogXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIualBsYXllcihcIm9wdGlvblwiLCBcInZvbHVtZVwiKSArIFwiLDxiciAvPlwiXHJcblx0XHRcdFxyXG5cdFx0XHQrIFwiJm5ic3A7bXV0ZWQ6IFwiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmpQbGF5ZXIoXCJvcHRpb25cIiwgXCJtdXRlZFwiKSArIFwiLDxiciAvPlwiXHJcblxyXG5cdFx0XHQrIFwiJm5ic3A7YmFja2dyb3VuZENvbG9yOiAnXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIualBsYXllcihcIm9wdGlvblwiLCBcImJhY2tncm91bmRDb2xvclwiKSArIFwiJyw8YnIgLz5cIlxyXG5cclxuXHRcdFx0KyBcIiZuYnNwO2Nzc1NlbGVjdG9yQW5jZXN0b3I6ICdcIiArICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5qUGxheWVyKFwib3B0aW9uXCIsIFwiY3NzU2VsZWN0b3JBbmNlc3RvclwiKSArIFwiJyw8YnIgLz5cIlxyXG5cclxuXHRcdFx0KyBcIiZuYnNwO2Nzc1NlbGVjdG9yOiB7XCI7XHJcblxyXG5cdFx0XHR2YXIgY3NzU2VsZWN0b3IgPSAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIualBsYXllcihcIm9wdGlvblwiLCBcImNzc1NlbGVjdG9yXCIpO1xyXG5cdFx0XHRmb3IocHJvcCBpbiBjc3NTZWxlY3Rvcikge1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIGpQbGF5ZXJJbmZvICs9IFwiPGJyIC8+Jm5ic3A7Jm5ic3A7XCIgKyBwcm9wICsgXCI6ICdcIiArIGNzc1NlbGVjdG9yW3Byb3BdICsgXCInLFwiIC8vIFRoaXMgd29ya3MgdG9vIG9mIGNvdXJzZSwgYnV0IHdhbnQgdG8gdXNlIG9wdGlvbiBtZXRob2QgZm9yIGRlZXAga2V5cy5cclxuXHRcdFx0XHRqUGxheWVySW5mbyArPSBcIjxiciAvPiZuYnNwOyZuYnNwO1wiICsgcHJvcCArIFwiOiAnXCIgKyAkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIualBsYXllcihcIm9wdGlvblwiLCBcImNzc1NlbGVjdG9yLlwiICsgcHJvcCkgKyBcIicsXCJcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0alBsYXllckluZm8gPSBqUGxheWVySW5mby5zbGljZSgwLCAtMSk7IC8vIEJlY2F1c2UgdGhlIHNsb3BweSBjb21tYSB3YXMgYnVnZ2luZyBtZS5cclxuXHJcblx0XHRcdGpQbGF5ZXJJbmZvICs9IFwiPGJyIC8+Jm5ic3A7fSw8YnIgLz5cIlxyXG5cclxuXHRcdFx0KyBcIiZuYnNwO2Vycm9yQWxlcnRzOiBcIiArICQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikualBsYXllci5qUGxheWVyKFwib3B0aW9uXCIsIFwiZXJyb3JBbGVydHNcIikgKyBcIiw8YnIgLz5cIlxyXG5cdFx0XHRcclxuXHRcdFx0KyBcIiZuYnNwO3dhcm5pbmdBbGVydHM6IFwiICsgJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmpQbGF5ZXIoXCJvcHRpb25cIiwgXCJ3YXJuaW5nQWxlcnRzXCIpICsgXCI8YnIgLz5cIlxyXG5cclxuXHRcdFx0KyBcIn0pOzwvY29kZT48L3A+XCI7XHJcblx0XHRcdCQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikuY29uZmlnSnEuaHRtbChqUGxheWVySW5mbyk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHRcdHVwZGF0ZVN0YXR1czogZnVuY3Rpb24oKSB7IC8vIFRoaXMgZGlzcGxheXMgaW5mb3JtYXRpb24gYWJvdXQgalBsYXllcidzIHN0YXR1cyBpbiB0aGUgaW5zcGVjdG9yXHJcblx0XHRcdCQodGhpcykuZGF0YShcImpQbGF5ZXJJbnNwZWN0b3JcIikuc3RhdHVzSnEuaHRtbChcclxuXHRcdFx0XHRcIjxwPmpQbGF5ZXIgaXMgXCIgK1xyXG5cdFx0XHRcdCgkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLnBhdXNlZCA/IFwicGF1c2VkXCIgOiBcInBsYXlpbmdcIikgK1xyXG5cdFx0XHRcdFwiIGF0IHRpbWU6IFwiICsgTWF0aC5mbG9vcigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLmN1cnJlbnRUaW1lKjEwKS8xMCArIFwicy5cIiArXHJcblx0XHRcdFx0XCIgKGQ6IFwiICsgTWF0aC5mbG9vcigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLmR1cmF0aW9uKjEwKS8xMCArIFwic1wiICtcclxuXHRcdFx0XHRcIiwgc3A6IFwiICsgTWF0aC5mbG9vcigkKHRoaXMpLmRhdGEoXCJqUGxheWVySW5zcGVjdG9yXCIpLmpQbGF5ZXIuZGF0YShcImpQbGF5ZXJcIikuc3RhdHVzLnNlZWtQZXJjZW50KSArIFwiJVwiICtcclxuXHRcdFx0XHRcIiwgY3ByOiBcIiArIE1hdGguZmxvb3IoJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnN0YXR1cy5jdXJyZW50UGVyY2VudFJlbGF0aXZlKSArIFwiJVwiICtcclxuXHRcdFx0XHRcIiwgY3BhOiBcIiArIE1hdGguZmxvb3IoJCh0aGlzKS5kYXRhKFwialBsYXllckluc3BlY3RvclwiKS5qUGxheWVyLmRhdGEoXCJqUGxheWVyXCIpLnN0YXR1cy5jdXJyZW50UGVyY2VudEFic29sdXRlKSArIFwiJSk8L3A+XCJcclxuXHRcdFx0KTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9XHJcblx0fTtcclxuXHQkLmZuLmpQbGF5ZXJJbnNwZWN0b3IgPSBmdW5jdGlvbiggbWV0aG9kICkge1xyXG5cdFx0Ly8gTWV0aG9kIGNhbGxpbmcgbG9naWNcclxuXHRcdGlmICggbWV0aG9kc1ttZXRob2RdICkge1xyXG5cdFx0XHRyZXR1cm4gbWV0aG9kc1sgbWV0aG9kIF0uYXBwbHkoIHRoaXMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCBhcmd1bWVudHMsIDEgKSk7XHJcblx0XHR9IGVsc2UgaWYgKCB0eXBlb2YgbWV0aG9kID09PSAnb2JqZWN0JyB8fCAhIG1ldGhvZCApIHtcclxuXHRcdFx0cmV0dXJuIG1ldGhvZHMuaW5pdC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQkLmVycm9yKCAnTWV0aG9kICcgKyAgbWV0aG9kICsgJyBkb2VzIG5vdCBleGlzdCBvbiBqUXVlcnkualBsYXllckluc3BlY3RvcicgKTtcclxuXHRcdH0gICAgXHJcblx0fTtcclxufSkoalF1ZXJ5KTtcclxuIl0sImZpbGUiOiJqcXVlcnkuanBsYXllci5pbnNwZWN0b3IuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

(function($){
	var	extend		= $.extend,
		mousedown	= 'mousedown',
		mousemove	= 'mousemove',
		mouseup		= 'mouseup',
		touchstart	= 'touchstart',
		touchmove	= 'touchmove',
		touchend	= 'touchend',
		touchcancel	= 'touchcancel';

	function unbind(elem, type, func){
		if (type.substr(0,5) !== 'touch'){ // A temporary fix for IE8 data passing problem in Jin.
			return $(elem).unbind(type, func);
		}
		var fnc, i;
		for (i=0; i<bind._binds.length; i++){
			if (bind._binds[i].elem === elem && bind._binds[i].type === type && bind._binds[i].func === func){
				if (document.addEventListener){
					elem.removeEventListener(type, bind._binds[i].fnc, false);
				} else {
					elem.detachEvent('on'+type, bind._binds[i].fnc);
				}
				bind._binds.splice(i--, 1);
			}
		}
	}

	function bind(elem, type, func, pass){
		if (type.substr(0,5) !== 'touch'){ // A temporary fix for IE8 data passing problem in Jin.
			return $(elem).bind(type, pass, func);
		}
		var fnc, i;
		if (bind[type]){
			return bind[type].bind(elem, type, func, pass);
		}
		fnc = function(e){
			if (!e){ // Fix some ie bugs...
				e = window.event;
			}
			if (!e.stopPropagation){
				e.stopPropagation = function(){ this.cancelBubble = true; };
			}
			e.data = pass;
			func.call(elem, e);
		};
		if (document.addEventListener){
			elem.addEventListener(type, fnc, false);
		} else {
			elem.attachEvent('on' + type, fnc);
		}
		bind._binds.push({elem: elem, type: type, func: func, fnc: fnc});
	}

	function grab(elem, options)
	{
		var data = {
			move: {x: 0, y: 0},
			offset: {x: 0, y: 0},
			position: {x: 0, y: 0},
			start: {x: 0, y: 0},
			affects: document.documentElement,
			stopPropagation: false,
			preventDefault: true,
			touch: true // Implementation unfinished, and doesn't support multitouch
		};
		extend(data, options);
		data.element = elem;
		bind(elem, mousedown, mouseDown, data);
		if (data.touch){
			bind(elem, touchstart, touchStart, data);
		}
	}
	function ungrab(elem){
		unbind(elem, mousedown, mousedown);
	}
	function mouseDown(e){
		e.data.position.x = e.pageX;
		e.data.position.y = e.pageY;
		e.data.start.x = e.pageX;
		e.data.start.y = e.pageY;
		e.data.event = e;
		if (e.data.onstart && e.data.onstart.call(e.data.element, e.data)){
			return;
		}
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.stopPropagation){
			e.stopPropagation();
		}
		bind(e.data.affects, mousemove, mouseMove, e.data);
		bind(e.data.affects, mouseup, mouseUp, e.data);
	}
	function mouseMove(e){
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.preventDefault){
			e.stopPropagation();
		}
		e.data.move.x = e.pageX - e.data.position.x;
		e.data.move.y = e.pageY - e.data.position.y;
		e.data.position.x = e.pageX;
		e.data.position.y = e.pageY;
		e.data.offset.x = e.pageX - e.data.start.x;
		e.data.offset.y = e.pageY - e.data.start.y;
		e.data.event = e;
		if (e.data.onmove){
			e.data.onmove.call(e.data.element, e.data);
		}
	}
	function mouseUp(e){
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.stopPropagation){
			e.stopPropagation();
		}
		unbind(e.data.affects, mousemove, mouseMove);
		unbind(e.data.affects, mouseup, mouseUp);
		e.data.event = e;
		if (e.data.onfinish){
			e.data.onfinish.call(e.data.element, e.data);
		}
	}
	function touchStart(e){
		e.data.position.x = e.touches[0].pageX;
		e.data.position.y = e.touches[0].pageY;
		e.data.start.x = e.touches[0].pageX;
		e.data.start.y = e.touches[0].pageY;
		e.data.event = e;
		if (e.data.onstart && e.data.onstart.call(e.data.element, e.data)){
			return;
		}
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.stopPropagation){
			e.stopPropagation();
		}
		bind(e.data.affects, touchmove, touchMove, e.data);
		bind(e.data.affects, touchend, touchEnd, e.data);
	}
	function touchMove(e){
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.stopPropagation){
			e.stopPropagation();
		}
		e.data.move.x = e.touches[0].pageX - e.data.position.x;
		e.data.move.y = e.touches[0].pageY - e.data.position.y;
		e.data.position.x = e.touches[0].pageX;
		e.data.position.y = e.touches[0].pageY;
		e.data.offset.x = e.touches[0].pageX - e.data.start.x;
		e.data.offset.y = e.touches[0].pageY - e.data.start.y;
		e.data.event = e;
		if (e.data.onmove){
			e.data.onmove.call(e.data.elem, e.data);
		}
	}
	function touchEnd(e){
		if (e.preventDefault && e.data.preventDefault){
			e.preventDefault();
		}
		if (e.stopPropagation && e.data.stopPropagation){
			e.stopPropagation();
		}
		unbind(e.data.affects, touchmove, touchMove);
		unbind(e.data.affects, touchend, touchEnd);
		e.data.event = e;
		if (e.data.onfinish){
			e.data.onfinish.call(e.data.element, e.data);
		}
	}

	bind._binds = [];

	$.fn.grab = function(a, b){
		return this.each(function(){
			return grab(this, a, b);
		});
	};
	$.fn.ungrab = function(a){
		return this.each(function(){
			return ungrab(this, a);
		});
	};
})(jQuery);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJqcXVlcnkuZ3JhYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCl7XHJcblx0dmFyXHRleHRlbmRcdFx0PSAkLmV4dGVuZCxcclxuXHRcdG1vdXNlZG93blx0PSAnbW91c2Vkb3duJyxcclxuXHRcdG1vdXNlbW92ZVx0PSAnbW91c2Vtb3ZlJyxcclxuXHRcdG1vdXNldXBcdFx0PSAnbW91c2V1cCcsXHJcblx0XHR0b3VjaHN0YXJ0XHQ9ICd0b3VjaHN0YXJ0JyxcclxuXHRcdHRvdWNobW92ZVx0PSAndG91Y2htb3ZlJyxcclxuXHRcdHRvdWNoZW5kXHQ9ICd0b3VjaGVuZCcsXHJcblx0XHR0b3VjaGNhbmNlbFx0PSAndG91Y2hjYW5jZWwnO1xyXG5cclxuXHRmdW5jdGlvbiB1bmJpbmQoZWxlbSwgdHlwZSwgZnVuYyl7XHJcblx0XHRpZiAodHlwZS5zdWJzdHIoMCw1KSAhPT0gJ3RvdWNoJyl7IC8vIEEgdGVtcG9yYXJ5IGZpeCBmb3IgSUU4IGRhdGEgcGFzc2luZyBwcm9ibGVtIGluIEppbi5cclxuXHRcdFx0cmV0dXJuICQoZWxlbSkudW5iaW5kKHR5cGUsIGZ1bmMpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGZuYywgaTtcclxuXHRcdGZvciAoaT0wOyBpPGJpbmQuX2JpbmRzLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0aWYgKGJpbmQuX2JpbmRzW2ldLmVsZW0gPT09IGVsZW0gJiYgYmluZC5fYmluZHNbaV0udHlwZSA9PT0gdHlwZSAmJiBiaW5kLl9iaW5kc1tpXS5mdW5jID09PSBmdW5jKXtcclxuXHRcdFx0XHRpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcil7XHJcblx0XHRcdFx0XHRlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgYmluZC5fYmluZHNbaV0uZm5jLCBmYWxzZSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGVsZW0uZGV0YWNoRXZlbnQoJ29uJyt0eXBlLCBiaW5kLl9iaW5kc1tpXS5mbmMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRiaW5kLl9iaW5kcy5zcGxpY2UoaS0tLCAxKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gYmluZChlbGVtLCB0eXBlLCBmdW5jLCBwYXNzKXtcclxuXHRcdGlmICh0eXBlLnN1YnN0cigwLDUpICE9PSAndG91Y2gnKXsgLy8gQSB0ZW1wb3JhcnkgZml4IGZvciBJRTggZGF0YSBwYXNzaW5nIHByb2JsZW0gaW4gSmluLlxyXG5cdFx0XHRyZXR1cm4gJChlbGVtKS5iaW5kKHR5cGUsIHBhc3MsIGZ1bmMpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGZuYywgaTtcclxuXHRcdGlmIChiaW5kW3R5cGVdKXtcclxuXHRcdFx0cmV0dXJuIGJpbmRbdHlwZV0uYmluZChlbGVtLCB0eXBlLCBmdW5jLCBwYXNzKTtcclxuXHRcdH1cclxuXHRcdGZuYyA9IGZ1bmN0aW9uKGUpe1xyXG5cdFx0XHRpZiAoIWUpeyAvLyBGaXggc29tZSBpZSBidWdzLi4uXHJcblx0XHRcdFx0ZSA9IHdpbmRvdy5ldmVudDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIWUuc3RvcFByb3BhZ2F0aW9uKXtcclxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uKCl7IHRoaXMuY2FuY2VsQnViYmxlID0gdHJ1ZTsgfTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlLmRhdGEgPSBwYXNzO1xyXG5cdFx0XHRmdW5jLmNhbGwoZWxlbSwgZSk7XHJcblx0XHR9O1xyXG5cdFx0aWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpe1xyXG5cdFx0XHRlbGVtLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm5jLCBmYWxzZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlbGVtLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCBmbmMpO1xyXG5cdFx0fVxyXG5cdFx0YmluZC5fYmluZHMucHVzaCh7ZWxlbTogZWxlbSwgdHlwZTogdHlwZSwgZnVuYzogZnVuYywgZm5jOiBmbmN9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGdyYWIoZWxlbSwgb3B0aW9ucylcclxuXHR7XHJcblx0XHR2YXIgZGF0YSA9IHtcclxuXHRcdFx0bW92ZToge3g6IDAsIHk6IDB9LFxyXG5cdFx0XHRvZmZzZXQ6IHt4OiAwLCB5OiAwfSxcclxuXHRcdFx0cG9zaXRpb246IHt4OiAwLCB5OiAwfSxcclxuXHRcdFx0c3RhcnQ6IHt4OiAwLCB5OiAwfSxcclxuXHRcdFx0YWZmZWN0czogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxyXG5cdFx0XHRzdG9wUHJvcGFnYXRpb246IGZhbHNlLFxyXG5cdFx0XHRwcmV2ZW50RGVmYXVsdDogdHJ1ZSxcclxuXHRcdFx0dG91Y2g6IHRydWUgLy8gSW1wbGVtZW50YXRpb24gdW5maW5pc2hlZCwgYW5kIGRvZXNuJ3Qgc3VwcG9ydCBtdWx0aXRvdWNoXHJcblx0XHR9O1xyXG5cdFx0ZXh0ZW5kKGRhdGEsIG9wdGlvbnMpO1xyXG5cdFx0ZGF0YS5lbGVtZW50ID0gZWxlbTtcclxuXHRcdGJpbmQoZWxlbSwgbW91c2Vkb3duLCBtb3VzZURvd24sIGRhdGEpO1xyXG5cdFx0aWYgKGRhdGEudG91Y2gpe1xyXG5cdFx0XHRiaW5kKGVsZW0sIHRvdWNoc3RhcnQsIHRvdWNoU3RhcnQsIGRhdGEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRmdW5jdGlvbiB1bmdyYWIoZWxlbSl7XHJcblx0XHR1bmJpbmQoZWxlbSwgbW91c2Vkb3duLCBtb3VzZWRvd24pO1xyXG5cdH1cclxuXHRmdW5jdGlvbiBtb3VzZURvd24oZSl7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueCA9IGUucGFnZVg7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueSA9IGUucGFnZVk7XHJcblx0XHRlLmRhdGEuc3RhcnQueCA9IGUucGFnZVg7XHJcblx0XHRlLmRhdGEuc3RhcnQueSA9IGUucGFnZVk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbnN0YXJ0ICYmIGUuZGF0YS5vbnN0YXJ0LmNhbGwoZS5kYXRhLmVsZW1lbnQsIGUuZGF0YSkpe1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAoZS5wcmV2ZW50RGVmYXVsdCAmJiBlLmRhdGEucHJldmVudERlZmF1bHQpe1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR9XHJcblx0XHRpZiAoZS5zdG9wUHJvcGFnYXRpb24gJiYgZS5kYXRhLnN0b3BQcm9wYWdhdGlvbil7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHR9XHJcblx0XHRiaW5kKGUuZGF0YS5hZmZlY3RzLCBtb3VzZW1vdmUsIG1vdXNlTW92ZSwgZS5kYXRhKTtcclxuXHRcdGJpbmQoZS5kYXRhLmFmZmVjdHMsIG1vdXNldXAsIG1vdXNlVXAsIGUuZGF0YSk7XHJcblx0fVxyXG5cdGZ1bmN0aW9uIG1vdXNlTW92ZShlKXtcclxuXHRcdGlmIChlLnByZXZlbnREZWZhdWx0ICYmIGUuZGF0YS5wcmV2ZW50RGVmYXVsdCl7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdH1cclxuXHRcdGlmIChlLnN0b3BQcm9wYWdhdGlvbiAmJiBlLmRhdGEucHJldmVudERlZmF1bHQpe1xyXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0fVxyXG5cdFx0ZS5kYXRhLm1vdmUueCA9IGUucGFnZVggLSBlLmRhdGEucG9zaXRpb24ueDtcclxuXHRcdGUuZGF0YS5tb3ZlLnkgPSBlLnBhZ2VZIC0gZS5kYXRhLnBvc2l0aW9uLnk7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueCA9IGUucGFnZVg7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueSA9IGUucGFnZVk7XHJcblx0XHRlLmRhdGEub2Zmc2V0LnggPSBlLnBhZ2VYIC0gZS5kYXRhLnN0YXJ0Lng7XHJcblx0XHRlLmRhdGEub2Zmc2V0LnkgPSBlLnBhZ2VZIC0gZS5kYXRhLnN0YXJ0Lnk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbm1vdmUpe1xyXG5cdFx0XHRlLmRhdGEub25tb3ZlLmNhbGwoZS5kYXRhLmVsZW1lbnQsIGUuZGF0YSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGZ1bmN0aW9uIG1vdXNlVXAoZSl7XHJcblx0XHRpZiAoZS5wcmV2ZW50RGVmYXVsdCAmJiBlLmRhdGEucHJldmVudERlZmF1bHQpe1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR9XHJcblx0XHRpZiAoZS5zdG9wUHJvcGFnYXRpb24gJiYgZS5kYXRhLnN0b3BQcm9wYWdhdGlvbil7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHR9XHJcblx0XHR1bmJpbmQoZS5kYXRhLmFmZmVjdHMsIG1vdXNlbW92ZSwgbW91c2VNb3ZlKTtcclxuXHRcdHVuYmluZChlLmRhdGEuYWZmZWN0cywgbW91c2V1cCwgbW91c2VVcCk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbmZpbmlzaCl7XHJcblx0XHRcdGUuZGF0YS5vbmZpbmlzaC5jYWxsKGUuZGF0YS5lbGVtZW50LCBlLmRhdGEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRmdW5jdGlvbiB0b3VjaFN0YXJ0KGUpe1xyXG5cdFx0ZS5kYXRhLnBvc2l0aW9uLnggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueSA9IGUudG91Y2hlc1swXS5wYWdlWTtcclxuXHRcdGUuZGF0YS5zdGFydC54ID0gZS50b3VjaGVzWzBdLnBhZ2VYO1xyXG5cdFx0ZS5kYXRhLnN0YXJ0LnkgPSBlLnRvdWNoZXNbMF0ucGFnZVk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbnN0YXJ0ICYmIGUuZGF0YS5vbnN0YXJ0LmNhbGwoZS5kYXRhLmVsZW1lbnQsIGUuZGF0YSkpe1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAoZS5wcmV2ZW50RGVmYXVsdCAmJiBlLmRhdGEucHJldmVudERlZmF1bHQpe1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR9XHJcblx0XHRpZiAoZS5zdG9wUHJvcGFnYXRpb24gJiYgZS5kYXRhLnN0b3BQcm9wYWdhdGlvbil7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHR9XHJcblx0XHRiaW5kKGUuZGF0YS5hZmZlY3RzLCB0b3VjaG1vdmUsIHRvdWNoTW92ZSwgZS5kYXRhKTtcclxuXHRcdGJpbmQoZS5kYXRhLmFmZmVjdHMsIHRvdWNoZW5kLCB0b3VjaEVuZCwgZS5kYXRhKTtcclxuXHR9XHJcblx0ZnVuY3Rpb24gdG91Y2hNb3ZlKGUpe1xyXG5cdFx0aWYgKGUucHJldmVudERlZmF1bHQgJiYgZS5kYXRhLnByZXZlbnREZWZhdWx0KXtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGUuc3RvcFByb3BhZ2F0aW9uICYmIGUuZGF0YS5zdG9wUHJvcGFnYXRpb24pe1xyXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0fVxyXG5cdFx0ZS5kYXRhLm1vdmUueCA9IGUudG91Y2hlc1swXS5wYWdlWCAtIGUuZGF0YS5wb3NpdGlvbi54O1xyXG5cdFx0ZS5kYXRhLm1vdmUueSA9IGUudG91Y2hlc1swXS5wYWdlWSAtIGUuZGF0YS5wb3NpdGlvbi55O1xyXG5cdFx0ZS5kYXRhLnBvc2l0aW9uLnggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XHJcblx0XHRlLmRhdGEucG9zaXRpb24ueSA9IGUudG91Y2hlc1swXS5wYWdlWTtcclxuXHRcdGUuZGF0YS5vZmZzZXQueCA9IGUudG91Y2hlc1swXS5wYWdlWCAtIGUuZGF0YS5zdGFydC54O1xyXG5cdFx0ZS5kYXRhLm9mZnNldC55ID0gZS50b3VjaGVzWzBdLnBhZ2VZIC0gZS5kYXRhLnN0YXJ0Lnk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbm1vdmUpe1xyXG5cdFx0XHRlLmRhdGEub25tb3ZlLmNhbGwoZS5kYXRhLmVsZW0sIGUuZGF0YSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGZ1bmN0aW9uIHRvdWNoRW5kKGUpe1xyXG5cdFx0aWYgKGUucHJldmVudERlZmF1bHQgJiYgZS5kYXRhLnByZXZlbnREZWZhdWx0KXtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGUuc3RvcFByb3BhZ2F0aW9uICYmIGUuZGF0YS5zdG9wUHJvcGFnYXRpb24pe1xyXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0fVxyXG5cdFx0dW5iaW5kKGUuZGF0YS5hZmZlY3RzLCB0b3VjaG1vdmUsIHRvdWNoTW92ZSk7XHJcblx0XHR1bmJpbmQoZS5kYXRhLmFmZmVjdHMsIHRvdWNoZW5kLCB0b3VjaEVuZCk7XHJcblx0XHRlLmRhdGEuZXZlbnQgPSBlO1xyXG5cdFx0aWYgKGUuZGF0YS5vbmZpbmlzaCl7XHJcblx0XHRcdGUuZGF0YS5vbmZpbmlzaC5jYWxsKGUuZGF0YS5lbGVtZW50LCBlLmRhdGEpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YmluZC5fYmluZHMgPSBbXTtcclxuXHJcblx0JC5mbi5ncmFiID0gZnVuY3Rpb24oYSwgYil7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiBncmFiKHRoaXMsIGEsIGIpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHQkLmZuLnVuZ3JhYiA9IGZ1bmN0aW9uKGEpe1xyXG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gdW5ncmFiKHRoaXMsIGEpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxufSkoalF1ZXJ5KTtcclxuIl0sImZpbGUiOiJqcXVlcnkuZ3JhYi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

/**
 * @license
 * lodash lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 */
;(function(){function t(t,n){return t.set(n[0],n[1]),t}function n(t,n){return t.add(n),t}function r(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}function e(t,n,r,e){for(var u=-1,o=t?t.length:0;++u<o;){var i=t[u];n(e,i,r(i),t)}return e}function u(t,n){for(var r=-1,e=t?t.length:0;++r<e&&false!==n(t[r],r,t););return t}function o(t,n){for(var r=t?t.length:0;r--&&false!==n(t[r],r,t););
return t}function i(t,n){for(var r=-1,e=t?t.length:0;++r<e;)if(!n(t[r],r,t))return false;return true}function f(t,n){for(var r=-1,e=t?t.length:0,u=0,o=[];++r<e;){var i=t[r];n(i,r,t)&&(o[u++]=i)}return o}function c(t,n){return!(!t||!t.length)&&-1<d(t,n,0)}function a(t,n,r){for(var e=-1,u=t?t.length:0;++e<u;)if(r(n,t[e]))return true;return false}function l(t,n){for(var r=-1,e=t?t.length:0,u=Array(e);++r<e;)u[r]=n(t[r],r,t);return u}function s(t,n){for(var r=-1,e=n.length,u=t.length;++r<e;)t[u+r]=n[r];return t}function h(t,n,r,e){
var u=-1,o=t?t.length:0;for(e&&o&&(r=t[++u]);++u<o;)r=n(r,t[u],u,t);return r}function p(t,n,r,e){var u=t?t.length:0;for(e&&u&&(r=t[--u]);u--;)r=n(r,t[u],u,t);return r}function _(t,n){for(var r=-1,e=t?t.length:0;++r<e;)if(n(t[r],r,t))return true;return false}function v(t,n,r){var e;return r(t,function(t,r,u){return n(t,r,u)?(e=r,false):void 0}),e}function g(t,n,r,e){var u=t.length;for(r+=e?1:-1;e?r--:++r<u;)if(n(t[r],r,t))return r;return-1}function d(t,n,r){if(n!==n)return M(t,r);--r;for(var e=t.length;++r<e;)if(t[r]===n)return r;
return-1}function y(t,n,r,e){--r;for(var u=t.length;++r<u;)if(e(t[r],n))return r;return-1}function b(t,n){var r=t?t.length:0;return r?w(t,n)/r:V}function x(t,n,r,e,u){return u(t,function(t,u,o){r=e?(e=false,t):n(r,t,u,o)}),r}function j(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].c;return t}function w(t,n){for(var r,e=-1,u=t.length;++e<u;){var o=n(t[e]);o!==T&&(r=r===T?o:r+o)}return r}function m(t,n){for(var r=-1,e=Array(t);++r<t;)e[r]=n(r);return e}function A(t,n){return l(n,function(n){return[n,t[n]];
})}function O(t){return function(n){return t(n)}}function k(t,n){return l(n,function(n){return t[n]})}function E(t,n){return t.has(n)}function S(t,n){for(var r=-1,e=t.length;++r<e&&-1<d(n,t[r],0););return r}function I(t,n){for(var r=t.length;r--&&-1<d(n,t[r],0););return r}function R(t){return t&&t.Object===Object?t:null}function W(t){return zt[t]}function B(t){return Ut[t]}function L(t){return"\\"+Dt[t]}function M(t,n,r){var e=t.length;for(n+=r?1:-1;r?n--:++n<e;){var u=t[n];if(u!==u)return n}return-1;
}function C(t){var n=false;if(null!=t&&typeof t.toString!="function")try{n=!!(t+"")}catch(r){}return n}function z(t){for(var n,r=[];!(n=t.next()).done;)r.push(n.value);return r}function U(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}function $(t,n){for(var r=-1,e=t.length,u=0,o=[];++r<e;){var i=t[r];i!==n&&"__lodash_placeholder__"!==i||(t[r]="__lodash_placeholder__",o[u++]=r)}return o}function D(t){var n=-1,r=Array(t.size);return t.forEach(function(t){r[++n]=t}),r}function F(t){
var n=-1,r=Array(t.size);return t.forEach(function(t){r[++n]=[t,t]}),r}function N(t){if(!t||!Wt.test(t))return t.length;for(var n=It.lastIndex=0;It.test(t);)n++;return n}function P(t){return $t[t]}function Z(R){function At(t,n){return R.setTimeout.call(Kt,t,n)}function Ot(t){if(Te(t)&&!yi(t)&&!(t instanceof Ut)){if(t instanceof zt)return t;if(Wu.call(t,"__wrapped__"))return ae(t)}return new zt(t)}function kt(){}function zt(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,
this.__values__=T}function Ut(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=false,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function $t(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Dt(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Pt(t){var n=-1,r=t?t.length:0;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Zt(t){var n=-1,r=t?t.length:0;
for(this.__data__=new Pt;++n<r;)this.add(t[n])}function qt(t){this.__data__=new Dt(t)}function Vt(t,n,r,e){return t===T||Ce(t,ku[r])&&!Wu.call(e,r)?n:t}function Jt(t,n,r){(r===T||Ce(t[n],r))&&(typeof n!="number"||r!==T||n in t)||(t[n]=r)}function Yt(t,n,r){var e=t[n];Wu.call(t,n)&&Ce(e,r)&&(r!==T||n in t)||(t[n]=r)}function Ht(t,n){for(var r=t.length;r--;)if(Ce(t[r][0],n))return r;return-1}function Qt(t,n,r,e){return Ao(t,function(t,u,o){n(e,t,r(t),o)}),e}function Xt(t,n){return t&&sr(n,iu(n),t)}
function tn(t,n){for(var r=-1,e=null==t,u=n.length,o=Array(u);++r<u;)o[r]=e?T:uu(t,n[r]);return o}function nn(t,n,r){return t===t&&(r!==T&&(t=r>=t?t:r),n!==T&&(t=t>=n?t:n)),t}function rn(t,n,r,e,o,i,f){var c;if(e&&(c=i?e(t,o,i,f):e(t)),c!==T)return c;if(!Ze(t))return t;if(o=yi(t)){if(c=Kr(t),!n)return lr(t,c)}else{var a=qr(t),l="[object Function]"==a||"[object GeneratorFunction]"==a;if(bi(t))return or(t,n);if("[object Object]"==a||"[object Arguments]"==a||l&&!i){if(C(t))return i?t:{};if(c=Gr(l?{}:t),
!n)return hr(t,Xt(c,t))}else{if(!Ct[a])return i?t:{};c=Jr(t,a,rn,n)}}if(f||(f=new qt),i=f.get(t))return i;if(f.set(t,c),!o)var s=r?gn(t,iu,Tr):iu(t);return u(s||t,function(u,o){s&&(o=u,u=t[o]),Yt(c,o,rn(u,n,r,e,o,t,f))}),c}function en(t){var n=iu(t),r=n.length;return function(e){if(null==e)return!r;for(var u=r;u--;){var o=n[u],i=t[o],f=e[o];if(f===T&&!(o in Object(e))||!i(f))return false}return true}}function un(t){return Ze(t)?Tu(t):{}}function on(t,n,r){if(typeof t!="function")throw new Au("Expected a function");
return At(function(){t.apply(T,r)},n)}function fn(t,n,r,e){var u=-1,o=c,i=true,f=t.length,s=[],h=n.length;if(!f)return s;r&&(n=l(n,O(r))),e?(o=a,i=false):n.length>=200&&(o=E,i=false,n=new Zt(n));t:for(;++u<f;){var p=t[u],_=r?r(p):p,p=e||0!==p?p:0;if(i&&_===_){for(var v=h;v--;)if(n[v]===_)continue t;s.push(p)}else o(n,_,e)||s.push(p)}return s}function cn(t,n){var r=true;return Ao(t,function(t,e,u){return r=!!n(t,e,u)}),r}function an(t,n,r){for(var e=-1,u=t.length;++e<u;){var o=t[e],i=n(o);if(null!=i&&(f===T?i===i&&!Je(i):r(i,f)))var f=i,c=o;
}return c}function ln(t,n){var r=[];return Ao(t,function(t,e,u){n(t,e,u)&&r.push(t)}),r}function sn(t,n,r,e,u){var o=-1,i=t.length;for(r||(r=Hr),u||(u=[]);++o<i;){var f=t[o];n>0&&r(f)?n>1?sn(f,n-1,r,e,u):s(u,f):e||(u[u.length]=f)}return u}function hn(t,n){return t&&ko(t,n,iu)}function pn(t,n){return t&&Eo(t,n,iu)}function _n(t,n){return f(n,function(n){return Fe(t[n])})}function vn(t,n){n=ne(n,t)?[n]:er(n);for(var r=0,e=n.length;null!=t&&e>r;)t=t[fe(n[r++])];return r&&r==e?t:T}function gn(t,n,r){
return n=n(t),yi(t)?n:s(n,r(t))}function dn(t,n){return t>n}function yn(t,n){return null!=t&&(Wu.call(t,n)||typeof t=="object"&&n in t&&null===Ju(Object(t)))}function bn(t,n){return null!=t&&n in Object(t)}function xn(t,n,r){for(var e=r?a:c,u=t[0].length,o=t.length,i=o,f=Array(o),s=1/0,h=[];i--;){var p=t[i];i&&n&&(p=l(p,O(n))),s=to(p.length,s),f[i]=!r&&(n||u>=120&&p.length>=120)?new Zt(i&&p):T}var p=t[0],_=-1,v=f[0];t:for(;++_<u&&s>h.length;){var g=p[_],d=n?n(g):g,g=r||0!==g?g:0;if(v?!E(v,d):!e(h,d,r)){
for(i=o;--i;){var y=f[i];if(y?!E(y,d):!e(t[i],d,r))continue t}v&&v.push(d),h.push(g)}}return h}function jn(t,n,r){var e={};return hn(t,function(t,u,o){n(e,r(t),u,o)}),e}function wn(t,n,e){return ne(n,t)||(n=er(n),t=ie(t,n),n=ve(n)),n=null==t?t:t[fe(n)],null==n?T:r(n,t,e)}function mn(t,n,r,e,u){if(t===n)n=true;else if(null==t||null==n||!Ze(t)&&!Te(n))n=t!==t&&n!==n;else t:{var o=yi(t),i=yi(n),f="[object Array]",c="[object Array]";o||(f=qr(t),f="[object Arguments]"==f?"[object Object]":f),i||(c=qr(n),
c="[object Arguments]"==c?"[object Object]":c);var a="[object Object]"==f&&!C(t),i="[object Object]"==c&&!C(n);if((c=f==c)&&!a)u||(u=new qt),n=o||Ye(t)?zr(t,n,mn,r,e,u):Ur(t,n,f,mn,r,e,u);else{if(!(2&e)&&(o=a&&Wu.call(t,"__wrapped__"),f=i&&Wu.call(n,"__wrapped__"),o||f)){t=o?t.value():t,n=f?n.value():n,u||(u=new qt),n=mn(t,n,r,e,u);break t}if(c)n:if(u||(u=new qt),o=2&e,f=iu(t),i=f.length,c=iu(n).length,i==c||o){for(a=i;a--;){var l=f[a];if(!(o?l in n:yn(n,l))){n=false;break n}}if(c=u.get(t))n=c==n;else{
c=true,u.set(t,n);for(var s=o;++a<i;){var l=f[a],h=t[l],p=n[l];if(r)var _=o?r(p,h,l,n,t,u):r(h,p,l,t,n,u);if(_===T?h!==p&&!mn(h,p,r,e,u):!_){c=false;break}s||(s="constructor"==l)}c&&!s&&(r=t.constructor,e=n.constructor,r!=e&&"constructor"in t&&"constructor"in n&&!(typeof r=="function"&&r instanceof r&&typeof e=="function"&&e instanceof e)&&(c=false)),u["delete"](t),n=c}}else n=false;else n=false}}return n}function An(t,n,r,e){var u=r.length,o=u,i=!e;if(null==t)return!o;for(t=Object(t);u--;){var f=r[u];if(i&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return false;
}for(;++u<o;){var f=r[u],c=f[0],a=t[c],l=f[1];if(i&&f[2]){if(a===T&&!(c in t))return false}else{if(f=new qt,e)var s=e(a,l,c,t,n,f);if(s===T?!mn(l,a,e,3,f):!s)return false}}return true}function On(t){return!Ze(t)||Iu&&Iu in t?false:(Fe(t)||C(t)?zu:yt).test(ce(t))}function kn(t){return typeof t=="function"?t:null==t?pu:typeof t=="object"?yi(t)?Wn(t[0],t[1]):Rn(t):du(t)}function En(t){t=null==t?t:Object(t);var n,r=[];for(n in t)r.push(n);return r}function Sn(t,n){return n>t}function In(t,n){var r=-1,e=Ue(t)?Array(t.length):[];
return Ao(t,function(t,u,o){e[++r]=n(t,u,o)}),e}function Rn(t){var n=Pr(t);return 1==n.length&&n[0][2]?ue(n[0][0],n[0][1]):function(r){return r===t||An(r,t,n)}}function Wn(t,n){return ne(t)&&n===n&&!Ze(n)?ue(fe(t),n):function(r){var e=uu(r,t);return e===T&&e===n?ou(r,t):mn(n,e,T,3)}}function Bn(t,n,r,e,o){if(t!==n){if(!yi(n)&&!Ye(n))var i=fu(n);u(i||n,function(u,f){if(i&&(f=u,u=n[f]),Ze(u)){o||(o=new qt);var c=f,a=o,l=t[c],s=n[c],h=a.get(s);if(h)Jt(t,c,h);else{var h=e?e(l,s,c+"",t,n,a):T,p=h===T;p&&(h=s,
yi(s)||Ye(s)?yi(l)?h=l:$e(l)?h=lr(l):(p=false,h=rn(s,true)):Ve(s)||ze(s)?ze(l)?h=ru(l):!Ze(l)||r&&Fe(l)?(p=false,h=rn(s,true)):h=l:p=false),a.set(s,h),p&&Bn(h,s,r,e,a),a["delete"](s),Jt(t,c,h)}}else c=e?e(t[f],u,f+"",t,n,o):T,c===T&&(c=u),Jt(t,f,c)})}}function Ln(t,n){var r=t.length;return r?(n+=0>n?r:0,Xr(n,r)?t[n]:T):void 0}function Mn(t,n,r){var e=-1;return n=l(n.length?n:[pu],O(Fr())),t=In(t,function(t){return{a:l(n,function(n){return n(t)}),b:++e,c:t}}),j(t,function(t,n){var e;t:{e=-1;for(var u=t.a,o=n.a,i=u.length,f=r.length;++e<i;){
var c=fr(u[e],o[e]);if(c){e=e>=f?c:c*("desc"==r[e]?-1:1);break t}}e=t.b-n.b}return e})}function Cn(t,n){return t=Object(t),h(n,function(n,r){return r in t&&(n[r]=t[r]),n},{})}function zn(t,n){for(var r=-1,e=gn(t,fu,Bo),u=e.length,o={};++r<u;){var i=e[r],f=t[i];n(f,i)&&(o[i]=f)}return o}function Un(t){return function(n){return null==n?T:n[t]}}function $n(t){return function(n){return vn(n,t)}}function Dn(t,n,r,e){var u=e?y:d,o=-1,i=n.length,f=t;for(t===n&&(n=lr(n)),r&&(f=l(t,O(r)));++o<i;)for(var c=0,a=n[o],a=r?r(a):a;-1<(c=u(f,a,c,e));)f!==t&&Vu.call(f,c,1),
Vu.call(t,c,1);return t}function Fn(t,n){for(var r=t?n.length:0,e=r-1;r--;){var u=n[r];if(r==e||u!==o){var o=u;if(Xr(u))Vu.call(t,u,1);else if(ne(u,t))delete t[fe(u)];else{var u=er(u),i=ie(t,u);null!=i&&delete i[fe(ve(u))]}}}}function Nn(t,n){return t+Gu(ro()*(n-t+1))}function Pn(t,n){var r="";if(!t||1>n||n>9007199254740991)return r;do n%2&&(r+=t),(n=Gu(n/2))&&(t+=t);while(n);return r}function Zn(t,n,r,e){n=ne(n,t)?[n]:er(n);for(var u=-1,o=n.length,i=o-1,f=t;null!=f&&++u<o;){var c=fe(n[u]);if(Ze(f)){
var a=r;if(u!=i){var l=f[c],a=e?e(l,c,f):T;a===T&&(a=null==l?Xr(n[u+1])?[]:{}:l)}Yt(f,c,a)}f=f[c]}return t}function Tn(t,n,r){var e=-1,u=t.length;for(0>n&&(n=-n>u?0:u+n),r=r>u?u:r,0>r&&(r+=u),u=n>r?0:r-n>>>0,n>>>=0,r=Array(u);++e<u;)r[e]=t[e+n];return r}function qn(t,n){var r;return Ao(t,function(t,e,u){return r=n(t,e,u),!r}),!!r}function Vn(t,n,r){var e=0,u=t?t.length:e;if(typeof n=="number"&&n===n&&2147483647>=u){for(;u>e;){var o=e+u>>>1,i=t[o];null!==i&&!Je(i)&&(r?n>=i:n>i)?e=o+1:u=o}return u}
return Kn(t,n,pu,r)}function Kn(t,n,r,e){n=r(n);for(var u=0,o=t?t.length:0,i=n!==n,f=null===n,c=Je(n),a=n===T;o>u;){var l=Gu((u+o)/2),s=r(t[l]),h=s!==T,p=null===s,_=s===s,v=Je(s);(i?e||_:a?_&&(e||h):f?_&&h&&(e||!p):c?_&&h&&!p&&(e||!v):p||v?0:e?n>=s:n>s)?u=l+1:o=l}return to(o,4294967294)}function Gn(t,n){for(var r=-1,e=t.length,u=0,o=[];++r<e;){var i=t[r],f=n?n(i):i;if(!r||!Ce(f,c)){var c=f;o[u++]=0===i?0:i}}return o}function Jn(t){return typeof t=="number"?t:Je(t)?V:+t}function Yn(t){if(typeof t=="string")return t;
if(Je(t))return mo?mo.call(t):"";var n=t+"";return"0"==n&&1/t==-q?"-0":n}function Hn(t,n,r){var e=-1,u=c,o=t.length,i=true,f=[],l=f;if(r)i=false,u=a;else if(o>=200){if(u=n?null:Io(t))return D(u);i=false,u=E,l=new Zt}else l=n?[]:f;t:for(;++e<o;){var s=t[e],h=n?n(s):s,s=r||0!==s?s:0;if(i&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue t;n&&l.push(h),f.push(s)}else u(l,h,r)||(l!==f&&l.push(h),f.push(s))}return f}function Qn(t,n,r,e){for(var u=t.length,o=e?u:-1;(e?o--:++o<u)&&n(t[o],o,t););return r?Tn(t,e?0:o,e?o+1:u):Tn(t,e?o+1:0,e?u:o);
}function Xn(t,n){var r=t;return r instanceof Ut&&(r=r.value()),h(n,function(t,n){return n.func.apply(n.thisArg,s([t],n.args))},r)}function tr(t,n,r){for(var e=-1,u=t.length;++e<u;)var o=o?s(fn(o,t[e],n,r),fn(t[e],o,n,r)):t[e];return o&&o.length?Hn(o,n,r):[]}function nr(t,n,r){for(var e=-1,u=t.length,o=n.length,i={};++e<u;)r(i,t[e],o>e?n[e]:T);return i}function rr(t){return $e(t)?t:[]}function er(t){return yi(t)?t:Co(t)}function ur(t,n,r){var e=t.length;return r=r===T?e:r,!n&&r>=e?t:Tn(t,n,r)}function or(t,n){
if(n)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}function ir(t){var n=new t.constructor(t.byteLength);return new Fu(n).set(new Fu(t)),n}function fr(t,n){if(t!==n){var r=t!==T,e=null===t,u=t===t,o=Je(t),i=n!==T,f=null===n,c=n===n,a=Je(n);if(!f&&!a&&!o&&t>n||o&&i&&c&&!f&&!a||e&&i&&c||!r&&c||!u)return 1;if(!e&&!o&&!a&&n>t||a&&r&&u&&!e&&!o||f&&r&&u||!i&&u||!c)return-1}return 0}function cr(t,n,r,e){var u=-1,o=t.length,i=r.length,f=-1,c=n.length,a=Xu(o-i,0),l=Array(c+a);for(e=!e;++f<c;)l[f]=n[f];
for(;++u<i;)(e||o>u)&&(l[r[u]]=t[u]);for(;a--;)l[f++]=t[u++];return l}function ar(t,n,r,e){var u=-1,o=t.length,i=-1,f=r.length,c=-1,a=n.length,l=Xu(o-f,0),s=Array(l+a);for(e=!e;++u<l;)s[u]=t[u];for(l=u;++c<a;)s[l+c]=n[c];for(;++i<f;)(e||o>u)&&(s[l+r[i]]=t[u++]);return s}function lr(t,n){var r=-1,e=t.length;for(n||(n=Array(e));++r<e;)n[r]=t[r];return n}function sr(t,n,r,e){r||(r={});for(var u=-1,o=n.length;++u<o;){var i=n[u],f=e?e(r[i],t[i],i,r,t):t[i];Yt(r,i,f)}return r}function hr(t,n){return sr(t,Tr(t),n);
}function pr(t,n){return function(r,u){var o=yi(r)?e:Qt,i=n?n():{};return o(r,t,Fr(u),i)}}function _r(t){return Me(function(n,r){var e=-1,u=r.length,o=u>1?r[u-1]:T,i=u>2?r[2]:T,o=t.length>3&&typeof o=="function"?(u--,o):T;for(i&&te(r[0],r[1],i)&&(o=3>u?T:o,u=1),n=Object(n);++e<u;)(i=r[e])&&t(n,i,e,o);return n})}function vr(t,n){return function(r,e){if(null==r)return r;if(!Ue(r))return t(r,e);for(var u=r.length,o=n?u:-1,i=Object(r);(n?o--:++o<u)&&false!==e(i[o],o,i););return r}}function gr(t){return function(n,r,e){
var u=-1,o=Object(n);e=e(n);for(var i=e.length;i--;){var f=e[t?i:++u];if(false===r(o[f],f,o))break}return n}}function dr(t,n,r){function e(){return(this&&this!==Kt&&this instanceof e?o:t).apply(u?r:this,arguments)}var u=1&n,o=xr(t);return e}function yr(t){return function(n){n=eu(n);var r=Wt.test(n)?n.match(It):T,e=r?r[0]:n.charAt(0);return n=r?ur(r,1).join(""):n.slice(1),e[t]()+n}}function br(t){return function(n){return h(su(lu(n).replace(Et,"")),t,"")}}function xr(t){return function(){var n=arguments;
switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var r=un(t.prototype),n=t.apply(r,n);return Ze(n)?n:r}}function jr(t,n,e){function u(){for(var i=arguments.length,f=Array(i),c=i,a=Dr(u);c--;)f[c]=arguments[c];return c=3>i&&f[0]!==a&&f[i-1]!==a?[]:$(f,a),
i-=c.length,e>i?Br(t,n,Ar,u.placeholder,T,f,c,T,T,e-i):r(this&&this!==Kt&&this instanceof u?o:t,this,f)}var o=xr(t);return u}function wr(t){return function(n,r,e){var u=Object(n);if(r=Fr(r,3),!Ue(n))var o=iu(n);return e=t(o||n,function(t,n){return o&&(n=t,t=u[n]),r(t,n,u)},e),e>-1?n[o?o[e]:e]:T}}function mr(t){return Me(function(n){n=sn(n,1);var r=n.length,e=r,u=zt.prototype.thru;for(t&&n.reverse();e--;){var o=n[e];if(typeof o!="function")throw new Au("Expected a function");if(u&&!i&&"wrapper"==$r(o))var i=new zt([],true);
}for(e=i?e:r;++e<r;)var o=n[e],u=$r(o),f="wrapper"==u?Ro(o):T,i=f&&re(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?i[$r(f[0])].apply(i,f[3]):1==o.length&&re(o)?i[u]():i.thru(o);return function(){var t=arguments,e=t[0];if(i&&1==t.length&&yi(e)&&e.length>=200)return i.plant(e).value();for(var u=0,t=r?n[u].apply(this,t):e;++u<r;)t=n[u].call(this,t);return t}})}function Ar(t,n,r,e,u,o,i,f,c,a){function l(){for(var d=arguments.length,y=Array(d),b=d;b--;)y[b]=arguments[b];if(_){var x,j=Dr(l),b=y.length;for(x=0;b--;)y[b]===j&&x++;
}if(e&&(y=cr(y,e,u,_)),o&&(y=ar(y,o,i,_)),d-=x,_&&a>d)return j=$(y,j),Br(t,n,Ar,l.placeholder,r,y,j,f,c,a-d);if(j=h?r:this,b=p?j[t]:t,d=y.length,f){x=y.length;for(var w=to(f.length,x),m=lr(y);w--;){var A=f[w];y[w]=Xr(A,x)?m[A]:T}}else v&&d>1&&y.reverse();return s&&d>c&&(y.length=c),this&&this!==Kt&&this instanceof l&&(b=g||xr(b)),b.apply(j,y)}var s=128&n,h=1&n,p=2&n,_=24&n,v=512&n,g=p?T:xr(t);return l}function Or(t,n){return function(r,e){return jn(r,t,n(e))}}function kr(t){return function(n,r){var e;
if(n===T&&r===T)return 0;if(n!==T&&(e=n),r!==T){if(e===T)return r;typeof n=="string"||typeof r=="string"?(n=Yn(n),r=Yn(r)):(n=Jn(n),r=Jn(r)),e=t(n,r)}return e}}function Er(t){return Me(function(n){return n=1==n.length&&yi(n[0])?l(n[0],O(Fr())):l(sn(n,1,Qr),O(Fr())),Me(function(e){var u=this;return t(n,function(t){return r(t,u,e)})})})}function Sr(t,n){n=n===T?" ":Yn(n);var r=n.length;return 2>r?r?Pn(n,t):n:(r=Pn(n,Ku(t/N(n))),Wt.test(n)?ur(r.match(It),0,t).join(""):r.slice(0,t))}function Ir(t,n,e,u){
function o(){for(var n=-1,c=arguments.length,a=-1,l=u.length,s=Array(l+c),h=this&&this!==Kt&&this instanceof o?f:t;++a<l;)s[a]=u[a];for(;c--;)s[a++]=arguments[++n];return r(h,i?e:this,s)}var i=1&n,f=xr(t);return o}function Rr(t){return function(n,r,e){e&&typeof e!="number"&&te(n,r,e)&&(r=e=T),n=nu(n),n=n===n?n:0,r===T?(r=n,n=0):r=nu(r)||0,e=e===T?r>n?1:-1:nu(e)||0;var u=-1;r=Xu(Ku((r-n)/(e||1)),0);for(var o=Array(r);r--;)o[t?r:++u]=n,n+=e;return o}}function Wr(t){return function(n,r){return typeof n=="string"&&typeof r=="string"||(n=nu(n),
r=nu(r)),t(n,r)}}function Br(t,n,r,e,u,o,i,f,c,a){var l=8&n,s=l?i:T;i=l?T:i;var h=l?o:T;return o=l?T:o,n=(n|(l?32:64))&~(l?64:32),4&n||(n&=-4),n=[t,n,u,h,s,o,i,f,c,a],r=r.apply(T,n),re(t)&&Mo(r,n),r.placeholder=e,r}function Lr(t){var n=wu[t];return function(t,r){if(t=nu(t),r=to(Xe(r),292)){var e=(eu(t)+"e").split("e"),e=n(e[0]+"e"+(+e[1]+r)),e=(eu(e)+"e").split("e");return+(e[0]+"e"+(+e[1]-r))}return n(t)}}function Mr(t){return function(n){var r=qr(n);return"[object Map]"==r?U(n):"[object Set]"==r?F(n):A(n,t(n));
}}function Cr(t,n,r,e,u,o,i,f){var c=2&n;if(!c&&typeof t!="function")throw new Au("Expected a function");var a=e?e.length:0;if(a||(n&=-97,e=u=T),i=i===T?i:Xu(Xe(i),0),f=f===T?f:Xe(f),a-=u?u.length:0,64&n){var l=e,s=u;e=u=T}var h=c?T:Ro(t);return o=[t,n,r,e,u,l,s,o,i,f],h&&(r=o[1],t=h[1],n=r|t,e=128==t&&8==r||128==t&&256==r&&h[8]>=o[7].length||384==t&&h[8]>=h[7].length&&8==r,131>n||e)&&(1&t&&(o[2]=h[2],n|=1&r?0:4),(r=h[3])&&(e=o[3],o[3]=e?cr(e,r,h[4]):r,o[4]=e?$(o[3],"__lodash_placeholder__"):h[4]),
(r=h[5])&&(e=o[5],o[5]=e?ar(e,r,h[6]):r,o[6]=e?$(o[5],"__lodash_placeholder__"):h[6]),(r=h[7])&&(o[7]=r),128&t&&(o[8]=null==o[8]?h[8]:to(o[8],h[8])),null==o[9]&&(o[9]=h[9]),o[0]=h[0],o[1]=n),t=o[0],n=o[1],r=o[2],e=o[3],u=o[4],f=o[9]=null==o[9]?c?0:t.length:Xu(o[9]-a,0),!f&&24&n&&(n&=-25),(h?So:Mo)(n&&1!=n?8==n||16==n?jr(t,n,f):32!=n&&33!=n||u.length?Ar.apply(T,o):Ir(t,n,r,e):dr(t,n,r),o)}function zr(t,n,r,e,u,o){var i=2&u,f=t.length,c=n.length;if(f!=c&&!(i&&c>f))return false;if(c=o.get(t))return c==n;
var c=-1,a=true,l=1&u?new Zt:T;for(o.set(t,n);++c<f;){var s=t[c],h=n[c];if(e)var p=i?e(h,s,c,n,t,o):e(s,h,c,t,n,o);if(p!==T){if(p)continue;a=false;break}if(l){if(!_(n,function(t,n){return l.has(n)||s!==t&&!r(s,t,e,u,o)?void 0:l.add(n)})){a=false;break}}else if(s!==h&&!r(s,h,e,u,o)){a=false;break}}return o["delete"](t),a}function Ur(t,n,r,e,u,o,i){switch(r){case"[object DataView]":if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)break;t=t.buffer,n=n.buffer;case"[object ArrayBuffer]":if(t.byteLength!=n.byteLength||!e(new Fu(t),new Fu(n)))break;
return true;case"[object Boolean]":case"[object Date]":return+t==+n;case"[object Error]":return t.name==n.name&&t.message==n.message;case"[object Number]":return t!=+t?n!=+n:t==+n;case"[object RegExp]":case"[object String]":return t==n+"";case"[object Map]":var f=U;case"[object Set]":if(f||(f=D),t.size!=n.size&&!(2&o))break;return(r=i.get(t))?r==n:(o|=1,i.set(t,n),zr(f(t),f(n),e,u,o,i));case"[object Symbol]":if(wo)return wo.call(t)==wo.call(n)}return false}function $r(t){for(var n=t.name+"",r=_o[n],e=Wu.call(_o,n)?r.length:0;e--;){
var u=r[e],o=u.func;if(null==o||o==t)return u.name}return n}function Dr(t){return(Wu.call(Ot,"placeholder")?Ot:t).placeholder}function Fr(){var t=Ot.iteratee||_u,t=t===_u?kn:t;return arguments.length?t(arguments[0],arguments[1]):t}function Nr(t,n){var r=t.__data__,e=typeof n;return("string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n)?r[typeof n=="string"?"string":"hash"]:r.map}function Pr(t){for(var n=iu(t),r=n.length;r--;){var e=n[r],u=t[e];n[r]=[e,u,u===u&&!Ze(u)]}return n;
}function Zr(t,n){var r=null==t?T:t[n];return On(r)?r:T}function Tr(t){return Pu(Object(t))}function qr(t){return Mu.call(t)}function Vr(t,n,r){n=ne(n,t)?[n]:er(n);for(var e,u=-1,o=n.length;++u<o;){var i=fe(n[u]);if(!(e=null!=t&&r(t,i)))break;t=t[i]}return e?e:(o=t?t.length:0,!!o&&Pe(o)&&Xr(i,o)&&(yi(t)||Ge(t)||ze(t)))}function Kr(t){var n=t.length,r=t.constructor(n);return n&&"string"==typeof t[0]&&Wu.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Gr(t){return typeof t.constructor!="function"||ee(t)?{}:un(Ju(Object(t)));
}function Jr(r,e,u,o){var i=r.constructor;switch(e){case"[object ArrayBuffer]":return ir(r);case"[object Boolean]":case"[object Date]":return new i(+r);case"[object DataView]":return e=o?ir(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":
return e=o?ir(r.buffer):r.buffer,new r.constructor(e,r.byteOffset,r.length);case"[object Map]":return e=o?u(U(r),true):U(r),h(e,t,new r.constructor);case"[object Number]":case"[object String]":return new i(r);case"[object RegExp]":return e=new r.constructor(r.source,_t.exec(r)),e.lastIndex=r.lastIndex,e;case"[object Set]":return e=o?u(D(r),true):D(r),h(e,n,new r.constructor);case"[object Symbol]":return wo?Object(wo.call(r)):{}}}function Yr(t){var n=t?t.length:T;return Pe(n)&&(yi(t)||Ge(t)||ze(t))?m(n,String):null;
}function Hr(t){return yi(t)||ze(t)}function Qr(t){return yi(t)&&!(2==t.length&&!Fe(t[0]))}function Xr(t,n){return n=null==n?9007199254740991:n,!!n&&(typeof t=="number"||xt.test(t))&&t>-1&&0==t%1&&n>t}function te(t,n,r){if(!Ze(r))return false;var e=typeof n;return("number"==e?Ue(r)&&Xr(n,r.length):"string"==e&&n in r)?Ce(r[n],t):false}function ne(t,n){if(yi(t))return false;var r=typeof t;return"number"==r||"symbol"==r||"boolean"==r||null==t||Je(t)?true:ut.test(t)||!et.test(t)||null!=n&&t in Object(n)}function re(t){
var n=$r(t),r=Ot[n];return typeof r=="function"&&n in Ut.prototype?t===r?true:(n=Ro(r),!!n&&t===n[0]):false}function ee(t){var n=t&&t.constructor;return t===(typeof n=="function"&&n.prototype||ku)}function ue(t,n){return function(r){return null==r?false:r[t]===n&&(n!==T||t in Object(r))}}function oe(t,n,r,e,u,o){return Ze(t)&&Ze(n)&&Bn(t,n,T,oe,o.set(n,t)),t}function ie(t,n){return 1==n.length?t:vn(t,Tn(n,0,-1))}function fe(t){if(typeof t=="string"||Je(t))return t;var n=t+"";return"0"==n&&1/t==-q?"-0":n}function ce(t){
if(null!=t){try{return Ru.call(t)}catch(n){}return t+""}return""}function ae(t){if(t instanceof Ut)return t.clone();var n=new zt(t.__wrapped__,t.__chain__);return n.__actions__=lr(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function le(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Xe(n),Tn(t,0>n?0:n,e)):[]}function se(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Xe(n),n=e-n,Tn(t,0,0>n?0:n)):[]}function he(t,n,r){var e=t?t.length:0;return e?(r=null==r?0:Xe(r),0>r&&(r=Xu(e+r,0)),
g(t,Fr(n,3),r)):-1}function pe(t,n,r){var e=t?t.length:0;if(!e)return-1;var u=e-1;return r!==T&&(u=Xe(r),u=0>r?Xu(e+u,0):to(u,e-1)),g(t,Fr(n,3),u,true)}function _e(t){return t&&t.length?t[0]:T}function ve(t){var n=t?t.length:0;return n?t[n-1]:T}function ge(t,n){return t&&t.length&&n&&n.length?Dn(t,n):t}function de(t){return t?uo.call(t):t}function ye(t){if(!t||!t.length)return[];var n=0;return t=f(t,function(t){return $e(t)?(n=Xu(t.length,n),true):void 0}),m(n,function(n){return l(t,Un(n))})}function be(t,n){
if(!t||!t.length)return[];var e=ye(t);return null==n?e:l(e,function(t){return r(n,T,t)})}function xe(t){return t=Ot(t),t.__chain__=true,t}function je(t,n){return n(t)}function we(){return this}function me(t,n){return(yi(t)?u:Ao)(t,Fr(n,3))}function Ae(t,n){return(yi(t)?o:Oo)(t,Fr(n,3))}function Oe(t,n){return(yi(t)?l:In)(t,Fr(n,3))}function ke(t,n,r){var e=-1,u=He(t),o=u.length,i=o-1;for(n=(r?te(t,n,r):n===T)?1:nn(Xe(n),0,o);++e<n;)t=Nn(e,i),r=u[t],u[t]=u[e],u[e]=r;return u.length=n,u}function Ee(){
return xu.now()}function Se(t,n,r){return n=r?T:n,n=t&&null==n?t.length:n,Cr(t,128,T,T,T,T,n)}function Ie(t,n){var r;if(typeof n!="function")throw new Au("Expected a function");return t=Xe(t),function(){return 0<--t&&(r=n.apply(this,arguments)),1>=t&&(n=T),r}}function Re(t,n,r){return n=r?T:n,t=Cr(t,8,T,T,T,T,T,n),t.placeholder=Re.placeholder,t}function We(t,n,r){return n=r?T:n,t=Cr(t,16,T,T,T,T,T,n),t.placeholder=We.placeholder,t}function Be(t,n,r){function e(n){var r=c,e=a;return c=a=T,_=n,s=t.apply(e,r);
}function u(t){var r=t-p;return t-=_,p===T||r>=n||0>r||g&&t>=l}function o(){var t=Ee();if(u(t))return i(t);var r;r=t-_,t=n-(t-p),r=g?to(t,l-r):t,h=At(o,r)}function i(t){return h=T,d&&c?e(t):(c=a=T,s)}function f(){var t=Ee(),r=u(t);if(c=arguments,a=this,p=t,r){if(h===T)return _=t=p,h=At(o,n),v?e(t):s;if(g)return h=At(o,n),e(p)}return h===T&&(h=At(o,n)),s}var c,a,l,s,h,p,_=0,v=false,g=false,d=true;if(typeof t!="function")throw new Au("Expected a function");return n=nu(n)||0,Ze(r)&&(v=!!r.leading,l=(g="maxWait"in r)?Xu(nu(r.maxWait)||0,n):l,
d="trailing"in r?!!r.trailing:d),f.cancel=function(){_=0,c=p=a=h=T},f.flush=function(){return h===T?s:i(Ee())},f}function Le(t,n){function r(){var e=arguments,u=n?n.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=t.apply(this,e),r.cache=o.set(u,e),e)}if(typeof t!="function"||n&&typeof n!="function")throw new Au("Expected a function");return r.cache=new(Le.Cache||Pt),r}function Me(t,n){if(typeof t!="function")throw new Au("Expected a function");return n=Xu(n===T?t.length-1:Xe(n),0),function(){
for(var e=arguments,u=-1,o=Xu(e.length-n,0),i=Array(o);++u<o;)i[u]=e[n+u];switch(n){case 0:return t.call(this,i);case 1:return t.call(this,e[0],i);case 2:return t.call(this,e[0],e[1],i)}for(o=Array(n+1),u=-1;++u<n;)o[u]=e[u];return o[n]=i,r(t,this,o)}}function Ce(t,n){return t===n||t!==t&&n!==n}function ze(t){return $e(t)&&Wu.call(t,"callee")&&(!qu.call(t,"callee")||"[object Arguments]"==Mu.call(t))}function Ue(t){return null!=t&&Pe(Wo(t))&&!Fe(t)}function $e(t){return Te(t)&&Ue(t)}function De(t){
return Te(t)?"[object Error]"==Mu.call(t)||typeof t.message=="string"&&typeof t.name=="string":false}function Fe(t){return t=Ze(t)?Mu.call(t):"","[object Function]"==t||"[object GeneratorFunction]"==t}function Ne(t){return typeof t=="number"&&t==Xe(t)}function Pe(t){return typeof t=="number"&&t>-1&&0==t%1&&9007199254740991>=t}function Ze(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function Te(t){return!!t&&typeof t=="object"}function qe(t){return typeof t=="number"||Te(t)&&"[object Number]"==Mu.call(t);
}function Ve(t){return!Te(t)||"[object Object]"!=Mu.call(t)||C(t)?false:(t=Ju(Object(t)),null===t?true:(t=Wu.call(t,"constructor")&&t.constructor,typeof t=="function"&&t instanceof t&&Ru.call(t)==Lu))}function Ke(t){return Ze(t)&&"[object RegExp]"==Mu.call(t)}function Ge(t){return typeof t=="string"||!yi(t)&&Te(t)&&"[object String]"==Mu.call(t)}function Je(t){return typeof t=="symbol"||Te(t)&&"[object Symbol]"==Mu.call(t)}function Ye(t){return Te(t)&&Pe(t.length)&&!!Mt[Mu.call(t)]}function He(t){if(!t)return[];
if(Ue(t))return Ge(t)?t.match(It):lr(t);if(Zu&&t[Zu])return z(t[Zu]());var n=qr(t);return("[object Map]"==n?U:"[object Set]"==n?D:cu)(t)}function Qe(t){return t?(t=nu(t),t===q||t===-q?1.7976931348623157e308*(0>t?-1:1):t===t?t:0):0===t?t:0}function Xe(t){t=Qe(t);var n=t%1;return t===t?n?t-n:t:0}function tu(t){return t?nn(Xe(t),0,4294967295):0}function nu(t){if(typeof t=="number")return t;if(Je(t))return V;if(Ze(t)&&(t=Fe(t.valueOf)?t.valueOf():t,t=Ze(t)?t+"":t),typeof t!="string")return 0===t?t:+t;
t=t.replace(ct,"");var n=dt.test(t);return n||bt.test(t)?Nt(t.slice(2),n?2:8):gt.test(t)?V:+t}function ru(t){return sr(t,fu(t))}function eu(t){return null==t?"":Yn(t)}function uu(t,n,r){return t=null==t?T:vn(t,n),t===T?r:t}function ou(t,n){return null!=t&&Vr(t,n,bn)}function iu(t){var n=ee(t);if(!n&&!Ue(t))return Qu(Object(t));var r,e=Yr(t),u=!!e,e=e||[],o=e.length;for(r in t)!yn(t,r)||u&&("length"==r||Xr(r,o))||n&&"constructor"==r||e.push(r);return e}function fu(t){for(var n=-1,r=ee(t),e=En(t),u=e.length,o=Yr(t),i=!!o,o=o||[],f=o.length;++n<u;){
var c=e[n];i&&("length"==c||Xr(c,f))||"constructor"==c&&(r||!Wu.call(t,c))||o.push(c)}return o}function cu(t){return t?k(t,iu(t)):[]}function au(t){return qi(eu(t).toLowerCase())}function lu(t){return(t=eu(t))&&t.replace(jt,W).replace(St,"")}function su(t,n,r){return t=eu(t),n=r?T:n,n===T&&(n=Bt.test(t)?Rt:st),t.match(n)||[]}function hu(t){return function(){return t}}function pu(t){return t}function _u(t){return kn(typeof t=="function"?t:rn(t,true))}function vu(t,n,r){var e=iu(n),o=_n(n,e);null!=r||Ze(n)&&(o.length||!e.length)||(r=n,
n=t,t=this,o=_n(n,iu(n)));var i=!(Ze(r)&&"chain"in r&&!r.chain),f=Fe(t);return u(o,function(r){var e=n[r];t[r]=e,f&&(t.prototype[r]=function(){var n=this.__chain__;if(i||n){var r=t(this.__wrapped__);return(r.__actions__=lr(this.__actions__)).push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,s([this.value()],arguments))})}),t}function gu(){}function du(t){return ne(t)?Un(fe(t)):$n(t)}function yu(){return[]}function bu(){return false}R=R?Gt.defaults({},R,Gt.pick(Kt,Lt)):Kt;var xu=R.Date,ju=R.Error,wu=R.Math,mu=R.RegExp,Au=R.TypeError,Ou=R.Array.prototype,ku=R.Object.prototype,Eu=R.String.prototype,Su=R["__core-js_shared__"],Iu=function(){
var t=/[^.]+$/.exec(Su&&Su.keys&&Su.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ru=R.Function.prototype.toString,Wu=ku.hasOwnProperty,Bu=0,Lu=Ru.call(Object),Mu=ku.toString,Cu=Kt._,zu=mu("^"+Ru.call(Wu).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Uu=Tt?R.Buffer:T,$u=R.Reflect,Du=R.Symbol,Fu=R.Uint8Array,Nu=$u?$u.f:T,Pu=Object.getOwnPropertySymbols,Zu=typeof(Zu=Du&&Du.iterator)=="symbol"?Zu:T,Tu=Object.create,qu=ku.propertyIsEnumerable,Vu=Ou.splice,Ku=wu.ceil,Gu=wu.floor,Ju=Object.getPrototypeOf,Yu=R.isFinite,Hu=Ou.join,Qu=Object.keys,Xu=wu.max,to=wu.min,no=R.parseInt,ro=wu.random,eo=Eu.replace,uo=Ou.reverse,oo=Eu.split,io=Zr(R,"DataView"),fo=Zr(R,"Map"),co=Zr(R,"Promise"),ao=Zr(R,"Set"),lo=Zr(R,"WeakMap"),so=Zr(Object,"create"),ho=lo&&new lo,po=!qu.call({
valueOf:1},"valueOf"),_o={},vo=ce(io),go=ce(fo),yo=ce(co),bo=ce(ao),xo=ce(lo),jo=Du?Du.prototype:T,wo=jo?jo.valueOf:T,mo=jo?jo.toString:T;Ot.templateSettings={escape:tt,evaluate:nt,interpolate:rt,variable:"",imports:{_:Ot}},Ot.prototype=kt.prototype,Ot.prototype.constructor=Ot,zt.prototype=un(kt.prototype),zt.prototype.constructor=zt,Ut.prototype=un(kt.prototype),Ut.prototype.constructor=Ut,$t.prototype.clear=function(){this.__data__=so?so(null):{}},$t.prototype["delete"]=function(t){return this.has(t)&&delete this.__data__[t];
},$t.prototype.get=function(t){var n=this.__data__;return so?(t=n[t],"__lodash_hash_undefined__"===t?T:t):Wu.call(n,t)?n[t]:T},$t.prototype.has=function(t){var n=this.__data__;return so?n[t]!==T:Wu.call(n,t)},$t.prototype.set=function(t,n){return this.__data__[t]=so&&n===T?"__lodash_hash_undefined__":n,this},Dt.prototype.clear=function(){this.__data__=[]},Dt.prototype["delete"]=function(t){var n=this.__data__;return t=Ht(n,t),0>t?false:(t==n.length-1?n.pop():Vu.call(n,t,1),true)},Dt.prototype.get=function(t){
var n=this.__data__;return t=Ht(n,t),0>t?T:n[t][1]},Dt.prototype.has=function(t){return-1<Ht(this.__data__,t)},Dt.prototype.set=function(t,n){var r=this.__data__,e=Ht(r,t);return 0>e?r.push([t,n]):r[e][1]=n,this},Pt.prototype.clear=function(){this.__data__={hash:new $t,map:new(fo||Dt),string:new $t}},Pt.prototype["delete"]=function(t){return Nr(this,t)["delete"](t)},Pt.prototype.get=function(t){return Nr(this,t).get(t)},Pt.prototype.has=function(t){return Nr(this,t).has(t)},Pt.prototype.set=function(t,n){
return Nr(this,t).set(t,n),this},Zt.prototype.add=Zt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Zt.prototype.has=function(t){return this.__data__.has(t)},qt.prototype.clear=function(){this.__data__=new Dt},qt.prototype["delete"]=function(t){return this.__data__["delete"](t)},qt.prototype.get=function(t){return this.__data__.get(t)},qt.prototype.has=function(t){return this.__data__.has(t)},qt.prototype.set=function(t,n){var r=this.__data__;return r instanceof Dt&&200==r.__data__.length&&(r=this.__data__=new Pt(r.__data__)),
r.set(t,n),this};var Ao=vr(hn),Oo=vr(pn,true),ko=gr(),Eo=gr(true);Nu&&!qu.call({valueOf:1},"valueOf")&&(En=function(t){return z(Nu(t))});var So=ho?function(t,n){return ho.set(t,n),t}:pu,Io=ao&&1/D(new ao([,-0]))[1]==q?function(t){return new ao(t)}:gu,Ro=ho?function(t){return ho.get(t)}:gu,Wo=Un("length");Pu||(Tr=yu);var Bo=Pu?function(t){for(var n=[];t;)s(n,Tr(t)),t=Ju(Object(t));return n}:Tr;(io&&"[object DataView]"!=qr(new io(new ArrayBuffer(1)))||fo&&"[object Map]"!=qr(new fo)||co&&"[object Promise]"!=qr(co.resolve())||ao&&"[object Set]"!=qr(new ao)||lo&&"[object WeakMap]"!=qr(new lo))&&(qr=function(t){
var n=Mu.call(t);if(t=(t="[object Object]"==n?t.constructor:T)?ce(t):T)switch(t){case vo:return"[object DataView]";case go:return"[object Map]";case yo:return"[object Promise]";case bo:return"[object Set]";case xo:return"[object WeakMap]"}return n});var Lo=Su?Fe:bu,Mo=function(){var t=0,n=0;return function(r,e){var u=Ee(),o=16-(u-n);if(n=u,o>0){if(150<=++t)return r}else t=0;return So(r,e)}}(),Co=Le(function(t){var n=[];return eu(t).replace(ot,function(t,r,e,u){n.push(e?u.replace(ht,"$1"):r||t)}),
n}),zo=Me(function(t,n){return $e(t)?fn(t,sn(n,1,$e,true)):[]}),Uo=Me(function(t,n){var r=ve(n);return $e(r)&&(r=T),$e(t)?fn(t,sn(n,1,$e,true),Fr(r)):[]}),$o=Me(function(t,n){var r=ve(n);return $e(r)&&(r=T),$e(t)?fn(t,sn(n,1,$e,true),T,r):[]}),Do=Me(function(t){var n=l(t,rr);return n.length&&n[0]===t[0]?xn(n):[]}),Fo=Me(function(t){var n=ve(t),r=l(t,rr);return n===ve(r)?n=T:r.pop(),r.length&&r[0]===t[0]?xn(r,Fr(n)):[]}),No=Me(function(t){var n=ve(t),r=l(t,rr);return n===ve(r)?n=T:r.pop(),r.length&&r[0]===t[0]?xn(r,T,n):[];
}),Po=Me(ge),Zo=Me(function(t,n){n=sn(n,1);var r=t?t.length:0,e=tn(t,n);return Fn(t,l(n,function(t){return Xr(t,r)?+t:t}).sort(fr)),e}),To=Me(function(t){return Hn(sn(t,1,$e,true))}),qo=Me(function(t){var n=ve(t);return $e(n)&&(n=T),Hn(sn(t,1,$e,true),Fr(n))}),Vo=Me(function(t){var n=ve(t);return $e(n)&&(n=T),Hn(sn(t,1,$e,true),T,n)}),Ko=Me(function(t,n){return $e(t)?fn(t,n):[]}),Go=Me(function(t){return tr(f(t,$e))}),Jo=Me(function(t){var n=ve(t);return $e(n)&&(n=T),tr(f(t,$e),Fr(n))}),Yo=Me(function(t){
var n=ve(t);return $e(n)&&(n=T),tr(f(t,$e),T,n)}),Ho=Me(ye),Qo=Me(function(t){var n=t.length,n=n>1?t[n-1]:T,n=typeof n=="function"?(t.pop(),n):T;return be(t,n)}),Xo=Me(function(t){function n(n){return tn(n,t)}t=sn(t,1);var r=t.length,e=r?t[0]:0,u=this.__wrapped__;return!(r>1||this.__actions__.length)&&u instanceof Ut&&Xr(e)?(u=u.slice(e,+e+(r?1:0)),u.__actions__.push({func:je,args:[n],thisArg:T}),new zt(u,this.__chain__).thru(function(t){return r&&!t.length&&t.push(T),t})):this.thru(n)}),ti=pr(function(t,n,r){
Wu.call(t,r)?++t[r]:t[r]=1}),ni=wr(he),ri=wr(pe),ei=pr(function(t,n,r){Wu.call(t,r)?t[r].push(n):t[r]=[n]}),ui=Me(function(t,n,e){var u=-1,o=typeof n=="function",i=ne(n),f=Ue(t)?Array(t.length):[];return Ao(t,function(t){var c=o?n:i&&null!=t?t[n]:T;f[++u]=c?r(c,t,e):wn(t,n,e)}),f}),oi=pr(function(t,n,r){t[r]=n}),ii=pr(function(t,n,r){t[r?0:1].push(n)},function(){return[[],[]]}),fi=Me(function(t,n){if(null==t)return[];var r=n.length;return r>1&&te(t,n[0],n[1])?n=[]:r>2&&te(n[0],n[1],n[2])&&(n=[n[0]]),
n=1==n.length&&yi(n[0])?n[0]:sn(n,1,Qr),Mn(t,n,[])}),ci=Me(function(t,n,r){var e=1;if(r.length)var u=$(r,Dr(ci)),e=32|e;return Cr(t,e,n,r,u)}),ai=Me(function(t,n,r){var e=3;if(r.length)var u=$(r,Dr(ai)),e=32|e;return Cr(n,e,t,r,u)}),li=Me(function(t,n){return on(t,1,n)}),si=Me(function(t,n,r){return on(t,nu(n)||0,r)});Le.Cache=Pt;var hi=Me(function(t,n){n=1==n.length&&yi(n[0])?l(n[0],O(Fr())):l(sn(n,1,Qr),O(Fr()));var e=n.length;return Me(function(u){for(var o=-1,i=to(u.length,e);++o<i;)u[o]=n[o].call(this,u[o]);
return r(t,this,u)})}),pi=Me(function(t,n){var r=$(n,Dr(pi));return Cr(t,32,T,n,r)}),_i=Me(function(t,n){var r=$(n,Dr(_i));return Cr(t,64,T,n,r)}),vi=Me(function(t,n){return Cr(t,256,T,T,T,sn(n,1))}),gi=Wr(dn),di=Wr(function(t,n){return t>=n}),yi=Array.isArray,bi=Uu?function(t){return t instanceof Uu}:bu,xi=Wr(Sn),ji=Wr(function(t,n){return n>=t}),wi=_r(function(t,n){if(po||ee(n)||Ue(n))sr(n,iu(n),t);else for(var r in n)Wu.call(n,r)&&Yt(t,r,n[r])}),mi=_r(function(t,n){if(po||ee(n)||Ue(n))sr(n,fu(n),t);else for(var r in n)Yt(t,r,n[r]);
}),Ai=_r(function(t,n,r,e){sr(n,fu(n),t,e)}),Oi=_r(function(t,n,r,e){sr(n,iu(n),t,e)}),ki=Me(function(t,n){return tn(t,sn(n,1))}),Ei=Me(function(t){return t.push(T,Vt),r(Ai,T,t)}),Si=Me(function(t){return t.push(T,oe),r(Li,T,t)}),Ii=Or(function(t,n,r){t[n]=r},hu(pu)),Ri=Or(function(t,n,r){Wu.call(t,n)?t[n].push(r):t[n]=[r]},Fr),Wi=Me(wn),Bi=_r(function(t,n,r){Bn(t,n,r)}),Li=_r(function(t,n,r,e){Bn(t,n,r,e)}),Mi=Me(function(t,n){return null==t?{}:(n=l(sn(n,1),fe),Cn(t,fn(gn(t,fu,Bo),n)))}),Ci=Me(function(t,n){
return null==t?{}:Cn(t,l(sn(n,1),fe))}),zi=Mr(iu),Ui=Mr(fu),$i=br(function(t,n,r){return n=n.toLowerCase(),t+(r?au(n):n)}),Di=br(function(t,n,r){return t+(r?"-":"")+n.toLowerCase()}),Fi=br(function(t,n,r){return t+(r?" ":"")+n.toLowerCase()}),Ni=yr("toLowerCase"),Pi=br(function(t,n,r){return t+(r?"_":"")+n.toLowerCase()}),Zi=br(function(t,n,r){return t+(r?" ":"")+qi(n)}),Ti=br(function(t,n,r){return t+(r?" ":"")+n.toUpperCase()}),qi=yr("toUpperCase"),Vi=Me(function(t,n){try{return r(t,T,n)}catch(e){
return De(e)?e:new ju(e)}}),Ki=Me(function(t,n){return u(sn(n,1),function(n){n=fe(n),t[n]=ci(t[n],t)}),t}),Gi=mr(),Ji=mr(true),Yi=Me(function(t,n){return function(r){return wn(r,t,n)}}),Hi=Me(function(t,n){return function(r){return wn(t,r,n)}}),Qi=Er(l),Xi=Er(i),tf=Er(_),nf=Rr(),rf=Rr(true),ef=kr(function(t,n){return t+n}),uf=Lr("ceil"),of=kr(function(t,n){return t/n}),ff=Lr("floor"),cf=kr(function(t,n){return t*n}),af=Lr("round"),lf=kr(function(t,n){return t-n});return Ot.after=function(t,n){if(typeof n!="function")throw new Au("Expected a function");
return t=Xe(t),function(){return 1>--t?n.apply(this,arguments):void 0}},Ot.ary=Se,Ot.assign=wi,Ot.assignIn=mi,Ot.assignInWith=Ai,Ot.assignWith=Oi,Ot.at=ki,Ot.before=Ie,Ot.bind=ci,Ot.bindAll=Ki,Ot.bindKey=ai,Ot.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return yi(t)?t:[t]},Ot.chain=xe,Ot.chunk=function(t,n,r){if(n=(r?te(t,n,r):n===T)?1:Xu(Xe(n),0),r=t?t.length:0,!r||1>n)return[];for(var e=0,u=0,o=Array(Ku(r/n));r>e;)o[u++]=Tn(t,e,e+=n);return o},Ot.compact=function(t){for(var n=-1,r=t?t.length:0,e=0,u=[];++n<r;){
var o=t[n];o&&(u[e++]=o)}return u},Ot.concat=function(){for(var t=arguments.length,n=Array(t?t-1:0),r=arguments[0],e=t;e--;)n[e-1]=arguments[e];return t?s(yi(r)?lr(r):[r],sn(n,1)):[]},Ot.cond=function(t){var n=t?t.length:0,e=Fr();return t=n?l(t,function(t){if("function"!=typeof t[1])throw new Au("Expected a function");return[e(t[0]),t[1]]}):[],Me(function(e){for(var u=-1;++u<n;){var o=t[u];if(r(o[0],this,e))return r(o[1],this,e)}})},Ot.conforms=function(t){return en(rn(t,true))},Ot.constant=hu,Ot.countBy=ti,
Ot.create=function(t,n){var r=un(t);return n?Xt(r,n):r},Ot.curry=Re,Ot.curryRight=We,Ot.debounce=Be,Ot.defaults=Ei,Ot.defaultsDeep=Si,Ot.defer=li,Ot.delay=si,Ot.difference=zo,Ot.differenceBy=Uo,Ot.differenceWith=$o,Ot.drop=le,Ot.dropRight=se,Ot.dropRightWhile=function(t,n){return t&&t.length?Qn(t,Fr(n,3),true,true):[]},Ot.dropWhile=function(t,n){return t&&t.length?Qn(t,Fr(n,3),true):[]},Ot.fill=function(t,n,r,e){var u=t?t.length:0;if(!u)return[];for(r&&typeof r!="number"&&te(t,n,r)&&(r=0,e=u),u=t.length,
r=Xe(r),0>r&&(r=-r>u?0:u+r),e=e===T||e>u?u:Xe(e),0>e&&(e+=u),e=r>e?0:tu(e);e>r;)t[r++]=n;return t},Ot.filter=function(t,n){return(yi(t)?f:ln)(t,Fr(n,3))},Ot.flatMap=function(t,n){return sn(Oe(t,n),1)},Ot.flatMapDeep=function(t,n){return sn(Oe(t,n),q)},Ot.flatMapDepth=function(t,n,r){return r=r===T?1:Xe(r),sn(Oe(t,n),r)},Ot.flatten=function(t){return t&&t.length?sn(t,1):[]},Ot.flattenDeep=function(t){return t&&t.length?sn(t,q):[]},Ot.flattenDepth=function(t,n){return t&&t.length?(n=n===T?1:Xe(n),sn(t,n)):[];
},Ot.flip=function(t){return Cr(t,512)},Ot.flow=Gi,Ot.flowRight=Ji,Ot.fromPairs=function(t){for(var n=-1,r=t?t.length:0,e={};++n<r;){var u=t[n];e[u[0]]=u[1]}return e},Ot.functions=function(t){return null==t?[]:_n(t,iu(t))},Ot.functionsIn=function(t){return null==t?[]:_n(t,fu(t))},Ot.groupBy=ei,Ot.initial=function(t){return se(t,1)},Ot.intersection=Do,Ot.intersectionBy=Fo,Ot.intersectionWith=No,Ot.invert=Ii,Ot.invertBy=Ri,Ot.invokeMap=ui,Ot.iteratee=_u,Ot.keyBy=oi,Ot.keys=iu,Ot.keysIn=fu,Ot.map=Oe,
Ot.mapKeys=function(t,n){var r={};return n=Fr(n,3),hn(t,function(t,e,u){r[n(t,e,u)]=t}),r},Ot.mapValues=function(t,n){var r={};return n=Fr(n,3),hn(t,function(t,e,u){r[e]=n(t,e,u)}),r},Ot.matches=function(t){return Rn(rn(t,true))},Ot.matchesProperty=function(t,n){return Wn(t,rn(n,true))},Ot.memoize=Le,Ot.merge=Bi,Ot.mergeWith=Li,Ot.method=Yi,Ot.methodOf=Hi,Ot.mixin=vu,Ot.negate=function(t){if(typeof t!="function")throw new Au("Expected a function");return function(){return!t.apply(this,arguments)}},Ot.nthArg=function(t){
return t=Xe(t),Me(function(n){return Ln(n,t)})},Ot.omit=Mi,Ot.omitBy=function(t,n){return n=Fr(n),zn(t,function(t,r){return!n(t,r)})},Ot.once=function(t){return Ie(2,t)},Ot.orderBy=function(t,n,r,e){return null==t?[]:(yi(n)||(n=null==n?[]:[n]),r=e?T:r,yi(r)||(r=null==r?[]:[r]),Mn(t,n,r))},Ot.over=Qi,Ot.overArgs=hi,Ot.overEvery=Xi,Ot.overSome=tf,Ot.partial=pi,Ot.partialRight=_i,Ot.partition=ii,Ot.pick=Ci,Ot.pickBy=function(t,n){return null==t?{}:zn(t,Fr(n))},Ot.property=du,Ot.propertyOf=function(t){
return function(n){return null==t?T:vn(t,n)}},Ot.pull=Po,Ot.pullAll=ge,Ot.pullAllBy=function(t,n,r){return t&&t.length&&n&&n.length?Dn(t,n,Fr(r)):t},Ot.pullAllWith=function(t,n,r){return t&&t.length&&n&&n.length?Dn(t,n,T,r):t},Ot.pullAt=Zo,Ot.range=nf,Ot.rangeRight=rf,Ot.rearg=vi,Ot.reject=function(t,n){var r=yi(t)?f:ln;return n=Fr(n,3),r(t,function(t,r,e){return!n(t,r,e)})},Ot.remove=function(t,n){var r=[];if(!t||!t.length)return r;var e=-1,u=[],o=t.length;for(n=Fr(n,3);++e<o;){var i=t[e];n(i,e,t)&&(r.push(i),
u.push(e))}return Fn(t,u),r},Ot.rest=Me,Ot.reverse=de,Ot.sampleSize=ke,Ot.set=function(t,n,r){return null==t?t:Zn(t,n,r)},Ot.setWith=function(t,n,r,e){return e=typeof e=="function"?e:T,null==t?t:Zn(t,n,r,e)},Ot.shuffle=function(t){return ke(t,4294967295)},Ot.slice=function(t,n,r){var e=t?t.length:0;return e?(r&&typeof r!="number"&&te(t,n,r)?(n=0,r=e):(n=null==n?0:Xe(n),r=r===T?e:Xe(r)),Tn(t,n,r)):[]},Ot.sortBy=fi,Ot.sortedUniq=function(t){return t&&t.length?Gn(t):[]},Ot.sortedUniqBy=function(t,n){
return t&&t.length?Gn(t,Fr(n)):[]},Ot.split=function(t,n,r){return r&&typeof r!="number"&&te(t,n,r)&&(n=r=T),r=r===T?4294967295:r>>>0,r?(t=eu(t))&&(typeof n=="string"||null!=n&&!Ke(n))&&(n=Yn(n),""==n&&Wt.test(t))?ur(t.match(It),0,r):oo.call(t,n,r):[]},Ot.spread=function(t,n){if(typeof t!="function")throw new Au("Expected a function");return n=n===T?0:Xu(Xe(n),0),Me(function(e){var u=e[n];return e=ur(e,0,n),u&&s(e,u),r(t,this,e)})},Ot.tail=function(t){return le(t,1)},Ot.take=function(t,n,r){return t&&t.length?(n=r||n===T?1:Xe(n),
Tn(t,0,0>n?0:n)):[]},Ot.takeRight=function(t,n,r){var e=t?t.length:0;return e?(n=r||n===T?1:Xe(n),n=e-n,Tn(t,0>n?0:n,e)):[]},Ot.takeRightWhile=function(t,n){return t&&t.length?Qn(t,Fr(n,3),false,true):[]},Ot.takeWhile=function(t,n){return t&&t.length?Qn(t,Fr(n,3)):[]},Ot.tap=function(t,n){return n(t),t},Ot.throttle=function(t,n,r){var e=true,u=true;if(typeof t!="function")throw new Au("Expected a function");return Ze(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),Be(t,n,{leading:e,maxWait:n,
trailing:u})},Ot.thru=je,Ot.toArray=He,Ot.toPairs=zi,Ot.toPairsIn=Ui,Ot.toPath=function(t){return yi(t)?l(t,fe):Je(t)?[t]:lr(Co(t))},Ot.toPlainObject=ru,Ot.transform=function(t,n,r){var e=yi(t)||Ye(t);if(n=Fr(n,4),null==r)if(e||Ze(t)){var o=t.constructor;r=e?yi(t)?new o:[]:Fe(o)?un(Ju(Object(t))):{}}else r={};return(e?u:hn)(t,function(t,e,u){return n(r,t,e,u)}),r},Ot.unary=function(t){return Se(t,1)},Ot.union=To,Ot.unionBy=qo,Ot.unionWith=Vo,Ot.uniq=function(t){return t&&t.length?Hn(t):[]},Ot.uniqBy=function(t,n){
return t&&t.length?Hn(t,Fr(n)):[]},Ot.uniqWith=function(t,n){return t&&t.length?Hn(t,T,n):[]},Ot.unset=function(t,n){var r;if(null==t)r=true;else{r=t;var e=n,e=ne(e,r)?[e]:er(e);r=ie(r,e),e=fe(ve(e)),r=!(null!=r&&yn(r,e))||delete r[e]}return r},Ot.unzip=ye,Ot.unzipWith=be,Ot.update=function(t,n,r){return null==t?t:Zn(t,n,(typeof r=="function"?r:pu)(vn(t,n)),void 0)},Ot.updateWith=function(t,n,r,e){return e=typeof e=="function"?e:T,null!=t&&(t=Zn(t,n,(typeof r=="function"?r:pu)(vn(t,n)),e)),t},Ot.values=cu,
Ot.valuesIn=function(t){return null==t?[]:k(t,fu(t))},Ot.without=Ko,Ot.words=su,Ot.wrap=function(t,n){return n=null==n?pu:n,pi(n,t)},Ot.xor=Go,Ot.xorBy=Jo,Ot.xorWith=Yo,Ot.zip=Ho,Ot.zipObject=function(t,n){return nr(t||[],n||[],Yt)},Ot.zipObjectDeep=function(t,n){return nr(t||[],n||[],Zn)},Ot.zipWith=Qo,Ot.entries=zi,Ot.entriesIn=Ui,Ot.extend=mi,Ot.extendWith=Ai,vu(Ot,Ot),Ot.add=ef,Ot.attempt=Vi,Ot.camelCase=$i,Ot.capitalize=au,Ot.ceil=uf,Ot.clamp=function(t,n,r){return r===T&&(r=n,n=T),r!==T&&(r=nu(r),
r=r===r?r:0),n!==T&&(n=nu(n),n=n===n?n:0),nn(nu(t),n,r)},Ot.clone=function(t){return rn(t,false,true)},Ot.cloneDeep=function(t){return rn(t,true,true)},Ot.cloneDeepWith=function(t,n){return rn(t,true,true,n)},Ot.cloneWith=function(t,n){return rn(t,false,true,n)},Ot.deburr=lu,Ot.divide=of,Ot.endsWith=function(t,n,r){t=eu(t),n=Yn(n);var e=t.length;return r=r===T?e:nn(Xe(r),0,e),r-=n.length,r>=0&&t.indexOf(n,r)==r},Ot.eq=Ce,Ot.escape=function(t){return(t=eu(t))&&X.test(t)?t.replace(H,B):t},Ot.escapeRegExp=function(t){
return(t=eu(t))&&ft.test(t)?t.replace(it,"\\$&"):t},Ot.every=function(t,n,r){var e=yi(t)?i:cn;return r&&te(t,n,r)&&(n=T),e(t,Fr(n,3))},Ot.find=ni,Ot.findIndex=he,Ot.findKey=function(t,n){return v(t,Fr(n,3),hn)},Ot.findLast=ri,Ot.findLastIndex=pe,Ot.findLastKey=function(t,n){return v(t,Fr(n,3),pn)},Ot.floor=ff,Ot.forEach=me,Ot.forEachRight=Ae,Ot.forIn=function(t,n){return null==t?t:ko(t,Fr(n,3),fu)},Ot.forInRight=function(t,n){return null==t?t:Eo(t,Fr(n,3),fu)},Ot.forOwn=function(t,n){return t&&hn(t,Fr(n,3));
},Ot.forOwnRight=function(t,n){return t&&pn(t,Fr(n,3))},Ot.get=uu,Ot.gt=gi,Ot.gte=di,Ot.has=function(t,n){return null!=t&&Vr(t,n,yn)},Ot.hasIn=ou,Ot.head=_e,Ot.identity=pu,Ot.includes=function(t,n,r,e){return t=Ue(t)?t:cu(t),r=r&&!e?Xe(r):0,e=t.length,0>r&&(r=Xu(e+r,0)),Ge(t)?e>=r&&-1<t.indexOf(n,r):!!e&&-1<d(t,n,r)},Ot.indexOf=function(t,n,r){var e=t?t.length:0;return e?(r=null==r?0:Xe(r),0>r&&(r=Xu(e+r,0)),d(t,n,r)):-1},Ot.inRange=function(t,n,r){return n=nu(n)||0,r===T?(r=n,n=0):r=nu(r)||0,t=nu(t),
t>=to(n,r)&&t<Xu(n,r)},Ot.invoke=Wi,Ot.isArguments=ze,Ot.isArray=yi,Ot.isArrayBuffer=function(t){return Te(t)&&"[object ArrayBuffer]"==Mu.call(t)},Ot.isArrayLike=Ue,Ot.isArrayLikeObject=$e,Ot.isBoolean=function(t){return true===t||false===t||Te(t)&&"[object Boolean]"==Mu.call(t)},Ot.isBuffer=bi,Ot.isDate=function(t){return Te(t)&&"[object Date]"==Mu.call(t)},Ot.isElement=function(t){return!!t&&1===t.nodeType&&Te(t)&&!Ve(t)},Ot.isEmpty=function(t){if(Ue(t)&&(yi(t)||Ge(t)||Fe(t.splice)||ze(t)||bi(t)))return!t.length;
if(Te(t)){var n=qr(t);if("[object Map]"==n||"[object Set]"==n)return!t.size}for(var r in t)if(Wu.call(t,r))return false;return!(po&&iu(t).length)},Ot.isEqual=function(t,n){return mn(t,n)},Ot.isEqualWith=function(t,n,r){var e=(r=typeof r=="function"?r:T)?r(t,n):T;return e===T?mn(t,n,r):!!e},Ot.isError=De,Ot.isFinite=function(t){return typeof t=="number"&&Yu(t)},Ot.isFunction=Fe,Ot.isInteger=Ne,Ot.isLength=Pe,Ot.isMap=function(t){return Te(t)&&"[object Map]"==qr(t)},Ot.isMatch=function(t,n){return t===n||An(t,n,Pr(n));
},Ot.isMatchWith=function(t,n,r){return r=typeof r=="function"?r:T,An(t,n,Pr(n),r)},Ot.isNaN=function(t){return qe(t)&&t!=+t},Ot.isNative=function(t){if(Lo(t))throw new ju("This method is not supported with `core-js`. Try https://github.com/es-shims.");return On(t)},Ot.isNil=function(t){return null==t},Ot.isNull=function(t){return null===t},Ot.isNumber=qe,Ot.isObject=Ze,Ot.isObjectLike=Te,Ot.isPlainObject=Ve,Ot.isRegExp=Ke,Ot.isSafeInteger=function(t){return Ne(t)&&t>=-9007199254740991&&9007199254740991>=t;
},Ot.isSet=function(t){return Te(t)&&"[object Set]"==qr(t)},Ot.isString=Ge,Ot.isSymbol=Je,Ot.isTypedArray=Ye,Ot.isUndefined=function(t){return t===T},Ot.isWeakMap=function(t){return Te(t)&&"[object WeakMap]"==qr(t)},Ot.isWeakSet=function(t){return Te(t)&&"[object WeakSet]"==Mu.call(t)},Ot.join=function(t,n){return t?Hu.call(t,n):""},Ot.kebabCase=Di,Ot.last=ve,Ot.lastIndexOf=function(t,n,r){var e=t?t.length:0;if(!e)return-1;var u=e;if(r!==T&&(u=Xe(r),u=(0>u?Xu(e+u,0):to(u,e-1))+1),n!==n)return M(t,u-1,true);
for(;u--;)if(t[u]===n)return u;return-1},Ot.lowerCase=Fi,Ot.lowerFirst=Ni,Ot.lt=xi,Ot.lte=ji,Ot.max=function(t){return t&&t.length?an(t,pu,dn):T},Ot.maxBy=function(t,n){return t&&t.length?an(t,Fr(n),dn):T},Ot.mean=function(t){return b(t,pu)},Ot.meanBy=function(t,n){return b(t,Fr(n))},Ot.min=function(t){return t&&t.length?an(t,pu,Sn):T},Ot.minBy=function(t,n){return t&&t.length?an(t,Fr(n),Sn):T},Ot.stubArray=yu,Ot.stubFalse=bu,Ot.stubObject=function(){return{}},Ot.stubString=function(){return""},Ot.stubTrue=function(){
return true},Ot.multiply=cf,Ot.nth=function(t,n){return t&&t.length?Ln(t,Xe(n)):T},Ot.noConflict=function(){return Kt._===this&&(Kt._=Cu),this},Ot.noop=gu,Ot.now=Ee,Ot.pad=function(t,n,r){t=eu(t);var e=(n=Xe(n))?N(t):0;return!n||e>=n?t:(n=(n-e)/2,Sr(Gu(n),r)+t+Sr(Ku(n),r))},Ot.padEnd=function(t,n,r){t=eu(t);var e=(n=Xe(n))?N(t):0;return n&&n>e?t+Sr(n-e,r):t},Ot.padStart=function(t,n,r){t=eu(t);var e=(n=Xe(n))?N(t):0;return n&&n>e?Sr(n-e,r)+t:t},Ot.parseInt=function(t,n,r){return r||null==n?n=0:n&&(n=+n),
t=eu(t).replace(ct,""),no(t,n||(vt.test(t)?16:10))},Ot.random=function(t,n,r){if(r&&typeof r!="boolean"&&te(t,n,r)&&(n=r=T),r===T&&(typeof n=="boolean"?(r=n,n=T):typeof t=="boolean"&&(r=t,t=T)),t===T&&n===T?(t=0,n=1):(t=nu(t)||0,n===T?(n=t,t=0):n=nu(n)||0),t>n){var e=t;t=n,n=e}return r||t%1||n%1?(r=ro(),to(t+r*(n-t+Ft("1e-"+((r+"").length-1))),n)):Nn(t,n)},Ot.reduce=function(t,n,r){var e=yi(t)?h:x,u=3>arguments.length;return e(t,Fr(n,4),r,u,Ao)},Ot.reduceRight=function(t,n,r){var e=yi(t)?p:x,u=3>arguments.length;
return e(t,Fr(n,4),r,u,Oo)},Ot.repeat=function(t,n,r){return n=(r?te(t,n,r):n===T)?1:Xe(n),Pn(eu(t),n)},Ot.replace=function(){var t=arguments,n=eu(t[0]);return 3>t.length?n:eo.call(n,t[1],t[2])},Ot.result=function(t,n,r){n=ne(n,t)?[n]:er(n);var e=-1,u=n.length;for(u||(t=T,u=1);++e<u;){var o=null==t?T:t[fe(n[e])];o===T&&(e=u,o=r),t=Fe(o)?o.call(t):o}return t},Ot.round=af,Ot.runInContext=Z,Ot.sample=function(t){t=Ue(t)?t:cu(t);var n=t.length;return n>0?t[Nn(0,n-1)]:T},Ot.size=function(t){if(null==t)return 0;
if(Ue(t)){var n=t.length;return n&&Ge(t)?N(t):n}return Te(t)&&(n=qr(t),"[object Map]"==n||"[object Set]"==n)?t.size:iu(t).length},Ot.snakeCase=Pi,Ot.some=function(t,n,r){var e=yi(t)?_:qn;return r&&te(t,n,r)&&(n=T),e(t,Fr(n,3))},Ot.sortedIndex=function(t,n){return Vn(t,n)},Ot.sortedIndexBy=function(t,n,r){return Kn(t,n,Fr(r))},Ot.sortedIndexOf=function(t,n){var r=t?t.length:0;if(r){var e=Vn(t,n);if(r>e&&Ce(t[e],n))return e}return-1},Ot.sortedLastIndex=function(t,n){return Vn(t,n,true)},Ot.sortedLastIndexBy=function(t,n,r){
return Kn(t,n,Fr(r),true)},Ot.sortedLastIndexOf=function(t,n){if(t&&t.length){var r=Vn(t,n,true)-1;if(Ce(t[r],n))return r}return-1},Ot.startCase=Zi,Ot.startsWith=function(t,n,r){return t=eu(t),r=nn(Xe(r),0,t.length),t.lastIndexOf(Yn(n),r)==r},Ot.subtract=lf,Ot.sum=function(t){return t&&t.length?w(t,pu):0},Ot.sumBy=function(t,n){return t&&t.length?w(t,Fr(n)):0},Ot.template=function(t,n,r){var e=Ot.templateSettings;r&&te(t,n,r)&&(n=T),t=eu(t),n=Ai({},n,e,Vt),r=Ai({},n.imports,e.imports,Vt);var u,o,i=iu(r),f=k(r,i),c=0;
r=n.interpolate||wt;var a="__p+='";r=mu((n.escape||wt).source+"|"+r.source+"|"+(r===rt?pt:wt).source+"|"+(n.evaluate||wt).source+"|$","g");var l="sourceURL"in n?"//# sourceURL="+n.sourceURL+"\n":"";if(t.replace(r,function(n,r,e,i,f,l){return e||(e=i),a+=t.slice(c,l).replace(mt,L),r&&(u=true,a+="'+__e("+r+")+'"),f&&(o=true,a+="';"+f+";\n__p+='"),e&&(a+="'+((__t=("+e+"))==null?'':__t)+'"),c=l+n.length,n}),a+="';",(n=n.variable)||(a="with(obj){"+a+"}"),a=(o?a.replace(K,""):a).replace(G,"$1").replace(J,"$1;"),
a="function("+(n||"obj")+"){"+(n?"":"obj||(obj={});")+"var __t,__p=''"+(u?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+a+"return __p}",n=Vi(function(){return Function(i,l+"return "+a).apply(T,f)}),n.source=a,De(n))throw n;return n},Ot.times=function(t,n){if(t=Xe(t),1>t||t>9007199254740991)return[];var r=4294967295,e=to(t,4294967295);for(n=Fr(n),t-=4294967295,e=m(e,n);++r<t;)n(r);return e},Ot.toFinite=Qe,Ot.toInteger=Xe,Ot.toLength=tu,Ot.toLower=function(t){
return eu(t).toLowerCase()},Ot.toNumber=nu,Ot.toSafeInteger=function(t){return nn(Xe(t),-9007199254740991,9007199254740991)},Ot.toString=eu,Ot.toUpper=function(t){return eu(t).toUpperCase()},Ot.trim=function(t,n,r){return(t=eu(t))&&(r||n===T)?t.replace(ct,""):t&&(n=Yn(n))?(t=t.match(It),n=n.match(It),ur(t,S(t,n),I(t,n)+1).join("")):t},Ot.trimEnd=function(t,n,r){return(t=eu(t))&&(r||n===T)?t.replace(lt,""):t&&(n=Yn(n))?(t=t.match(It),n=I(t,n.match(It))+1,ur(t,0,n).join("")):t},Ot.trimStart=function(t,n,r){
return(t=eu(t))&&(r||n===T)?t.replace(at,""):t&&(n=Yn(n))?(t=t.match(It),n=S(t,n.match(It)),ur(t,n).join("")):t},Ot.truncate=function(t,n){var r=30,e="...";if(Ze(n))var u="separator"in n?n.separator:u,r="length"in n?Xe(n.length):r,e="omission"in n?Yn(n.omission):e;t=eu(t);var o=t.length;if(Wt.test(t))var i=t.match(It),o=i.length;if(r>=o)return t;if(o=r-N(e),1>o)return e;if(r=i?ur(i,0,o).join(""):t.slice(0,o),u===T)return r+e;if(i&&(o+=r.length-o),Ke(u)){if(t.slice(o).search(u)){var f=r;for(u.global||(u=mu(u.source,eu(_t.exec(u))+"g")),
u.lastIndex=0;i=u.exec(f);)var c=i.index;r=r.slice(0,c===T?o:c)}}else t.indexOf(Yn(u),o)!=o&&(u=r.lastIndexOf(u),u>-1&&(r=r.slice(0,u)));return r+e},Ot.unescape=function(t){return(t=eu(t))&&Q.test(t)?t.replace(Y,P):t},Ot.uniqueId=function(t){var n=++Bu;return eu(t)+n},Ot.upperCase=Ti,Ot.upperFirst=qi,Ot.each=me,Ot.eachRight=Ae,Ot.first=_e,vu(Ot,function(){var t={};return hn(Ot,function(n,r){Wu.call(Ot.prototype,r)||(t[r]=n)}),t}(),{chain:false}),Ot.VERSION="4.13.1",u("bind bindKey curry curryRight partial partialRight".split(" "),function(t){
Ot[t].placeholder=Ot}),u(["drop","take"],function(t,n){Ut.prototype[t]=function(r){var e=this.__filtered__;if(e&&!n)return new Ut(this);r=r===T?1:Xu(Xe(r),0);var u=this.clone();return e?u.__takeCount__=to(r,u.__takeCount__):u.__views__.push({size:to(r,4294967295),type:t+(0>u.__dir__?"Right":"")}),u},Ut.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),u(["filter","map","takeWhile"],function(t,n){var r=n+1,e=1==r||3==r;Ut.prototype[t]=function(t){var n=this.clone();return n.__iteratees__.push({
iteratee:Fr(t,3),type:r}),n.__filtered__=n.__filtered__||e,n}}),u(["head","last"],function(t,n){var r="take"+(n?"Right":"");Ut.prototype[t]=function(){return this[r](1).value()[0]}}),u(["initial","tail"],function(t,n){var r="drop"+(n?"":"Right");Ut.prototype[t]=function(){return this.__filtered__?new Ut(this):this[r](1)}}),Ut.prototype.compact=function(){return this.filter(pu)},Ut.prototype.find=function(t){return this.filter(t).head()},Ut.prototype.findLast=function(t){return this.reverse().find(t);
},Ut.prototype.invokeMap=Me(function(t,n){return typeof t=="function"?new Ut(this):this.map(function(r){return wn(r,t,n)})}),Ut.prototype.reject=function(t){return t=Fr(t,3),this.filter(function(n){return!t(n)})},Ut.prototype.slice=function(t,n){t=Xe(t);var r=this;return r.__filtered__&&(t>0||0>n)?new Ut(r):(0>t?r=r.takeRight(-t):t&&(r=r.drop(t)),n!==T&&(n=Xe(n),r=0>n?r.dropRight(-n):r.take(n-t)),r)},Ut.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ut.prototype.toArray=function(){
return this.take(4294967295)},hn(Ut.prototype,function(t,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),e=/^(?:head|last)$/.test(n),u=Ot[e?"take"+("last"==n?"Right":""):n],o=e||/^find/.test(n);u&&(Ot.prototype[n]=function(){function n(t){return t=u.apply(Ot,s([t],f)),e&&h?t[0]:t}var i=this.__wrapped__,f=e?[1]:arguments,c=i instanceof Ut,a=f[0],l=c||yi(i);l&&r&&typeof a=="function"&&1!=a.length&&(c=l=false);var h=this.__chain__,p=!!this.__actions__.length,a=o&&!h,c=c&&!p;return!o&&l?(i=c?i:new Ut(this),
i=t.apply(i,f),i.__actions__.push({func:je,args:[n],thisArg:T}),new zt(i,h)):a&&c?t.apply(this,f):(i=this.thru(n),a?e?i.value()[0]:i.value():i)})}),u("pop push shift sort splice unshift".split(" "),function(t){var n=Ou[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",e=/^(?:pop|shift)$/.test(t);Ot.prototype[t]=function(){var t=arguments;if(e&&!this.__chain__){var u=this.value();return n.apply(yi(u)?u:[],t)}return this[r](function(r){return n.apply(yi(r)?r:[],t)})}}),hn(Ut.prototype,function(t,n){
var r=Ot[n];if(r){var e=r.name+"";(_o[e]||(_o[e]=[])).push({name:n,func:r})}}),_o[Ar(T,2).name]=[{name:"wrapper",func:T}],Ut.prototype.clone=function(){var t=new Ut(this.__wrapped__);return t.__actions__=lr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=lr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=lr(this.__views__),t},Ut.prototype.reverse=function(){if(this.__filtered__){var t=new Ut(this);t.__dir__=-1,t.__filtered__=true}else t=this.clone(),
t.__dir__*=-1;return t},Ut.prototype.value=function(){var t,n=this.__wrapped__.value(),r=this.__dir__,e=yi(n),u=0>r,o=e?n.length:0;t=o;for(var i=this.__views__,f=0,c=-1,a=i.length;++c<a;){var l=i[c],s=l.size;switch(l.type){case"drop":f+=s;break;case"dropRight":t-=s;break;case"take":t=to(t,f+s);break;case"takeRight":f=Xu(f,t-s)}}if(t={start:f,end:t},i=t.start,f=t.end,t=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,c=0,a=to(t,this.__takeCount__),!e||200>o||o==t&&a==t)return Xn(n,this.__actions__);e=[];
t:for(;t--&&a>c;){for(u+=r,o=-1,l=n[u];++o<f;){var h=i[o],s=h.type,h=(0,h.iteratee)(l);if(2==s)l=h;else if(!h){if(1==s)continue t;break t}}e[c++]=l}return e},Ot.prototype.at=Xo,Ot.prototype.chain=function(){return xe(this)},Ot.prototype.commit=function(){return new zt(this.value(),this.__chain__)},Ot.prototype.next=function(){this.__values__===T&&(this.__values__=He(this.value()));var t=this.__index__>=this.__values__.length,n=t?T:this.__values__[this.__index__++];return{done:t,value:n}},Ot.prototype.plant=function(t){
for(var n,r=this;r instanceof kt;){var e=ae(r);e.__index__=0,e.__values__=T,n?u.__wrapped__=e:n=e;var u=e,r=r.__wrapped__}return u.__wrapped__=t,n},Ot.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof Ut?(this.__actions__.length&&(t=new Ut(this)),t=t.reverse(),t.__actions__.push({func:je,args:[de],thisArg:T}),new zt(t,this.__chain__)):this.thru(de)},Ot.prototype.toJSON=Ot.prototype.valueOf=Ot.prototype.value=function(){return Xn(this.__wrapped__,this.__actions__)},Zu&&(Ot.prototype[Zu]=we),
Ot}var T,q=1/0,V=NaN,K=/\b__p\+='';/g,G=/\b(__p\+=)''\+/g,J=/(__e\(.*?\)|\b__t\))\+'';/g,Y=/&(?:amp|lt|gt|quot|#39|#96);/g,H=/[&<>"'`]/g,Q=RegExp(Y.source),X=RegExp(H.source),tt=/<%-([\s\S]+?)%>/g,nt=/<%([\s\S]+?)%>/g,rt=/<%=([\s\S]+?)%>/g,et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ut=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,it=/[\\^$.*+?()[\]{}|]/g,ft=RegExp(it.source),ct=/^\s+|\s+$/g,at=/^\s+/,lt=/\s+$/,st=/[a-zA-Z0-9]+/g,ht=/\\(\\)?/g,pt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_t=/\w*$/,vt=/^0x/i,gt=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,yt=/^\[object .+?Constructor\]$/,bt=/^0o[0-7]+$/i,xt=/^(?:0|[1-9]\d*)$/,jt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,wt=/($^)/,mt=/['\n\r\u2028\u2029\\]/g,At="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",Ot="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+At,kt="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",Et=RegExp("['\u2019]","g"),St=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),It=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+kt+At,"g"),Rt=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\\d+",Ot].join("|"),"g"),Wt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Bt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Lt="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ isFinite parseInt setTimeout".split(" "),Mt={};
Mt["[object Float32Array]"]=Mt["[object Float64Array]"]=Mt["[object Int8Array]"]=Mt["[object Int16Array]"]=Mt["[object Int32Array]"]=Mt["[object Uint8Array]"]=Mt["[object Uint8ClampedArray]"]=Mt["[object Uint16Array]"]=Mt["[object Uint32Array]"]=true,Mt["[object Arguments]"]=Mt["[object Array]"]=Mt["[object ArrayBuffer]"]=Mt["[object Boolean]"]=Mt["[object DataView]"]=Mt["[object Date]"]=Mt["[object Error]"]=Mt["[object Function]"]=Mt["[object Map]"]=Mt["[object Number]"]=Mt["[object Object]"]=Mt["[object RegExp]"]=Mt["[object Set]"]=Mt["[object String]"]=Mt["[object WeakMap]"]=false;
var Ct={};Ct["[object Arguments]"]=Ct["[object Array]"]=Ct["[object ArrayBuffer]"]=Ct["[object DataView]"]=Ct["[object Boolean]"]=Ct["[object Date]"]=Ct["[object Float32Array]"]=Ct["[object Float64Array]"]=Ct["[object Int8Array]"]=Ct["[object Int16Array]"]=Ct["[object Int32Array]"]=Ct["[object Map]"]=Ct["[object Number]"]=Ct["[object Object]"]=Ct["[object RegExp]"]=Ct["[object Set]"]=Ct["[object String]"]=Ct["[object Symbol]"]=Ct["[object Uint8Array]"]=Ct["[object Uint8ClampedArray]"]=Ct["[object Uint16Array]"]=Ct["[object Uint32Array]"]=true,
Ct["[object Error]"]=Ct["[object Function]"]=Ct["[object WeakMap]"]=false;var zt={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O",
"\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss"},Ut={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},$t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Dt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ft=parseFloat,Nt=parseInt,Pt=typeof exports=="object"&&exports,Zt=Pt&&typeof module=="object"&&module,Tt=Zt&&Zt.exports===Pt,qt=R(typeof self=="object"&&self),Vt=R(typeof this=="object"&&this),Kt=R(typeof global=="object"&&global)||qt||Vt||Function("return this")(),Gt=Z();
(qt||{})._=Gt,typeof define=="function"&&typeof define.amd=="object"&&define.amd? define(function(){return Gt}):Zt?((Zt.exports=Gt)._=Gt,Pt._=Gt):Kt._=Gt}).call(this);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJsb2Rhc2gubWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBsb2Rhc2ggbG9kYXNoLmNvbS9saWNlbnNlIHwgVW5kZXJzY29yZS5qcyAxLjguMyB1bmRlcnNjb3JlanMub3JnL0xJQ0VOU0VcclxuICovXHJcbjsoZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsbil7cmV0dXJuIHQuc2V0KG5bMF0sblsxXSksdH1mdW5jdGlvbiBuKHQsbil7cmV0dXJuIHQuYWRkKG4pLHR9ZnVuY3Rpb24gcih0LG4scil7c3dpdGNoKHIubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIHQuY2FsbChuKTtjYXNlIDE6cmV0dXJuIHQuY2FsbChuLHJbMF0pO2Nhc2UgMjpyZXR1cm4gdC5jYWxsKG4sclswXSxyWzFdKTtjYXNlIDM6cmV0dXJuIHQuY2FsbChuLHJbMF0sclsxXSxyWzJdKX1yZXR1cm4gdC5hcHBseShuLHIpfWZ1bmN0aW9uIGUodCxuLHIsZSl7Zm9yKHZhciB1PS0xLG89dD90Lmxlbmd0aDowOysrdTxvOyl7dmFyIGk9dFt1XTtuKGUsaSxyKGkpLHQpfXJldHVybiBlfWZ1bmN0aW9uIHUodCxuKXtmb3IodmFyIHI9LTEsZT10P3QubGVuZ3RoOjA7KytyPGUmJmZhbHNlIT09bih0W3JdLHIsdCk7KTtyZXR1cm4gdH1mdW5jdGlvbiBvKHQsbil7Zm9yKHZhciByPXQ/dC5sZW5ndGg6MDtyLS0mJmZhbHNlIT09bih0W3JdLHIsdCk7KTtcclxucmV0dXJuIHR9ZnVuY3Rpb24gaSh0LG4pe2Zvcih2YXIgcj0tMSxlPXQ/dC5sZW5ndGg6MDsrK3I8ZTspaWYoIW4odFtyXSxyLHQpKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX1mdW5jdGlvbiBmKHQsbil7Zm9yKHZhciByPS0xLGU9dD90Lmxlbmd0aDowLHU9MCxvPVtdOysrcjxlOyl7dmFyIGk9dFtyXTtuKGkscix0KSYmKG9bdSsrXT1pKX1yZXR1cm4gb31mdW5jdGlvbiBjKHQsbil7cmV0dXJuISghdHx8IXQubGVuZ3RoKSYmLTE8ZCh0LG4sMCl9ZnVuY3Rpb24gYSh0LG4scil7Zm9yKHZhciBlPS0xLHU9dD90Lmxlbmd0aDowOysrZTx1OylpZihyKG4sdFtlXSkpcmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlfWZ1bmN0aW9uIGwodCxuKXtmb3IodmFyIHI9LTEsZT10P3QubGVuZ3RoOjAsdT1BcnJheShlKTsrK3I8ZTspdVtyXT1uKHRbcl0scix0KTtyZXR1cm4gdX1mdW5jdGlvbiBzKHQsbil7Zm9yKHZhciByPS0xLGU9bi5sZW5ndGgsdT10Lmxlbmd0aDsrK3I8ZTspdFt1K3JdPW5bcl07cmV0dXJuIHR9ZnVuY3Rpb24gaCh0LG4scixlKXtcclxudmFyIHU9LTEsbz10P3QubGVuZ3RoOjA7Zm9yKGUmJm8mJihyPXRbKyt1XSk7Kyt1PG87KXI9bihyLHRbdV0sdSx0KTtyZXR1cm4gcn1mdW5jdGlvbiBwKHQsbixyLGUpe3ZhciB1PXQ/dC5sZW5ndGg6MDtmb3IoZSYmdSYmKHI9dFstLXVdKTt1LS07KXI9bihyLHRbdV0sdSx0KTtyZXR1cm4gcn1mdW5jdGlvbiBfKHQsbil7Zm9yKHZhciByPS0xLGU9dD90Lmxlbmd0aDowOysrcjxlOylpZihuKHRbcl0scix0KSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2V9ZnVuY3Rpb24gdih0LG4scil7dmFyIGU7cmV0dXJuIHIodCxmdW5jdGlvbih0LHIsdSl7cmV0dXJuIG4odCxyLHUpPyhlPXIsZmFsc2UpOnZvaWQgMH0pLGV9ZnVuY3Rpb24gZyh0LG4scixlKXt2YXIgdT10Lmxlbmd0aDtmb3Iocis9ZT8xOi0xO2U/ci0tOisrcjx1OylpZihuKHRbcl0scix0KSlyZXR1cm4gcjtyZXR1cm4tMX1mdW5jdGlvbiBkKHQsbixyKXtpZihuIT09bilyZXR1cm4gTSh0LHIpOy0tcjtmb3IodmFyIGU9dC5sZW5ndGg7KytyPGU7KWlmKHRbcl09PT1uKXJldHVybiByO1xyXG5yZXR1cm4tMX1mdW5jdGlvbiB5KHQsbixyLGUpey0tcjtmb3IodmFyIHU9dC5sZW5ndGg7KytyPHU7KWlmKGUodFtyXSxuKSlyZXR1cm4gcjtyZXR1cm4tMX1mdW5jdGlvbiBiKHQsbil7dmFyIHI9dD90Lmxlbmd0aDowO3JldHVybiByP3codCxuKS9yOlZ9ZnVuY3Rpb24geCh0LG4scixlLHUpe3JldHVybiB1KHQsZnVuY3Rpb24odCx1LG8pe3I9ZT8oZT1mYWxzZSx0KTpuKHIsdCx1LG8pfSkscn1mdW5jdGlvbiBqKHQsbil7dmFyIHI9dC5sZW5ndGg7Zm9yKHQuc29ydChuKTtyLS07KXRbcl09dFtyXS5jO3JldHVybiB0fWZ1bmN0aW9uIHcodCxuKXtmb3IodmFyIHIsZT0tMSx1PXQubGVuZ3RoOysrZTx1Oyl7dmFyIG89bih0W2VdKTtvIT09VCYmKHI9cj09PVQ/bzpyK28pfXJldHVybiByfWZ1bmN0aW9uIG0odCxuKXtmb3IodmFyIHI9LTEsZT1BcnJheSh0KTsrK3I8dDspZVtyXT1uKHIpO3JldHVybiBlfWZ1bmN0aW9uIEEodCxuKXtyZXR1cm4gbChuLGZ1bmN0aW9uKG4pe3JldHVybltuLHRbbl1dO1xyXG59KX1mdW5jdGlvbiBPKHQpe3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gdChuKX19ZnVuY3Rpb24gayh0LG4pe3JldHVybiBsKG4sZnVuY3Rpb24obil7cmV0dXJuIHRbbl19KX1mdW5jdGlvbiBFKHQsbil7cmV0dXJuIHQuaGFzKG4pfWZ1bmN0aW9uIFModCxuKXtmb3IodmFyIHI9LTEsZT10Lmxlbmd0aDsrK3I8ZSYmLTE8ZChuLHRbcl0sMCk7KTtyZXR1cm4gcn1mdW5jdGlvbiBJKHQsbil7Zm9yKHZhciByPXQubGVuZ3RoO3ItLSYmLTE8ZChuLHRbcl0sMCk7KTtyZXR1cm4gcn1mdW5jdGlvbiBSKHQpe3JldHVybiB0JiZ0Lk9iamVjdD09PU9iamVjdD90Om51bGx9ZnVuY3Rpb24gVyh0KXtyZXR1cm4genRbdF19ZnVuY3Rpb24gQih0KXtyZXR1cm4gVXRbdF19ZnVuY3Rpb24gTCh0KXtyZXR1cm5cIlxcXFxcIitEdFt0XX1mdW5jdGlvbiBNKHQsbixyKXt2YXIgZT10Lmxlbmd0aDtmb3Iobis9cj8xOi0xO3I/bi0tOisrbjxlOyl7dmFyIHU9dFtuXTtpZih1IT09dSlyZXR1cm4gbn1yZXR1cm4tMTtcclxufWZ1bmN0aW9uIEModCl7dmFyIG49ZmFsc2U7aWYobnVsbCE9dCYmdHlwZW9mIHQudG9TdHJpbmchPVwiZnVuY3Rpb25cIil0cnl7bj0hISh0K1wiXCIpfWNhdGNoKHIpe31yZXR1cm4gbn1mdW5jdGlvbiB6KHQpe2Zvcih2YXIgbixyPVtdOyEobj10Lm5leHQoKSkuZG9uZTspci5wdXNoKG4udmFsdWUpO3JldHVybiByfWZ1bmN0aW9uIFUodCl7dmFyIG49LTEscj1BcnJheSh0LnNpemUpO3JldHVybiB0LmZvckVhY2goZnVuY3Rpb24odCxlKXtyWysrbl09W2UsdF19KSxyfWZ1bmN0aW9uICQodCxuKXtmb3IodmFyIHI9LTEsZT10Lmxlbmd0aCx1PTAsbz1bXTsrK3I8ZTspe3ZhciBpPXRbcl07aSE9PW4mJlwiX19sb2Rhc2hfcGxhY2Vob2xkZXJfX1wiIT09aXx8KHRbcl09XCJfX2xvZGFzaF9wbGFjZWhvbGRlcl9fXCIsb1t1KytdPXIpfXJldHVybiBvfWZ1bmN0aW9uIEQodCl7dmFyIG49LTEscj1BcnJheSh0LnNpemUpO3JldHVybiB0LmZvckVhY2goZnVuY3Rpb24odCl7clsrK25dPXR9KSxyfWZ1bmN0aW9uIEYodCl7XHJcbnZhciBuPS0xLHI9QXJyYXkodC5zaXplKTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3JbKytuXT1bdCx0XX0pLHJ9ZnVuY3Rpb24gTih0KXtpZighdHx8IVd0LnRlc3QodCkpcmV0dXJuIHQubGVuZ3RoO2Zvcih2YXIgbj1JdC5sYXN0SW5kZXg9MDtJdC50ZXN0KHQpOyluKys7cmV0dXJuIG59ZnVuY3Rpb24gUCh0KXtyZXR1cm4gJHRbdF19ZnVuY3Rpb24gWihSKXtmdW5jdGlvbiBBdCh0LG4pe3JldHVybiBSLnNldFRpbWVvdXQuY2FsbChLdCx0LG4pfWZ1bmN0aW9uIE90KHQpe2lmKFRlKHQpJiYheWkodCkmJiEodCBpbnN0YW5jZW9mIFV0KSl7aWYodCBpbnN0YW5jZW9mIHp0KXJldHVybiB0O2lmKFd1LmNhbGwodCxcIl9fd3JhcHBlZF9fXCIpKXJldHVybiBhZSh0KX1yZXR1cm4gbmV3IHp0KHQpfWZ1bmN0aW9uIGt0KCl7fWZ1bmN0aW9uIHp0KHQsbil7dGhpcy5fX3dyYXBwZWRfXz10LHRoaXMuX19hY3Rpb25zX189W10sdGhpcy5fX2NoYWluX189ISFuLHRoaXMuX19pbmRleF9fPTAsXHJcbnRoaXMuX192YWx1ZXNfXz1UfWZ1bmN0aW9uIFV0KHQpe3RoaXMuX193cmFwcGVkX189dCx0aGlzLl9fYWN0aW9uc19fPVtdLHRoaXMuX19kaXJfXz0xLHRoaXMuX19maWx0ZXJlZF9fPWZhbHNlLHRoaXMuX19pdGVyYXRlZXNfXz1bXSx0aGlzLl9fdGFrZUNvdW50X189NDI5NDk2NzI5NSx0aGlzLl9fdmlld3NfXz1bXX1mdW5jdGlvbiAkdCh0KXt2YXIgbj0tMSxyPXQ/dC5sZW5ndGg6MDtmb3IodGhpcy5jbGVhcigpOysrbjxyOyl7dmFyIGU9dFtuXTt0aGlzLnNldChlWzBdLGVbMV0pfX1mdW5jdGlvbiBEdCh0KXt2YXIgbj0tMSxyPXQ/dC5sZW5ndGg6MDtmb3IodGhpcy5jbGVhcigpOysrbjxyOyl7dmFyIGU9dFtuXTt0aGlzLnNldChlWzBdLGVbMV0pfX1mdW5jdGlvbiBQdCh0KXt2YXIgbj0tMSxyPXQ/dC5sZW5ndGg6MDtmb3IodGhpcy5jbGVhcigpOysrbjxyOyl7dmFyIGU9dFtuXTt0aGlzLnNldChlWzBdLGVbMV0pfX1mdW5jdGlvbiBadCh0KXt2YXIgbj0tMSxyPXQ/dC5sZW5ndGg6MDtcclxuZm9yKHRoaXMuX19kYXRhX189bmV3IFB0OysrbjxyOyl0aGlzLmFkZCh0W25dKX1mdW5jdGlvbiBxdCh0KXt0aGlzLl9fZGF0YV9fPW5ldyBEdCh0KX1mdW5jdGlvbiBWdCh0LG4scixlKXtyZXR1cm4gdD09PVR8fENlKHQsa3Vbcl0pJiYhV3UuY2FsbChlLHIpP246dH1mdW5jdGlvbiBKdCh0LG4scil7KHI9PT1UfHxDZSh0W25dLHIpKSYmKHR5cGVvZiBuIT1cIm51bWJlclwifHxyIT09VHx8biBpbiB0KXx8KHRbbl09cil9ZnVuY3Rpb24gWXQodCxuLHIpe3ZhciBlPXRbbl07V3UuY2FsbCh0LG4pJiZDZShlLHIpJiYociE9PVR8fG4gaW4gdCl8fCh0W25dPXIpfWZ1bmN0aW9uIEh0KHQsbil7Zm9yKHZhciByPXQubGVuZ3RoO3ItLTspaWYoQ2UodFtyXVswXSxuKSlyZXR1cm4gcjtyZXR1cm4tMX1mdW5jdGlvbiBRdCh0LG4scixlKXtyZXR1cm4gQW8odCxmdW5jdGlvbih0LHUsbyl7bihlLHQscih0KSxvKX0pLGV9ZnVuY3Rpb24gWHQodCxuKXtyZXR1cm4gdCYmc3IobixpdShuKSx0KX1cclxuZnVuY3Rpb24gdG4odCxuKXtmb3IodmFyIHI9LTEsZT1udWxsPT10LHU9bi5sZW5ndGgsbz1BcnJheSh1KTsrK3I8dTspb1tyXT1lP1Q6dXUodCxuW3JdKTtyZXR1cm4gb31mdW5jdGlvbiBubih0LG4scil7cmV0dXJuIHQ9PT10JiYociE9PVQmJih0PXI+PXQ/dDpyKSxuIT09VCYmKHQ9dD49bj90Om4pKSx0fWZ1bmN0aW9uIHJuKHQsbixyLGUsbyxpLGYpe3ZhciBjO2lmKGUmJihjPWk/ZSh0LG8saSxmKTplKHQpKSxjIT09VClyZXR1cm4gYztpZighWmUodCkpcmV0dXJuIHQ7aWYobz15aSh0KSl7aWYoYz1Lcih0KSwhbilyZXR1cm4gbHIodCxjKX1lbHNle3ZhciBhPXFyKHQpLGw9XCJbb2JqZWN0IEZ1bmN0aW9uXVwiPT1hfHxcIltvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dXCI9PWE7aWYoYmkodCkpcmV0dXJuIG9yKHQsbik7aWYoXCJbb2JqZWN0IE9iamVjdF1cIj09YXx8XCJbb2JqZWN0IEFyZ3VtZW50c11cIj09YXx8bCYmIWkpe2lmKEModCkpcmV0dXJuIGk/dDp7fTtpZihjPUdyKGw/e306dCksXHJcbiFuKXJldHVybiBocih0LFh0KGMsdCkpfWVsc2V7aWYoIUN0W2FdKXJldHVybiBpP3Q6e307Yz1Kcih0LGEscm4sbil9fWlmKGZ8fChmPW5ldyBxdCksaT1mLmdldCh0KSlyZXR1cm4gaTtpZihmLnNldCh0LGMpLCFvKXZhciBzPXI/Z24odCxpdSxUcik6aXUodCk7cmV0dXJuIHUoc3x8dCxmdW5jdGlvbih1LG8pe3MmJihvPXUsdT10W29dKSxZdChjLG8scm4odSxuLHIsZSxvLHQsZikpfSksY31mdW5jdGlvbiBlbih0KXt2YXIgbj1pdSh0KSxyPW4ubGVuZ3RoO3JldHVybiBmdW5jdGlvbihlKXtpZihudWxsPT1lKXJldHVybiFyO2Zvcih2YXIgdT1yO3UtLTspe3ZhciBvPW5bdV0saT10W29dLGY9ZVtvXTtpZihmPT09VCYmIShvIGluIE9iamVjdChlKSl8fCFpKGYpKXJldHVybiBmYWxzZX1yZXR1cm4gdHJ1ZX19ZnVuY3Rpb24gdW4odCl7cmV0dXJuIFplKHQpP1R1KHQpOnt9fWZ1bmN0aW9uIG9uKHQsbixyKXtpZih0eXBlb2YgdCE9XCJmdW5jdGlvblwiKXRocm93IG5ldyBBdShcIkV4cGVjdGVkIGEgZnVuY3Rpb25cIik7XHJcbnJldHVybiBBdChmdW5jdGlvbigpe3QuYXBwbHkoVCxyKX0sbil9ZnVuY3Rpb24gZm4odCxuLHIsZSl7dmFyIHU9LTEsbz1jLGk9dHJ1ZSxmPXQubGVuZ3RoLHM9W10saD1uLmxlbmd0aDtpZighZilyZXR1cm4gcztyJiYobj1sKG4sTyhyKSkpLGU/KG89YSxpPWZhbHNlKTpuLmxlbmd0aD49MjAwJiYobz1FLGk9ZmFsc2Usbj1uZXcgWnQobikpO3Q6Zm9yKDsrK3U8Zjspe3ZhciBwPXRbdV0sXz1yP3IocCk6cCxwPWV8fDAhPT1wP3A6MDtpZihpJiZfPT09Xyl7Zm9yKHZhciB2PWg7di0tOylpZihuW3ZdPT09Xyljb250aW51ZSB0O3MucHVzaChwKX1lbHNlIG8obixfLGUpfHxzLnB1c2gocCl9cmV0dXJuIHN9ZnVuY3Rpb24gY24odCxuKXt2YXIgcj10cnVlO3JldHVybiBBbyh0LGZ1bmN0aW9uKHQsZSx1KXtyZXR1cm4gcj0hIW4odCxlLHUpfSkscn1mdW5jdGlvbiBhbih0LG4scil7Zm9yKHZhciBlPS0xLHU9dC5sZW5ndGg7KytlPHU7KXt2YXIgbz10W2VdLGk9bihvKTtpZihudWxsIT1pJiYoZj09PVQ/aT09PWkmJiFKZShpKTpyKGksZikpKXZhciBmPWksYz1vO1xyXG59cmV0dXJuIGN9ZnVuY3Rpb24gbG4odCxuKXt2YXIgcj1bXTtyZXR1cm4gQW8odCxmdW5jdGlvbih0LGUsdSl7bih0LGUsdSkmJnIucHVzaCh0KX0pLHJ9ZnVuY3Rpb24gc24odCxuLHIsZSx1KXt2YXIgbz0tMSxpPXQubGVuZ3RoO2ZvcihyfHwocj1IciksdXx8KHU9W10pOysrbzxpOyl7dmFyIGY9dFtvXTtuPjAmJnIoZik/bj4xP3NuKGYsbi0xLHIsZSx1KTpzKHUsZik6ZXx8KHVbdS5sZW5ndGhdPWYpfXJldHVybiB1fWZ1bmN0aW9uIGhuKHQsbil7cmV0dXJuIHQmJmtvKHQsbixpdSl9ZnVuY3Rpb24gcG4odCxuKXtyZXR1cm4gdCYmRW8odCxuLGl1KX1mdW5jdGlvbiBfbih0LG4pe3JldHVybiBmKG4sZnVuY3Rpb24obil7cmV0dXJuIEZlKHRbbl0pfSl9ZnVuY3Rpb24gdm4odCxuKXtuPW5lKG4sdCk/W25dOmVyKG4pO2Zvcih2YXIgcj0wLGU9bi5sZW5ndGg7bnVsbCE9dCYmZT5yOyl0PXRbZmUobltyKytdKV07cmV0dXJuIHImJnI9PWU/dDpUfWZ1bmN0aW9uIGduKHQsbixyKXtcclxucmV0dXJuIG49bih0KSx5aSh0KT9uOnMobixyKHQpKX1mdW5jdGlvbiBkbih0LG4pe3JldHVybiB0Pm59ZnVuY3Rpb24geW4odCxuKXtyZXR1cm4gbnVsbCE9dCYmKFd1LmNhbGwodCxuKXx8dHlwZW9mIHQ9PVwib2JqZWN0XCImJm4gaW4gdCYmbnVsbD09PUp1KE9iamVjdCh0KSkpfWZ1bmN0aW9uIGJuKHQsbil7cmV0dXJuIG51bGwhPXQmJm4gaW4gT2JqZWN0KHQpfWZ1bmN0aW9uIHhuKHQsbixyKXtmb3IodmFyIGU9cj9hOmMsdT10WzBdLmxlbmd0aCxvPXQubGVuZ3RoLGk9byxmPUFycmF5KG8pLHM9MS8wLGg9W107aS0tOyl7dmFyIHA9dFtpXTtpJiZuJiYocD1sKHAsTyhuKSkpLHM9dG8ocC5sZW5ndGgscyksZltpXT0hciYmKG58fHU+PTEyMCYmcC5sZW5ndGg+PTEyMCk/bmV3IFp0KGkmJnApOlR9dmFyIHA9dFswXSxfPS0xLHY9ZlswXTt0OmZvcig7KytfPHUmJnM+aC5sZW5ndGg7KXt2YXIgZz1wW19dLGQ9bj9uKGcpOmcsZz1yfHwwIT09Zz9nOjA7aWYodj8hRSh2LGQpOiFlKGgsZCxyKSl7XHJcbmZvcihpPW87LS1pOyl7dmFyIHk9ZltpXTtpZih5PyFFKHksZCk6IWUodFtpXSxkLHIpKWNvbnRpbnVlIHR9diYmdi5wdXNoKGQpLGgucHVzaChnKX19cmV0dXJuIGh9ZnVuY3Rpb24gam4odCxuLHIpe3ZhciBlPXt9O3JldHVybiBobih0LGZ1bmN0aW9uKHQsdSxvKXtuKGUscih0KSx1LG8pfSksZX1mdW5jdGlvbiB3bih0LG4sZSl7cmV0dXJuIG5lKG4sdCl8fChuPWVyKG4pLHQ9aWUodCxuKSxuPXZlKG4pKSxuPW51bGw9PXQ/dDp0W2ZlKG4pXSxudWxsPT1uP1Q6cihuLHQsZSl9ZnVuY3Rpb24gbW4odCxuLHIsZSx1KXtpZih0PT09biluPXRydWU7ZWxzZSBpZihudWxsPT10fHxudWxsPT1ufHwhWmUodCkmJiFUZShuKSluPXQhPT10JiZuIT09bjtlbHNlIHQ6e3ZhciBvPXlpKHQpLGk9eWkobiksZj1cIltvYmplY3QgQXJyYXldXCIsYz1cIltvYmplY3QgQXJyYXldXCI7b3x8KGY9cXIodCksZj1cIltvYmplY3QgQXJndW1lbnRzXVwiPT1mP1wiW29iamVjdCBPYmplY3RdXCI6ZiksaXx8KGM9cXIobiksXHJcbmM9XCJbb2JqZWN0IEFyZ3VtZW50c11cIj09Yz9cIltvYmplY3QgT2JqZWN0XVwiOmMpO3ZhciBhPVwiW29iamVjdCBPYmplY3RdXCI9PWYmJiFDKHQpLGk9XCJbb2JqZWN0IE9iamVjdF1cIj09YyYmIUMobik7aWYoKGM9Zj09YykmJiFhKXV8fCh1PW5ldyBxdCksbj1vfHxZZSh0KT96cih0LG4sbW4scixlLHUpOlVyKHQsbixmLG1uLHIsZSx1KTtlbHNle2lmKCEoMiZlKSYmKG89YSYmV3UuY2FsbCh0LFwiX193cmFwcGVkX19cIiksZj1pJiZXdS5jYWxsKG4sXCJfX3dyYXBwZWRfX1wiKSxvfHxmKSl7dD1vP3QudmFsdWUoKTp0LG49Zj9uLnZhbHVlKCk6bix1fHwodT1uZXcgcXQpLG49bW4odCxuLHIsZSx1KTticmVhayB0fWlmKGMpbjppZih1fHwodT1uZXcgcXQpLG89MiZlLGY9aXUodCksaT1mLmxlbmd0aCxjPWl1KG4pLmxlbmd0aCxpPT1jfHxvKXtmb3IoYT1pO2EtLTspe3ZhciBsPWZbYV07aWYoIShvP2wgaW4gbjp5bihuLGwpKSl7bj1mYWxzZTticmVhayBufX1pZihjPXUuZ2V0KHQpKW49Yz09bjtlbHNle1xyXG5jPXRydWUsdS5zZXQodCxuKTtmb3IodmFyIHM9bzsrK2E8aTspe3ZhciBsPWZbYV0saD10W2xdLHA9bltsXTtpZihyKXZhciBfPW8/cihwLGgsbCxuLHQsdSk6cihoLHAsbCx0LG4sdSk7aWYoXz09PVQ/aCE9PXAmJiFtbihoLHAscixlLHUpOiFfKXtjPWZhbHNlO2JyZWFrfXN8fChzPVwiY29uc3RydWN0b3JcIj09bCl9YyYmIXMmJihyPXQuY29uc3RydWN0b3IsZT1uLmNvbnN0cnVjdG9yLHIhPWUmJlwiY29uc3RydWN0b3JcImluIHQmJlwiY29uc3RydWN0b3JcImluIG4mJiEodHlwZW9mIHI9PVwiZnVuY3Rpb25cIiYmciBpbnN0YW5jZW9mIHImJnR5cGVvZiBlPT1cImZ1bmN0aW9uXCImJmUgaW5zdGFuY2VvZiBlKSYmKGM9ZmFsc2UpKSx1W1wiZGVsZXRlXCJdKHQpLG49Y319ZWxzZSBuPWZhbHNlO2Vsc2Ugbj1mYWxzZX19cmV0dXJuIG59ZnVuY3Rpb24gQW4odCxuLHIsZSl7dmFyIHU9ci5sZW5ndGgsbz11LGk9IWU7aWYobnVsbD09dClyZXR1cm4hbztmb3IodD1PYmplY3QodCk7dS0tOyl7dmFyIGY9clt1XTtpZihpJiZmWzJdP2ZbMV0hPT10W2ZbMF1dOiEoZlswXWluIHQpKXJldHVybiBmYWxzZTtcclxufWZvcig7Kyt1PG87KXt2YXIgZj1yW3VdLGM9ZlswXSxhPXRbY10sbD1mWzFdO2lmKGkmJmZbMl0pe2lmKGE9PT1UJiYhKGMgaW4gdCkpcmV0dXJuIGZhbHNlfWVsc2V7aWYoZj1uZXcgcXQsZSl2YXIgcz1lKGEsbCxjLHQsbixmKTtpZihzPT09VD8hbW4obCxhLGUsMyxmKTohcylyZXR1cm4gZmFsc2V9fXJldHVybiB0cnVlfWZ1bmN0aW9uIE9uKHQpe3JldHVybiFaZSh0KXx8SXUmJkl1IGluIHQ/ZmFsc2U6KEZlKHQpfHxDKHQpP3p1Onl0KS50ZXN0KGNlKHQpKX1mdW5jdGlvbiBrbih0KXtyZXR1cm4gdHlwZW9mIHQ9PVwiZnVuY3Rpb25cIj90Om51bGw9PXQ/cHU6dHlwZW9mIHQ9PVwib2JqZWN0XCI/eWkodCk/V24odFswXSx0WzFdKTpSbih0KTpkdSh0KX1mdW5jdGlvbiBFbih0KXt0PW51bGw9PXQ/dDpPYmplY3QodCk7dmFyIG4scj1bXTtmb3IobiBpbiB0KXIucHVzaChuKTtyZXR1cm4gcn1mdW5jdGlvbiBTbih0LG4pe3JldHVybiBuPnR9ZnVuY3Rpb24gSW4odCxuKXt2YXIgcj0tMSxlPVVlKHQpP0FycmF5KHQubGVuZ3RoKTpbXTtcclxucmV0dXJuIEFvKHQsZnVuY3Rpb24odCx1LG8pe2VbKytyXT1uKHQsdSxvKX0pLGV9ZnVuY3Rpb24gUm4odCl7dmFyIG49UHIodCk7cmV0dXJuIDE9PW4ubGVuZ3RoJiZuWzBdWzJdP3VlKG5bMF1bMF0sblswXVsxXSk6ZnVuY3Rpb24ocil7cmV0dXJuIHI9PT10fHxBbihyLHQsbil9fWZ1bmN0aW9uIFduKHQsbil7cmV0dXJuIG5lKHQpJiZuPT09biYmIVplKG4pP3VlKGZlKHQpLG4pOmZ1bmN0aW9uKHIpe3ZhciBlPXV1KHIsdCk7cmV0dXJuIGU9PT1UJiZlPT09bj9vdShyLHQpOm1uKG4sZSxULDMpfX1mdW5jdGlvbiBCbih0LG4scixlLG8pe2lmKHQhPT1uKXtpZigheWkobikmJiFZZShuKSl2YXIgaT1mdShuKTt1KGl8fG4sZnVuY3Rpb24odSxmKXtpZihpJiYoZj11LHU9bltmXSksWmUodSkpe298fChvPW5ldyBxdCk7dmFyIGM9ZixhPW8sbD10W2NdLHM9bltjXSxoPWEuZ2V0KHMpO2lmKGgpSnQodCxjLGgpO2Vsc2V7dmFyIGg9ZT9lKGwscyxjK1wiXCIsdCxuLGEpOlQscD1oPT09VDtwJiYoaD1zLFxyXG55aShzKXx8WWUocyk/eWkobCk/aD1sOiRlKGwpP2g9bHIobCk6KHA9ZmFsc2UsaD1ybihzLHRydWUpKTpWZShzKXx8emUocyk/emUobCk/aD1ydShsKTohWmUobCl8fHImJkZlKGwpPyhwPWZhbHNlLGg9cm4ocyx0cnVlKSk6aD1sOnA9ZmFsc2UpLGEuc2V0KHMsaCkscCYmQm4oaCxzLHIsZSxhKSxhW1wiZGVsZXRlXCJdKHMpLEp0KHQsYyxoKX19ZWxzZSBjPWU/ZSh0W2ZdLHUsZitcIlwiLHQsbixvKTpULGM9PT1UJiYoYz11KSxKdCh0LGYsYyl9KX19ZnVuY3Rpb24gTG4odCxuKXt2YXIgcj10Lmxlbmd0aDtyZXR1cm4gcj8obis9MD5uP3I6MCxYcihuLHIpP3Rbbl06VCk6dm9pZCAwfWZ1bmN0aW9uIE1uKHQsbixyKXt2YXIgZT0tMTtyZXR1cm4gbj1sKG4ubGVuZ3RoP246W3B1XSxPKEZyKCkpKSx0PUluKHQsZnVuY3Rpb24odCl7cmV0dXJue2E6bChuLGZ1bmN0aW9uKG4pe3JldHVybiBuKHQpfSksYjorK2UsYzp0fX0pLGoodCxmdW5jdGlvbih0LG4pe3ZhciBlO3Q6e2U9LTE7Zm9yKHZhciB1PXQuYSxvPW4uYSxpPXUubGVuZ3RoLGY9ci5sZW5ndGg7KytlPGk7KXtcclxudmFyIGM9ZnIodVtlXSxvW2VdKTtpZihjKXtlPWU+PWY/YzpjKihcImRlc2NcIj09cltlXT8tMToxKTticmVhayB0fX1lPXQuYi1uLmJ9cmV0dXJuIGV9KX1mdW5jdGlvbiBDbih0LG4pe3JldHVybiB0PU9iamVjdCh0KSxoKG4sZnVuY3Rpb24obixyKXtyZXR1cm4gciBpbiB0JiYobltyXT10W3JdKSxufSx7fSl9ZnVuY3Rpb24gem4odCxuKXtmb3IodmFyIHI9LTEsZT1nbih0LGZ1LEJvKSx1PWUubGVuZ3RoLG89e307KytyPHU7KXt2YXIgaT1lW3JdLGY9dFtpXTtuKGYsaSkmJihvW2ldPWYpfXJldHVybiBvfWZ1bmN0aW9uIFVuKHQpe3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gbnVsbD09bj9UOm5bdF19fWZ1bmN0aW9uICRuKHQpe3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gdm4obix0KX19ZnVuY3Rpb24gRG4odCxuLHIsZSl7dmFyIHU9ZT95OmQsbz0tMSxpPW4ubGVuZ3RoLGY9dDtmb3IodD09PW4mJihuPWxyKG4pKSxyJiYoZj1sKHQsTyhyKSkpOysrbzxpOylmb3IodmFyIGM9MCxhPW5bb10sYT1yP3IoYSk6YTstMTwoYz11KGYsYSxjLGUpKTspZiE9PXQmJlZ1LmNhbGwoZixjLDEpLFxyXG5WdS5jYWxsKHQsYywxKTtyZXR1cm4gdH1mdW5jdGlvbiBGbih0LG4pe2Zvcih2YXIgcj10P24ubGVuZ3RoOjAsZT1yLTE7ci0tOyl7dmFyIHU9bltyXTtpZihyPT1lfHx1IT09byl7dmFyIG89dTtpZihYcih1KSlWdS5jYWxsKHQsdSwxKTtlbHNlIGlmKG5lKHUsdCkpZGVsZXRlIHRbZmUodSldO2Vsc2V7dmFyIHU9ZXIodSksaT1pZSh0LHUpO251bGwhPWkmJmRlbGV0ZSBpW2ZlKHZlKHUpKV19fX19ZnVuY3Rpb24gTm4odCxuKXtyZXR1cm4gdCtHdShybygpKihuLXQrMSkpfWZ1bmN0aW9uIFBuKHQsbil7dmFyIHI9XCJcIjtpZighdHx8MT5ufHxuPjkwMDcxOTkyNTQ3NDA5OTEpcmV0dXJuIHI7ZG8gbiUyJiYocis9dCksKG49R3Uobi8yKSkmJih0Kz10KTt3aGlsZShuKTtyZXR1cm4gcn1mdW5jdGlvbiBabih0LG4scixlKXtuPW5lKG4sdCk/W25dOmVyKG4pO2Zvcih2YXIgdT0tMSxvPW4ubGVuZ3RoLGk9by0xLGY9dDtudWxsIT1mJiYrK3U8bzspe3ZhciBjPWZlKG5bdV0pO2lmKFplKGYpKXtcclxudmFyIGE9cjtpZih1IT1pKXt2YXIgbD1mW2NdLGE9ZT9lKGwsYyxmKTpUO2E9PT1UJiYoYT1udWxsPT1sP1hyKG5bdSsxXSk/W106e306bCl9WXQoZixjLGEpfWY9ZltjXX1yZXR1cm4gdH1mdW5jdGlvbiBUbih0LG4scil7dmFyIGU9LTEsdT10Lmxlbmd0aDtmb3IoMD5uJiYobj0tbj51PzA6dStuKSxyPXI+dT91OnIsMD5yJiYocis9dSksdT1uPnI/MDpyLW4+Pj4wLG4+Pj49MCxyPUFycmF5KHUpOysrZTx1OylyW2VdPXRbZStuXTtyZXR1cm4gcn1mdW5jdGlvbiBxbih0LG4pe3ZhciByO3JldHVybiBBbyh0LGZ1bmN0aW9uKHQsZSx1KXtyZXR1cm4gcj1uKHQsZSx1KSwhcn0pLCEhcn1mdW5jdGlvbiBWbih0LG4scil7dmFyIGU9MCx1PXQ/dC5sZW5ndGg6ZTtpZih0eXBlb2Ygbj09XCJudW1iZXJcIiYmbj09PW4mJjIxNDc0ODM2NDc+PXUpe2Zvcig7dT5lOyl7dmFyIG89ZSt1Pj4+MSxpPXRbb107bnVsbCE9PWkmJiFKZShpKSYmKHI/bj49aTpuPmkpP2U9bysxOnU9b31yZXR1cm4gdX1cclxucmV0dXJuIEtuKHQsbixwdSxyKX1mdW5jdGlvbiBLbih0LG4scixlKXtuPXIobik7Zm9yKHZhciB1PTAsbz10P3QubGVuZ3RoOjAsaT1uIT09bixmPW51bGw9PT1uLGM9SmUobiksYT1uPT09VDtvPnU7KXt2YXIgbD1HdSgodStvKS8yKSxzPXIodFtsXSksaD1zIT09VCxwPW51bGw9PT1zLF89cz09PXMsdj1KZShzKTsoaT9lfHxfOmE/XyYmKGV8fGgpOmY/XyYmaCYmKGV8fCFwKTpjP18mJmgmJiFwJiYoZXx8IXYpOnB8fHY/MDplP24+PXM6bj5zKT91PWwrMTpvPWx9cmV0dXJuIHRvKG8sNDI5NDk2NzI5NCl9ZnVuY3Rpb24gR24odCxuKXtmb3IodmFyIHI9LTEsZT10Lmxlbmd0aCx1PTAsbz1bXTsrK3I8ZTspe3ZhciBpPXRbcl0sZj1uP24oaSk6aTtpZighcnx8IUNlKGYsYykpe3ZhciBjPWY7b1t1KytdPTA9PT1pPzA6aX19cmV0dXJuIG99ZnVuY3Rpb24gSm4odCl7cmV0dXJuIHR5cGVvZiB0PT1cIm51bWJlclwiP3Q6SmUodCk/VjordH1mdW5jdGlvbiBZbih0KXtpZih0eXBlb2YgdD09XCJzdHJpbmdcIilyZXR1cm4gdDtcclxuaWYoSmUodCkpcmV0dXJuIG1vP21vLmNhbGwodCk6XCJcIjt2YXIgbj10K1wiXCI7cmV0dXJuXCIwXCI9PW4mJjEvdD09LXE/XCItMFwiOm59ZnVuY3Rpb24gSG4odCxuLHIpe3ZhciBlPS0xLHU9YyxvPXQubGVuZ3RoLGk9dHJ1ZSxmPVtdLGw9ZjtpZihyKWk9ZmFsc2UsdT1hO2Vsc2UgaWYobz49MjAwKXtpZih1PW4/bnVsbDpJbyh0KSlyZXR1cm4gRCh1KTtpPWZhbHNlLHU9RSxsPW5ldyBadH1lbHNlIGw9bj9bXTpmO3Q6Zm9yKDsrK2U8bzspe3ZhciBzPXRbZV0saD1uP24ocyk6cyxzPXJ8fDAhPT1zP3M6MDtpZihpJiZoPT09aCl7Zm9yKHZhciBwPWwubGVuZ3RoO3AtLTspaWYobFtwXT09PWgpY29udGludWUgdDtuJiZsLnB1c2goaCksZi5wdXNoKHMpfWVsc2UgdShsLGgscil8fChsIT09ZiYmbC5wdXNoKGgpLGYucHVzaChzKSl9cmV0dXJuIGZ9ZnVuY3Rpb24gUW4odCxuLHIsZSl7Zm9yKHZhciB1PXQubGVuZ3RoLG89ZT91Oi0xOyhlP28tLTorK288dSkmJm4odFtvXSxvLHQpOyk7cmV0dXJuIHI/VG4odCxlPzA6byxlP28rMTp1KTpUbih0LGU/bysxOjAsZT91Om8pO1xyXG59ZnVuY3Rpb24gWG4odCxuKXt2YXIgcj10O3JldHVybiByIGluc3RhbmNlb2YgVXQmJihyPXIudmFsdWUoKSksaChuLGZ1bmN0aW9uKHQsbil7cmV0dXJuIG4uZnVuYy5hcHBseShuLnRoaXNBcmcscyhbdF0sbi5hcmdzKSl9LHIpfWZ1bmN0aW9uIHRyKHQsbixyKXtmb3IodmFyIGU9LTEsdT10Lmxlbmd0aDsrK2U8dTspdmFyIG89bz9zKGZuKG8sdFtlXSxuLHIpLGZuKHRbZV0sbyxuLHIpKTp0W2VdO3JldHVybiBvJiZvLmxlbmd0aD9IbihvLG4scik6W119ZnVuY3Rpb24gbnIodCxuLHIpe2Zvcih2YXIgZT0tMSx1PXQubGVuZ3RoLG89bi5sZW5ndGgsaT17fTsrK2U8dTspcihpLHRbZV0sbz5lP25bZV06VCk7cmV0dXJuIGl9ZnVuY3Rpb24gcnIodCl7cmV0dXJuICRlKHQpP3Q6W119ZnVuY3Rpb24gZXIodCl7cmV0dXJuIHlpKHQpP3Q6Q28odCl9ZnVuY3Rpb24gdXIodCxuLHIpe3ZhciBlPXQubGVuZ3RoO3JldHVybiByPXI9PT1UP2U6ciwhbiYmcj49ZT90OlRuKHQsbixyKX1mdW5jdGlvbiBvcih0LG4pe1xyXG5pZihuKXJldHVybiB0LnNsaWNlKCk7dmFyIHI9bmV3IHQuY29uc3RydWN0b3IodC5sZW5ndGgpO3JldHVybiB0LmNvcHkocikscn1mdW5jdGlvbiBpcih0KXt2YXIgbj1uZXcgdC5jb25zdHJ1Y3Rvcih0LmJ5dGVMZW5ndGgpO3JldHVybiBuZXcgRnUobikuc2V0KG5ldyBGdSh0KSksbn1mdW5jdGlvbiBmcih0LG4pe2lmKHQhPT1uKXt2YXIgcj10IT09VCxlPW51bGw9PT10LHU9dD09PXQsbz1KZSh0KSxpPW4hPT1ULGY9bnVsbD09PW4sYz1uPT09bixhPUplKG4pO2lmKCFmJiYhYSYmIW8mJnQ+bnx8byYmaSYmYyYmIWYmJiFhfHxlJiZpJiZjfHwhciYmY3x8IXUpcmV0dXJuIDE7aWYoIWUmJiFvJiYhYSYmbj50fHxhJiZyJiZ1JiYhZSYmIW98fGYmJnImJnV8fCFpJiZ1fHwhYylyZXR1cm4tMX1yZXR1cm4gMH1mdW5jdGlvbiBjcih0LG4scixlKXt2YXIgdT0tMSxvPXQubGVuZ3RoLGk9ci5sZW5ndGgsZj0tMSxjPW4ubGVuZ3RoLGE9WHUoby1pLDApLGw9QXJyYXkoYythKTtmb3IoZT0hZTsrK2Y8YzspbFtmXT1uW2ZdO1xyXG5mb3IoOysrdTxpOykoZXx8bz51KSYmKGxbclt1XV09dFt1XSk7Zm9yKDthLS07KWxbZisrXT10W3UrK107cmV0dXJuIGx9ZnVuY3Rpb24gYXIodCxuLHIsZSl7dmFyIHU9LTEsbz10Lmxlbmd0aCxpPS0xLGY9ci5sZW5ndGgsYz0tMSxhPW4ubGVuZ3RoLGw9WHUoby1mLDApLHM9QXJyYXkobCthKTtmb3IoZT0hZTsrK3U8bDspc1t1XT10W3VdO2ZvcihsPXU7KytjPGE7KXNbbCtjXT1uW2NdO2Zvcig7KytpPGY7KShlfHxvPnUpJiYoc1tsK3JbaV1dPXRbdSsrXSk7cmV0dXJuIHN9ZnVuY3Rpb24gbHIodCxuKXt2YXIgcj0tMSxlPXQubGVuZ3RoO2ZvcihufHwobj1BcnJheShlKSk7KytyPGU7KW5bcl09dFtyXTtyZXR1cm4gbn1mdW5jdGlvbiBzcih0LG4scixlKXtyfHwocj17fSk7Zm9yKHZhciB1PS0xLG89bi5sZW5ndGg7Kyt1PG87KXt2YXIgaT1uW3VdLGY9ZT9lKHJbaV0sdFtpXSxpLHIsdCk6dFtpXTtZdChyLGksZil9cmV0dXJuIHJ9ZnVuY3Rpb24gaHIodCxuKXtyZXR1cm4gc3IodCxUcih0KSxuKTtcclxufWZ1bmN0aW9uIHByKHQsbil7cmV0dXJuIGZ1bmN0aW9uKHIsdSl7dmFyIG89eWkocik/ZTpRdCxpPW4/bigpOnt9O3JldHVybiBvKHIsdCxGcih1KSxpKX19ZnVuY3Rpb24gX3IodCl7cmV0dXJuIE1lKGZ1bmN0aW9uKG4scil7dmFyIGU9LTEsdT1yLmxlbmd0aCxvPXU+MT9yW3UtMV06VCxpPXU+Mj9yWzJdOlQsbz10Lmxlbmd0aD4zJiZ0eXBlb2Ygbz09XCJmdW5jdGlvblwiPyh1LS0sbyk6VDtmb3IoaSYmdGUoclswXSxyWzFdLGkpJiYobz0zPnU/VDpvLHU9MSksbj1PYmplY3Qobik7KytlPHU7KShpPXJbZV0pJiZ0KG4saSxlLG8pO3JldHVybiBufSl9ZnVuY3Rpb24gdnIodCxuKXtyZXR1cm4gZnVuY3Rpb24ocixlKXtpZihudWxsPT1yKXJldHVybiByO2lmKCFVZShyKSlyZXR1cm4gdChyLGUpO2Zvcih2YXIgdT1yLmxlbmd0aCxvPW4/dTotMSxpPU9iamVjdChyKTsobj9vLS06KytvPHUpJiZmYWxzZSE9PWUoaVtvXSxvLGkpOyk7cmV0dXJuIHJ9fWZ1bmN0aW9uIGdyKHQpe3JldHVybiBmdW5jdGlvbihuLHIsZSl7XHJcbnZhciB1PS0xLG89T2JqZWN0KG4pO2U9ZShuKTtmb3IodmFyIGk9ZS5sZW5ndGg7aS0tOyl7dmFyIGY9ZVt0P2k6Kyt1XTtpZihmYWxzZT09PXIob1tmXSxmLG8pKWJyZWFrfXJldHVybiBufX1mdW5jdGlvbiBkcih0LG4scil7ZnVuY3Rpb24gZSgpe3JldHVybih0aGlzJiZ0aGlzIT09S3QmJnRoaXMgaW5zdGFuY2VvZiBlP286dCkuYXBwbHkodT9yOnRoaXMsYXJndW1lbnRzKX12YXIgdT0xJm4sbz14cih0KTtyZXR1cm4gZX1mdW5jdGlvbiB5cih0KXtyZXR1cm4gZnVuY3Rpb24obil7bj1ldShuKTt2YXIgcj1XdC50ZXN0KG4pP24ubWF0Y2goSXQpOlQsZT1yP3JbMF06bi5jaGFyQXQoMCk7cmV0dXJuIG49cj91cihyLDEpLmpvaW4oXCJcIik6bi5zbGljZSgxKSxlW3RdKCkrbn19ZnVuY3Rpb24gYnIodCl7cmV0dXJuIGZ1bmN0aW9uKG4pe3JldHVybiBoKHN1KGx1KG4pLnJlcGxhY2UoRXQsXCJcIikpLHQsXCJcIil9fWZ1bmN0aW9uIHhyKHQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBuPWFyZ3VtZW50cztcclxuc3dpdGNoKG4ubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIG5ldyB0O2Nhc2UgMTpyZXR1cm4gbmV3IHQoblswXSk7Y2FzZSAyOnJldHVybiBuZXcgdChuWzBdLG5bMV0pO2Nhc2UgMzpyZXR1cm4gbmV3IHQoblswXSxuWzFdLG5bMl0pO2Nhc2UgNDpyZXR1cm4gbmV3IHQoblswXSxuWzFdLG5bMl0sblszXSk7Y2FzZSA1OnJldHVybiBuZXcgdChuWzBdLG5bMV0sblsyXSxuWzNdLG5bNF0pO2Nhc2UgNjpyZXR1cm4gbmV3IHQoblswXSxuWzFdLG5bMl0sblszXSxuWzRdLG5bNV0pO2Nhc2UgNzpyZXR1cm4gbmV3IHQoblswXSxuWzFdLG5bMl0sblszXSxuWzRdLG5bNV0sbls2XSl9dmFyIHI9dW4odC5wcm90b3R5cGUpLG49dC5hcHBseShyLG4pO3JldHVybiBaZShuKT9uOnJ9fWZ1bmN0aW9uIGpyKHQsbixlKXtmdW5jdGlvbiB1KCl7Zm9yKHZhciBpPWFyZ3VtZW50cy5sZW5ndGgsZj1BcnJheShpKSxjPWksYT1Ecih1KTtjLS07KWZbY109YXJndW1lbnRzW2NdO3JldHVybiBjPTM+aSYmZlswXSE9PWEmJmZbaS0xXSE9PWE/W106JChmLGEpLFxyXG5pLT1jLmxlbmd0aCxlPmk/QnIodCxuLEFyLHUucGxhY2Vob2xkZXIsVCxmLGMsVCxULGUtaSk6cih0aGlzJiZ0aGlzIT09S3QmJnRoaXMgaW5zdGFuY2VvZiB1P286dCx0aGlzLGYpfXZhciBvPXhyKHQpO3JldHVybiB1fWZ1bmN0aW9uIHdyKHQpe3JldHVybiBmdW5jdGlvbihuLHIsZSl7dmFyIHU9T2JqZWN0KG4pO2lmKHI9RnIociwzKSwhVWUobikpdmFyIG89aXUobik7cmV0dXJuIGU9dChvfHxuLGZ1bmN0aW9uKHQsbil7cmV0dXJuIG8mJihuPXQsdD11W25dKSxyKHQsbix1KX0sZSksZT4tMT9uW28/b1tlXTplXTpUfX1mdW5jdGlvbiBtcih0KXtyZXR1cm4gTWUoZnVuY3Rpb24obil7bj1zbihuLDEpO3ZhciByPW4ubGVuZ3RoLGU9cix1PXp0LnByb3RvdHlwZS50aHJ1O2Zvcih0JiZuLnJldmVyc2UoKTtlLS07KXt2YXIgbz1uW2VdO2lmKHR5cGVvZiBvIT1cImZ1bmN0aW9uXCIpdGhyb3cgbmV3IEF1KFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTtpZih1JiYhaSYmXCJ3cmFwcGVyXCI9PSRyKG8pKXZhciBpPW5ldyB6dChbXSx0cnVlKTtcclxufWZvcihlPWk/ZTpyOysrZTxyOyl2YXIgbz1uW2VdLHU9JHIobyksZj1cIndyYXBwZXJcIj09dT9SbyhvKTpULGk9ZiYmcmUoZlswXSkmJjQyND09ZlsxXSYmIWZbNF0ubGVuZ3RoJiYxPT1mWzldP2lbJHIoZlswXSldLmFwcGx5KGksZlszXSk6MT09by5sZW5ndGgmJnJlKG8pP2lbdV0oKTppLnRocnUobyk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9YXJndW1lbnRzLGU9dFswXTtpZihpJiYxPT10Lmxlbmd0aCYmeWkoZSkmJmUubGVuZ3RoPj0yMDApcmV0dXJuIGkucGxhbnQoZSkudmFsdWUoKTtmb3IodmFyIHU9MCx0PXI/blt1XS5hcHBseSh0aGlzLHQpOmU7Kyt1PHI7KXQ9blt1XS5jYWxsKHRoaXMsdCk7cmV0dXJuIHR9fSl9ZnVuY3Rpb24gQXIodCxuLHIsZSx1LG8saSxmLGMsYSl7ZnVuY3Rpb24gbCgpe2Zvcih2YXIgZD1hcmd1bWVudHMubGVuZ3RoLHk9QXJyYXkoZCksYj1kO2ItLTspeVtiXT1hcmd1bWVudHNbYl07aWYoXyl7dmFyIHgsaj1EcihsKSxiPXkubGVuZ3RoO2Zvcih4PTA7Yi0tOyl5W2JdPT09aiYmeCsrO1xyXG59aWYoZSYmKHk9Y3IoeSxlLHUsXykpLG8mJih5PWFyKHksbyxpLF8pKSxkLT14LF8mJmE+ZClyZXR1cm4gaj0kKHksaiksQnIodCxuLEFyLGwucGxhY2Vob2xkZXIscix5LGosZixjLGEtZCk7aWYoaj1oP3I6dGhpcyxiPXA/alt0XTp0LGQ9eS5sZW5ndGgsZil7eD15Lmxlbmd0aDtmb3IodmFyIHc9dG8oZi5sZW5ndGgseCksbT1scih5KTt3LS07KXt2YXIgQT1mW3ddO3lbd109WHIoQSx4KT9tW0FdOlR9fWVsc2UgdiYmZD4xJiZ5LnJldmVyc2UoKTtyZXR1cm4gcyYmZD5jJiYoeS5sZW5ndGg9YyksdGhpcyYmdGhpcyE9PUt0JiZ0aGlzIGluc3RhbmNlb2YgbCYmKGI9Z3x8eHIoYikpLGIuYXBwbHkoaix5KX12YXIgcz0xMjgmbixoPTEmbixwPTImbixfPTI0Jm4sdj01MTImbixnPXA/VDp4cih0KTtyZXR1cm4gbH1mdW5jdGlvbiBPcih0LG4pe3JldHVybiBmdW5jdGlvbihyLGUpe3JldHVybiBqbihyLHQsbihlKSl9fWZ1bmN0aW9uIGtyKHQpe3JldHVybiBmdW5jdGlvbihuLHIpe3ZhciBlO1xyXG5pZihuPT09VCYmcj09PVQpcmV0dXJuIDA7aWYobiE9PVQmJihlPW4pLHIhPT1UKXtpZihlPT09VClyZXR1cm4gcjt0eXBlb2Ygbj09XCJzdHJpbmdcInx8dHlwZW9mIHI9PVwic3RyaW5nXCI/KG49WW4obikscj1ZbihyKSk6KG49Sm4obikscj1KbihyKSksZT10KG4scil9cmV0dXJuIGV9fWZ1bmN0aW9uIEVyKHQpe3JldHVybiBNZShmdW5jdGlvbihuKXtyZXR1cm4gbj0xPT1uLmxlbmd0aCYmeWkoblswXSk/bChuWzBdLE8oRnIoKSkpOmwoc24obiwxLFFyKSxPKEZyKCkpKSxNZShmdW5jdGlvbihlKXt2YXIgdT10aGlzO3JldHVybiB0KG4sZnVuY3Rpb24odCl7cmV0dXJuIHIodCx1LGUpfSl9KX0pfWZ1bmN0aW9uIFNyKHQsbil7bj1uPT09VD9cIiBcIjpZbihuKTt2YXIgcj1uLmxlbmd0aDtyZXR1cm4gMj5yP3I/UG4obix0KTpuOihyPVBuKG4sS3UodC9OKG4pKSksV3QudGVzdChuKT91cihyLm1hdGNoKEl0KSwwLHQpLmpvaW4oXCJcIik6ci5zbGljZSgwLHQpKX1mdW5jdGlvbiBJcih0LG4sZSx1KXtcclxuZnVuY3Rpb24gbygpe2Zvcih2YXIgbj0tMSxjPWFyZ3VtZW50cy5sZW5ndGgsYT0tMSxsPXUubGVuZ3RoLHM9QXJyYXkobCtjKSxoPXRoaXMmJnRoaXMhPT1LdCYmdGhpcyBpbnN0YW5jZW9mIG8/Zjp0OysrYTxsOylzW2FdPXVbYV07Zm9yKDtjLS07KXNbYSsrXT1hcmd1bWVudHNbKytuXTtyZXR1cm4gcihoLGk/ZTp0aGlzLHMpfXZhciBpPTEmbixmPXhyKHQpO3JldHVybiBvfWZ1bmN0aW9uIFJyKHQpe3JldHVybiBmdW5jdGlvbihuLHIsZSl7ZSYmdHlwZW9mIGUhPVwibnVtYmVyXCImJnRlKG4scixlKSYmKHI9ZT1UKSxuPW51KG4pLG49bj09PW4/bjowLHI9PT1UPyhyPW4sbj0wKTpyPW51KHIpfHwwLGU9ZT09PVQ/cj5uPzE6LTE6bnUoZSl8fDA7dmFyIHU9LTE7cj1YdShLdSgoci1uKS8oZXx8MSkpLDApO2Zvcih2YXIgbz1BcnJheShyKTtyLS07KW9bdD9yOisrdV09bixuKz1lO3JldHVybiBvfX1mdW5jdGlvbiBXcih0KXtyZXR1cm4gZnVuY3Rpb24obixyKXtyZXR1cm4gdHlwZW9mIG49PVwic3RyaW5nXCImJnR5cGVvZiByPT1cInN0cmluZ1wifHwobj1udShuKSxcclxucj1udShyKSksdChuLHIpfX1mdW5jdGlvbiBCcih0LG4scixlLHUsbyxpLGYsYyxhKXt2YXIgbD04Jm4scz1sP2k6VDtpPWw/VDppO3ZhciBoPWw/bzpUO3JldHVybiBvPWw/VDpvLG49KG58KGw/MzI6NjQpKSZ+KGw/NjQ6MzIpLDQmbnx8KG4mPS00KSxuPVt0LG4sdSxoLHMsbyxpLGYsYyxhXSxyPXIuYXBwbHkoVCxuKSxyZSh0KSYmTW8ocixuKSxyLnBsYWNlaG9sZGVyPWUscn1mdW5jdGlvbiBMcih0KXt2YXIgbj13dVt0XTtyZXR1cm4gZnVuY3Rpb24odCxyKXtpZih0PW51KHQpLHI9dG8oWGUociksMjkyKSl7dmFyIGU9KGV1KHQpK1wiZVwiKS5zcGxpdChcImVcIiksZT1uKGVbMF0rXCJlXCIrKCtlWzFdK3IpKSxlPShldShlKStcImVcIikuc3BsaXQoXCJlXCIpO3JldHVybisoZVswXStcImVcIisoK2VbMV0tcikpfXJldHVybiBuKHQpfX1mdW5jdGlvbiBNcih0KXtyZXR1cm4gZnVuY3Rpb24obil7dmFyIHI9cXIobik7cmV0dXJuXCJbb2JqZWN0IE1hcF1cIj09cj9VKG4pOlwiW29iamVjdCBTZXRdXCI9PXI/RihuKTpBKG4sdChuKSk7XHJcbn19ZnVuY3Rpb24gQ3IodCxuLHIsZSx1LG8saSxmKXt2YXIgYz0yJm47aWYoIWMmJnR5cGVvZiB0IT1cImZ1bmN0aW9uXCIpdGhyb3cgbmV3IEF1KFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTt2YXIgYT1lP2UubGVuZ3RoOjA7aWYoYXx8KG4mPS05NyxlPXU9VCksaT1pPT09VD9pOlh1KFhlKGkpLDApLGY9Zj09PVQ/ZjpYZShmKSxhLT11P3UubGVuZ3RoOjAsNjQmbil7dmFyIGw9ZSxzPXU7ZT11PVR9dmFyIGg9Yz9UOlJvKHQpO3JldHVybiBvPVt0LG4scixlLHUsbCxzLG8saSxmXSxoJiYocj1vWzFdLHQ9aFsxXSxuPXJ8dCxlPTEyOD09dCYmOD09cnx8MTI4PT10JiYyNTY9PXImJmhbOF0+PW9bN10ubGVuZ3RofHwzODQ9PXQmJmhbOF0+PWhbN10ubGVuZ3RoJiY4PT1yLDEzMT5ufHxlKSYmKDEmdCYmKG9bMl09aFsyXSxufD0xJnI/MDo0KSwocj1oWzNdKSYmKGU9b1szXSxvWzNdPWU/Y3IoZSxyLGhbNF0pOnIsb1s0XT1lPyQob1szXSxcIl9fbG9kYXNoX3BsYWNlaG9sZGVyX19cIik6aFs0XSksXHJcbihyPWhbNV0pJiYoZT1vWzVdLG9bNV09ZT9hcihlLHIsaFs2XSk6cixvWzZdPWU/JChvWzVdLFwiX19sb2Rhc2hfcGxhY2Vob2xkZXJfX1wiKTpoWzZdKSwocj1oWzddKSYmKG9bN109ciksMTI4JnQmJihvWzhdPW51bGw9PW9bOF0/aFs4XTp0byhvWzhdLGhbOF0pKSxudWxsPT1vWzldJiYob1s5XT1oWzldKSxvWzBdPWhbMF0sb1sxXT1uKSx0PW9bMF0sbj1vWzFdLHI9b1syXSxlPW9bM10sdT1vWzRdLGY9b1s5XT1udWxsPT1vWzldP2M/MDp0Lmxlbmd0aDpYdShvWzldLWEsMCksIWYmJjI0Jm4mJihuJj0tMjUpLChoP1NvOk1vKShuJiYxIT1uPzg9PW58fDE2PT1uP2pyKHQsbixmKTozMiE9biYmMzMhPW58fHUubGVuZ3RoP0FyLmFwcGx5KFQsbyk6SXIodCxuLHIsZSk6ZHIodCxuLHIpLG8pfWZ1bmN0aW9uIHpyKHQsbixyLGUsdSxvKXt2YXIgaT0yJnUsZj10Lmxlbmd0aCxjPW4ubGVuZ3RoO2lmKGYhPWMmJiEoaSYmYz5mKSlyZXR1cm4gZmFsc2U7aWYoYz1vLmdldCh0KSlyZXR1cm4gYz09bjtcclxudmFyIGM9LTEsYT10cnVlLGw9MSZ1P25ldyBadDpUO2ZvcihvLnNldCh0LG4pOysrYzxmOyl7dmFyIHM9dFtjXSxoPW5bY107aWYoZSl2YXIgcD1pP2UoaCxzLGMsbix0LG8pOmUocyxoLGMsdCxuLG8pO2lmKHAhPT1UKXtpZihwKWNvbnRpbnVlO2E9ZmFsc2U7YnJlYWt9aWYobCl7aWYoIV8obixmdW5jdGlvbih0LG4pe3JldHVybiBsLmhhcyhuKXx8cyE9PXQmJiFyKHMsdCxlLHUsbyk/dm9pZCAwOmwuYWRkKG4pfSkpe2E9ZmFsc2U7YnJlYWt9fWVsc2UgaWYocyE9PWgmJiFyKHMsaCxlLHUsbykpe2E9ZmFsc2U7YnJlYWt9fXJldHVybiBvW1wiZGVsZXRlXCJdKHQpLGF9ZnVuY3Rpb24gVXIodCxuLHIsZSx1LG8saSl7c3dpdGNoKHIpe2Nhc2VcIltvYmplY3QgRGF0YVZpZXddXCI6aWYodC5ieXRlTGVuZ3RoIT1uLmJ5dGVMZW5ndGh8fHQuYnl0ZU9mZnNldCE9bi5ieXRlT2Zmc2V0KWJyZWFrO3Q9dC5idWZmZXIsbj1uLmJ1ZmZlcjtjYXNlXCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiOmlmKHQuYnl0ZUxlbmd0aCE9bi5ieXRlTGVuZ3RofHwhZShuZXcgRnUodCksbmV3IEZ1KG4pKSlicmVhaztcclxucmV0dXJuIHRydWU7Y2FzZVwiW29iamVjdCBCb29sZWFuXVwiOmNhc2VcIltvYmplY3QgRGF0ZV1cIjpyZXR1cm4rdD09K247Y2FzZVwiW29iamVjdCBFcnJvcl1cIjpyZXR1cm4gdC5uYW1lPT1uLm5hbWUmJnQubWVzc2FnZT09bi5tZXNzYWdlO2Nhc2VcIltvYmplY3QgTnVtYmVyXVwiOnJldHVybiB0IT0rdD9uIT0rbjp0PT0rbjtjYXNlXCJbb2JqZWN0IFJlZ0V4cF1cIjpjYXNlXCJbb2JqZWN0IFN0cmluZ11cIjpyZXR1cm4gdD09bitcIlwiO2Nhc2VcIltvYmplY3QgTWFwXVwiOnZhciBmPVU7Y2FzZVwiW29iamVjdCBTZXRdXCI6aWYoZnx8KGY9RCksdC5zaXplIT1uLnNpemUmJiEoMiZvKSlicmVhaztyZXR1cm4ocj1pLmdldCh0KSk/cj09bjoob3w9MSxpLnNldCh0LG4pLHpyKGYodCksZihuKSxlLHUsbyxpKSk7Y2FzZVwiW29iamVjdCBTeW1ib2xdXCI6aWYod28pcmV0dXJuIHdvLmNhbGwodCk9PXdvLmNhbGwobil9cmV0dXJuIGZhbHNlfWZ1bmN0aW9uICRyKHQpe2Zvcih2YXIgbj10Lm5hbWUrXCJcIixyPV9vW25dLGU9V3UuY2FsbChfbyxuKT9yLmxlbmd0aDowO2UtLTspe1xyXG52YXIgdT1yW2VdLG89dS5mdW5jO2lmKG51bGw9PW98fG89PXQpcmV0dXJuIHUubmFtZX1yZXR1cm4gbn1mdW5jdGlvbiBEcih0KXtyZXR1cm4oV3UuY2FsbChPdCxcInBsYWNlaG9sZGVyXCIpP090OnQpLnBsYWNlaG9sZGVyfWZ1bmN0aW9uIEZyKCl7dmFyIHQ9T3QuaXRlcmF0ZWV8fF91LHQ9dD09PV91P2tuOnQ7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/dChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTp0fWZ1bmN0aW9uIE5yKHQsbil7dmFyIHI9dC5fX2RhdGFfXyxlPXR5cGVvZiBuO3JldHVybihcInN0cmluZ1wiPT1lfHxcIm51bWJlclwiPT1lfHxcInN5bWJvbFwiPT1lfHxcImJvb2xlYW5cIj09ZT9cIl9fcHJvdG9fX1wiIT09bjpudWxsPT09bik/clt0eXBlb2Ygbj09XCJzdHJpbmdcIj9cInN0cmluZ1wiOlwiaGFzaFwiXTpyLm1hcH1mdW5jdGlvbiBQcih0KXtmb3IodmFyIG49aXUodCkscj1uLmxlbmd0aDtyLS07KXt2YXIgZT1uW3JdLHU9dFtlXTtuW3JdPVtlLHUsdT09PXUmJiFaZSh1KV19cmV0dXJuIG47XHJcbn1mdW5jdGlvbiBacih0LG4pe3ZhciByPW51bGw9PXQ/VDp0W25dO3JldHVybiBPbihyKT9yOlR9ZnVuY3Rpb24gVHIodCl7cmV0dXJuIFB1KE9iamVjdCh0KSl9ZnVuY3Rpb24gcXIodCl7cmV0dXJuIE11LmNhbGwodCl9ZnVuY3Rpb24gVnIodCxuLHIpe249bmUobix0KT9bbl06ZXIobik7Zm9yKHZhciBlLHU9LTEsbz1uLmxlbmd0aDsrK3U8bzspe3ZhciBpPWZlKG5bdV0pO2lmKCEoZT1udWxsIT10JiZyKHQsaSkpKWJyZWFrO3Q9dFtpXX1yZXR1cm4gZT9lOihvPXQ/dC5sZW5ndGg6MCwhIW8mJlBlKG8pJiZYcihpLG8pJiYoeWkodCl8fEdlKHQpfHx6ZSh0KSkpfWZ1bmN0aW9uIEtyKHQpe3ZhciBuPXQubGVuZ3RoLHI9dC5jb25zdHJ1Y3RvcihuKTtyZXR1cm4gbiYmXCJzdHJpbmdcIj09dHlwZW9mIHRbMF0mJld1LmNhbGwodCxcImluZGV4XCIpJiYoci5pbmRleD10LmluZGV4LHIuaW5wdXQ9dC5pbnB1dCkscn1mdW5jdGlvbiBHcih0KXtyZXR1cm4gdHlwZW9mIHQuY29uc3RydWN0b3IhPVwiZnVuY3Rpb25cInx8ZWUodCk/e306dW4oSnUoT2JqZWN0KHQpKSk7XHJcbn1mdW5jdGlvbiBKcihyLGUsdSxvKXt2YXIgaT1yLmNvbnN0cnVjdG9yO3N3aXRjaChlKXtjYXNlXCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiOnJldHVybiBpcihyKTtjYXNlXCJbb2JqZWN0IEJvb2xlYW5dXCI6Y2FzZVwiW29iamVjdCBEYXRlXVwiOnJldHVybiBuZXcgaSgrcik7Y2FzZVwiW29iamVjdCBEYXRhVmlld11cIjpyZXR1cm4gZT1vP2lyKHIuYnVmZmVyKTpyLmJ1ZmZlcixuZXcgci5jb25zdHJ1Y3RvcihlLHIuYnl0ZU9mZnNldCxyLmJ5dGVMZW5ndGgpO2Nhc2VcIltvYmplY3QgRmxvYXQzMkFycmF5XVwiOmNhc2VcIltvYmplY3QgRmxvYXQ2NEFycmF5XVwiOmNhc2VcIltvYmplY3QgSW50OEFycmF5XVwiOmNhc2VcIltvYmplY3QgSW50MTZBcnJheV1cIjpjYXNlXCJbb2JqZWN0IEludDMyQXJyYXldXCI6Y2FzZVwiW29iamVjdCBVaW50OEFycmF5XVwiOmNhc2VcIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldXCI6Y2FzZVwiW29iamVjdCBVaW50MTZBcnJheV1cIjpjYXNlXCJbb2JqZWN0IFVpbnQzMkFycmF5XVwiOlxyXG5yZXR1cm4gZT1vP2lyKHIuYnVmZmVyKTpyLmJ1ZmZlcixuZXcgci5jb25zdHJ1Y3RvcihlLHIuYnl0ZU9mZnNldCxyLmxlbmd0aCk7Y2FzZVwiW29iamVjdCBNYXBdXCI6cmV0dXJuIGU9bz91KFUociksdHJ1ZSk6VShyKSxoKGUsdCxuZXcgci5jb25zdHJ1Y3Rvcik7Y2FzZVwiW29iamVjdCBOdW1iZXJdXCI6Y2FzZVwiW29iamVjdCBTdHJpbmddXCI6cmV0dXJuIG5ldyBpKHIpO2Nhc2VcIltvYmplY3QgUmVnRXhwXVwiOnJldHVybiBlPW5ldyByLmNvbnN0cnVjdG9yKHIuc291cmNlLF90LmV4ZWMocikpLGUubGFzdEluZGV4PXIubGFzdEluZGV4LGU7Y2FzZVwiW29iamVjdCBTZXRdXCI6cmV0dXJuIGU9bz91KEQociksdHJ1ZSk6RChyKSxoKGUsbixuZXcgci5jb25zdHJ1Y3Rvcik7Y2FzZVwiW29iamVjdCBTeW1ib2xdXCI6cmV0dXJuIHdvP09iamVjdCh3by5jYWxsKHIpKTp7fX19ZnVuY3Rpb24gWXIodCl7dmFyIG49dD90Lmxlbmd0aDpUO3JldHVybiBQZShuKSYmKHlpKHQpfHxHZSh0KXx8emUodCkpP20obixTdHJpbmcpOm51bGw7XHJcbn1mdW5jdGlvbiBIcih0KXtyZXR1cm4geWkodCl8fHplKHQpfWZ1bmN0aW9uIFFyKHQpe3JldHVybiB5aSh0KSYmISgyPT10Lmxlbmd0aCYmIUZlKHRbMF0pKX1mdW5jdGlvbiBYcih0LG4pe3JldHVybiBuPW51bGw9PW4/OTAwNzE5OTI1NDc0MDk5MTpuLCEhbiYmKHR5cGVvZiB0PT1cIm51bWJlclwifHx4dC50ZXN0KHQpKSYmdD4tMSYmMD09dCUxJiZuPnR9ZnVuY3Rpb24gdGUodCxuLHIpe2lmKCFaZShyKSlyZXR1cm4gZmFsc2U7dmFyIGU9dHlwZW9mIG47cmV0dXJuKFwibnVtYmVyXCI9PWU/VWUocikmJlhyKG4sci5sZW5ndGgpOlwic3RyaW5nXCI9PWUmJm4gaW4gcik/Q2UocltuXSx0KTpmYWxzZX1mdW5jdGlvbiBuZSh0LG4pe2lmKHlpKHQpKXJldHVybiBmYWxzZTt2YXIgcj10eXBlb2YgdDtyZXR1cm5cIm51bWJlclwiPT1yfHxcInN5bWJvbFwiPT1yfHxcImJvb2xlYW5cIj09cnx8bnVsbD09dHx8SmUodCk/dHJ1ZTp1dC50ZXN0KHQpfHwhZXQudGVzdCh0KXx8bnVsbCE9biYmdCBpbiBPYmplY3Qobil9ZnVuY3Rpb24gcmUodCl7XHJcbnZhciBuPSRyKHQpLHI9T3Rbbl07cmV0dXJuIHR5cGVvZiByPT1cImZ1bmN0aW9uXCImJm4gaW4gVXQucHJvdG90eXBlP3Q9PT1yP3RydWU6KG49Um8ociksISFuJiZ0PT09blswXSk6ZmFsc2V9ZnVuY3Rpb24gZWUodCl7dmFyIG49dCYmdC5jb25zdHJ1Y3RvcjtyZXR1cm4gdD09PSh0eXBlb2Ygbj09XCJmdW5jdGlvblwiJiZuLnByb3RvdHlwZXx8a3UpfWZ1bmN0aW9uIHVlKHQsbil7cmV0dXJuIGZ1bmN0aW9uKHIpe3JldHVybiBudWxsPT1yP2ZhbHNlOnJbdF09PT1uJiYobiE9PVR8fHQgaW4gT2JqZWN0KHIpKX19ZnVuY3Rpb24gb2UodCxuLHIsZSx1LG8pe3JldHVybiBaZSh0KSYmWmUobikmJkJuKHQsbixULG9lLG8uc2V0KG4sdCkpLHR9ZnVuY3Rpb24gaWUodCxuKXtyZXR1cm4gMT09bi5sZW5ndGg/dDp2bih0LFRuKG4sMCwtMSkpfWZ1bmN0aW9uIGZlKHQpe2lmKHR5cGVvZiB0PT1cInN0cmluZ1wifHxKZSh0KSlyZXR1cm4gdDt2YXIgbj10K1wiXCI7cmV0dXJuXCIwXCI9PW4mJjEvdD09LXE/XCItMFwiOm59ZnVuY3Rpb24gY2UodCl7XHJcbmlmKG51bGwhPXQpe3RyeXtyZXR1cm4gUnUuY2FsbCh0KX1jYXRjaChuKXt9cmV0dXJuIHQrXCJcIn1yZXR1cm5cIlwifWZ1bmN0aW9uIGFlKHQpe2lmKHQgaW5zdGFuY2VvZiBVdClyZXR1cm4gdC5jbG9uZSgpO3ZhciBuPW5ldyB6dCh0Ll9fd3JhcHBlZF9fLHQuX19jaGFpbl9fKTtyZXR1cm4gbi5fX2FjdGlvbnNfXz1scih0Ll9fYWN0aW9uc19fKSxuLl9faW5kZXhfXz10Ll9faW5kZXhfXyxuLl9fdmFsdWVzX189dC5fX3ZhbHVlc19fLG59ZnVuY3Rpb24gbGUodCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtyZXR1cm4gZT8obj1yfHxuPT09VD8xOlhlKG4pLFRuKHQsMD5uPzA6bixlKSk6W119ZnVuY3Rpb24gc2UodCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtyZXR1cm4gZT8obj1yfHxuPT09VD8xOlhlKG4pLG49ZS1uLFRuKHQsMCwwPm4/MDpuKSk6W119ZnVuY3Rpb24gaGUodCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtyZXR1cm4gZT8ocj1udWxsPT1yPzA6WGUociksMD5yJiYocj1YdShlK3IsMCkpLFxyXG5nKHQsRnIobiwzKSxyKSk6LTF9ZnVuY3Rpb24gcGUodCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtpZighZSlyZXR1cm4tMTt2YXIgdT1lLTE7cmV0dXJuIHIhPT1UJiYodT1YZShyKSx1PTA+cj9YdShlK3UsMCk6dG8odSxlLTEpKSxnKHQsRnIobiwzKSx1LHRydWUpfWZ1bmN0aW9uIF9lKHQpe3JldHVybiB0JiZ0Lmxlbmd0aD90WzBdOlR9ZnVuY3Rpb24gdmUodCl7dmFyIG49dD90Lmxlbmd0aDowO3JldHVybiBuP3Rbbi0xXTpUfWZ1bmN0aW9uIGdlKHQsbil7cmV0dXJuIHQmJnQubGVuZ3RoJiZuJiZuLmxlbmd0aD9Ebih0LG4pOnR9ZnVuY3Rpb24gZGUodCl7cmV0dXJuIHQ/dW8uY2FsbCh0KTp0fWZ1bmN0aW9uIHllKHQpe2lmKCF0fHwhdC5sZW5ndGgpcmV0dXJuW107dmFyIG49MDtyZXR1cm4gdD1mKHQsZnVuY3Rpb24odCl7cmV0dXJuICRlKHQpPyhuPVh1KHQubGVuZ3RoLG4pLHRydWUpOnZvaWQgMH0pLG0obixmdW5jdGlvbihuKXtyZXR1cm4gbCh0LFVuKG4pKX0pfWZ1bmN0aW9uIGJlKHQsbil7XHJcbmlmKCF0fHwhdC5sZW5ndGgpcmV0dXJuW107dmFyIGU9eWUodCk7cmV0dXJuIG51bGw9PW4/ZTpsKGUsZnVuY3Rpb24odCl7cmV0dXJuIHIobixULHQpfSl9ZnVuY3Rpb24geGUodCl7cmV0dXJuIHQ9T3QodCksdC5fX2NoYWluX189dHJ1ZSx0fWZ1bmN0aW9uIGplKHQsbil7cmV0dXJuIG4odCl9ZnVuY3Rpb24gd2UoKXtyZXR1cm4gdGhpc31mdW5jdGlvbiBtZSh0LG4pe3JldHVybih5aSh0KT91OkFvKSh0LEZyKG4sMykpfWZ1bmN0aW9uIEFlKHQsbil7cmV0dXJuKHlpKHQpP286T28pKHQsRnIobiwzKSl9ZnVuY3Rpb24gT2UodCxuKXtyZXR1cm4oeWkodCk/bDpJbikodCxGcihuLDMpKX1mdW5jdGlvbiBrZSh0LG4scil7dmFyIGU9LTEsdT1IZSh0KSxvPXUubGVuZ3RoLGk9by0xO2ZvcihuPShyP3RlKHQsbixyKTpuPT09VCk/MTpubihYZShuKSwwLG8pOysrZTxuOyl0PU5uKGUsaSkscj11W3RdLHVbdF09dVtlXSx1W2VdPXI7cmV0dXJuIHUubGVuZ3RoPW4sdX1mdW5jdGlvbiBFZSgpe1xyXG5yZXR1cm4geHUubm93KCl9ZnVuY3Rpb24gU2UodCxuLHIpe3JldHVybiBuPXI/VDpuLG49dCYmbnVsbD09bj90Lmxlbmd0aDpuLENyKHQsMTI4LFQsVCxULFQsbil9ZnVuY3Rpb24gSWUodCxuKXt2YXIgcjtpZih0eXBlb2YgbiE9XCJmdW5jdGlvblwiKXRocm93IG5ldyBBdShcIkV4cGVjdGVkIGEgZnVuY3Rpb25cIik7cmV0dXJuIHQ9WGUodCksZnVuY3Rpb24oKXtyZXR1cm4gMDwtLXQmJihyPW4uYXBwbHkodGhpcyxhcmd1bWVudHMpKSwxPj10JiYobj1UKSxyfX1mdW5jdGlvbiBSZSh0LG4scil7cmV0dXJuIG49cj9UOm4sdD1Dcih0LDgsVCxULFQsVCxULG4pLHQucGxhY2Vob2xkZXI9UmUucGxhY2Vob2xkZXIsdH1mdW5jdGlvbiBXZSh0LG4scil7cmV0dXJuIG49cj9UOm4sdD1Dcih0LDE2LFQsVCxULFQsVCxuKSx0LnBsYWNlaG9sZGVyPVdlLnBsYWNlaG9sZGVyLHR9ZnVuY3Rpb24gQmUodCxuLHIpe2Z1bmN0aW9uIGUobil7dmFyIHI9YyxlPWE7cmV0dXJuIGM9YT1ULF89bixzPXQuYXBwbHkoZSxyKTtcclxufWZ1bmN0aW9uIHUodCl7dmFyIHI9dC1wO3JldHVybiB0LT1fLHA9PT1UfHxyPj1ufHwwPnJ8fGcmJnQ+PWx9ZnVuY3Rpb24gbygpe3ZhciB0PUVlKCk7aWYodSh0KSlyZXR1cm4gaSh0KTt2YXIgcjtyPXQtXyx0PW4tKHQtcCkscj1nP3RvKHQsbC1yKTp0LGg9QXQobyxyKX1mdW5jdGlvbiBpKHQpe3JldHVybiBoPVQsZCYmYz9lKHQpOihjPWE9VCxzKX1mdW5jdGlvbiBmKCl7dmFyIHQ9RWUoKSxyPXUodCk7aWYoYz1hcmd1bWVudHMsYT10aGlzLHA9dCxyKXtpZihoPT09VClyZXR1cm4gXz10PXAsaD1BdChvLG4pLHY/ZSh0KTpzO2lmKGcpcmV0dXJuIGg9QXQobyxuKSxlKHApfXJldHVybiBoPT09VCYmKGg9QXQobyxuKSksc312YXIgYyxhLGwscyxoLHAsXz0wLHY9ZmFsc2UsZz1mYWxzZSxkPXRydWU7aWYodHlwZW9mIHQhPVwiZnVuY3Rpb25cIil0aHJvdyBuZXcgQXUoXCJFeHBlY3RlZCBhIGZ1bmN0aW9uXCIpO3JldHVybiBuPW51KG4pfHwwLFplKHIpJiYodj0hIXIubGVhZGluZyxsPShnPVwibWF4V2FpdFwiaW4gcik/WHUobnUoci5tYXhXYWl0KXx8MCxuKTpsLFxyXG5kPVwidHJhaWxpbmdcImluIHI/ISFyLnRyYWlsaW5nOmQpLGYuY2FuY2VsPWZ1bmN0aW9uKCl7Xz0wLGM9cD1hPWg9VH0sZi5mbHVzaD1mdW5jdGlvbigpe3JldHVybiBoPT09VD9zOmkoRWUoKSl9LGZ9ZnVuY3Rpb24gTGUodCxuKXtmdW5jdGlvbiByKCl7dmFyIGU9YXJndW1lbnRzLHU9bj9uLmFwcGx5KHRoaXMsZSk6ZVswXSxvPXIuY2FjaGU7cmV0dXJuIG8uaGFzKHUpP28uZ2V0KHUpOihlPXQuYXBwbHkodGhpcyxlKSxyLmNhY2hlPW8uc2V0KHUsZSksZSl9aWYodHlwZW9mIHQhPVwiZnVuY3Rpb25cInx8biYmdHlwZW9mIG4hPVwiZnVuY3Rpb25cIil0aHJvdyBuZXcgQXUoXCJFeHBlY3RlZCBhIGZ1bmN0aW9uXCIpO3JldHVybiByLmNhY2hlPW5ldyhMZS5DYWNoZXx8UHQpLHJ9ZnVuY3Rpb24gTWUodCxuKXtpZih0eXBlb2YgdCE9XCJmdW5jdGlvblwiKXRocm93IG5ldyBBdShcIkV4cGVjdGVkIGEgZnVuY3Rpb25cIik7cmV0dXJuIG49WHUobj09PVQ/dC5sZW5ndGgtMTpYZShuKSwwKSxmdW5jdGlvbigpe1xyXG5mb3IodmFyIGU9YXJndW1lbnRzLHU9LTEsbz1YdShlLmxlbmd0aC1uLDApLGk9QXJyYXkobyk7Kyt1PG87KWlbdV09ZVtuK3VdO3N3aXRjaChuKXtjYXNlIDA6cmV0dXJuIHQuY2FsbCh0aGlzLGkpO2Nhc2UgMTpyZXR1cm4gdC5jYWxsKHRoaXMsZVswXSxpKTtjYXNlIDI6cmV0dXJuIHQuY2FsbCh0aGlzLGVbMF0sZVsxXSxpKX1mb3Iobz1BcnJheShuKzEpLHU9LTE7Kyt1PG47KW9bdV09ZVt1XTtyZXR1cm4gb1tuXT1pLHIodCx0aGlzLG8pfX1mdW5jdGlvbiBDZSh0LG4pe3JldHVybiB0PT09bnx8dCE9PXQmJm4hPT1ufWZ1bmN0aW9uIHplKHQpe3JldHVybiAkZSh0KSYmV3UuY2FsbCh0LFwiY2FsbGVlXCIpJiYoIXF1LmNhbGwodCxcImNhbGxlZVwiKXx8XCJbb2JqZWN0IEFyZ3VtZW50c11cIj09TXUuY2FsbCh0KSl9ZnVuY3Rpb24gVWUodCl7cmV0dXJuIG51bGwhPXQmJlBlKFdvKHQpKSYmIUZlKHQpfWZ1bmN0aW9uICRlKHQpe3JldHVybiBUZSh0KSYmVWUodCl9ZnVuY3Rpb24gRGUodCl7XHJcbnJldHVybiBUZSh0KT9cIltvYmplY3QgRXJyb3JdXCI9PU11LmNhbGwodCl8fHR5cGVvZiB0Lm1lc3NhZ2U9PVwic3RyaW5nXCImJnR5cGVvZiB0Lm5hbWU9PVwic3RyaW5nXCI6ZmFsc2V9ZnVuY3Rpb24gRmUodCl7cmV0dXJuIHQ9WmUodCk/TXUuY2FsbCh0KTpcIlwiLFwiW29iamVjdCBGdW5jdGlvbl1cIj09dHx8XCJbb2JqZWN0IEdlbmVyYXRvckZ1bmN0aW9uXVwiPT10fWZ1bmN0aW9uIE5lKHQpe3JldHVybiB0eXBlb2YgdD09XCJudW1iZXJcIiYmdD09WGUodCl9ZnVuY3Rpb24gUGUodCl7cmV0dXJuIHR5cGVvZiB0PT1cIm51bWJlclwiJiZ0Pi0xJiYwPT10JTEmJjkwMDcxOTkyNTQ3NDA5OTE+PXR9ZnVuY3Rpb24gWmUodCl7dmFyIG49dHlwZW9mIHQ7cmV0dXJuISF0JiYoXCJvYmplY3RcIj09bnx8XCJmdW5jdGlvblwiPT1uKX1mdW5jdGlvbiBUZSh0KXtyZXR1cm4hIXQmJnR5cGVvZiB0PT1cIm9iamVjdFwifWZ1bmN0aW9uIHFlKHQpe3JldHVybiB0eXBlb2YgdD09XCJudW1iZXJcInx8VGUodCkmJlwiW29iamVjdCBOdW1iZXJdXCI9PU11LmNhbGwodCk7XHJcbn1mdW5jdGlvbiBWZSh0KXtyZXR1cm4hVGUodCl8fFwiW29iamVjdCBPYmplY3RdXCIhPU11LmNhbGwodCl8fEModCk/ZmFsc2U6KHQ9SnUoT2JqZWN0KHQpKSxudWxsPT09dD90cnVlOih0PVd1LmNhbGwodCxcImNvbnN0cnVjdG9yXCIpJiZ0LmNvbnN0cnVjdG9yLHR5cGVvZiB0PT1cImZ1bmN0aW9uXCImJnQgaW5zdGFuY2VvZiB0JiZSdS5jYWxsKHQpPT1MdSkpfWZ1bmN0aW9uIEtlKHQpe3JldHVybiBaZSh0KSYmXCJbb2JqZWN0IFJlZ0V4cF1cIj09TXUuY2FsbCh0KX1mdW5jdGlvbiBHZSh0KXtyZXR1cm4gdHlwZW9mIHQ9PVwic3RyaW5nXCJ8fCF5aSh0KSYmVGUodCkmJlwiW29iamVjdCBTdHJpbmddXCI9PU11LmNhbGwodCl9ZnVuY3Rpb24gSmUodCl7cmV0dXJuIHR5cGVvZiB0PT1cInN5bWJvbFwifHxUZSh0KSYmXCJbb2JqZWN0IFN5bWJvbF1cIj09TXUuY2FsbCh0KX1mdW5jdGlvbiBZZSh0KXtyZXR1cm4gVGUodCkmJlBlKHQubGVuZ3RoKSYmISFNdFtNdS5jYWxsKHQpXX1mdW5jdGlvbiBIZSh0KXtpZighdClyZXR1cm5bXTtcclxuaWYoVWUodCkpcmV0dXJuIEdlKHQpP3QubWF0Y2goSXQpOmxyKHQpO2lmKFp1JiZ0W1p1XSlyZXR1cm4geih0W1p1XSgpKTt2YXIgbj1xcih0KTtyZXR1cm4oXCJbb2JqZWN0IE1hcF1cIj09bj9VOlwiW29iamVjdCBTZXRdXCI9PW4/RDpjdSkodCl9ZnVuY3Rpb24gUWUodCl7cmV0dXJuIHQ/KHQ9bnUodCksdD09PXF8fHQ9PT0tcT8xLjc5NzY5MzEzNDg2MjMxNTdlMzA4KigwPnQ/LTE6MSk6dD09PXQ/dDowKTowPT09dD90OjB9ZnVuY3Rpb24gWGUodCl7dD1RZSh0KTt2YXIgbj10JTE7cmV0dXJuIHQ9PT10P24/dC1uOnQ6MH1mdW5jdGlvbiB0dSh0KXtyZXR1cm4gdD9ubihYZSh0KSwwLDQyOTQ5NjcyOTUpOjB9ZnVuY3Rpb24gbnUodCl7aWYodHlwZW9mIHQ9PVwibnVtYmVyXCIpcmV0dXJuIHQ7aWYoSmUodCkpcmV0dXJuIFY7aWYoWmUodCkmJih0PUZlKHQudmFsdWVPZik/dC52YWx1ZU9mKCk6dCx0PVplKHQpP3QrXCJcIjp0KSx0eXBlb2YgdCE9XCJzdHJpbmdcIilyZXR1cm4gMD09PXQ/dDordDtcclxudD10LnJlcGxhY2UoY3QsXCJcIik7dmFyIG49ZHQudGVzdCh0KTtyZXR1cm4gbnx8YnQudGVzdCh0KT9OdCh0LnNsaWNlKDIpLG4/Mjo4KTpndC50ZXN0KHQpP1Y6K3R9ZnVuY3Rpb24gcnUodCl7cmV0dXJuIHNyKHQsZnUodCkpfWZ1bmN0aW9uIGV1KHQpe3JldHVybiBudWxsPT10P1wiXCI6WW4odCl9ZnVuY3Rpb24gdXUodCxuLHIpe3JldHVybiB0PW51bGw9PXQ/VDp2bih0LG4pLHQ9PT1UP3I6dH1mdW5jdGlvbiBvdSh0LG4pe3JldHVybiBudWxsIT10JiZWcih0LG4sYm4pfWZ1bmN0aW9uIGl1KHQpe3ZhciBuPWVlKHQpO2lmKCFuJiYhVWUodCkpcmV0dXJuIFF1KE9iamVjdCh0KSk7dmFyIHIsZT1Zcih0KSx1PSEhZSxlPWV8fFtdLG89ZS5sZW5ndGg7Zm9yKHIgaW4gdCkheW4odCxyKXx8dSYmKFwibGVuZ3RoXCI9PXJ8fFhyKHIsbykpfHxuJiZcImNvbnN0cnVjdG9yXCI9PXJ8fGUucHVzaChyKTtyZXR1cm4gZX1mdW5jdGlvbiBmdSh0KXtmb3IodmFyIG49LTEscj1lZSh0KSxlPUVuKHQpLHU9ZS5sZW5ndGgsbz1Zcih0KSxpPSEhbyxvPW98fFtdLGY9by5sZW5ndGg7KytuPHU7KXtcclxudmFyIGM9ZVtuXTtpJiYoXCJsZW5ndGhcIj09Y3x8WHIoYyxmKSl8fFwiY29uc3RydWN0b3JcIj09YyYmKHJ8fCFXdS5jYWxsKHQsYykpfHxvLnB1c2goYyl9cmV0dXJuIG99ZnVuY3Rpb24gY3UodCl7cmV0dXJuIHQ/ayh0LGl1KHQpKTpbXX1mdW5jdGlvbiBhdSh0KXtyZXR1cm4gcWkoZXUodCkudG9Mb3dlckNhc2UoKSl9ZnVuY3Rpb24gbHUodCl7cmV0dXJuKHQ9ZXUodCkpJiZ0LnJlcGxhY2UoanQsVykucmVwbGFjZShTdCxcIlwiKX1mdW5jdGlvbiBzdSh0LG4scil7cmV0dXJuIHQ9ZXUodCksbj1yP1Q6bixuPT09VCYmKG49QnQudGVzdCh0KT9SdDpzdCksdC5tYXRjaChuKXx8W119ZnVuY3Rpb24gaHUodCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHR9fWZ1bmN0aW9uIHB1KHQpe3JldHVybiB0fWZ1bmN0aW9uIF91KHQpe3JldHVybiBrbih0eXBlb2YgdD09XCJmdW5jdGlvblwiP3Q6cm4odCx0cnVlKSl9ZnVuY3Rpb24gdnUodCxuLHIpe3ZhciBlPWl1KG4pLG89X24obixlKTtudWxsIT1yfHxaZShuKSYmKG8ubGVuZ3RofHwhZS5sZW5ndGgpfHwocj1uLFxyXG5uPXQsdD10aGlzLG89X24obixpdShuKSkpO3ZhciBpPSEoWmUocikmJlwiY2hhaW5cImluIHImJiFyLmNoYWluKSxmPUZlKHQpO3JldHVybiB1KG8sZnVuY3Rpb24ocil7dmFyIGU9bltyXTt0W3JdPWUsZiYmKHQucHJvdG90eXBlW3JdPWZ1bmN0aW9uKCl7dmFyIG49dGhpcy5fX2NoYWluX187aWYoaXx8bil7dmFyIHI9dCh0aGlzLl9fd3JhcHBlZF9fKTtyZXR1cm4oci5fX2FjdGlvbnNfXz1scih0aGlzLl9fYWN0aW9uc19fKSkucHVzaCh7ZnVuYzplLGFyZ3M6YXJndW1lbnRzLHRoaXNBcmc6dH0pLHIuX19jaGFpbl9fPW4scn1yZXR1cm4gZS5hcHBseSh0LHMoW3RoaXMudmFsdWUoKV0sYXJndW1lbnRzKSl9KX0pLHR9ZnVuY3Rpb24gZ3UoKXt9ZnVuY3Rpb24gZHUodCl7cmV0dXJuIG5lKHQpP1VuKGZlKHQpKTokbih0KX1mdW5jdGlvbiB5dSgpe3JldHVybltdfWZ1bmN0aW9uIGJ1KCl7cmV0dXJuIGZhbHNlfVI9Uj9HdC5kZWZhdWx0cyh7fSxSLEd0LnBpY2soS3QsTHQpKTpLdDt2YXIgeHU9Ui5EYXRlLGp1PVIuRXJyb3Isd3U9Ui5NYXRoLG11PVIuUmVnRXhwLEF1PVIuVHlwZUVycm9yLE91PVIuQXJyYXkucHJvdG90eXBlLGt1PVIuT2JqZWN0LnByb3RvdHlwZSxFdT1SLlN0cmluZy5wcm90b3R5cGUsU3U9UltcIl9fY29yZS1qc19zaGFyZWRfX1wiXSxJdT1mdW5jdGlvbigpe1xyXG52YXIgdD0vW14uXSskLy5leGVjKFN1JiZTdS5rZXlzJiZTdS5rZXlzLklFX1BST1RPfHxcIlwiKTtyZXR1cm4gdD9cIlN5bWJvbChzcmMpXzEuXCIrdDpcIlwifSgpLFJ1PVIuRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nLFd1PWt1Lmhhc093blByb3BlcnR5LEJ1PTAsTHU9UnUuY2FsbChPYmplY3QpLE11PWt1LnRvU3RyaW5nLEN1PUt0Ll8senU9bXUoXCJeXCIrUnUuY2FsbChXdSkucmVwbGFjZShpdCxcIlxcXFwkJlwiKS5yZXBsYWNlKC9oYXNPd25Qcm9wZXJ0eXwoZnVuY3Rpb24pLio/KD89XFxcXFxcKCl8IGZvciAuKz8oPz1cXFxcXFxdKS9nLFwiJDEuKj9cIikrXCIkXCIpLFV1PVR0P1IuQnVmZmVyOlQsJHU9Ui5SZWZsZWN0LER1PVIuU3ltYm9sLEZ1PVIuVWludDhBcnJheSxOdT0kdT8kdS5mOlQsUHU9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyxadT10eXBlb2YoWnU9RHUmJkR1Lml0ZXJhdG9yKT09XCJzeW1ib2xcIj9adTpULFR1PU9iamVjdC5jcmVhdGUscXU9a3UucHJvcGVydHlJc0VudW1lcmFibGUsVnU9T3Uuc3BsaWNlLEt1PXd1LmNlaWwsR3U9d3UuZmxvb3IsSnU9T2JqZWN0LmdldFByb3RvdHlwZU9mLFl1PVIuaXNGaW5pdGUsSHU9T3Uuam9pbixRdT1PYmplY3Qua2V5cyxYdT13dS5tYXgsdG89d3UubWluLG5vPVIucGFyc2VJbnQscm89d3UucmFuZG9tLGVvPUV1LnJlcGxhY2UsdW89T3UucmV2ZXJzZSxvbz1FdS5zcGxpdCxpbz1acihSLFwiRGF0YVZpZXdcIiksZm89WnIoUixcIk1hcFwiKSxjbz1acihSLFwiUHJvbWlzZVwiKSxhbz1acihSLFwiU2V0XCIpLGxvPVpyKFIsXCJXZWFrTWFwXCIpLHNvPVpyKE9iamVjdCxcImNyZWF0ZVwiKSxobz1sbyYmbmV3IGxvLHBvPSFxdS5jYWxsKHtcclxudmFsdWVPZjoxfSxcInZhbHVlT2ZcIiksX289e30sdm89Y2UoaW8pLGdvPWNlKGZvKSx5bz1jZShjbyksYm89Y2UoYW8pLHhvPWNlKGxvKSxqbz1EdT9EdS5wcm90b3R5cGU6VCx3bz1qbz9qby52YWx1ZU9mOlQsbW89am8/am8udG9TdHJpbmc6VDtPdC50ZW1wbGF0ZVNldHRpbmdzPXtlc2NhcGU6dHQsZXZhbHVhdGU6bnQsaW50ZXJwb2xhdGU6cnQsdmFyaWFibGU6XCJcIixpbXBvcnRzOntfOk90fX0sT3QucHJvdG90eXBlPWt0LnByb3RvdHlwZSxPdC5wcm90b3R5cGUuY29uc3RydWN0b3I9T3QsenQucHJvdG90eXBlPXVuKGt0LnByb3RvdHlwZSksenQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXp0LFV0LnByb3RvdHlwZT11bihrdC5wcm90b3R5cGUpLFV0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1VdCwkdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9fZGF0YV9fPXNvP3NvKG51bGwpOnt9fSwkdC5wcm90b3R5cGVbXCJkZWxldGVcIl09ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaGFzKHQpJiZkZWxldGUgdGhpcy5fX2RhdGFfX1t0XTtcclxufSwkdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMuX19kYXRhX187cmV0dXJuIHNvPyh0PW5bdF0sXCJfX2xvZGFzaF9oYXNoX3VuZGVmaW5lZF9fXCI9PT10P1Q6dCk6V3UuY2FsbChuLHQpP25bdF06VH0sJHQucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXt2YXIgbj10aGlzLl9fZGF0YV9fO3JldHVybiBzbz9uW3RdIT09VDpXdS5jYWxsKG4sdCl9LCR0LnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdGhpcy5fX2RhdGFfX1t0XT1zbyYmbj09PVQ/XCJfX2xvZGFzaF9oYXNoX3VuZGVmaW5lZF9fXCI6bix0aGlzfSxEdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9fZGF0YV9fPVtdfSxEdC5wcm90b3R5cGVbXCJkZWxldGVcIl09ZnVuY3Rpb24odCl7dmFyIG49dGhpcy5fX2RhdGFfXztyZXR1cm4gdD1IdChuLHQpLDA+dD9mYWxzZToodD09bi5sZW5ndGgtMT9uLnBvcCgpOlZ1LmNhbGwobix0LDEpLHRydWUpfSxEdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe1xyXG52YXIgbj10aGlzLl9fZGF0YV9fO3JldHVybiB0PUh0KG4sdCksMD50P1Q6blt0XVsxXX0sRHQucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXtyZXR1cm4tMTxIdCh0aGlzLl9fZGF0YV9fLHQpfSxEdC5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsbil7dmFyIHI9dGhpcy5fX2RhdGFfXyxlPUh0KHIsdCk7cmV0dXJuIDA+ZT9yLnB1c2goW3Qsbl0pOnJbZV1bMV09bix0aGlzfSxQdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9fZGF0YV9fPXtoYXNoOm5ldyAkdCxtYXA6bmV3KGZvfHxEdCksc3RyaW5nOm5ldyAkdH19LFB0LnByb3RvdHlwZVtcImRlbGV0ZVwiXT1mdW5jdGlvbih0KXtyZXR1cm4gTnIodGhpcyx0KVtcImRlbGV0ZVwiXSh0KX0sUHQucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtyZXR1cm4gTnIodGhpcyx0KS5nZXQodCl9LFB0LnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24odCl7cmV0dXJuIE5yKHRoaXMsdCkuaGFzKHQpfSxQdC5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsbil7XHJcbnJldHVybiBOcih0aGlzLHQpLnNldCh0LG4pLHRoaXN9LFp0LnByb3RvdHlwZS5hZGQ9WnQucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19kYXRhX18uc2V0KHQsXCJfX2xvZGFzaF9oYXNoX3VuZGVmaW5lZF9fXCIpLHRoaXN9LFp0LnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19kYXRhX18uaGFzKHQpfSxxdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9fZGF0YV9fPW5ldyBEdH0scXQucHJvdG90eXBlW1wiZGVsZXRlXCJdPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9fZGF0YV9fW1wiZGVsZXRlXCJdKHQpfSxxdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9fZGF0YV9fLmdldCh0KX0scXQucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fX2RhdGFfXy5oYXModCl9LHF0LnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24odCxuKXt2YXIgcj10aGlzLl9fZGF0YV9fO3JldHVybiByIGluc3RhbmNlb2YgRHQmJjIwMD09ci5fX2RhdGFfXy5sZW5ndGgmJihyPXRoaXMuX19kYXRhX189bmV3IFB0KHIuX19kYXRhX18pKSxcclxuci5zZXQodCxuKSx0aGlzfTt2YXIgQW89dnIoaG4pLE9vPXZyKHBuLHRydWUpLGtvPWdyKCksRW89Z3IodHJ1ZSk7TnUmJiFxdS5jYWxsKHt2YWx1ZU9mOjF9LFwidmFsdWVPZlwiKSYmKEVuPWZ1bmN0aW9uKHQpe3JldHVybiB6KE51KHQpKX0pO3ZhciBTbz1obz9mdW5jdGlvbih0LG4pe3JldHVybiBoby5zZXQodCxuKSx0fTpwdSxJbz1hbyYmMS9EKG5ldyBhbyhbLC0wXSkpWzFdPT1xP2Z1bmN0aW9uKHQpe3JldHVybiBuZXcgYW8odCl9Omd1LFJvPWhvP2Z1bmN0aW9uKHQpe3JldHVybiBoby5nZXQodCl9Omd1LFdvPVVuKFwibGVuZ3RoXCIpO1B1fHwoVHI9eXUpO3ZhciBCbz1QdT9mdW5jdGlvbih0KXtmb3IodmFyIG49W107dDspcyhuLFRyKHQpKSx0PUp1KE9iamVjdCh0KSk7cmV0dXJuIG59OlRyOyhpbyYmXCJbb2JqZWN0IERhdGFWaWV3XVwiIT1xcihuZXcgaW8obmV3IEFycmF5QnVmZmVyKDEpKSl8fGZvJiZcIltvYmplY3QgTWFwXVwiIT1xcihuZXcgZm8pfHxjbyYmXCJbb2JqZWN0IFByb21pc2VdXCIhPXFyKGNvLnJlc29sdmUoKSl8fGFvJiZcIltvYmplY3QgU2V0XVwiIT1xcihuZXcgYW8pfHxsbyYmXCJbb2JqZWN0IFdlYWtNYXBdXCIhPXFyKG5ldyBsbykpJiYocXI9ZnVuY3Rpb24odCl7XHJcbnZhciBuPU11LmNhbGwodCk7aWYodD0odD1cIltvYmplY3QgT2JqZWN0XVwiPT1uP3QuY29uc3RydWN0b3I6VCk/Y2UodCk6VClzd2l0Y2godCl7Y2FzZSB2bzpyZXR1cm5cIltvYmplY3QgRGF0YVZpZXddXCI7Y2FzZSBnbzpyZXR1cm5cIltvYmplY3QgTWFwXVwiO2Nhc2UgeW86cmV0dXJuXCJbb2JqZWN0IFByb21pc2VdXCI7Y2FzZSBibzpyZXR1cm5cIltvYmplY3QgU2V0XVwiO2Nhc2UgeG86cmV0dXJuXCJbb2JqZWN0IFdlYWtNYXBdXCJ9cmV0dXJuIG59KTt2YXIgTG89U3U/RmU6YnUsTW89ZnVuY3Rpb24oKXt2YXIgdD0wLG49MDtyZXR1cm4gZnVuY3Rpb24ocixlKXt2YXIgdT1FZSgpLG89MTYtKHUtbik7aWYobj11LG8+MCl7aWYoMTUwPD0rK3QpcmV0dXJuIHJ9ZWxzZSB0PTA7cmV0dXJuIFNvKHIsZSl9fSgpLENvPUxlKGZ1bmN0aW9uKHQpe3ZhciBuPVtdO3JldHVybiBldSh0KS5yZXBsYWNlKG90LGZ1bmN0aW9uKHQscixlLHUpe24ucHVzaChlP3UucmVwbGFjZShodCxcIiQxXCIpOnJ8fHQpfSksXHJcbm59KSx6bz1NZShmdW5jdGlvbih0LG4pe3JldHVybiAkZSh0KT9mbih0LHNuKG4sMSwkZSx0cnVlKSk6W119KSxVbz1NZShmdW5jdGlvbih0LG4pe3ZhciByPXZlKG4pO3JldHVybiAkZShyKSYmKHI9VCksJGUodCk/Zm4odCxzbihuLDEsJGUsdHJ1ZSksRnIocikpOltdfSksJG89TWUoZnVuY3Rpb24odCxuKXt2YXIgcj12ZShuKTtyZXR1cm4gJGUocikmJihyPVQpLCRlKHQpP2ZuKHQsc24obiwxLCRlLHRydWUpLFQscik6W119KSxEbz1NZShmdW5jdGlvbih0KXt2YXIgbj1sKHQscnIpO3JldHVybiBuLmxlbmd0aCYmblswXT09PXRbMF0/eG4obik6W119KSxGbz1NZShmdW5jdGlvbih0KXt2YXIgbj12ZSh0KSxyPWwodCxycik7cmV0dXJuIG49PT12ZShyKT9uPVQ6ci5wb3AoKSxyLmxlbmd0aCYmclswXT09PXRbMF0/eG4ocixGcihuKSk6W119KSxObz1NZShmdW5jdGlvbih0KXt2YXIgbj12ZSh0KSxyPWwodCxycik7cmV0dXJuIG49PT12ZShyKT9uPVQ6ci5wb3AoKSxyLmxlbmd0aCYmclswXT09PXRbMF0/eG4ocixULG4pOltdO1xyXG59KSxQbz1NZShnZSksWm89TWUoZnVuY3Rpb24odCxuKXtuPXNuKG4sMSk7dmFyIHI9dD90Lmxlbmd0aDowLGU9dG4odCxuKTtyZXR1cm4gRm4odCxsKG4sZnVuY3Rpb24odCl7cmV0dXJuIFhyKHQscik/K3Q6dH0pLnNvcnQoZnIpKSxlfSksVG89TWUoZnVuY3Rpb24odCl7cmV0dXJuIEhuKHNuKHQsMSwkZSx0cnVlKSl9KSxxbz1NZShmdW5jdGlvbih0KXt2YXIgbj12ZSh0KTtyZXR1cm4gJGUobikmJihuPVQpLEhuKHNuKHQsMSwkZSx0cnVlKSxGcihuKSl9KSxWbz1NZShmdW5jdGlvbih0KXt2YXIgbj12ZSh0KTtyZXR1cm4gJGUobikmJihuPVQpLEhuKHNuKHQsMSwkZSx0cnVlKSxULG4pfSksS289TWUoZnVuY3Rpb24odCxuKXtyZXR1cm4gJGUodCk/Zm4odCxuKTpbXX0pLEdvPU1lKGZ1bmN0aW9uKHQpe3JldHVybiB0cihmKHQsJGUpKX0pLEpvPU1lKGZ1bmN0aW9uKHQpe3ZhciBuPXZlKHQpO3JldHVybiAkZShuKSYmKG49VCksdHIoZih0LCRlKSxGcihuKSl9KSxZbz1NZShmdW5jdGlvbih0KXtcclxudmFyIG49dmUodCk7cmV0dXJuICRlKG4pJiYobj1UKSx0cihmKHQsJGUpLFQsbil9KSxIbz1NZSh5ZSksUW89TWUoZnVuY3Rpb24odCl7dmFyIG49dC5sZW5ndGgsbj1uPjE/dFtuLTFdOlQsbj10eXBlb2Ygbj09XCJmdW5jdGlvblwiPyh0LnBvcCgpLG4pOlQ7cmV0dXJuIGJlKHQsbil9KSxYbz1NZShmdW5jdGlvbih0KXtmdW5jdGlvbiBuKG4pe3JldHVybiB0bihuLHQpfXQ9c24odCwxKTt2YXIgcj10Lmxlbmd0aCxlPXI/dFswXTowLHU9dGhpcy5fX3dyYXBwZWRfXztyZXR1cm4hKHI+MXx8dGhpcy5fX2FjdGlvbnNfXy5sZW5ndGgpJiZ1IGluc3RhbmNlb2YgVXQmJlhyKGUpPyh1PXUuc2xpY2UoZSwrZSsocj8xOjApKSx1Ll9fYWN0aW9uc19fLnB1c2goe2Z1bmM6amUsYXJnczpbbl0sdGhpc0FyZzpUfSksbmV3IHp0KHUsdGhpcy5fX2NoYWluX18pLnRocnUoZnVuY3Rpb24odCl7cmV0dXJuIHImJiF0Lmxlbmd0aCYmdC5wdXNoKFQpLHR9KSk6dGhpcy50aHJ1KG4pfSksdGk9cHIoZnVuY3Rpb24odCxuLHIpe1xyXG5XdS5jYWxsKHQscik/Kyt0W3JdOnRbcl09MX0pLG5pPXdyKGhlKSxyaT13cihwZSksZWk9cHIoZnVuY3Rpb24odCxuLHIpe1d1LmNhbGwodCxyKT90W3JdLnB1c2gobik6dFtyXT1bbl19KSx1aT1NZShmdW5jdGlvbih0LG4sZSl7dmFyIHU9LTEsbz10eXBlb2Ygbj09XCJmdW5jdGlvblwiLGk9bmUobiksZj1VZSh0KT9BcnJheSh0Lmxlbmd0aCk6W107cmV0dXJuIEFvKHQsZnVuY3Rpb24odCl7dmFyIGM9bz9uOmkmJm51bGwhPXQ/dFtuXTpUO2ZbKyt1XT1jP3IoYyx0LGUpOnduKHQsbixlKX0pLGZ9KSxvaT1wcihmdW5jdGlvbih0LG4scil7dFtyXT1ufSksaWk9cHIoZnVuY3Rpb24odCxuLHIpe3Rbcj8wOjFdLnB1c2gobil9LGZ1bmN0aW9uKCl7cmV0dXJuW1tdLFtdXX0pLGZpPU1lKGZ1bmN0aW9uKHQsbil7aWYobnVsbD09dClyZXR1cm5bXTt2YXIgcj1uLmxlbmd0aDtyZXR1cm4gcj4xJiZ0ZSh0LG5bMF0sblsxXSk/bj1bXTpyPjImJnRlKG5bMF0sblsxXSxuWzJdKSYmKG49W25bMF1dKSxcclxubj0xPT1uLmxlbmd0aCYmeWkoblswXSk/blswXTpzbihuLDEsUXIpLE1uKHQsbixbXSl9KSxjaT1NZShmdW5jdGlvbih0LG4scil7dmFyIGU9MTtpZihyLmxlbmd0aCl2YXIgdT0kKHIsRHIoY2kpKSxlPTMyfGU7cmV0dXJuIENyKHQsZSxuLHIsdSl9KSxhaT1NZShmdW5jdGlvbih0LG4scil7dmFyIGU9MztpZihyLmxlbmd0aCl2YXIgdT0kKHIsRHIoYWkpKSxlPTMyfGU7cmV0dXJuIENyKG4sZSx0LHIsdSl9KSxsaT1NZShmdW5jdGlvbih0LG4pe3JldHVybiBvbih0LDEsbil9KSxzaT1NZShmdW5jdGlvbih0LG4scil7cmV0dXJuIG9uKHQsbnUobil8fDAscil9KTtMZS5DYWNoZT1QdDt2YXIgaGk9TWUoZnVuY3Rpb24odCxuKXtuPTE9PW4ubGVuZ3RoJiZ5aShuWzBdKT9sKG5bMF0sTyhGcigpKSk6bChzbihuLDEsUXIpLE8oRnIoKSkpO3ZhciBlPW4ubGVuZ3RoO3JldHVybiBNZShmdW5jdGlvbih1KXtmb3IodmFyIG89LTEsaT10byh1Lmxlbmd0aCxlKTsrK288aTspdVtvXT1uW29dLmNhbGwodGhpcyx1W29dKTtcclxucmV0dXJuIHIodCx0aGlzLHUpfSl9KSxwaT1NZShmdW5jdGlvbih0LG4pe3ZhciByPSQobixEcihwaSkpO3JldHVybiBDcih0LDMyLFQsbixyKX0pLF9pPU1lKGZ1bmN0aW9uKHQsbil7dmFyIHI9JChuLERyKF9pKSk7cmV0dXJuIENyKHQsNjQsVCxuLHIpfSksdmk9TWUoZnVuY3Rpb24odCxuKXtyZXR1cm4gQ3IodCwyNTYsVCxULFQsc24obiwxKSl9KSxnaT1XcihkbiksZGk9V3IoZnVuY3Rpb24odCxuKXtyZXR1cm4gdD49bn0pLHlpPUFycmF5LmlzQXJyYXksYmk9VXU/ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBVdX06YnUseGk9V3IoU24pLGppPVdyKGZ1bmN0aW9uKHQsbil7cmV0dXJuIG4+PXR9KSx3aT1fcihmdW5jdGlvbih0LG4pe2lmKHBvfHxlZShuKXx8VWUobikpc3IobixpdShuKSx0KTtlbHNlIGZvcih2YXIgciBpbiBuKVd1LmNhbGwobixyKSYmWXQodCxyLG5bcl0pfSksbWk9X3IoZnVuY3Rpb24odCxuKXtpZihwb3x8ZWUobil8fFVlKG4pKXNyKG4sZnUobiksdCk7ZWxzZSBmb3IodmFyIHIgaW4gbilZdCh0LHIsbltyXSk7XHJcbn0pLEFpPV9yKGZ1bmN0aW9uKHQsbixyLGUpe3NyKG4sZnUobiksdCxlKX0pLE9pPV9yKGZ1bmN0aW9uKHQsbixyLGUpe3NyKG4saXUobiksdCxlKX0pLGtpPU1lKGZ1bmN0aW9uKHQsbil7cmV0dXJuIHRuKHQsc24obiwxKSl9KSxFaT1NZShmdW5jdGlvbih0KXtyZXR1cm4gdC5wdXNoKFQsVnQpLHIoQWksVCx0KX0pLFNpPU1lKGZ1bmN0aW9uKHQpe3JldHVybiB0LnB1c2goVCxvZSkscihMaSxULHQpfSksSWk9T3IoZnVuY3Rpb24odCxuLHIpe3Rbbl09cn0saHUocHUpKSxSaT1PcihmdW5jdGlvbih0LG4scil7V3UuY2FsbCh0LG4pP3Rbbl0ucHVzaChyKTp0W25dPVtyXX0sRnIpLFdpPU1lKHduKSxCaT1fcihmdW5jdGlvbih0LG4scil7Qm4odCxuLHIpfSksTGk9X3IoZnVuY3Rpb24odCxuLHIsZSl7Qm4odCxuLHIsZSl9KSxNaT1NZShmdW5jdGlvbih0LG4pe3JldHVybiBudWxsPT10P3t9OihuPWwoc24obiwxKSxmZSksQ24odCxmbihnbih0LGZ1LEJvKSxuKSkpfSksQ2k9TWUoZnVuY3Rpb24odCxuKXtcclxucmV0dXJuIG51bGw9PXQ/e306Q24odCxsKHNuKG4sMSksZmUpKX0pLHppPU1yKGl1KSxVaT1NcihmdSksJGk9YnIoZnVuY3Rpb24odCxuLHIpe3JldHVybiBuPW4udG9Mb3dlckNhc2UoKSx0KyhyP2F1KG4pOm4pfSksRGk9YnIoZnVuY3Rpb24odCxuLHIpe3JldHVybiB0KyhyP1wiLVwiOlwiXCIpK24udG9Mb3dlckNhc2UoKX0pLEZpPWJyKGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gdCsocj9cIiBcIjpcIlwiKStuLnRvTG93ZXJDYXNlKCl9KSxOaT15cihcInRvTG93ZXJDYXNlXCIpLFBpPWJyKGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gdCsocj9cIl9cIjpcIlwiKStuLnRvTG93ZXJDYXNlKCl9KSxaaT1icihmdW5jdGlvbih0LG4scil7cmV0dXJuIHQrKHI/XCIgXCI6XCJcIikrcWkobil9KSxUaT1icihmdW5jdGlvbih0LG4scil7cmV0dXJuIHQrKHI/XCIgXCI6XCJcIikrbi50b1VwcGVyQ2FzZSgpfSkscWk9eXIoXCJ0b1VwcGVyQ2FzZVwiKSxWaT1NZShmdW5jdGlvbih0LG4pe3RyeXtyZXR1cm4gcih0LFQsbil9Y2F0Y2goZSl7XHJcbnJldHVybiBEZShlKT9lOm5ldyBqdShlKX19KSxLaT1NZShmdW5jdGlvbih0LG4pe3JldHVybiB1KHNuKG4sMSksZnVuY3Rpb24obil7bj1mZShuKSx0W25dPWNpKHRbbl0sdCl9KSx0fSksR2k9bXIoKSxKaT1tcih0cnVlKSxZaT1NZShmdW5jdGlvbih0LG4pe3JldHVybiBmdW5jdGlvbihyKXtyZXR1cm4gd24ocix0LG4pfX0pLEhpPU1lKGZ1bmN0aW9uKHQsbil7cmV0dXJuIGZ1bmN0aW9uKHIpe3JldHVybiB3bih0LHIsbil9fSksUWk9RXIobCksWGk9RXIoaSksdGY9RXIoXyksbmY9UnIoKSxyZj1Scih0cnVlKSxlZj1rcihmdW5jdGlvbih0LG4pe3JldHVybiB0K259KSx1Zj1McihcImNlaWxcIiksb2Y9a3IoZnVuY3Rpb24odCxuKXtyZXR1cm4gdC9ufSksZmY9THIoXCJmbG9vclwiKSxjZj1rcihmdW5jdGlvbih0LG4pe3JldHVybiB0Km59KSxhZj1McihcInJvdW5kXCIpLGxmPWtyKGZ1bmN0aW9uKHQsbil7cmV0dXJuIHQtbn0pO3JldHVybiBPdC5hZnRlcj1mdW5jdGlvbih0LG4pe2lmKHR5cGVvZiBuIT1cImZ1bmN0aW9uXCIpdGhyb3cgbmV3IEF1KFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTtcclxucmV0dXJuIHQ9WGUodCksZnVuY3Rpb24oKXtyZXR1cm4gMT4tLXQ/bi5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dm9pZCAwfX0sT3QuYXJ5PVNlLE90LmFzc2lnbj13aSxPdC5hc3NpZ25Jbj1taSxPdC5hc3NpZ25JbldpdGg9QWksT3QuYXNzaWduV2l0aD1PaSxPdC5hdD1raSxPdC5iZWZvcmU9SWUsT3QuYmluZD1jaSxPdC5iaW5kQWxsPUtpLE90LmJpbmRLZXk9YWksT3QuY2FzdEFycmF5PWZ1bmN0aW9uKCl7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuW107dmFyIHQ9YXJndW1lbnRzWzBdO3JldHVybiB5aSh0KT90Olt0XX0sT3QuY2hhaW49eGUsT3QuY2h1bms9ZnVuY3Rpb24odCxuLHIpe2lmKG49KHI/dGUodCxuLHIpOm49PT1UKT8xOlh1KFhlKG4pLDApLHI9dD90Lmxlbmd0aDowLCFyfHwxPm4pcmV0dXJuW107Zm9yKHZhciBlPTAsdT0wLG89QXJyYXkoS3Uoci9uKSk7cj5lOylvW3UrK109VG4odCxlLGUrPW4pO3JldHVybiBvfSxPdC5jb21wYWN0PWZ1bmN0aW9uKHQpe2Zvcih2YXIgbj0tMSxyPXQ/dC5sZW5ndGg6MCxlPTAsdT1bXTsrK248cjspe1xyXG52YXIgbz10W25dO28mJih1W2UrK109byl9cmV0dXJuIHV9LE90LmNvbmNhdD1mdW5jdGlvbigpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLG49QXJyYXkodD90LTE6MCkscj1hcmd1bWVudHNbMF0sZT10O2UtLTspbltlLTFdPWFyZ3VtZW50c1tlXTtyZXR1cm4gdD9zKHlpKHIpP2xyKHIpOltyXSxzbihuLDEpKTpbXX0sT3QuY29uZD1mdW5jdGlvbih0KXt2YXIgbj10P3QubGVuZ3RoOjAsZT1GcigpO3JldHVybiB0PW4/bCh0LGZ1bmN0aW9uKHQpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRbMV0pdGhyb3cgbmV3IEF1KFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTtyZXR1cm5bZSh0WzBdKSx0WzFdXX0pOltdLE1lKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdT0tMTsrK3U8bjspe3ZhciBvPXRbdV07aWYocihvWzBdLHRoaXMsZSkpcmV0dXJuIHIob1sxXSx0aGlzLGUpfX0pfSxPdC5jb25mb3Jtcz1mdW5jdGlvbih0KXtyZXR1cm4gZW4ocm4odCx0cnVlKSl9LE90LmNvbnN0YW50PWh1LE90LmNvdW50Qnk9dGksXHJcbk90LmNyZWF0ZT1mdW5jdGlvbih0LG4pe3ZhciByPXVuKHQpO3JldHVybiBuP1h0KHIsbik6cn0sT3QuY3Vycnk9UmUsT3QuY3VycnlSaWdodD1XZSxPdC5kZWJvdW5jZT1CZSxPdC5kZWZhdWx0cz1FaSxPdC5kZWZhdWx0c0RlZXA9U2ksT3QuZGVmZXI9bGksT3QuZGVsYXk9c2ksT3QuZGlmZmVyZW5jZT16byxPdC5kaWZmZXJlbmNlQnk9VW8sT3QuZGlmZmVyZW5jZVdpdGg9JG8sT3QuZHJvcD1sZSxPdC5kcm9wUmlnaHQ9c2UsT3QuZHJvcFJpZ2h0V2hpbGU9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/UW4odCxGcihuLDMpLHRydWUsdHJ1ZSk6W119LE90LmRyb3BXaGlsZT1mdW5jdGlvbih0LG4pe3JldHVybiB0JiZ0Lmxlbmd0aD9Rbih0LEZyKG4sMyksdHJ1ZSk6W119LE90LmZpbGw9ZnVuY3Rpb24odCxuLHIsZSl7dmFyIHU9dD90Lmxlbmd0aDowO2lmKCF1KXJldHVybltdO2ZvcihyJiZ0eXBlb2YgciE9XCJudW1iZXJcIiYmdGUodCxuLHIpJiYocj0wLGU9dSksdT10Lmxlbmd0aCxcclxucj1YZShyKSwwPnImJihyPS1yPnU/MDp1K3IpLGU9ZT09PVR8fGU+dT91OlhlKGUpLDA+ZSYmKGUrPXUpLGU9cj5lPzA6dHUoZSk7ZT5yOyl0W3IrK109bjtyZXR1cm4gdH0sT3QuZmlsdGVyPWZ1bmN0aW9uKHQsbil7cmV0dXJuKHlpKHQpP2Y6bG4pKHQsRnIobiwzKSl9LE90LmZsYXRNYXA9ZnVuY3Rpb24odCxuKXtyZXR1cm4gc24oT2UodCxuKSwxKX0sT3QuZmxhdE1hcERlZXA9ZnVuY3Rpb24odCxuKXtyZXR1cm4gc24oT2UodCxuKSxxKX0sT3QuZmxhdE1hcERlcHRoPWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gcj1yPT09VD8xOlhlKHIpLHNuKE9lKHQsbikscil9LE90LmZsYXR0ZW49ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQubGVuZ3RoP3NuKHQsMSk6W119LE90LmZsYXR0ZW5EZWVwPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lmxlbmd0aD9zbih0LHEpOltdfSxPdC5mbGF0dGVuRGVwdGg9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/KG49bj09PVQ/MTpYZShuKSxzbih0LG4pKTpbXTtcclxufSxPdC5mbGlwPWZ1bmN0aW9uKHQpe3JldHVybiBDcih0LDUxMil9LE90LmZsb3c9R2ksT3QuZmxvd1JpZ2h0PUppLE90LmZyb21QYWlycz1mdW5jdGlvbih0KXtmb3IodmFyIG49LTEscj10P3QubGVuZ3RoOjAsZT17fTsrK248cjspe3ZhciB1PXRbbl07ZVt1WzBdXT11WzFdfXJldHVybiBlfSxPdC5mdW5jdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/W106X24odCxpdSh0KSl9LE90LmZ1bmN0aW9uc0luPWZ1bmN0aW9uKHQpe3JldHVybiBudWxsPT10P1tdOl9uKHQsZnUodCkpfSxPdC5ncm91cEJ5PWVpLE90LmluaXRpYWw9ZnVuY3Rpb24odCl7cmV0dXJuIHNlKHQsMSl9LE90LmludGVyc2VjdGlvbj1EbyxPdC5pbnRlcnNlY3Rpb25CeT1GbyxPdC5pbnRlcnNlY3Rpb25XaXRoPU5vLE90LmludmVydD1JaSxPdC5pbnZlcnRCeT1SaSxPdC5pbnZva2VNYXA9dWksT3QuaXRlcmF0ZWU9X3UsT3Qua2V5Qnk9b2ksT3Qua2V5cz1pdSxPdC5rZXlzSW49ZnUsT3QubWFwPU9lLFxyXG5PdC5tYXBLZXlzPWZ1bmN0aW9uKHQsbil7dmFyIHI9e307cmV0dXJuIG49RnIobiwzKSxobih0LGZ1bmN0aW9uKHQsZSx1KXtyW24odCxlLHUpXT10fSkscn0sT3QubWFwVmFsdWVzPWZ1bmN0aW9uKHQsbil7dmFyIHI9e307cmV0dXJuIG49RnIobiwzKSxobih0LGZ1bmN0aW9uKHQsZSx1KXtyW2VdPW4odCxlLHUpfSkscn0sT3QubWF0Y2hlcz1mdW5jdGlvbih0KXtyZXR1cm4gUm4ocm4odCx0cnVlKSl9LE90Lm1hdGNoZXNQcm9wZXJ0eT1mdW5jdGlvbih0LG4pe3JldHVybiBXbih0LHJuKG4sdHJ1ZSkpfSxPdC5tZW1vaXplPUxlLE90Lm1lcmdlPUJpLE90Lm1lcmdlV2l0aD1MaSxPdC5tZXRob2Q9WWksT3QubWV0aG9kT2Y9SGksT3QubWl4aW49dnUsT3QubmVnYXRlPWZ1bmN0aW9uKHQpe2lmKHR5cGVvZiB0IT1cImZ1bmN0aW9uXCIpdGhyb3cgbmV3IEF1KFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4hdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxPdC5udGhBcmc9ZnVuY3Rpb24odCl7XHJcbnJldHVybiB0PVhlKHQpLE1lKGZ1bmN0aW9uKG4pe3JldHVybiBMbihuLHQpfSl9LE90Lm9taXQ9TWksT3Qub21pdEJ5PWZ1bmN0aW9uKHQsbil7cmV0dXJuIG49RnIobiksem4odCxmdW5jdGlvbih0LHIpe3JldHVybiFuKHQscil9KX0sT3Qub25jZT1mdW5jdGlvbih0KXtyZXR1cm4gSWUoMix0KX0sT3Qub3JkZXJCeT1mdW5jdGlvbih0LG4scixlKXtyZXR1cm4gbnVsbD09dD9bXTooeWkobil8fChuPW51bGw9PW4/W106W25dKSxyPWU/VDpyLHlpKHIpfHwocj1udWxsPT1yP1tdOltyXSksTW4odCxuLHIpKX0sT3Qub3Zlcj1RaSxPdC5vdmVyQXJncz1oaSxPdC5vdmVyRXZlcnk9WGksT3Qub3ZlclNvbWU9dGYsT3QucGFydGlhbD1waSxPdC5wYXJ0aWFsUmlnaHQ9X2ksT3QucGFydGl0aW9uPWlpLE90LnBpY2s9Q2ksT3QucGlja0J5PWZ1bmN0aW9uKHQsbil7cmV0dXJuIG51bGw9PXQ/e306em4odCxGcihuKSl9LE90LnByb3BlcnR5PWR1LE90LnByb3BlcnR5T2Y9ZnVuY3Rpb24odCl7XHJcbnJldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gbnVsbD09dD9UOnZuKHQsbil9fSxPdC5wdWxsPVBvLE90LnB1bGxBbGw9Z2UsT3QucHVsbEFsbEJ5PWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gdCYmdC5sZW5ndGgmJm4mJm4ubGVuZ3RoP0RuKHQsbixGcihyKSk6dH0sT3QucHVsbEFsbFdpdGg9ZnVuY3Rpb24odCxuLHIpe3JldHVybiB0JiZ0Lmxlbmd0aCYmbiYmbi5sZW5ndGg/RG4odCxuLFQscik6dH0sT3QucHVsbEF0PVpvLE90LnJhbmdlPW5mLE90LnJhbmdlUmlnaHQ9cmYsT3QucmVhcmc9dmksT3QucmVqZWN0PWZ1bmN0aW9uKHQsbil7dmFyIHI9eWkodCk/ZjpsbjtyZXR1cm4gbj1GcihuLDMpLHIodCxmdW5jdGlvbih0LHIsZSl7cmV0dXJuIW4odCxyLGUpfSl9LE90LnJlbW92ZT1mdW5jdGlvbih0LG4pe3ZhciByPVtdO2lmKCF0fHwhdC5sZW5ndGgpcmV0dXJuIHI7dmFyIGU9LTEsdT1bXSxvPXQubGVuZ3RoO2ZvcihuPUZyKG4sMyk7KytlPG87KXt2YXIgaT10W2VdO24oaSxlLHQpJiYoci5wdXNoKGkpLFxyXG51LnB1c2goZSkpfXJldHVybiBGbih0LHUpLHJ9LE90LnJlc3Q9TWUsT3QucmV2ZXJzZT1kZSxPdC5zYW1wbGVTaXplPWtlLE90LnNldD1mdW5jdGlvbih0LG4scil7cmV0dXJuIG51bGw9PXQ/dDpabih0LG4scil9LE90LnNldFdpdGg9ZnVuY3Rpb24odCxuLHIsZSl7cmV0dXJuIGU9dHlwZW9mIGU9PVwiZnVuY3Rpb25cIj9lOlQsbnVsbD09dD90OlpuKHQsbixyLGUpfSxPdC5zaHVmZmxlPWZ1bmN0aW9uKHQpe3JldHVybiBrZSh0LDQyOTQ5NjcyOTUpfSxPdC5zbGljZT1mdW5jdGlvbih0LG4scil7dmFyIGU9dD90Lmxlbmd0aDowO3JldHVybiBlPyhyJiZ0eXBlb2YgciE9XCJudW1iZXJcIiYmdGUodCxuLHIpPyhuPTAscj1lKToobj1udWxsPT1uPzA6WGUobikscj1yPT09VD9lOlhlKHIpKSxUbih0LG4scikpOltdfSxPdC5zb3J0Qnk9ZmksT3Quc29ydGVkVW5pcT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5sZW5ndGg/R24odCk6W119LE90LnNvcnRlZFVuaXFCeT1mdW5jdGlvbih0LG4pe1xyXG5yZXR1cm4gdCYmdC5sZW5ndGg/R24odCxGcihuKSk6W119LE90LnNwbGl0PWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gciYmdHlwZW9mIHIhPVwibnVtYmVyXCImJnRlKHQsbixyKSYmKG49cj1UKSxyPXI9PT1UPzQyOTQ5NjcyOTU6cj4+PjAscj8odD1ldSh0KSkmJih0eXBlb2Ygbj09XCJzdHJpbmdcInx8bnVsbCE9biYmIUtlKG4pKSYmKG49WW4obiksXCJcIj09biYmV3QudGVzdCh0KSk/dXIodC5tYXRjaChJdCksMCxyKTpvby5jYWxsKHQsbixyKTpbXX0sT3Quc3ByZWFkPWZ1bmN0aW9uKHQsbil7aWYodHlwZW9mIHQhPVwiZnVuY3Rpb25cIil0aHJvdyBuZXcgQXUoXCJFeHBlY3RlZCBhIGZ1bmN0aW9uXCIpO3JldHVybiBuPW49PT1UPzA6WHUoWGUobiksMCksTWUoZnVuY3Rpb24oZSl7dmFyIHU9ZVtuXTtyZXR1cm4gZT11cihlLDAsbiksdSYmcyhlLHUpLHIodCx0aGlzLGUpfSl9LE90LnRhaWw9ZnVuY3Rpb24odCl7cmV0dXJuIGxlKHQsMSl9LE90LnRha2U9ZnVuY3Rpb24odCxuLHIpe3JldHVybiB0JiZ0Lmxlbmd0aD8obj1yfHxuPT09VD8xOlhlKG4pLFxyXG5Ubih0LDAsMD5uPzA6bikpOltdfSxPdC50YWtlUmlnaHQ9ZnVuY3Rpb24odCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtyZXR1cm4gZT8obj1yfHxuPT09VD8xOlhlKG4pLG49ZS1uLFRuKHQsMD5uPzA6bixlKSk6W119LE90LnRha2VSaWdodFdoaWxlPWZ1bmN0aW9uKHQsbil7cmV0dXJuIHQmJnQubGVuZ3RoP1FuKHQsRnIobiwzKSxmYWxzZSx0cnVlKTpbXX0sT3QudGFrZVdoaWxlPWZ1bmN0aW9uKHQsbil7cmV0dXJuIHQmJnQubGVuZ3RoP1FuKHQsRnIobiwzKSk6W119LE90LnRhcD1mdW5jdGlvbih0LG4pe3JldHVybiBuKHQpLHR9LE90LnRocm90dGxlPWZ1bmN0aW9uKHQsbixyKXt2YXIgZT10cnVlLHU9dHJ1ZTtpZih0eXBlb2YgdCE9XCJmdW5jdGlvblwiKXRocm93IG5ldyBBdShcIkV4cGVjdGVkIGEgZnVuY3Rpb25cIik7cmV0dXJuIFplKHIpJiYoZT1cImxlYWRpbmdcImluIHI/ISFyLmxlYWRpbmc6ZSx1PVwidHJhaWxpbmdcImluIHI/ISFyLnRyYWlsaW5nOnUpLEJlKHQsbix7bGVhZGluZzplLG1heFdhaXQ6bixcclxudHJhaWxpbmc6dX0pfSxPdC50aHJ1PWplLE90LnRvQXJyYXk9SGUsT3QudG9QYWlycz16aSxPdC50b1BhaXJzSW49VWksT3QudG9QYXRoPWZ1bmN0aW9uKHQpe3JldHVybiB5aSh0KT9sKHQsZmUpOkplKHQpP1t0XTpscihDbyh0KSl9LE90LnRvUGxhaW5PYmplY3Q9cnUsT3QudHJhbnNmb3JtPWZ1bmN0aW9uKHQsbixyKXt2YXIgZT15aSh0KXx8WWUodCk7aWYobj1GcihuLDQpLG51bGw9PXIpaWYoZXx8WmUodCkpe3ZhciBvPXQuY29uc3RydWN0b3I7cj1lP3lpKHQpP25ldyBvOltdOkZlKG8pP3VuKEp1KE9iamVjdCh0KSkpOnt9fWVsc2Ugcj17fTtyZXR1cm4oZT91OmhuKSh0LGZ1bmN0aW9uKHQsZSx1KXtyZXR1cm4gbihyLHQsZSx1KX0pLHJ9LE90LnVuYXJ5PWZ1bmN0aW9uKHQpe3JldHVybiBTZSh0LDEpfSxPdC51bmlvbj1UbyxPdC51bmlvbkJ5PXFvLE90LnVuaW9uV2l0aD1WbyxPdC51bmlxPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lmxlbmd0aD9Ibih0KTpbXX0sT3QudW5pcUJ5PWZ1bmN0aW9uKHQsbil7XHJcbnJldHVybiB0JiZ0Lmxlbmd0aD9Ibih0LEZyKG4pKTpbXX0sT3QudW5pcVdpdGg9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/SG4odCxULG4pOltdfSxPdC51bnNldD1mdW5jdGlvbih0LG4pe3ZhciByO2lmKG51bGw9PXQpcj10cnVlO2Vsc2V7cj10O3ZhciBlPW4sZT1uZShlLHIpP1tlXTplcihlKTtyPWllKHIsZSksZT1mZSh2ZShlKSkscj0hKG51bGwhPXImJnluKHIsZSkpfHxkZWxldGUgcltlXX1yZXR1cm4gcn0sT3QudW56aXA9eWUsT3QudW56aXBXaXRoPWJlLE90LnVwZGF0ZT1mdW5jdGlvbih0LG4scil7cmV0dXJuIG51bGw9PXQ/dDpabih0LG4sKHR5cGVvZiByPT1cImZ1bmN0aW9uXCI/cjpwdSkodm4odCxuKSksdm9pZCAwKX0sT3QudXBkYXRlV2l0aD1mdW5jdGlvbih0LG4scixlKXtyZXR1cm4gZT10eXBlb2YgZT09XCJmdW5jdGlvblwiP2U6VCxudWxsIT10JiYodD1abih0LG4sKHR5cGVvZiByPT1cImZ1bmN0aW9uXCI/cjpwdSkodm4odCxuKSksZSkpLHR9LE90LnZhbHVlcz1jdSxcclxuT3QudmFsdWVzSW49ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/W106ayh0LGZ1KHQpKX0sT3Qud2l0aG91dD1LbyxPdC53b3Jkcz1zdSxPdC53cmFwPWZ1bmN0aW9uKHQsbil7cmV0dXJuIG49bnVsbD09bj9wdTpuLHBpKG4sdCl9LE90Lnhvcj1HbyxPdC54b3JCeT1KbyxPdC54b3JXaXRoPVlvLE90LnppcD1IbyxPdC56aXBPYmplY3Q9ZnVuY3Rpb24odCxuKXtyZXR1cm4gbnIodHx8W10sbnx8W10sWXQpfSxPdC56aXBPYmplY3REZWVwPWZ1bmN0aW9uKHQsbil7cmV0dXJuIG5yKHR8fFtdLG58fFtdLFpuKX0sT3QuemlwV2l0aD1RbyxPdC5lbnRyaWVzPXppLE90LmVudHJpZXNJbj1VaSxPdC5leHRlbmQ9bWksT3QuZXh0ZW5kV2l0aD1BaSx2dShPdCxPdCksT3QuYWRkPWVmLE90LmF0dGVtcHQ9VmksT3QuY2FtZWxDYXNlPSRpLE90LmNhcGl0YWxpemU9YXUsT3QuY2VpbD11ZixPdC5jbGFtcD1mdW5jdGlvbih0LG4scil7cmV0dXJuIHI9PT1UJiYocj1uLG49VCksciE9PVQmJihyPW51KHIpLFxyXG5yPXI9PT1yP3I6MCksbiE9PVQmJihuPW51KG4pLG49bj09PW4/bjowKSxubihudSh0KSxuLHIpfSxPdC5jbG9uZT1mdW5jdGlvbih0KXtyZXR1cm4gcm4odCxmYWxzZSx0cnVlKX0sT3QuY2xvbmVEZWVwPWZ1bmN0aW9uKHQpe3JldHVybiBybih0LHRydWUsdHJ1ZSl9LE90LmNsb25lRGVlcFdpdGg9ZnVuY3Rpb24odCxuKXtyZXR1cm4gcm4odCx0cnVlLHRydWUsbil9LE90LmNsb25lV2l0aD1mdW5jdGlvbih0LG4pe3JldHVybiBybih0LGZhbHNlLHRydWUsbil9LE90LmRlYnVycj1sdSxPdC5kaXZpZGU9b2YsT3QuZW5kc1dpdGg9ZnVuY3Rpb24odCxuLHIpe3Q9ZXUodCksbj1ZbihuKTt2YXIgZT10Lmxlbmd0aDtyZXR1cm4gcj1yPT09VD9lOm5uKFhlKHIpLDAsZSksci09bi5sZW5ndGgscj49MCYmdC5pbmRleE9mKG4scik9PXJ9LE90LmVxPUNlLE90LmVzY2FwZT1mdW5jdGlvbih0KXtyZXR1cm4odD1ldSh0KSkmJlgudGVzdCh0KT90LnJlcGxhY2UoSCxCKTp0fSxPdC5lc2NhcGVSZWdFeHA9ZnVuY3Rpb24odCl7XHJcbnJldHVybih0PWV1KHQpKSYmZnQudGVzdCh0KT90LnJlcGxhY2UoaXQsXCJcXFxcJCZcIik6dH0sT3QuZXZlcnk9ZnVuY3Rpb24odCxuLHIpe3ZhciBlPXlpKHQpP2k6Y247cmV0dXJuIHImJnRlKHQsbixyKSYmKG49VCksZSh0LEZyKG4sMykpfSxPdC5maW5kPW5pLE90LmZpbmRJbmRleD1oZSxPdC5maW5kS2V5PWZ1bmN0aW9uKHQsbil7cmV0dXJuIHYodCxGcihuLDMpLGhuKX0sT3QuZmluZExhc3Q9cmksT3QuZmluZExhc3RJbmRleD1wZSxPdC5maW5kTGFzdEtleT1mdW5jdGlvbih0LG4pe3JldHVybiB2KHQsRnIobiwzKSxwbil9LE90LmZsb29yPWZmLE90LmZvckVhY2g9bWUsT3QuZm9yRWFjaFJpZ2h0PUFlLE90LmZvckluPWZ1bmN0aW9uKHQsbil7cmV0dXJuIG51bGw9PXQ/dDprbyh0LEZyKG4sMyksZnUpfSxPdC5mb3JJblJpZ2h0PWZ1bmN0aW9uKHQsbil7cmV0dXJuIG51bGw9PXQ/dDpFbyh0LEZyKG4sMyksZnUpfSxPdC5mb3JPd249ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmaG4odCxGcihuLDMpKTtcclxufSxPdC5mb3JPd25SaWdodD1mdW5jdGlvbih0LG4pe3JldHVybiB0JiZwbih0LEZyKG4sMykpfSxPdC5nZXQ9dXUsT3QuZ3Q9Z2ksT3QuZ3RlPWRpLE90Lmhhcz1mdW5jdGlvbih0LG4pe3JldHVybiBudWxsIT10JiZWcih0LG4seW4pfSxPdC5oYXNJbj1vdSxPdC5oZWFkPV9lLE90LmlkZW50aXR5PXB1LE90LmluY2x1ZGVzPWZ1bmN0aW9uKHQsbixyLGUpe3JldHVybiB0PVVlKHQpP3Q6Y3UodCkscj1yJiYhZT9YZShyKTowLGU9dC5sZW5ndGgsMD5yJiYocj1YdShlK3IsMCkpLEdlKHQpP2U+PXImJi0xPHQuaW5kZXhPZihuLHIpOiEhZSYmLTE8ZCh0LG4scil9LE90LmluZGV4T2Y9ZnVuY3Rpb24odCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtyZXR1cm4gZT8ocj1udWxsPT1yPzA6WGUociksMD5yJiYocj1YdShlK3IsMCkpLGQodCxuLHIpKTotMX0sT3QuaW5SYW5nZT1mdW5jdGlvbih0LG4scil7cmV0dXJuIG49bnUobil8fDAscj09PVQ/KHI9bixuPTApOnI9bnUocil8fDAsdD1udSh0KSxcclxudD49dG8obixyKSYmdDxYdShuLHIpfSxPdC5pbnZva2U9V2ksT3QuaXNBcmd1bWVudHM9emUsT3QuaXNBcnJheT15aSxPdC5pc0FycmF5QnVmZmVyPWZ1bmN0aW9uKHQpe3JldHVybiBUZSh0KSYmXCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiPT1NdS5jYWxsKHQpfSxPdC5pc0FycmF5TGlrZT1VZSxPdC5pc0FycmF5TGlrZU9iamVjdD0kZSxPdC5pc0Jvb2xlYW49ZnVuY3Rpb24odCl7cmV0dXJuIHRydWU9PT10fHxmYWxzZT09PXR8fFRlKHQpJiZcIltvYmplY3QgQm9vbGVhbl1cIj09TXUuY2FsbCh0KX0sT3QuaXNCdWZmZXI9YmksT3QuaXNEYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBUZSh0KSYmXCJbb2JqZWN0IERhdGVdXCI9PU11LmNhbGwodCl9LE90LmlzRWxlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4hIXQmJjE9PT10Lm5vZGVUeXBlJiZUZSh0KSYmIVZlKHQpfSxPdC5pc0VtcHR5PWZ1bmN0aW9uKHQpe2lmKFVlKHQpJiYoeWkodCl8fEdlKHQpfHxGZSh0LnNwbGljZSl8fHplKHQpfHxiaSh0KSkpcmV0dXJuIXQubGVuZ3RoO1xyXG5pZihUZSh0KSl7dmFyIG49cXIodCk7aWYoXCJbb2JqZWN0IE1hcF1cIj09bnx8XCJbb2JqZWN0IFNldF1cIj09bilyZXR1cm4hdC5zaXplfWZvcih2YXIgciBpbiB0KWlmKFd1LmNhbGwodCxyKSlyZXR1cm4gZmFsc2U7cmV0dXJuIShwbyYmaXUodCkubGVuZ3RoKX0sT3QuaXNFcXVhbD1mdW5jdGlvbih0LG4pe3JldHVybiBtbih0LG4pfSxPdC5pc0VxdWFsV2l0aD1mdW5jdGlvbih0LG4scil7dmFyIGU9KHI9dHlwZW9mIHI9PVwiZnVuY3Rpb25cIj9yOlQpP3IodCxuKTpUO3JldHVybiBlPT09VD9tbih0LG4scik6ISFlfSxPdC5pc0Vycm9yPURlLE90LmlzRmluaXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09XCJudW1iZXJcIiYmWXUodCl9LE90LmlzRnVuY3Rpb249RmUsT3QuaXNJbnRlZ2VyPU5lLE90LmlzTGVuZ3RoPVBlLE90LmlzTWFwPWZ1bmN0aW9uKHQpe3JldHVybiBUZSh0KSYmXCJbb2JqZWN0IE1hcF1cIj09cXIodCl9LE90LmlzTWF0Y2g9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdD09PW58fEFuKHQsbixQcihuKSk7XHJcbn0sT3QuaXNNYXRjaFdpdGg9ZnVuY3Rpb24odCxuLHIpe3JldHVybiByPXR5cGVvZiByPT1cImZ1bmN0aW9uXCI/cjpULEFuKHQsbixQcihuKSxyKX0sT3QuaXNOYU49ZnVuY3Rpb24odCl7cmV0dXJuIHFlKHQpJiZ0IT0rdH0sT3QuaXNOYXRpdmU9ZnVuY3Rpb24odCl7aWYoTG8odCkpdGhyb3cgbmV3IGp1KFwiVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCB3aXRoIGBjb3JlLWpzYC4gVHJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9lcy1zaGltcy5cIik7cmV0dXJuIE9uKHQpfSxPdC5pc05pbD1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dH0sT3QuaXNOdWxsPWZ1bmN0aW9uKHQpe3JldHVybiBudWxsPT09dH0sT3QuaXNOdW1iZXI9cWUsT3QuaXNPYmplY3Q9WmUsT3QuaXNPYmplY3RMaWtlPVRlLE90LmlzUGxhaW5PYmplY3Q9VmUsT3QuaXNSZWdFeHA9S2UsT3QuaXNTYWZlSW50ZWdlcj1mdW5jdGlvbih0KXtyZXR1cm4gTmUodCkmJnQ+PS05MDA3MTk5MjU0NzQwOTkxJiY5MDA3MTk5MjU0NzQwOTkxPj10O1xyXG59LE90LmlzU2V0PWZ1bmN0aW9uKHQpe3JldHVybiBUZSh0KSYmXCJbb2JqZWN0IFNldF1cIj09cXIodCl9LE90LmlzU3RyaW5nPUdlLE90LmlzU3ltYm9sPUplLE90LmlzVHlwZWRBcnJheT1ZZSxPdC5pc1VuZGVmaW5lZD1mdW5jdGlvbih0KXtyZXR1cm4gdD09PVR9LE90LmlzV2Vha01hcD1mdW5jdGlvbih0KXtyZXR1cm4gVGUodCkmJlwiW29iamVjdCBXZWFrTWFwXVwiPT1xcih0KX0sT3QuaXNXZWFrU2V0PWZ1bmN0aW9uKHQpe3JldHVybiBUZSh0KSYmXCJbb2JqZWN0IFdlYWtTZXRdXCI9PU11LmNhbGwodCl9LE90LmpvaW49ZnVuY3Rpb24odCxuKXtyZXR1cm4gdD9IdS5jYWxsKHQsbik6XCJcIn0sT3Qua2ViYWJDYXNlPURpLE90Lmxhc3Q9dmUsT3QubGFzdEluZGV4T2Y9ZnVuY3Rpb24odCxuLHIpe3ZhciBlPXQ/dC5sZW5ndGg6MDtpZighZSlyZXR1cm4tMTt2YXIgdT1lO2lmKHIhPT1UJiYodT1YZShyKSx1PSgwPnU/WHUoZSt1LDApOnRvKHUsZS0xKSkrMSksbiE9PW4pcmV0dXJuIE0odCx1LTEsdHJ1ZSk7XHJcbmZvcig7dS0tOylpZih0W3VdPT09bilyZXR1cm4gdTtyZXR1cm4tMX0sT3QubG93ZXJDYXNlPUZpLE90Lmxvd2VyRmlyc3Q9TmksT3QubHQ9eGksT3QubHRlPWppLE90Lm1heD1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5sZW5ndGg/YW4odCxwdSxkbik6VH0sT3QubWF4Qnk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/YW4odCxGcihuKSxkbik6VH0sT3QubWVhbj1mdW5jdGlvbih0KXtyZXR1cm4gYih0LHB1KX0sT3QubWVhbkJ5PWZ1bmN0aW9uKHQsbil7cmV0dXJuIGIodCxGcihuKSl9LE90Lm1pbj1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5sZW5ndGg/YW4odCxwdSxTbik6VH0sT3QubWluQnk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/YW4odCxGcihuKSxTbik6VH0sT3Quc3R1YkFycmF5PXl1LE90LnN0dWJGYWxzZT1idSxPdC5zdHViT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJue319LE90LnN0dWJTdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSxPdC5zdHViVHJ1ZT1mdW5jdGlvbigpe1xyXG5yZXR1cm4gdHJ1ZX0sT3QubXVsdGlwbHk9Y2YsT3QubnRoPWZ1bmN0aW9uKHQsbil7cmV0dXJuIHQmJnQubGVuZ3RoP0xuKHQsWGUobikpOlR9LE90Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gS3QuXz09PXRoaXMmJihLdC5fPUN1KSx0aGlzfSxPdC5ub29wPWd1LE90Lm5vdz1FZSxPdC5wYWQ9ZnVuY3Rpb24odCxuLHIpe3Q9ZXUodCk7dmFyIGU9KG49WGUobikpP04odCk6MDtyZXR1cm4hbnx8ZT49bj90OihuPShuLWUpLzIsU3IoR3UobikscikrdCtTcihLdShuKSxyKSl9LE90LnBhZEVuZD1mdW5jdGlvbih0LG4scil7dD1ldSh0KTt2YXIgZT0obj1YZShuKSk/Tih0KTowO3JldHVybiBuJiZuPmU/dCtTcihuLWUscik6dH0sT3QucGFkU3RhcnQ9ZnVuY3Rpb24odCxuLHIpe3Q9ZXUodCk7dmFyIGU9KG49WGUobikpP04odCk6MDtyZXR1cm4gbiYmbj5lP1NyKG4tZSxyKSt0OnR9LE90LnBhcnNlSW50PWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gcnx8bnVsbD09bj9uPTA6biYmKG49K24pLFxyXG50PWV1KHQpLnJlcGxhY2UoY3QsXCJcIiksbm8odCxufHwodnQudGVzdCh0KT8xNjoxMCkpfSxPdC5yYW5kb209ZnVuY3Rpb24odCxuLHIpe2lmKHImJnR5cGVvZiByIT1cImJvb2xlYW5cIiYmdGUodCxuLHIpJiYobj1yPVQpLHI9PT1UJiYodHlwZW9mIG49PVwiYm9vbGVhblwiPyhyPW4sbj1UKTp0eXBlb2YgdD09XCJib29sZWFuXCImJihyPXQsdD1UKSksdD09PVQmJm49PT1UPyh0PTAsbj0xKToodD1udSh0KXx8MCxuPT09VD8obj10LHQ9MCk6bj1udShuKXx8MCksdD5uKXt2YXIgZT10O3Q9bixuPWV9cmV0dXJuIHJ8fHQlMXx8biUxPyhyPXJvKCksdG8odCtyKihuLXQrRnQoXCIxZS1cIisoKHIrXCJcIikubGVuZ3RoLTEpKSksbikpOk5uKHQsbil9LE90LnJlZHVjZT1mdW5jdGlvbih0LG4scil7dmFyIGU9eWkodCk/aDp4LHU9Mz5hcmd1bWVudHMubGVuZ3RoO3JldHVybiBlKHQsRnIobiw0KSxyLHUsQW8pfSxPdC5yZWR1Y2VSaWdodD1mdW5jdGlvbih0LG4scil7dmFyIGU9eWkodCk/cDp4LHU9Mz5hcmd1bWVudHMubGVuZ3RoO1xyXG5yZXR1cm4gZSh0LEZyKG4sNCkscix1LE9vKX0sT3QucmVwZWF0PWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbj0ocj90ZSh0LG4scik6bj09PVQpPzE6WGUobiksUG4oZXUodCksbil9LE90LnJlcGxhY2U9ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMsbj1ldSh0WzBdKTtyZXR1cm4gMz50Lmxlbmd0aD9uOmVvLmNhbGwobix0WzFdLHRbMl0pfSxPdC5yZXN1bHQ9ZnVuY3Rpb24odCxuLHIpe249bmUobix0KT9bbl06ZXIobik7dmFyIGU9LTEsdT1uLmxlbmd0aDtmb3IodXx8KHQ9VCx1PTEpOysrZTx1Oyl7dmFyIG89bnVsbD09dD9UOnRbZmUobltlXSldO289PT1UJiYoZT11LG89ciksdD1GZShvKT9vLmNhbGwodCk6b31yZXR1cm4gdH0sT3Qucm91bmQ9YWYsT3QucnVuSW5Db250ZXh0PVosT3Quc2FtcGxlPWZ1bmN0aW9uKHQpe3Q9VWUodCk/dDpjdSh0KTt2YXIgbj10Lmxlbmd0aDtyZXR1cm4gbj4wP3RbTm4oMCxuLTEpXTpUfSxPdC5zaXplPWZ1bmN0aW9uKHQpe2lmKG51bGw9PXQpcmV0dXJuIDA7XHJcbmlmKFVlKHQpKXt2YXIgbj10Lmxlbmd0aDtyZXR1cm4gbiYmR2UodCk/Tih0KTpufXJldHVybiBUZSh0KSYmKG49cXIodCksXCJbb2JqZWN0IE1hcF1cIj09bnx8XCJbb2JqZWN0IFNldF1cIj09bik/dC5zaXplOml1KHQpLmxlbmd0aH0sT3Quc25ha2VDYXNlPVBpLE90LnNvbWU9ZnVuY3Rpb24odCxuLHIpe3ZhciBlPXlpKHQpP186cW47cmV0dXJuIHImJnRlKHQsbixyKSYmKG49VCksZSh0LEZyKG4sMykpfSxPdC5zb3J0ZWRJbmRleD1mdW5jdGlvbih0LG4pe3JldHVybiBWbih0LG4pfSxPdC5zb3J0ZWRJbmRleEJ5PWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gS24odCxuLEZyKHIpKX0sT3Quc29ydGVkSW5kZXhPZj1mdW5jdGlvbih0LG4pe3ZhciByPXQ/dC5sZW5ndGg6MDtpZihyKXt2YXIgZT1Wbih0LG4pO2lmKHI+ZSYmQ2UodFtlXSxuKSlyZXR1cm4gZX1yZXR1cm4tMX0sT3Quc29ydGVkTGFzdEluZGV4PWZ1bmN0aW9uKHQsbil7cmV0dXJuIFZuKHQsbix0cnVlKX0sT3Quc29ydGVkTGFzdEluZGV4Qnk9ZnVuY3Rpb24odCxuLHIpe1xyXG5yZXR1cm4gS24odCxuLEZyKHIpLHRydWUpfSxPdC5zb3J0ZWRMYXN0SW5kZXhPZj1mdW5jdGlvbih0LG4pe2lmKHQmJnQubGVuZ3RoKXt2YXIgcj1Wbih0LG4sdHJ1ZSktMTtpZihDZSh0W3JdLG4pKXJldHVybiByfXJldHVybi0xfSxPdC5zdGFydENhc2U9WmksT3Quc3RhcnRzV2l0aD1mdW5jdGlvbih0LG4scil7cmV0dXJuIHQ9ZXUodCkscj1ubihYZShyKSwwLHQubGVuZ3RoKSx0Lmxhc3RJbmRleE9mKFluKG4pLHIpPT1yfSxPdC5zdWJ0cmFjdD1sZixPdC5zdW09ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQubGVuZ3RoP3codCxwdSk6MH0sT3Quc3VtQnk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmdC5sZW5ndGg/dyh0LEZyKG4pKTowfSxPdC50ZW1wbGF0ZT1mdW5jdGlvbih0LG4scil7dmFyIGU9T3QudGVtcGxhdGVTZXR0aW5ncztyJiZ0ZSh0LG4scikmJihuPVQpLHQ9ZXUodCksbj1BaSh7fSxuLGUsVnQpLHI9QWkoe30sbi5pbXBvcnRzLGUuaW1wb3J0cyxWdCk7dmFyIHUsbyxpPWl1KHIpLGY9ayhyLGkpLGM9MDtcclxucj1uLmludGVycG9sYXRlfHx3dDt2YXIgYT1cIl9fcCs9J1wiO3I9bXUoKG4uZXNjYXBlfHx3dCkuc291cmNlK1wifFwiK3Iuc291cmNlK1wifFwiKyhyPT09cnQ/cHQ6d3QpLnNvdXJjZStcInxcIisobi5ldmFsdWF0ZXx8d3QpLnNvdXJjZStcInwkXCIsXCJnXCIpO3ZhciBsPVwic291cmNlVVJMXCJpbiBuP1wiLy8jIHNvdXJjZVVSTD1cIituLnNvdXJjZVVSTCtcIlxcblwiOlwiXCI7aWYodC5yZXBsYWNlKHIsZnVuY3Rpb24obixyLGUsaSxmLGwpe3JldHVybiBlfHwoZT1pKSxhKz10LnNsaWNlKGMsbCkucmVwbGFjZShtdCxMKSxyJiYodT10cnVlLGErPVwiJytfX2UoXCIrcitcIikrJ1wiKSxmJiYobz10cnVlLGErPVwiJztcIitmK1wiO1xcbl9fcCs9J1wiKSxlJiYoYSs9XCInKygoX190PShcIitlK1wiKSk9PW51bGw/Jyc6X190KSsnXCIpLGM9bCtuLmxlbmd0aCxufSksYSs9XCInO1wiLChuPW4udmFyaWFibGUpfHwoYT1cIndpdGgob2JqKXtcIithK1wifVwiKSxhPShvP2EucmVwbGFjZShLLFwiXCIpOmEpLnJlcGxhY2UoRyxcIiQxXCIpLnJlcGxhY2UoSixcIiQxO1wiKSxcclxuYT1cImZ1bmN0aW9uKFwiKyhufHxcIm9ialwiKStcIil7XCIrKG4/XCJcIjpcIm9ianx8KG9iaj17fSk7XCIpK1widmFyIF9fdCxfX3A9JydcIisodT9cIixfX2U9Xy5lc2NhcGVcIjpcIlwiKSsobz9cIixfX2o9QXJyYXkucHJvdG90eXBlLmpvaW47ZnVuY3Rpb24gcHJpbnQoKXtfX3ArPV9fai5jYWxsKGFyZ3VtZW50cywnJyl9XCI6XCI7XCIpK2ErXCJyZXR1cm4gX19wfVwiLG49VmkoZnVuY3Rpb24oKXtyZXR1cm4gRnVuY3Rpb24oaSxsK1wicmV0dXJuIFwiK2EpLmFwcGx5KFQsZil9KSxuLnNvdXJjZT1hLERlKG4pKXRocm93IG47cmV0dXJuIG59LE90LnRpbWVzPWZ1bmN0aW9uKHQsbil7aWYodD1YZSh0KSwxPnR8fHQ+OTAwNzE5OTI1NDc0MDk5MSlyZXR1cm5bXTt2YXIgcj00Mjk0OTY3Mjk1LGU9dG8odCw0Mjk0OTY3Mjk1KTtmb3Iobj1GcihuKSx0LT00Mjk0OTY3Mjk1LGU9bShlLG4pOysrcjx0OyluKHIpO3JldHVybiBlfSxPdC50b0Zpbml0ZT1RZSxPdC50b0ludGVnZXI9WGUsT3QudG9MZW5ndGg9dHUsT3QudG9Mb3dlcj1mdW5jdGlvbih0KXtcclxucmV0dXJuIGV1KHQpLnRvTG93ZXJDYXNlKCl9LE90LnRvTnVtYmVyPW51LE90LnRvU2FmZUludGVnZXI9ZnVuY3Rpb24odCl7cmV0dXJuIG5uKFhlKHQpLC05MDA3MTk5MjU0NzQwOTkxLDkwMDcxOTkyNTQ3NDA5OTEpfSxPdC50b1N0cmluZz1ldSxPdC50b1VwcGVyPWZ1bmN0aW9uKHQpe3JldHVybiBldSh0KS50b1VwcGVyQ2FzZSgpfSxPdC50cmltPWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4odD1ldSh0KSkmJihyfHxuPT09VCk/dC5yZXBsYWNlKGN0LFwiXCIpOnQmJihuPVluKG4pKT8odD10Lm1hdGNoKEl0KSxuPW4ubWF0Y2goSXQpLHVyKHQsUyh0LG4pLEkodCxuKSsxKS5qb2luKFwiXCIpKTp0fSxPdC50cmltRW5kPWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4odD1ldSh0KSkmJihyfHxuPT09VCk/dC5yZXBsYWNlKGx0LFwiXCIpOnQmJihuPVluKG4pKT8odD10Lm1hdGNoKEl0KSxuPUkodCxuLm1hdGNoKEl0KSkrMSx1cih0LDAsbikuam9pbihcIlwiKSk6dH0sT3QudHJpbVN0YXJ0PWZ1bmN0aW9uKHQsbixyKXtcclxucmV0dXJuKHQ9ZXUodCkpJiYocnx8bj09PVQpP3QucmVwbGFjZShhdCxcIlwiKTp0JiYobj1ZbihuKSk/KHQ9dC5tYXRjaChJdCksbj1TKHQsbi5tYXRjaChJdCkpLHVyKHQsbikuam9pbihcIlwiKSk6dH0sT3QudHJ1bmNhdGU9ZnVuY3Rpb24odCxuKXt2YXIgcj0zMCxlPVwiLi4uXCI7aWYoWmUobikpdmFyIHU9XCJzZXBhcmF0b3JcImluIG4/bi5zZXBhcmF0b3I6dSxyPVwibGVuZ3RoXCJpbiBuP1hlKG4ubGVuZ3RoKTpyLGU9XCJvbWlzc2lvblwiaW4gbj9ZbihuLm9taXNzaW9uKTplO3Q9ZXUodCk7dmFyIG89dC5sZW5ndGg7aWYoV3QudGVzdCh0KSl2YXIgaT10Lm1hdGNoKEl0KSxvPWkubGVuZ3RoO2lmKHI+PW8pcmV0dXJuIHQ7aWYobz1yLU4oZSksMT5vKXJldHVybiBlO2lmKHI9aT91cihpLDAsbykuam9pbihcIlwiKTp0LnNsaWNlKDAsbyksdT09PVQpcmV0dXJuIHIrZTtpZihpJiYobys9ci5sZW5ndGgtbyksS2UodSkpe2lmKHQuc2xpY2Uobykuc2VhcmNoKHUpKXt2YXIgZj1yO2Zvcih1Lmdsb2JhbHx8KHU9bXUodS5zb3VyY2UsZXUoX3QuZXhlYyh1KSkrXCJnXCIpKSxcclxudS5sYXN0SW5kZXg9MDtpPXUuZXhlYyhmKTspdmFyIGM9aS5pbmRleDtyPXIuc2xpY2UoMCxjPT09VD9vOmMpfX1lbHNlIHQuaW5kZXhPZihZbih1KSxvKSE9byYmKHU9ci5sYXN0SW5kZXhPZih1KSx1Pi0xJiYocj1yLnNsaWNlKDAsdSkpKTtyZXR1cm4gcitlfSxPdC51bmVzY2FwZT1mdW5jdGlvbih0KXtyZXR1cm4odD1ldSh0KSkmJlEudGVzdCh0KT90LnJlcGxhY2UoWSxQKTp0fSxPdC51bmlxdWVJZD1mdW5jdGlvbih0KXt2YXIgbj0rK0J1O3JldHVybiBldSh0KStufSxPdC51cHBlckNhc2U9VGksT3QudXBwZXJGaXJzdD1xaSxPdC5lYWNoPW1lLE90LmVhY2hSaWdodD1BZSxPdC5maXJzdD1fZSx2dShPdCxmdW5jdGlvbigpe3ZhciB0PXt9O3JldHVybiBobihPdCxmdW5jdGlvbihuLHIpe1d1LmNhbGwoT3QucHJvdG90eXBlLHIpfHwodFtyXT1uKX0pLHR9KCkse2NoYWluOmZhbHNlfSksT3QuVkVSU0lPTj1cIjQuMTMuMVwiLHUoXCJiaW5kIGJpbmRLZXkgY3VycnkgY3VycnlSaWdodCBwYXJ0aWFsIHBhcnRpYWxSaWdodFwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbih0KXtcclxuT3RbdF0ucGxhY2Vob2xkZXI9T3R9KSx1KFtcImRyb3BcIixcInRha2VcIl0sZnVuY3Rpb24odCxuKXtVdC5wcm90b3R5cGVbdF09ZnVuY3Rpb24ocil7dmFyIGU9dGhpcy5fX2ZpbHRlcmVkX187aWYoZSYmIW4pcmV0dXJuIG5ldyBVdCh0aGlzKTtyPXI9PT1UPzE6WHUoWGUociksMCk7dmFyIHU9dGhpcy5jbG9uZSgpO3JldHVybiBlP3UuX190YWtlQ291bnRfXz10byhyLHUuX190YWtlQ291bnRfXyk6dS5fX3ZpZXdzX18ucHVzaCh7c2l6ZTp0byhyLDQyOTQ5NjcyOTUpLHR5cGU6dCsoMD51Ll9fZGlyX18/XCJSaWdodFwiOlwiXCIpfSksdX0sVXQucHJvdG90eXBlW3QrXCJSaWdodFwiXT1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5yZXZlcnNlKClbdF0obikucmV2ZXJzZSgpfX0pLHUoW1wiZmlsdGVyXCIsXCJtYXBcIixcInRha2VXaGlsZVwiXSxmdW5jdGlvbih0LG4pe3ZhciByPW4rMSxlPTE9PXJ8fDM9PXI7VXQucHJvdG90eXBlW3RdPWZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMuY2xvbmUoKTtyZXR1cm4gbi5fX2l0ZXJhdGVlc19fLnB1c2goe1xyXG5pdGVyYXRlZTpGcih0LDMpLHR5cGU6cn0pLG4uX19maWx0ZXJlZF9fPW4uX19maWx0ZXJlZF9ffHxlLG59fSksdShbXCJoZWFkXCIsXCJsYXN0XCJdLGZ1bmN0aW9uKHQsbil7dmFyIHI9XCJ0YWtlXCIrKG4/XCJSaWdodFwiOlwiXCIpO1V0LnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiB0aGlzW3JdKDEpLnZhbHVlKClbMF19fSksdShbXCJpbml0aWFsXCIsXCJ0YWlsXCJdLGZ1bmN0aW9uKHQsbil7dmFyIHI9XCJkcm9wXCIrKG4/XCJcIjpcIlJpZ2h0XCIpO1V0LnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9fZmlsdGVyZWRfXz9uZXcgVXQodGhpcyk6dGhpc1tyXSgxKX19KSxVdC5wcm90b3R5cGUuY29tcGFjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbHRlcihwdSl9LFV0LnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmZpbHRlcih0KS5oZWFkKCl9LFV0LnByb3RvdHlwZS5maW5kTGFzdD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yZXZlcnNlKCkuZmluZCh0KTtcclxufSxVdC5wcm90b3R5cGUuaW52b2tlTWFwPU1lKGZ1bmN0aW9uKHQsbil7cmV0dXJuIHR5cGVvZiB0PT1cImZ1bmN0aW9uXCI/bmV3IFV0KHRoaXMpOnRoaXMubWFwKGZ1bmN0aW9uKHIpe3JldHVybiB3bihyLHQsbil9KX0pLFV0LnByb3RvdHlwZS5yZWplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9RnIodCwzKSx0aGlzLmZpbHRlcihmdW5jdGlvbihuKXtyZXR1cm4hdChuKX0pfSxVdC5wcm90b3R5cGUuc2xpY2U9ZnVuY3Rpb24odCxuKXt0PVhlKHQpO3ZhciByPXRoaXM7cmV0dXJuIHIuX19maWx0ZXJlZF9fJiYodD4wfHwwPm4pP25ldyBVdChyKTooMD50P3I9ci50YWtlUmlnaHQoLXQpOnQmJihyPXIuZHJvcCh0KSksbiE9PVQmJihuPVhlKG4pLHI9MD5uP3IuZHJvcFJpZ2h0KC1uKTpyLnRha2Uobi10KSkscil9LFV0LnByb3RvdHlwZS50YWtlUmlnaHRXaGlsZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yZXZlcnNlKCkudGFrZVdoaWxlKHQpLnJldmVyc2UoKX0sVXQucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24oKXtcclxucmV0dXJuIHRoaXMudGFrZSg0Mjk0OTY3Mjk1KX0saG4oVXQucHJvdG90eXBlLGZ1bmN0aW9uKHQsbil7dmFyIHI9L14oPzpmaWx0ZXJ8ZmluZHxtYXB8cmVqZWN0KXxXaGlsZSQvLnRlc3QobiksZT0vXig/OmhlYWR8bGFzdCkkLy50ZXN0KG4pLHU9T3RbZT9cInRha2VcIisoXCJsYXN0XCI9PW4/XCJSaWdodFwiOlwiXCIpOm5dLG89ZXx8L15maW5kLy50ZXN0KG4pO3UmJihPdC5wcm90b3R5cGVbbl09ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQpe3JldHVybiB0PXUuYXBwbHkoT3QscyhbdF0sZikpLGUmJmg/dFswXTp0fXZhciBpPXRoaXMuX193cmFwcGVkX18sZj1lP1sxXTphcmd1bWVudHMsYz1pIGluc3RhbmNlb2YgVXQsYT1mWzBdLGw9Y3x8eWkoaSk7bCYmciYmdHlwZW9mIGE9PVwiZnVuY3Rpb25cIiYmMSE9YS5sZW5ndGgmJihjPWw9ZmFsc2UpO3ZhciBoPXRoaXMuX19jaGFpbl9fLHA9ISF0aGlzLl9fYWN0aW9uc19fLmxlbmd0aCxhPW8mJiFoLGM9YyYmIXA7cmV0dXJuIW8mJmw/KGk9Yz9pOm5ldyBVdCh0aGlzKSxcclxuaT10LmFwcGx5KGksZiksaS5fX2FjdGlvbnNfXy5wdXNoKHtmdW5jOmplLGFyZ3M6W25dLHRoaXNBcmc6VH0pLG5ldyB6dChpLGgpKTphJiZjP3QuYXBwbHkodGhpcyxmKTooaT10aGlzLnRocnUobiksYT9lP2kudmFsdWUoKVswXTppLnZhbHVlKCk6aSl9KX0pLHUoXCJwb3AgcHVzaCBzaGlmdCBzb3J0IHNwbGljZSB1bnNoaWZ0XCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKHQpe3ZhciBuPU91W3RdLHI9L14oPzpwdXNofHNvcnR8dW5zaGlmdCkkLy50ZXN0KHQpP1widGFwXCI6XCJ0aHJ1XCIsZT0vXig/OnBvcHxzaGlmdCkkLy50ZXN0KHQpO090LnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cztpZihlJiYhdGhpcy5fX2NoYWluX18pe3ZhciB1PXRoaXMudmFsdWUoKTtyZXR1cm4gbi5hcHBseSh5aSh1KT91OltdLHQpfXJldHVybiB0aGlzW3JdKGZ1bmN0aW9uKHIpe3JldHVybiBuLmFwcGx5KHlpKHIpP3I6W10sdCl9KX19KSxobihVdC5wcm90b3R5cGUsZnVuY3Rpb24odCxuKXtcclxudmFyIHI9T3Rbbl07aWYocil7dmFyIGU9ci5uYW1lK1wiXCI7KF9vW2VdfHwoX29bZV09W10pKS5wdXNoKHtuYW1lOm4sZnVuYzpyfSl9fSksX29bQXIoVCwyKS5uYW1lXT1be25hbWU6XCJ3cmFwcGVyXCIsZnVuYzpUfV0sVXQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IFV0KHRoaXMuX193cmFwcGVkX18pO3JldHVybiB0Ll9fYWN0aW9uc19fPWxyKHRoaXMuX19hY3Rpb25zX18pLHQuX19kaXJfXz10aGlzLl9fZGlyX18sdC5fX2ZpbHRlcmVkX189dGhpcy5fX2ZpbHRlcmVkX18sdC5fX2l0ZXJhdGVlc19fPWxyKHRoaXMuX19pdGVyYXRlZXNfXyksdC5fX3Rha2VDb3VudF9fPXRoaXMuX190YWtlQ291bnRfXyx0Ll9fdmlld3NfXz1scih0aGlzLl9fdmlld3NfXyksdH0sVXQucHJvdG90eXBlLnJldmVyc2U9ZnVuY3Rpb24oKXtpZih0aGlzLl9fZmlsdGVyZWRfXyl7dmFyIHQ9bmV3IFV0KHRoaXMpO3QuX19kaXJfXz0tMSx0Ll9fZmlsdGVyZWRfXz10cnVlfWVsc2UgdD10aGlzLmNsb25lKCksXHJcbnQuX19kaXJfXyo9LTE7cmV0dXJuIHR9LFV0LnByb3RvdHlwZS52YWx1ZT1mdW5jdGlvbigpe3ZhciB0LG49dGhpcy5fX3dyYXBwZWRfXy52YWx1ZSgpLHI9dGhpcy5fX2Rpcl9fLGU9eWkobiksdT0wPnIsbz1lP24ubGVuZ3RoOjA7dD1vO2Zvcih2YXIgaT10aGlzLl9fdmlld3NfXyxmPTAsYz0tMSxhPWkubGVuZ3RoOysrYzxhOyl7dmFyIGw9aVtjXSxzPWwuc2l6ZTtzd2l0Y2gobC50eXBlKXtjYXNlXCJkcm9wXCI6Zis9czticmVhaztjYXNlXCJkcm9wUmlnaHRcIjp0LT1zO2JyZWFrO2Nhc2VcInRha2VcIjp0PXRvKHQsZitzKTticmVhaztjYXNlXCJ0YWtlUmlnaHRcIjpmPVh1KGYsdC1zKX19aWYodD17c3RhcnQ6ZixlbmQ6dH0saT10LnN0YXJ0LGY9dC5lbmQsdD1mLWksdT11P2Y6aS0xLGk9dGhpcy5fX2l0ZXJhdGVlc19fLGY9aS5sZW5ndGgsYz0wLGE9dG8odCx0aGlzLl9fdGFrZUNvdW50X18pLCFlfHwyMDA+b3x8bz09dCYmYT09dClyZXR1cm4gWG4obix0aGlzLl9fYWN0aW9uc19fKTtlPVtdO1xyXG50OmZvcig7dC0tJiZhPmM7KXtmb3IodSs9cixvPS0xLGw9blt1XTsrK288Zjspe3ZhciBoPWlbb10scz1oLnR5cGUsaD0oMCxoLml0ZXJhdGVlKShsKTtpZigyPT1zKWw9aDtlbHNlIGlmKCFoKXtpZigxPT1zKWNvbnRpbnVlIHQ7YnJlYWsgdH19ZVtjKytdPWx9cmV0dXJuIGV9LE90LnByb3RvdHlwZS5hdD1YbyxPdC5wcm90b3R5cGUuY2hhaW49ZnVuY3Rpb24oKXtyZXR1cm4geGUodGhpcyl9LE90LnByb3RvdHlwZS5jb21taXQ9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHp0KHRoaXMudmFsdWUoKSx0aGlzLl9fY2hhaW5fXyl9LE90LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7dGhpcy5fX3ZhbHVlc19fPT09VCYmKHRoaXMuX192YWx1ZXNfXz1IZSh0aGlzLnZhbHVlKCkpKTt2YXIgdD10aGlzLl9faW5kZXhfXz49dGhpcy5fX3ZhbHVlc19fLmxlbmd0aCxuPXQ/VDp0aGlzLl9fdmFsdWVzX19bdGhpcy5fX2luZGV4X18rK107cmV0dXJue2RvbmU6dCx2YWx1ZTpufX0sT3QucHJvdG90eXBlLnBsYW50PWZ1bmN0aW9uKHQpe1xyXG5mb3IodmFyIG4scj10aGlzO3IgaW5zdGFuY2VvZiBrdDspe3ZhciBlPWFlKHIpO2UuX19pbmRleF9fPTAsZS5fX3ZhbHVlc19fPVQsbj91Ll9fd3JhcHBlZF9fPWU6bj1lO3ZhciB1PWUscj1yLl9fd3JhcHBlZF9ffXJldHVybiB1Ll9fd3JhcHBlZF9fPXQsbn0sT3QucHJvdG90eXBlLnJldmVyc2U9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9fd3JhcHBlZF9fO3JldHVybiB0IGluc3RhbmNlb2YgVXQ/KHRoaXMuX19hY3Rpb25zX18ubGVuZ3RoJiYodD1uZXcgVXQodGhpcykpLHQ9dC5yZXZlcnNlKCksdC5fX2FjdGlvbnNfXy5wdXNoKHtmdW5jOmplLGFyZ3M6W2RlXSx0aGlzQXJnOlR9KSxuZXcgenQodCx0aGlzLl9fY2hhaW5fXykpOnRoaXMudGhydShkZSl9LE90LnByb3RvdHlwZS50b0pTT049T3QucHJvdG90eXBlLnZhbHVlT2Y9T3QucHJvdG90eXBlLnZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIFhuKHRoaXMuX193cmFwcGVkX18sdGhpcy5fX2FjdGlvbnNfXyl9LFp1JiYoT3QucHJvdG90eXBlW1p1XT13ZSksXHJcbk90fXZhciBULHE9MS8wLFY9TmFOLEs9L1xcYl9fcFxcKz0nJzsvZyxHPS9cXGIoX19wXFwrPSknJ1xcKy9nLEo9LyhfX2VcXCguKj9cXCl8XFxiX190XFwpKVxcKycnOy9nLFk9LyYoPzphbXB8bHR8Z3R8cXVvdHwjMzl8Izk2KTsvZyxIPS9bJjw+XCInYF0vZyxRPVJlZ0V4cChZLnNvdXJjZSksWD1SZWdFeHAoSC5zb3VyY2UpLHR0PS88JS0oW1xcc1xcU10rPyklPi9nLG50PS88JShbXFxzXFxTXSs/KSU+L2cscnQ9LzwlPShbXFxzXFxTXSs/KSU+L2csZXQ9L1xcLnxcXFsoPzpbXltcXF1dKnwoW1wiJ10pKD86KD8hXFwxKVteXFxcXF18XFxcXC4pKj9cXDEpXFxdLyx1dD0vXlxcdyokLyxvdD0vW14uW1xcXV0rfFxcWyg/OigtP1xcZCsoPzpcXC5cXGQrKT8pfChbXCInXSkoKD86KD8hXFwyKVteXFxcXF18XFxcXC4pKj8pXFwyKVxcXXwoPz0oXFwufFxcW1xcXSkoPzpcXDR8JCkpL2csaXQ9L1tcXFxcXiQuKis/KClbXFxde318XS9nLGZ0PVJlZ0V4cChpdC5zb3VyY2UpLGN0PS9eXFxzK3xcXHMrJC9nLGF0PS9eXFxzKy8sbHQ9L1xccyskLyxzdD0vW2EtekEtWjAtOV0rL2csaHQ9L1xcXFwoXFxcXCk/L2cscHQ9L1xcJFxceyhbXlxcXFx9XSooPzpcXFxcLlteXFxcXH1dKikqKVxcfS9nLF90PS9cXHcqJC8sdnQ9L14weC9pLGd0PS9eWy0rXTB4WzAtOWEtZl0rJC9pLGR0PS9eMGJbMDFdKyQvaSx5dD0vXlxcW29iamVjdCAuKz9Db25zdHJ1Y3RvclxcXSQvLGJ0PS9eMG9bMC03XSskL2kseHQ9L14oPzowfFsxLTldXFxkKikkLyxqdD0vW1xceGMwLVxceGQ2XFx4ZDgtXFx4ZGVcXHhkZi1cXHhmNlxceGY4LVxceGZmXS9nLHd0PS8oJF4pLyxtdD0vWydcXG5cXHJcXHUyMDI4XFx1MjAyOVxcXFxdL2csQXQ9XCJbXFxcXHVmZTBlXFxcXHVmZTBmXT8oPzpbXFxcXHUwMzAwLVxcXFx1MDM2ZlxcXFx1ZmUyMC1cXFxcdWZlMjNcXFxcdTIwZDAtXFxcXHUyMGYwXXxcXFxcdWQ4M2NbXFxcXHVkZmZiLVxcXFx1ZGZmZl0pPyg/OlxcXFx1MjAwZCg/OlteXFxcXHVkODAwLVxcXFx1ZGZmZl18KD86XFxcXHVkODNjW1xcXFx1ZGRlNi1cXFxcdWRkZmZdKXsyfXxbXFxcXHVkODAwLVxcXFx1ZGJmZl1bXFxcXHVkYzAwLVxcXFx1ZGZmZl0pW1xcXFx1ZmUwZVxcXFx1ZmUwZl0/KD86W1xcXFx1MDMwMC1cXFxcdTAzNmZcXFxcdWZlMjAtXFxcXHVmZTIzXFxcXHUyMGQwLVxcXFx1MjBmMF18XFxcXHVkODNjW1xcXFx1ZGZmYi1cXFxcdWRmZmZdKT8pKlwiLE90PVwiKD86W1xcXFx1MjcwMC1cXFxcdTI3YmZdfCg/OlxcXFx1ZDgzY1tcXFxcdWRkZTYtXFxcXHVkZGZmXSl7Mn18W1xcXFx1ZDgwMC1cXFxcdWRiZmZdW1xcXFx1ZGMwMC1cXFxcdWRmZmZdKVwiK0F0LGt0PVwiKD86W15cXFxcdWQ4MDAtXFxcXHVkZmZmXVtcXFxcdTAzMDAtXFxcXHUwMzZmXFxcXHVmZTIwLVxcXFx1ZmUyM1xcXFx1MjBkMC1cXFxcdTIwZjBdP3xbXFxcXHUwMzAwLVxcXFx1MDM2ZlxcXFx1ZmUyMC1cXFxcdWZlMjNcXFxcdTIwZDAtXFxcXHUyMGYwXXwoPzpcXFxcdWQ4M2NbXFxcXHVkZGU2LVxcXFx1ZGRmZl0pezJ9fFtcXFxcdWQ4MDAtXFxcXHVkYmZmXVtcXFxcdWRjMDAtXFxcXHVkZmZmXXxbXFxcXHVkODAwLVxcXFx1ZGZmZl0pXCIsRXQ9UmVnRXhwKFwiWydcXHUyMDE5XVwiLFwiZ1wiKSxTdD1SZWdFeHAoXCJbXFxcXHUwMzAwLVxcXFx1MDM2ZlxcXFx1ZmUyMC1cXFxcdWZlMjNcXFxcdTIwZDAtXFxcXHUyMGYwXVwiLFwiZ1wiKSxJdD1SZWdFeHAoXCJcXFxcdWQ4M2NbXFxcXHVkZmZiLVxcXFx1ZGZmZl0oPz1cXFxcdWQ4M2NbXFxcXHVkZmZiLVxcXFx1ZGZmZl0pfFwiK2t0K0F0LFwiZ1wiKSxSdD1SZWdFeHAoW1wiW0EtWlxcXFx4YzAtXFxcXHhkNlxcXFx4ZDgtXFxcXHhkZV0/W2EtelxcXFx4ZGYtXFxcXHhmNlxcXFx4ZjgtXFxcXHhmZl0rKD86WydcXHUyMDE5XSg/OmR8bGx8bXxyZXxzfHR8dmUpKT8oPz1bXFxcXHhhY1xcXFx4YjFcXFxceGQ3XFxcXHhmN1xcXFx4MDAtXFxcXHgyZlxcXFx4M2EtXFxcXHg0MFxcXFx4NWItXFxcXHg2MFxcXFx4N2ItXFxcXHhiZlxcXFx1MjAwMC1cXFxcdTIwNmYgXFxcXHRcXFxceDBiXFxcXGZcXFxceGEwXFxcXHVmZWZmXFxcXG5cXFxcclxcXFx1MjAyOFxcXFx1MjAyOVxcXFx1MTY4MFxcXFx1MTgwZVxcXFx1MjAwMFxcXFx1MjAwMVxcXFx1MjAwMlxcXFx1MjAwM1xcXFx1MjAwNFxcXFx1MjAwNVxcXFx1MjAwNlxcXFx1MjAwN1xcXFx1MjAwOFxcXFx1MjAwOVxcXFx1MjAwYVxcXFx1MjAyZlxcXFx1MjA1ZlxcXFx1MzAwMF18W0EtWlxcXFx4YzAtXFxcXHhkNlxcXFx4ZDgtXFxcXHhkZV18JCl8KD86W0EtWlxcXFx4YzAtXFxcXHhkNlxcXFx4ZDgtXFxcXHhkZV18W15cXFxcdWQ4MDAtXFxcXHVkZmZmXFxcXHhhY1xcXFx4YjFcXFxceGQ3XFxcXHhmN1xcXFx4MDAtXFxcXHgyZlxcXFx4M2EtXFxcXHg0MFxcXFx4NWItXFxcXHg2MFxcXFx4N2ItXFxcXHhiZlxcXFx1MjAwMC1cXFxcdTIwNmYgXFxcXHRcXFxceDBiXFxcXGZcXFxceGEwXFxcXHVmZWZmXFxcXG5cXFxcclxcXFx1MjAyOFxcXFx1MjAyOVxcXFx1MTY4MFxcXFx1MTgwZVxcXFx1MjAwMFxcXFx1MjAwMVxcXFx1MjAwMlxcXFx1MjAwM1xcXFx1MjAwNFxcXFx1MjAwNVxcXFx1MjAwNlxcXFx1MjAwN1xcXFx1MjAwOFxcXFx1MjAwOVxcXFx1MjAwYVxcXFx1MjAyZlxcXFx1MjA1ZlxcXFx1MzAwMFxcXFxkK1xcXFx1MjcwMC1cXFxcdTI3YmZhLXpcXFxceGRmLVxcXFx4ZjZcXFxceGY4LVxcXFx4ZmZBLVpcXFxceGMwLVxcXFx4ZDZcXFxceGQ4LVxcXFx4ZGVdKSsoPzpbJ1xcdTIwMTldKD86RHxMTHxNfFJFfFN8VHxWRSkpPyg/PVtcXFxceGFjXFxcXHhiMVxcXFx4ZDdcXFxceGY3XFxcXHgwMC1cXFxceDJmXFxcXHgzYS1cXFxceDQwXFxcXHg1Yi1cXFxceDYwXFxcXHg3Yi1cXFxceGJmXFxcXHUyMDAwLVxcXFx1MjA2ZiBcXFxcdFxcXFx4MGJcXFxcZlxcXFx4YTBcXFxcdWZlZmZcXFxcblxcXFxyXFxcXHUyMDI4XFxcXHUyMDI5XFxcXHUxNjgwXFxcXHUxODBlXFxcXHUyMDAwXFxcXHUyMDAxXFxcXHUyMDAyXFxcXHUyMDAzXFxcXHUyMDA0XFxcXHUyMDA1XFxcXHUyMDA2XFxcXHUyMDA3XFxcXHUyMDA4XFxcXHUyMDA5XFxcXHUyMDBhXFxcXHUyMDJmXFxcXHUyMDVmXFxcXHUzMDAwXXxbQS1aXFxcXHhjMC1cXFxceGQ2XFxcXHhkOC1cXFxceGRlXSg/OlthLXpcXFxceGRmLVxcXFx4ZjZcXFxceGY4LVxcXFx4ZmZdfFteXFxcXHVkODAwLVxcXFx1ZGZmZlxcXFx4YWNcXFxceGIxXFxcXHhkN1xcXFx4ZjdcXFxceDAwLVxcXFx4MmZcXFxceDNhLVxcXFx4NDBcXFxceDViLVxcXFx4NjBcXFxceDdiLVxcXFx4YmZcXFxcdTIwMDAtXFxcXHUyMDZmIFxcXFx0XFxcXHgwYlxcXFxmXFxcXHhhMFxcXFx1ZmVmZlxcXFxuXFxcXHJcXFxcdTIwMjhcXFxcdTIwMjlcXFxcdTE2ODBcXFxcdTE4MGVcXFxcdTIwMDBcXFxcdTIwMDFcXFxcdTIwMDJcXFxcdTIwMDNcXFxcdTIwMDRcXFxcdTIwMDVcXFxcdTIwMDZcXFxcdTIwMDdcXFxcdTIwMDhcXFxcdTIwMDlcXFxcdTIwMGFcXFxcdTIwMmZcXFxcdTIwNWZcXFxcdTMwMDBcXFxcZCtcXFxcdTI3MDAtXFxcXHUyN2JmYS16XFxcXHhkZi1cXFxceGY2XFxcXHhmOC1cXFxceGZmQS1aXFxcXHhjMC1cXFxceGQ2XFxcXHhkOC1cXFxceGRlXSl8JCl8W0EtWlxcXFx4YzAtXFxcXHhkNlxcXFx4ZDgtXFxcXHhkZV0/KD86W2EtelxcXFx4ZGYtXFxcXHhmNlxcXFx4ZjgtXFxcXHhmZl18W15cXFxcdWQ4MDAtXFxcXHVkZmZmXFxcXHhhY1xcXFx4YjFcXFxceGQ3XFxcXHhmN1xcXFx4MDAtXFxcXHgyZlxcXFx4M2EtXFxcXHg0MFxcXFx4NWItXFxcXHg2MFxcXFx4N2ItXFxcXHhiZlxcXFx1MjAwMC1cXFxcdTIwNmYgXFxcXHRcXFxceDBiXFxcXGZcXFxceGEwXFxcXHVmZWZmXFxcXG5cXFxcclxcXFx1MjAyOFxcXFx1MjAyOVxcXFx1MTY4MFxcXFx1MTgwZVxcXFx1MjAwMFxcXFx1MjAwMVxcXFx1MjAwMlxcXFx1MjAwM1xcXFx1MjAwNFxcXFx1MjAwNVxcXFx1MjAwNlxcXFx1MjAwN1xcXFx1MjAwOFxcXFx1MjAwOVxcXFx1MjAwYVxcXFx1MjAyZlxcXFx1MjA1ZlxcXFx1MzAwMFxcXFxkK1xcXFx1MjcwMC1cXFxcdTI3YmZhLXpcXFxceGRmLVxcXFx4ZjZcXFxceGY4LVxcXFx4ZmZBLVpcXFxceGMwLVxcXFx4ZDZcXFxceGQ4LVxcXFx4ZGVdKSsoPzpbJ1xcdTIwMTldKD86ZHxsbHxtfHJlfHN8dHx2ZSkpP3xbQS1aXFxcXHhjMC1cXFxceGQ2XFxcXHhkOC1cXFxceGRlXSsoPzpbJ1xcdTIwMTldKD86RHxMTHxNfFJFfFN8VHxWRSkpP3xcXFxcZCtcIixPdF0uam9pbihcInxcIiksXCJnXCIpLFd0PVJlZ0V4cChcIltcXFxcdTIwMGRcXFxcdWQ4MDAtXFxcXHVkZmZmXFxcXHUwMzAwLVxcXFx1MDM2ZlxcXFx1ZmUyMC1cXFxcdWZlMjNcXFxcdTIwZDAtXFxcXHUyMGYwXFxcXHVmZTBlXFxcXHVmZTBmXVwiKSxCdD0vW2Etel1bQS1aXXxbQS1aXXsyLH1bYS16XXxbMC05XVthLXpBLVpdfFthLXpBLVpdWzAtOV18W15hLXpBLVowLTkgXS8sTHQ9XCJBcnJheSBCdWZmZXIgRGF0YVZpZXcgRGF0ZSBFcnJvciBGbG9hdDMyQXJyYXkgRmxvYXQ2NEFycmF5IEZ1bmN0aW9uIEludDhBcnJheSBJbnQxNkFycmF5IEludDMyQXJyYXkgTWFwIE1hdGggT2JqZWN0IFByb21pc2UgUmVmbGVjdCBSZWdFeHAgU2V0IFN0cmluZyBTeW1ib2wgVHlwZUVycm9yIFVpbnQ4QXJyYXkgVWludDhDbGFtcGVkQXJyYXkgVWludDE2QXJyYXkgVWludDMyQXJyYXkgV2Vha01hcCBfIGlzRmluaXRlIHBhcnNlSW50IHNldFRpbWVvdXRcIi5zcGxpdChcIiBcIiksTXQ9e307XHJcbk10W1wiW29iamVjdCBGbG9hdDMyQXJyYXldXCJdPU10W1wiW29iamVjdCBGbG9hdDY0QXJyYXldXCJdPU10W1wiW29iamVjdCBJbnQ4QXJyYXldXCJdPU10W1wiW29iamVjdCBJbnQxNkFycmF5XVwiXT1NdFtcIltvYmplY3QgSW50MzJBcnJheV1cIl09TXRbXCJbb2JqZWN0IFVpbnQ4QXJyYXldXCJdPU10W1wiW29iamVjdCBVaW50OENsYW1wZWRBcnJheV1cIl09TXRbXCJbb2JqZWN0IFVpbnQxNkFycmF5XVwiXT1NdFtcIltvYmplY3QgVWludDMyQXJyYXldXCJdPXRydWUsTXRbXCJbb2JqZWN0IEFyZ3VtZW50c11cIl09TXRbXCJbb2JqZWN0IEFycmF5XVwiXT1NdFtcIltvYmplY3QgQXJyYXlCdWZmZXJdXCJdPU10W1wiW29iamVjdCBCb29sZWFuXVwiXT1NdFtcIltvYmplY3QgRGF0YVZpZXddXCJdPU10W1wiW29iamVjdCBEYXRlXVwiXT1NdFtcIltvYmplY3QgRXJyb3JdXCJdPU10W1wiW29iamVjdCBGdW5jdGlvbl1cIl09TXRbXCJbb2JqZWN0IE1hcF1cIl09TXRbXCJbb2JqZWN0IE51bWJlcl1cIl09TXRbXCJbb2JqZWN0IE9iamVjdF1cIl09TXRbXCJbb2JqZWN0IFJlZ0V4cF1cIl09TXRbXCJbb2JqZWN0IFNldF1cIl09TXRbXCJbb2JqZWN0IFN0cmluZ11cIl09TXRbXCJbb2JqZWN0IFdlYWtNYXBdXCJdPWZhbHNlO1xyXG52YXIgQ3Q9e307Q3RbXCJbb2JqZWN0IEFyZ3VtZW50c11cIl09Q3RbXCJbb2JqZWN0IEFycmF5XVwiXT1DdFtcIltvYmplY3QgQXJyYXlCdWZmZXJdXCJdPUN0W1wiW29iamVjdCBEYXRhVmlld11cIl09Q3RbXCJbb2JqZWN0IEJvb2xlYW5dXCJdPUN0W1wiW29iamVjdCBEYXRlXVwiXT1DdFtcIltvYmplY3QgRmxvYXQzMkFycmF5XVwiXT1DdFtcIltvYmplY3QgRmxvYXQ2NEFycmF5XVwiXT1DdFtcIltvYmplY3QgSW50OEFycmF5XVwiXT1DdFtcIltvYmplY3QgSW50MTZBcnJheV1cIl09Q3RbXCJbb2JqZWN0IEludDMyQXJyYXldXCJdPUN0W1wiW29iamVjdCBNYXBdXCJdPUN0W1wiW29iamVjdCBOdW1iZXJdXCJdPUN0W1wiW29iamVjdCBPYmplY3RdXCJdPUN0W1wiW29iamVjdCBSZWdFeHBdXCJdPUN0W1wiW29iamVjdCBTZXRdXCJdPUN0W1wiW29iamVjdCBTdHJpbmddXCJdPUN0W1wiW29iamVjdCBTeW1ib2xdXCJdPUN0W1wiW29iamVjdCBVaW50OEFycmF5XVwiXT1DdFtcIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldXCJdPUN0W1wiW29iamVjdCBVaW50MTZBcnJheV1cIl09Q3RbXCJbb2JqZWN0IFVpbnQzMkFycmF5XVwiXT10cnVlLFxyXG5DdFtcIltvYmplY3QgRXJyb3JdXCJdPUN0W1wiW29iamVjdCBGdW5jdGlvbl1cIl09Q3RbXCJbb2JqZWN0IFdlYWtNYXBdXCJdPWZhbHNlO3ZhciB6dD17XCJcXHhjMFwiOlwiQVwiLFwiXFx4YzFcIjpcIkFcIixcIlxceGMyXCI6XCJBXCIsXCJcXHhjM1wiOlwiQVwiLFwiXFx4YzRcIjpcIkFcIixcIlxceGM1XCI6XCJBXCIsXCJcXHhlMFwiOlwiYVwiLFwiXFx4ZTFcIjpcImFcIixcIlxceGUyXCI6XCJhXCIsXCJcXHhlM1wiOlwiYVwiLFwiXFx4ZTRcIjpcImFcIixcIlxceGU1XCI6XCJhXCIsXCJcXHhjN1wiOlwiQ1wiLFwiXFx4ZTdcIjpcImNcIixcIlxceGQwXCI6XCJEXCIsXCJcXHhmMFwiOlwiZFwiLFwiXFx4YzhcIjpcIkVcIixcIlxceGM5XCI6XCJFXCIsXCJcXHhjYVwiOlwiRVwiLFwiXFx4Y2JcIjpcIkVcIixcIlxceGU4XCI6XCJlXCIsXCJcXHhlOVwiOlwiZVwiLFwiXFx4ZWFcIjpcImVcIixcIlxceGViXCI6XCJlXCIsXCJcXHhjY1wiOlwiSVwiLFwiXFx4Y2RcIjpcIklcIixcIlxceGNlXCI6XCJJXCIsXCJcXHhjZlwiOlwiSVwiLFwiXFx4ZWNcIjpcImlcIixcIlxceGVkXCI6XCJpXCIsXCJcXHhlZVwiOlwiaVwiLFwiXFx4ZWZcIjpcImlcIixcIlxceGQxXCI6XCJOXCIsXCJcXHhmMVwiOlwiblwiLFwiXFx4ZDJcIjpcIk9cIixcIlxceGQzXCI6XCJPXCIsXCJcXHhkNFwiOlwiT1wiLFwiXFx4ZDVcIjpcIk9cIixcIlxceGQ2XCI6XCJPXCIsXHJcblwiXFx4ZDhcIjpcIk9cIixcIlxceGYyXCI6XCJvXCIsXCJcXHhmM1wiOlwib1wiLFwiXFx4ZjRcIjpcIm9cIixcIlxceGY1XCI6XCJvXCIsXCJcXHhmNlwiOlwib1wiLFwiXFx4ZjhcIjpcIm9cIixcIlxceGQ5XCI6XCJVXCIsXCJcXHhkYVwiOlwiVVwiLFwiXFx4ZGJcIjpcIlVcIixcIlxceGRjXCI6XCJVXCIsXCJcXHhmOVwiOlwidVwiLFwiXFx4ZmFcIjpcInVcIixcIlxceGZiXCI6XCJ1XCIsXCJcXHhmY1wiOlwidVwiLFwiXFx4ZGRcIjpcIllcIixcIlxceGZkXCI6XCJ5XCIsXCJcXHhmZlwiOlwieVwiLFwiXFx4YzZcIjpcIkFlXCIsXCJcXHhlNlwiOlwiYWVcIixcIlxceGRlXCI6XCJUaFwiLFwiXFx4ZmVcIjpcInRoXCIsXCJcXHhkZlwiOlwic3NcIn0sVXQ9e1wiJlwiOlwiJmFtcDtcIixcIjxcIjpcIiZsdDtcIixcIj5cIjpcIiZndDtcIiwnXCInOlwiJnF1b3Q7XCIsXCInXCI6XCImIzM5O1wiLFwiYFwiOlwiJiM5NjtcIn0sJHQ9e1wiJmFtcDtcIjpcIiZcIixcIiZsdDtcIjpcIjxcIixcIiZndDtcIjpcIj5cIixcIiZxdW90O1wiOidcIicsXCImIzM5O1wiOlwiJ1wiLFwiJiM5NjtcIjpcImBcIn0sRHQ9e1wiXFxcXFwiOlwiXFxcXFwiLFwiJ1wiOlwiJ1wiLFwiXFxuXCI6XCJuXCIsXCJcXHJcIjpcInJcIixcIlxcdTIwMjhcIjpcInUyMDI4XCIsXCJcXHUyMDI5XCI6XCJ1MjAyOVwifSxGdD1wYXJzZUZsb2F0LE50PXBhcnNlSW50LFB0PXR5cGVvZiBleHBvcnRzPT1cIm9iamVjdFwiJiZleHBvcnRzLFp0PVB0JiZ0eXBlb2YgbW9kdWxlPT1cIm9iamVjdFwiJiZtb2R1bGUsVHQ9WnQmJlp0LmV4cG9ydHM9PT1QdCxxdD1SKHR5cGVvZiBzZWxmPT1cIm9iamVjdFwiJiZzZWxmKSxWdD1SKHR5cGVvZiB0aGlzPT1cIm9iamVjdFwiJiZ0aGlzKSxLdD1SKHR5cGVvZiBnbG9iYWw9PVwib2JqZWN0XCImJmdsb2JhbCl8fHF0fHxWdHx8RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpLEd0PVooKTtcclxuKHF0fHx7fSkuXz1HdCx0eXBlb2YgZGVmaW5lPT1cImZ1bmN0aW9uXCImJnR5cGVvZiBkZWZpbmUuYW1kPT1cIm9iamVjdFwiJiZkZWZpbmUuYW1kPyBkZWZpbmUoZnVuY3Rpb24oKXtyZXR1cm4gR3R9KTpadD8oKFp0LmV4cG9ydHM9R3QpLl89R3QsUHQuXz1HdCk6S3QuXz1HdH0pLmNhbGwodGhpcyk7Il0sImZpbGUiOiJsb2Rhc2gubWluLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
